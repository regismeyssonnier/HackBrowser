//webtv-html5-player-1.3.0-03052017-093422
//hasplayer-1.10.1
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.OrangePlayer=e()}}(function(){var e;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return r(n?n:t)},d,d.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";var i=function(t,n){var i=e("../../../utils");return function(e){var r,o,s,a,l=t,u=!1,d=function(t){r=l.find(t.lastSettingsMenuClass),o=l.find(t.lastMenuClass),s=l.find(t.firstControlBarButtonClass),e.on(n+"-open-reglages",function(){u=!0}),e.on([n+"-open-menu",n+"-hide-osd"],function(){u=!1}),e.on([n+"-open-window"],function(){a=!0}),e.on([n+"-close-window"],function(){a=!1}),e.on(n+"-focus-first-element",function(){c()}),e.on(n+"-focus-last-element",function(){h()}),e.on(n+"-keyup-tab",function(t){var n=l[0];i.isSoloMode(e)&&!n.contains(t.target)&&(t.shiftKey?h():c())}),l[0].addEventListener("blur",function(e){var t=e.relatedTarget,n=l[0];e.preventDefault(),e.stopPropagation(),n.contains(t)||f(e)},{capture:!0})},c=function(){e.emit(n+"-main-mouse-move");var t=s;a&&(t=u?r:o),l.find(".op-control-bar").one("animationend",function(){t.focus()}),t.focus()},h=function(){e.emit(n+"-main-mouse-move");var t=u?r:o;l.find(".op-menu").one("animationend",function(){t.focus()}),t.focus()},f=function(t){if(t&&t.relatedTarget&&t.relatedTarget.previousElementSibling){var r=t.relatedTarget.previousElementSibling.contains(l[0]);i.isSoloMode(e)?(t.preventDefault(),t.stopPropagation(),r?c():h()):e.emit(n+"-leave-player",[t,!r])}},p=function(){};return{init:d,destroy:p}}};t.exports=i},{"../../../utils":71}],2:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return"<div>\n</div>"},useData:!0})},{"hbsfy/runtime":85}],3:[function(e,t,n){"use strict";var i=e("./background-error.hbs"),r=function(e){return function(t){var n=null,r=function(){n=$("#"+e+"-"+t.instanceId),l.initSubscribeControls()},o=function(){var e=i();n.empty().append(e),n.removeClass("op-hidden")},s=function(){n.addClass("op-hidden")},a=function(){n.empty(),s()},l={initSubscribeControls:function(){t.on(e+"-hasplayer-display-message",o),t.on(e+"-hasplayer-empty-message",a)}},u=function(){};return{init:r,destroy:u}}};t.exports=r},{"./background-error.hbs":2}],4:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<a class="stop-anchor" tabindex="0" aria-label="retour">\n    <!-- inject:close:svg -->\n    <svg version="1.1" focusable="false" baseProfile="tiny" id="Calque_1"\t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32"\t xml:space="preserve"><path fill="#444444" d="M28.9,24L28.9,24l-8-8l8-8l0,0c0.1-0.1,0.1-0.2,0.2-0.3c0.1-0.3,0-0.6-0.2-0.9l-3.8-3.8\tc-0.2-0.2-0.6-0.3-0.9-0.2c-0.1,0-0.2,0.1-0.3,0.2l0,0l-8,8l-8-8l0,0C7.9,3,7.8,2.9,7.7,2.9c-0.3-0.1-0.6,0-0.9,0.2L3.1,6.8\tC2.8,7.1,2.8,7.4,2.9,7.7C2.9,7.8,3,7.9,3.1,8l0,0l8,8l-8,8l0,0c-0.1,0.1-0.1,0.2-0.2,0.3c-0.1,0.3,0,0.6,0.2,0.9l3.8,3.8\tc0.2,0.2,0.6,0.3,0.9,0.2c0.1,0,0.2-0.1,0.3-0.2l0,0l8-8l8,8l0,0c0.1,0.1,0.2,0.1,0.3,0.2c0.3,0.1,0.6,0,0.9-0.2l3.8-3.8\tc0.2-0.2,0.3-0.6,0.2-0.9C29.1,24.2,29,24.1,28.9,24z"/></svg>\n    <!-- endinject -->\n</a>'},useData:!0})},{"hbsfy/runtime":85}],5:[function(e,t,n){"use strict";var i=e("./closeCross.hbs"),r=function(e){return function(t){var n=null,r=function(){n=$("#"+e+"-"+t.instanceId),o()},o=function(){var e=i();n.empty().append(e),l.init()},s=function(){n.removeClass("op-hidden")},a=function(){n.addClass("op-hidden")},l={init:function(){t.on(e+"-open-window",function(e){e&&s()}),t.on(e+"-close-window",a),n.on("click",function(n){n.stopPropagation(),t.emit(e+"-close-window"),0===n.clientX&&0===n.clientY?t.emit(e+"-close-window-enter"):t.emit(e+"-close-window-manual")})}},u=function(){};return{init:r,destroy:u}}};t.exports=r},{"./closeCross.hbs":4}],6:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o,s=t.helperMissing,a="function";return'<div class="op-summary">\n\t'+(null!=(o=null!=(o=t.summary||(null!=e?e.summary:e))?o:s,r=typeof o===a?o.call(e,{name:"summary",hash:{},data:i}):o)?r:"")+'\n</div>\n<div class="op-panel-container">\n\t'+(null!=(o=null!=(o=t.details||(null!=e?e.details:e))?o:s,r=typeof o===a?o.call(e,{name:"details",hash:{},data:i}):o)?r:"")+"\n</div>"},useData:!0})},{"hbsfy/runtime":85}],7:[function(e,t,n){"use strict";var i=e("./double-panel.hbs"),r=function(e){return function(t){var n=null,r=function(){n=$("#"+e),t.on(e+"-load-panel",o)},o=function(r){var o=i(r);n.html(o),t.emit(e+"-on-panel-loaded")},s=function(){};return{init:r,destroy:s}}};t.exports=r},{"./double-panel.hbs":6}],8:[function(e,t,n){"use strict";var i=function(e){return function(t){var n=null,i=!0,r=!1,o={13:"keydown-enter",32:"keydown-space",37:"keydown-left",38:"keydown-up",39:"keydown-right",40:"keydown-down",82:"keydown-R",76:"keydown-L"},s={37:"keyup-left",39:"keyup-right",9:"keyup-tab"},a=function(){n=t.options,t.on(e+"-main-mouse-enter",function(){r=!0}),t.on(e+"-main-mouse-leave",function(){r=!1}),t.on(e+"-enable-keys-events",function(){i=!0}),t.on(e+"-disable-keys-events",function(){i=!1}),n.on("keyup",u),n.on("keydown",l),$(document).on("keyup",function(e){r&&u(e)}),$(document).on("keydown",function(e){r&&l(e)})},l=function(n){if(i){t.emit(e+"-main-mouse-move");var r=o[n.keyCode];r&&(n.preventDefault(),n.stopPropagation(),t.emit(e+"-"+r,n))}},u=function(n){if(i){n.stopPropagation();var r=s[n.keyCode];r&&t.emit(e+"-"+r,n)}},d=function(){};return{init:a,destroy:d}}};t.exports=i},{}],9:[function(e,t,n){"use strict";var i=function(e){var t;return function(n){var i=null,r=!1,o=!1,s=n.delayInactivity,a=!0,l=function(){i=n.options,n.on([e+"-main-mouse-enter",e+"-main-mouse-move"],c),n.on(e+"-main-mouse-leave",h),n.on(e+"-video-touch-start",function(){r?(o=!1,d()):c()}),n.on(e+"-keep-osd-visible",function(){o=!0,c()}),n.on(e+"-purge-osd-visible",function(){o=!1,c()}),n.on(e+"-change-osd-timeout",function(e){var t="number"==typeof e?e:n.delayInactivity;s!==t&&(s=t,h())}),n.on(e+"-enable-osd-events",function(){a=!0}),n.on(e+"-disable-osd-events",function(){clearTimeout(t),a=!1}),n.on(e+"-force-show-osd",u),n.on(e+"-force-hide-osd",d),$(document).on("mouseup",function(){n.emit(e+"-on-mouseup")})},u=function(){r||(r=!0,clearTimeout(t),i.removeClass("op-cursor-hidden"),n.emit(e+"-show-osd"))},d=function(){o?h():(r=!1,clearTimeout(t),s=n.delayInactivity,i.addClass("op-cursor-hidden"),n.emit(e+"-close-window"),n.emit(e+"-hide-osd"))},c=function(){a&&(u(),h())},h=function(){a&&r&&(clearTimeout(t),t=setTimeout(d,s))},f=function(){};return{init:l,destroy:f}}};t.exports=i},{}],10:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="enter">\n  <!-- inject:enter:svg -->\n          <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 50 72" enable-background="new 0 0 50 72" xml:space="preserve">        <g id="Calque_1">            <path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M6.2,0.5h37.4        c3,0,5.5,2.4,5.5,5.5v60c0,3-2.4,5.5-5.5,5.5c0,0-6.1,0-14.7,0.1c-2.8,0-5.9-2.4-5.9-5.6c-0.1-6.7-0.1-12.1-0.1-13.1        c0.2-4.9-4.7-3.9-6.8-3.9c-5.7,0-9.9,0-9.9,0c-3,0-5.5-2.4-5.5-5.5V6C0.7,2.9,3.2,0.5,6.2,0.5z" />        </g>        <g id="Calque_2">            <g>                <polygon fill-rule="evenodd" clip-rule="evenodd" points="10.4,32.1 16,28.6 16,31.5 38.8,31.5 38.8,28.6 39.7,28.6 39.7,32.5             16,32.5 16,35.5         " />                <g transform="matrix(1 0 0 1 9.5596 25.708)" style="line-height:124.00000095%;fill:#010202;font-family:\'OrangeSans75Bold, Helvetica, Arial\'" id="text3042">                    <path d="m 1.8849,-3.4196001 4.0891001,0 0,-0.8446 -4.0891001,0 0,-2.3999 4.2436001,0 0,-0.8446 -5.20150008,0 0,7.5087001 5.38690008,0 0,-0.84460002 -4.4290001,0 0,-2.57500008" style="font-size:10.30000019px;line-height:124.00000095%" id="path3073" />                    <path d="m 7.6010783,-5.3972001 0,5.3972001 0.8652,0 0,-2.9767001 c 0,-1.1020989 0.5768009,-1.8231 1.4626001,-1.8231 0.6797996,0 1.1123996,0.4120007 1.1123996,1.0609 l 0,3.7389001 0.8549,0 0,-4.0788001 c 0,-0.8960991 -0.669501,-1.4729 -1.7098,-1.4729 -0.8033988,0 -1.3184001,0.3090008 -1.7921997,1.0609 l 0,-0.9064 -0.7931,0" style="font-size:10.30000019px;line-height:124.00000095%" id="path3075" />                    <path d="m 15.229677,-5.3972001 -0.8858,0 0,-1.4832 -0.8549,0 0,1.4832 -0.7313,0 0,0.7004 0.7313,0 0,4.07880009 c 0,0.54589946 0.3708,0.85490001 1.0403,0.85490001 0.206,0 0.412,-0.0206001 0.7004,-0.0721 l 0,-0.72100001 c -0.1133,0.0309 -0.2472,0.0412 -0.412,0.0412 -0.3708,0 -0.4738,-0.10300038 -0.4738,-0.48410001 l 0,-3.69770008 0.8858,0 0,-0.7004" style="font-size:10.30000019px;line-height:124.00000095%" id="path3077" />                    <path d="m 16.180818,-5.3972001 0,5.3972001 0.8652,0 0,-2.8016001 c 0,-0.7724992 0.1957,-1.2772003 0.6077,-1.5759 0.267799,-0.1956998 0.5253,-0.2575 1.1227,-0.2678 l 0,-0.8755 c -0.1442,-0.0206 -0.2163,-0.0309 -0.3296,-0.0309 -0.5562,0 -0.978501,0.3296008 -1.4729,1.133 l 0,-0.9785 -0.7931,0" style="font-size:10.30000019px;line-height:124.00000095%" id="path3079" />                    <path d="m 24.194056,-2.4102 c 0,-0.8239992 -0.0618,-1.3184005 -0.2163,-1.7201001 -0.350199,-0.8857991 -1.174201,-1.4214 -2.1836,-1.4214 -1.503798,0 -2.472,1.1536018 -2.472,2.9252001 0,1.77159821 0.937302,2.8634 2.4514,2.8634 1.235999,0 2.090901,-0.70040118 2.3072,-1.8746 l -0.8652,0 c -0.236899,0.71069927 -0.721,1.08149999 -1.4111,1.08149999 -0.545899,0 -1.0094,-0.24720046 -1.2978,-0.70039999 -0.206,-0.3089997 -0.2781,-0.6180006 -0.2884,-1.1536 l 3.9758,0 m -3.9552,-0.7004001 c 0.0721,-0.999099 0.679801,-1.648 1.545,-1.648 0.844599,0 1.4935,0.7004009 1.4935,1.5862 0,0.0206 0,0.0412 -0.0103,0.0618 l -3.0282,0 m 1.8437,-4.5114 -0.9888,1.5244 0.618,0 1.5347,-1.5244 -1.1639,0" style="font-size:10.30000019px;line-height:124.00000095%" id="path3081" />                    <path d="m 29.927455,-2.4102 c 0,-0.8239992 -0.0618,-1.3184005 -0.2163,-1.7201001 -0.3502,-0.8857991 -1.174201,-1.4214 -2.1836,-1.4214 -1.503799,0 -2.472,1.1536018 -2.472,2.9252001 0,1.77159821 0.937301,2.8634 2.4514,2.8634 1.235999,0 2.0909,-0.70040118 2.3072,-1.8746 l -0.8652,0 c -0.2369,0.71069927 -0.721001,1.08149999 -1.4111,1.08149999 -0.5459,0 -1.009401,-0.24720046 -1.2978,-0.70039999 -0.206,-0.3089997 -0.2781,-0.6180006 -0.2884,-1.1536 l 3.9758,0 m -3.9552,-0.7004001 c 0.0721,-0.999099 0.679801,-1.648 1.545,-1.648 0.844599,0 1.4935,0.7004009 1.4935,1.5862 0,0.0206 0,0.0412 -0.0103,0.0618 l -3.0282,0" style="font-size:10.30000019px;line-height:124.00000095%" id="path3083" />                </g>            </g>        </g>    </svg>\n  <!-- endinject -->\n</div>\n<div class="esc">\n  <!-- inject:esc:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_1">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#fff" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/>\t<g>\t\t<polygon fill="#fff" points="17.2,27.4 22,27.4 22,26.1 18.8,26.1 18.8,23.8 21.7,23.8 21.7,22.5 18.8,22.5 18.8,20.6 22,20.6 \t\t\t22,19.3 17.2,19.3 \t\t"/>\t\t<path fill="#fff" d="M27.1,21.5c-0.4-0.1-0.9-0.3-1.7-0.3c-1.2,0-2.3,0.6-2.3,1.9c0,2,2.7,1.3,2.7,2.4c0,0.6-0.6,0.8-1,0.8\t\t\tc-0.5,0-1-0.1-1.5-0.4l-0.1,1.3c0.6,0.1,1.3,0.3,1.8,0.3c1.3,0,2.6-0.5,2.6-1.9c0-2.2-2.7-1.5-2.7-2.6c0-0.5,0.4-0.6,0.9-0.6\t\t\tc0.5,0,0.9,0.1,1.4,0.3V21.5z"/>\t\t<path fill="#fff" d="M32.6,21.5c-0.4-0.1-0.9-0.3-1.4-0.3c-1.9,0-2.9,1.4-2.9,3.1c0,1.8,1,3.2,2.9,3.2c0.6,0,1.2-0.1,1.5-0.3\t\t\tV26c-0.4,0.1-0.8,0.3-1.3,0.3c-1,0-1.5-0.8-1.5-1.9c0-1,0.5-1.8,1.5-1.8c0.5,0,0.8,0,1,0.1L32.6,21.5z"/>\t</g></g></svg>\n  <!-- endinject -->\n</div>\n<div class="echap">\n  <!-- inject:echap:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#fff" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="vecto_-_copie">\t<g>\t\t<path fill="#fff" d="M10.5,27.2V20h5.4v1.2h-3.9v1.6h3.6v1.2h-3.6v2h4v1.2H10.5z M12.3,19.6l0.7-1.5h1.6l-1.4,1.5H12.3z"/>\t\t<path fill="#fff" d="M21.7,23.6l-1.4,0.2c0-0.3-0.1-0.5-0.3-0.6C19.9,23,19.7,23,19.4,23c-0.3,0-0.6,0.1-0.8,0.4\t\t\ts-0.3,0.6-0.3,1.2c0,0.6,0.1,1.1,0.3,1.3c0.2,0.3,0.5,0.4,0.8,0.4c0.3,0,0.5-0.1,0.6-0.2c0.2-0.1,0.3-0.4,0.4-0.8l1.4,0.2\t\t\tc-0.1,0.6-0.4,1.1-0.8,1.4s-0.9,0.5-1.6,0.5c-0.8,0-1.4-0.2-1.8-0.7s-0.7-1.1-0.7-2c0-0.9,0.2-1.5,0.7-2s1.1-0.7,1.9-0.7\t\t\tc0.6,0,1.1,0.1,1.5,0.4C21.3,22.6,21.6,23,21.7,23.6z"/>\t\t<path fill="#fff" d="M24.2,20v2.7c0.4-0.5,1-0.8,1.6-0.8c0.3,0,0.6,0.1,0.9,0.2c0.3,0.1,0.4,0.3,0.6,0.5\t\t\tc0.1,0.2,0.2,0.4,0.3,0.6c0,0.2,0.1,0.6,0.1,1v3.1h-1.4v-2.8c0-0.5,0-0.9-0.1-1c-0.1-0.1-0.1-0.3-0.3-0.4s-0.3-0.1-0.5-0.1\t\t\tc-0.2,0-0.4,0.1-0.6,0.2c-0.2,0.1-0.3,0.3-0.4,0.5c-0.1,0.2-0.1,0.6-0.1,1v2.6h-1.4V20H24.2z"/>\t\t<path fill="#fff" d="M30,23.6l-1.3-0.2c0.1-0.5,0.4-0.9,0.7-1.1s0.9-0.4,1.5-0.4c0.6,0,1.1,0.1,1.4,0.2s0.5,0.3,0.6,0.6\t\t\ts0.2,0.6,0.2,1.2l0,1.6c0,0.5,0,0.8,0.1,1c0,0.2,0.1,0.5,0.2,0.7h-1.4c0-0.1-0.1-0.2-0.1-0.4c0-0.1,0-0.1,0-0.2\t\t\tc-0.2,0.2-0.5,0.4-0.8,0.5c-0.3,0.1-0.6,0.2-0.9,0.2c-0.5,0-1-0.1-1.3-0.4c-0.3-0.3-0.5-0.7-0.5-1.1c0-0.3,0.1-0.6,0.2-0.8\t\t\tc0.1-0.2,0.3-0.4,0.6-0.5s0.6-0.2,1.1-0.3c0.6-0.1,1.1-0.2,1.3-0.3v-0.1c0-0.3-0.1-0.5-0.2-0.6s-0.4-0.2-0.7-0.2\t\t\tc-0.2,0-0.4,0-0.6,0.1S30.1,23.4,30,23.6z M31.8,24.7c-0.2,0.1-0.5,0.1-0.8,0.2s-0.6,0.2-0.8,0.2c-0.2,0.1-0.3,0.3-0.3,0.5\t\t\tc0,0.2,0.1,0.4,0.2,0.5c0.1,0.1,0.3,0.2,0.6,0.2c0.2,0,0.5-0.1,0.7-0.2c0.2-0.1,0.3-0.3,0.3-0.5c0-0.1,0.1-0.3,0.1-0.7V24.7z"/>\t\t<path fill="#fff" d="M34.5,22h1.3v0.8c0.2-0.3,0.4-0.5,0.7-0.6c0.3-0.2,0.6-0.2,1-0.2c0.6,0,1.1,0.2,1.5,0.7\t\t\tc0.4,0.5,0.6,1.1,0.6,2c0,0.9-0.2,1.6-0.6,2c-0.4,0.5-0.9,0.7-1.5,0.7c-0.3,0-0.6-0.1-0.8-0.2c-0.2-0.1-0.5-0.3-0.7-0.6v2.6h-1.4\t\t\tV22z M35.9,24.5c0,0.6,0.1,1,0.3,1.3c0.2,0.3,0.5,0.4,0.9,0.4c0.3,0,0.6-0.1,0.8-0.4c0.2-0.3,0.3-0.7,0.3-1.3c0-0.5-0.1-1-0.3-1.2\t\t\tc-0.2-0.3-0.5-0.4-0.8-0.4c-0.3,0-0.6,0.1-0.8,0.4C36,23.6,35.9,24,35.9,24.5z"/>\t</g></g></svg>\n  <!-- endinject -->\n</div>\n<div class="espace">\n  <!-- inject:espace:svg -->\n  <svg version="1.1" focusable="false" baseProfile="tiny" id="Calque_1"\t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 64 32"\t xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill="none" stroke="#010202" stroke-width="2" stroke-miterlimit="10" d="M5.5,1h53.1c2.4,0,4.4,1.9,4.4,4.3v21.4\t\tc0,2.4-1.9,4.3-4.4,4.3H5.5c-2.4,0-4.4-1.9-4.4-4.3V5.3C1.2,2.9,3.1,1,5.5,1z"/></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-fleche-g">\n  <!-- inject:aide-fleche-g:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="Calque_8">\t<path fill="#fff" clip-rule="evenodd" d="M15.5,24.3l9.1,5.9v-5h9.9v-1.8h-9.9v-5.1L15.5,24.3z"/></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-fleche-d">\n  <!-- inject:aide-fleche-d:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="Calque_8_-_copie">\t<path fill="#fff" clip-rule="evenodd" d="M25.3,18.4v5.1h-9.9v1.8h9.9v5l9.1-5.9L25.3,18.4z"/></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-fleche-b">\n  <!-- inject:aide-fleche-b:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="F_D_-_copie_2">\t<path fill="#fff" clip-rule="evenodd" d="M30.9,24.7h-5.1v-9.9H24v9.9h-5l5.9,9.1L30.9,24.7z"/></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-fleche-h">\n  <!-- inject:aide-fleche-h:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="F_D_-_copie">\t<path fill="#fff" clip-rule="evenodd" d="M19,24h5.1v9.9h1.8V24h5L25,14.9L19,24z"/></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-l">\n  <!-- inject:aide-l:svg -->\n  <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 62 62" enable-background="new 0 0 62 62" xml:space="preserve"><g id="Calque_3" display="none"></g><g id="Calque_3_-_copie">\t<path fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M9.5,1.7h42.8c4.6,0,8.4,3.7,8.4,8.3v41.5\t\tc0,4.6-3.7,8.3-8.4,8.3H9.5c-4.6,0-8.4-3.7-8.4-8.3V10C1.2,5.5,5,1.7,9.5,1.7z"/></g><g id="Calque_3_-_copie_2" display="none">\t<rect x="-0.1" y="0.4" display="inline" fill="#3AAA35" width="62" height="60.6"/></g><g id="vecto" display="none">\t\t\t<text transform="matrix(1 0 0 1 12.3096 34.3935)" display="inline" fill="#585857" font-family="\'Arial-BoldMT\'" font-size="12.5004">échap</text></g><g id="vecto_-_copie" display="none">\t<g display="inline">\t\t<path fill="#010202" d="M13,34.3v-8.9h6.7v1.5h-4.8v2h4.5v1.5h-4.5v2.5h5v1.5C19.8,34.3,13,34.3,13,34.3z M15.3,24.9l0.9-1.9h2\t\t\tl-1.7,1.9H15.3z"/>\t\t<path fill="#010202" d="M26.9,29.9l-1.7,0.2c0-0.4-0.1-0.6-0.4-0.7c-0.1-0.2-0.4-0.2-0.7-0.2c-0.4,0-0.7,0.1-1,0.5\t\t\tc-0.2,0.4-0.4,0.7-0.4,1.5c0,0.7,0.1,1.4,0.4,1.6c0.2,0.4,0.6,0.5,1,0.5s0.6-0.1,0.7-0.2c0.2-0.1,0.4-0.5,0.5-1l1.7,0.2\t\t\tc-0.1,0.7-0.5,1.4-1,1.7c-0.5,0.4-1.1,0.6-2,0.6c-1,0-1.7-0.2-2.2-0.9c-0.5-0.6-0.9-1.4-0.9-2.5c0-1.1,0.2-1.9,0.9-2.5\t\t\tc0.6-0.6,1.4-0.9,2.4-0.9c0.7,0,1.4,0.1,1.9,0.5C26.4,28.6,26.8,29.1,26.9,29.9z"/>\t\t<path fill="#010202" d="M30,25.4v3.3c0.5-0.6,1.2-1,2-1c0.4,0,0.7,0.1,1.1,0.2s0.5,0.4,0.7,0.6c0.1,0.2,0.2,0.5,0.4,0.7\t\t\tc0,0.2,0.1,0.7,0.1,1.2v3.8h-1.7V31c0-0.6,0-1.1-0.1-1.2s-0.1-0.4-0.4-0.5c-0.2-0.1-0.4-0.1-0.6-0.1s-0.5,0.1-0.7,0.2\t\t\tc-0.2,0.1-0.4,0.4-0.5,0.6s-0.1,0.7-0.1,1.2v3.2h-1.7v-9.1H30z"/>\t\t<path fill="#010202" d="M37.2,29.9l-1.6-0.2c0.1-0.6,0.5-1.1,0.9-1.4s1.1-0.5,1.9-0.5s1.4,0.1,1.7,0.2c0.4,0.1,0.6,0.4,0.7,0.7\t\t\tc0.1,0.4,0.2,0.7,0.2,1.5v2c0,0.6,0,1,0.1,1.2c0,0.2,0.1,0.6,0.2,0.9h-1.7c0-0.1-0.1-0.2-0.1-0.5c0-0.1,0-0.1,0-0.2\t\t\tc-0.2,0.2-0.6,0.5-1,0.6c-0.4,0.1-0.7,0.2-1.1,0.2c-0.6,0-1.2-0.1-1.6-0.5c-0.4-0.4-0.6-0.9-0.6-1.4c0-0.4,0.1-0.7,0.2-1\t\t\tc0.1-0.2,0.4-0.5,0.7-0.6s0.7-0.2,1.4-0.4c0.7-0.1,1.4-0.2,1.6-0.4v-0.1c0-0.4-0.1-0.6-0.2-0.7s-0.5-0.2-0.9-0.2\t\t\tc-0.2,0-0.5,0-0.7,0.1S37.3,29.6,37.2,29.9z M39.4,31.2c-0.2,0.1-0.6,0.1-1,0.2c-0.4,0.1-0.7,0.2-1,0.2c-0.2,0.1-0.4,0.4-0.4,0.6\t\t\ts0.1,0.5,0.2,0.6s0.4,0.2,0.7,0.2c0.2,0,0.6-0.1,0.9-0.2s0.4-0.4,0.4-0.6c0-0.1,0.1-0.4,0.1-0.9C39.4,31.5,39.4,31.2,39.4,31.2z"\t\t\t/>\t\t<path fill="#010202" d="M42.8,27.9h1.6v1c0.2-0.4,0.5-0.6,0.9-0.7c0.4-0.2,0.7-0.2,1.2-0.2c0.7,0,1.4,0.2,1.9,0.9s0.7,1.4,0.7,2.5\t\t\tc0,1.1-0.2,2-0.7,2.5c-0.5,0.6-1.1,0.9-1.9,0.9c-0.4,0-0.7-0.1-1-0.2c-0.2-0.1-0.6-0.4-0.9-0.7v3.2h-1.7v-8.9H42.8z M44.5,31\t\t\tc0,0.7,0.1,1.2,0.4,1.6c0.2,0.4,0.6,0.5,1.1,0.5c0.4,0,0.7-0.1,1-0.5c0.2-0.4,0.4-0.9,0.4-1.6c0-0.6-0.1-1.2-0.4-1.5\t\t\tc-0.2-0.4-0.6-0.5-1-0.5c-0.4,0-0.7,0.1-1,0.5C44.6,29.9,44.5,30.4,44.5,31z"/>\t</g></g><g id="esc" display="none">\t<g display="inline">\t\t<polygon fill="#010202" points="21.3,34.6 27.3,34.6 27.3,33 23.3,33 23.3,30.1 26.9,30.1 26.9,28.5 23.3,28.5 23.3,26.2 \t\t\t27.3,26.2 27.3,24.6 21.3,24.6 \t\t"/>\t\t<path fill="#010202" d="M33.6,27.3c-0.5-0.1-1.1-0.4-2.1-0.4c-1.5,0-2.9,0.7-2.9,2.4c0,2.5,3.3,1.6,3.3,3c0,0.7-0.7,1-1.2,1\t\t\tc-0.6,0-1.2-0.1-1.9-0.5l-0.1,1.6c0.7,0.1,1.6,0.4,2.2,0.4c1.6,0,3.2-0.6,3.2-2.4c0-2.7-3.3-1.9-3.3-3.2c0-0.6,0.5-0.7,1.1-0.7\t\t\tc0.6,0,1.1,0.1,1.7,0.4v-1.5H33.6z"/>\t\t<path fill="#010202" d="M40.4,27.3c-0.5-0.1-1.1-0.4-1.7-0.4c-2.4,0-3.6,1.7-3.6,3.8c0,2.2,1.2,4,3.6,4c0.7,0,1.5-0.1,1.9-0.4\t\t\tv-1.5c-0.5,0.1-1,0.4-1.6,0.4c-1.2,0-1.9-1-1.9-2.4c0-1.2,0.6-2.2,1.9-2.2c0.6,0,1,0,1.2,0.1L40.4,27.3z"/>\t</g></g><g id="reperes" display="none"></g><g id="F_G" display="none">\t<path display="inline" d="M19.2,30.8l11.3,7.3v-6.2h12.3v-2.2H30.5v-6.3L19.2,30.8z"/></g><g id="F_D" display="none">\t<path display="inline" d="M31.4,23.4v6.3H19.1V32h12.3v6.2l11.3-7.3L31.4,23.4z"/></g><g id="F_D_-_copie" display="none">\t<path display="inline" d="M23.6,30.4h6.3v12.3h2.2V30.4h6.2L31,19.1L23.6,30.4z"/></g><g id="F_D_-_copie_2" display="none">\t<path display="inline" d="M38.3,31.2H32V19h-2.2v12.3h-6.2l7.3,11.3L38.3,31.2z"/></g><path d="M22.7,44V17.5h3.5v23.2h13v3.1H22.7V44z"/></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-r">\n  <!-- inject:aide-r:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="R_vecto">\t<g>\t\t<path d="M18.8,12.5c1.4-0.3,3.4-0.4,5.4-0.4c3,0,4.9,0.5,6.2,1.8c1.1,1,1.7,2.4,1.7,4.1c0,2.9-1.8,4.7-4.1,5.5v0.1\t\t\tc1.7,0.6,2.7,2.1,3.2,4.4c0.7,3,1.2,5.1,1.7,5.9h-2.9c-0.4-0.6-0.8-2.5-1.4-5.2c-0.6-3-1.8-4.1-4.3-4.2h-2.6v9.4h-2.8V12.5z\t\t\t M21.5,22.4h2.9c3,0,4.9-1.6,4.9-4.1c0-2.8-2-4-5-4c-1.3,0-2.3,0.1-2.8,0.3V22.4z" fill="#fff"/>\t</g></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-tab">\n  <!-- inject:aide-tab:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="Tab_Mac">\t<g>\t\t<rect x="16.6" y="23.7" fill-rule="evenodd" clip-rule="evenodd" fill="#010202" width="13" height="1.4"/>\t\t<g>\t\t\t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#010202" points="32,24.5 24.6,19.9 24.6,21.4 28.6,23.7 16.5,23.7 \t\t\t\t16.5,25.1 28.6,25 24.6,27.5 24.6,28.9 \t\t\t"/>\t\t\t<rect x="32.7" y="19.7" clip-rule="evenodd" fill="#fff" width="1.4" height="9"/>\t\t</g>\t</g></g></svg>\n  <!-- endinject -->\n</div>\n<div class="aide-tab-2">\n  <!-- inject:aide-tab-2:svg -->\n  <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 50 49" enable-background="new 0 0 50 49" xml:space="preserve"><g id="Calque_3_-_copie">\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" d="M7.7,0.9\t\th34.5c3.7,0,6.8,3,6.8,6.7v33.5c0,3.7-3,6.7-6.8,6.7H7.7c-3.7,0-6.8-3-6.8-6.7V7.6C1,3.9,4,0.9,7.7,0.9z"/></g><g id="Calque_15">\t<g>\t\t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#010202" points="16.7,18 23.9,13.5 23.9,17.4 31.9,17.4 31.9,18.7 \t\t\t23.9,18.7 23.9,22.6 \t\t"/>\t\t<rect x="14.8" y="13.3" clip-rule="evenodd" fill="#fff" width="1.4" height="9"/>\t\t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#010202" points="33.2,30.8 25.8,26.2 25.8,30 17.8,30 17.8,31.4 \t\t\t25.8,31.4 25.8,35.2 \t\t"/>\t\t<rect x="33.9" y="26" clip-rule="evenodd" fill="#fff" width="1.4" height="9"/>\t</g></g></svg>\n  <!-- endinject -->\n</div>'},useData:!0})},{"hbsfy/runtime":85}],11:[function(e,t,n){"use strict";var i=e("../../../utils"),r=function(e){var t=3e3,n="0",r="controlBarToolTip",o=null,s=null;return function(a){var l=null,u=null,d=function(){l=$("#"+e+"-"+a.instanceId),c()},c=function(){o=a.options.i18n[r],u=l.find(".op-volume"),y.init()},h=function(){l.addClass(a.classes.opShowAnim).removeClass(a.classes.opFadeOut).removeClass(a.classes.opHidden)},f=function(){l.removeClass(a.classes.opFadeOut).removeClass(a.classes.opHidden)},p=function(){l.hasClass(a.classes.opHidden)||l.removeClass(a.classes.opShowAnim).addClass(a.classes.opFadeOut)},m=function(e,t){e.addClass("op-hidden"),i.destroyTimeout(t)},g=function(){l.removeClass(a.classes.opShowAnim).addClass(a.classes.opHidden),clearTimeout(s)},y={initGeneralControls:function(){l.find(".op-control-menu").on("click",function(t){clearTimeout(s),a.emit(e+"-open-menu"),document.querySelector(".op-menu-sumup").focus(),a.emit(e+"-gstat",{area:"menuPrincipal",action:"afficher"})}),l.find(".op-reglages").on("click",function(t){a.emit(e+"-open-reglages"),document.querySelector(".op-settings-menu-format").focus(),a.emit(e+"-gstat",{area:"menuParametre",action:"afficher"})})},initVideoControls:function(){function t(e){n.attr("title",e?o.buttonPauseToolTipLabel:o.buttonPlayToolTipLabel),n.toggleClass("op-pause",e),i.copyTitleToSVG(n)}var n=l.find(".op-play");n.on("click",function(){a.emit(e+"-play-pause")}),a.on(e+"-video-play",function(e){t(!0),"undefined"!=typeof e&&"undefined"!=typeof e.volume?y.setVolume(""+Math.round(100*e.volume)):i.getPreferences().volume&&y.setVolume(""+i.getPreferences().volume)}),a.on(e+"-video-pause",function(){t(!1)}),a.on(e+"-show-osd",h),a.on(e+"-hide-osd",p),l.on("mouseenter",function(){a.emit(e+"-keep-osd-visible")}),l.on("mouseleave",function(){a.emit(e+"-purge-osd-visible")}),a.on(e+"-open-window",g),a.on(e+"-close-window",f),a.on(e+"-setConfig",function(){i.isSoloMode(a)?(l.find(".op-format, .op-zoom-normal").hide(),l.find(".op-zoom-vignette").show(),l.find(".op-control-right").addClass("op-mode-vignette")):(l.find(".op-format, .op-zoom-normal").show(),l.find(".op-zoom-vignette").hide()),this.playerConfig.isFeatureEnabled("play-pause")||l.find(".op-play").hide()}),l.find(".op-format").on("click",function(t){t.stopPropagation(),a.emit(e+"-onSticked")})},initZoomControls:function(){var t=l.find(".op-zoom"),n=function(){t.toggleClass("fullscreen");var e=a.options.i18n[r],n=t.attr("title");t.attr("title",n===e.buttonNormalScreenToolTipLabel?e.buttonFullScreenToolTipLabel:e.buttonNormalScreenToolTipLabel)},i=function(n){n.stopPropagation(),a.emit(e+"-change-zoom",e+"-main-container"),a.emit(e+"-gstat",{area:"ecran",action:t.hasClass("fullscreen")?"quart":"full"})};t.on("click",i),document.msFullscreenEnabled&&t.on("keypress",function(e){13===e.keyCode&&i(e)}),a.on(e+"-fullscreen",n)},setVolume:function(t,n){var r=l.find(".op-sound"),s="op-range";n=n||{save:!0},s+=Math.max(Math.min(8*(Math.floor(t/8)+1),100),8),u.removeClass(),u.addClass("op-volume "+s),u.val(t),u.attr("aria-valuenow",t),"0"===t?(n.save!==!1&&i.storePreferences({volume:50}),r.attr("title",o.buttonVolumeToolTipLabel),r.find("svg:first-child").css("display","none"),r.find("svg:last-child").css("display","block"),r.find("path:nth-last-child(2)").css("display","")):(n.save!==!1&&i.storePreferences({volume:t}),r.attr("title",o.buttonMuteToolTipLabel),t<51?r.find("path:nth-last-child(2)").css("display","none"):r.find("path:nth-last-child(2)").css("display",""),r.find("svg:first-child").css("display","block"),r.find("svg:last-child").css("display","none")),l.find(".op-volume-value").text(t),l.find(".op-container-volume").attr({"aria-valuenow":t,"aria-valuetext":t+"% "+a._("sound")}),a.emit(e+"-change-volume",t)},keyBoardVolume:function(t){if(9===t.keyCode)m(l.find(".op-container-volume"),e+"hideVolumeTimeout");else{t.stopPropagation(),t.preventDefault(),i.refreshTimeout(e+"hideVolumeTimeout");var n=parseInt(u.val());switch(t.keyCode){case 38:n<100&&y.setVolume(n+1+"");break;case 40:n>0&&y.setVolume(n-1+"")}}},initSoundControls:function(){var r=l.find(".op-sound"),o=l.find(".op-container-volume");u.on("mousemove",function(t){if(1===t.buttons){i.refreshTimeout(e+"hideVolumeTimeout");var n=t.target.value;y.setVolume(n)}}),u.on("mousedown",function(){a.emit(e+"-gstat",{area:"volume",action:"changer"})}),u.on("click",function(t){i.refreshTimeout(e+"hideVolumeTimeout");var n=t.target.value;y.setVolume(n)}),r.on("mouseover focus",function(n){i.initTimeout(e+"hideVolumeTimeout",m.bind(void 0,o,e+"hideVolumeTimeout"),t),i.detectionMobileTablet()||o.removeClass("op-hidden")}),o.on("mouseover focus",function(t){i.cancelTimeout(e+"hideVolumeTimeout"),i.detectionMobileTablet()||o.removeClass("op-hidden")}),o.on("mouseleave",function(n){i.initTimeout(e+"hideVolumeTimeout",m.bind(void 0,o,e+"hideVolumeTimeout"),t)}),r.on("click",function(t){t.stopPropagation();var o=u.val(),s=!1;"0"!==o?(n=o,o="0",s=!0):(o="0"===n?"50":n,n="0"),y.setVolume(o,{save:!s}),i.copyTitleToSVG(r),a.emit(e+"-gstat",{area:"volume",action:"changer"})}),r.on("keydown",this.keyBoardVolume,!1),o.on("keydown",this.keyBoardVolume,!1);var s=this;a.on(e+"-main-volume",function(n){s.keyBoardVolume(n),i.initTimeout(e+"hideVolumeTimeout",m.bind(void 0,o,"hideVolumeTimeout"),t),o.removeClass("op-hidden")},!1)},svga11y:function(){i.copyTitleToSVG(l.find("a[title]"))},init:function(){this.svga11y(),this.initGeneralControls(),this.initVideoControls(),this.initZoomControls(),this.initSoundControls()}},v=function(){};return{init:d,destroy:v}}};t.exports=r},{"../../../utils":71}],12:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r,o=t.helperMissing;return"\n"+(null!=(r=(t.if_eq||e&&e.if_eq||o).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.type:r,{name:"if_eq",hash:{compare:"LINK"},fn:this.program(2,i,0),
inverse:this.noop,data:i}))?r:"")+(null!=(r=(t.if_eq||e&&e.if_eq||o).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.type:r,{name:"if_eq",hash:{compare:"REPLAY"},fn:this.program(7,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=(t.if_eq||e&&e.if_eq||o).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.type:r,{name:"if_eq",hash:{compare:"ACK"},fn:this.program(9,i,0),inverse:this.noop,data:i}))?r:"")},2:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'            <a href="'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.value:r,e))+'" target="_blank" class="op-error-link" aria-label="'+s(o(null!=(r=null!=e?e.i18n:e)?r.newWindow:r,e))+'">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.btnText:r,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.program(5,i,0),data:i}))?r:"")+"            </a>\n"},3:function(e,t,n,i){var r;return"                    "+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.btnText:r,e))+"\n"},5:function(e,t,n,i){var r;return"                    "+this.escapeExpression(this.lambda(null!=(r=null!=e?e.i18n:e)?r.messageViewMoreInfoLabel:r,e))+"\n"},7:function(e,t,n,i){var r;return'            <button class="op-error-button">\n                '+this.escapeExpression(this.lambda(null!=(r=null!=e?e.i18n:e)?r.messageViewReplayLabel:r,e))+"\n            </button>\n"},9:function(e,t,n,i){var r;return'            <button class="op-acknowledge-button" value="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.value:r,e))+'">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.btnText:r,{name:"if",hash:{},fn:this.program(10,i,0),inverse:this.program(12,i,0),data:i}))?r:"")+"            </button>\n"},10:function(e,t,n,i){var r;return"                "+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.btnText:r,e))+"\n"},12:function(e,t,n,i){var r;return"                "+this.escapeExpression(this.lambda(null!=(r=null!=e?e.i18n:e)?r.messageViewAcknowledgeButtonLabel:r,e))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=this.lambda;return'<div class="op-error-box" role="alert">\n    <div class="op-error-picto op-picto-error">\n            <!-- inject:error:svg -->\n            <svg version="1.1" focusable="false" baseProfile="tiny" id="Calque_1"\t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32"\t xml:space="preserve"><g id="erreur">\t<path fill="#444444" d="M16,28.5c-3.8,0-7.5,0-11.3,0c-0.4,0-0.8,0-1.1-0.1c-1.8-0.5-2.7-2-2.2-4c0.1-0.5,0.3-0.9,0.5-1.3\t\tc3.6-6.2,7.2-12.5,10.8-18.7c1.1-1.9,3-2.4,4.7-1.7c0.8,0.3,1.3,0.9,1.8,1.6C22.8,10.5,26.4,16.8,30,23c0.5,0.9,0.8,1.8,0.6,2.9\t\tc-0.2,1.6-1.5,2.6-3.3,2.6c-3.6,0-7.2,0-10.7,0C16.4,28.5,16.2,28.5,16,28.5z M16,20.3c1.1,1.1,2.1,2.1,3.1,3.2\t\tc0.4,0.4,0.9,0.5,1.4,0.4c1-0.3,1.3-1.5,0.5-2.3c-1-1-2.1-2.1-3.1-3.1c0.1-0.1,0.2-0.2,0.3-0.3c0.9-0.9,1.8-1.7,2.6-2.6\t\tc0.6-0.6,0.7-1.5,0.1-2c-0.6-0.6-1.4-0.5-2,0.1c-0.7,0.7-1.5,1.5-2.2,2.2c-0.2,0.2-0.5,0.5-0.7,0.7c-0.2-0.1-0.3-0.2-0.4-0.3\t\tc-0.9-0.9-1.7-1.8-2.6-2.6c-0.6-0.6-1.4-0.6-2-0.1c-0.6,0.6-0.5,1.4,0.1,2c0.7,0.7,1.4,1.4,2.1,2c0.3,0.3,0.6,0.6,1,0.9\t\tc-0.2,0.2-0.3,0.2-0.4,0.3c-0.9,0.9-1.9,1.9-2.8,2.8c-0.4,0.4-0.5,0.9-0.3,1.4c0.3,1,1.5,1.3,2.3,0.5C13.9,22.4,14.9,21.4,16,20.3z\t\t"/></g></svg>\n            <!-- endinject -->\n    </div>\n    <div class="op-error-picto op-picto-warn">\n            <!-- inject:alert:svg -->\n            <svg version="1.1" focusable="false" baseProfile="tiny" id="Calque_1"\t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32"\t xml:space="preserve"><path fill="#444444" d="M15.9,28.5c-3.7,0-7.5,0-11.2,0c-0.5,0-1.1-0.1-1.6-0.3C1.8,27.8,1,26.4,1.3,25c0.1-0.7,0.3-1.3,0.7-2\tc3.5-6.2,7.1-12.3,10.7-18.5c0.6-1,1.3-1.8,2.5-2.1c1.6-0.4,3.1,0.3,4,1.9c0.8,1.4,1.6,2.8,2.4,4.2c2.8,4.8,5.5,9.6,8.3,14.4\tc0.6,1,0.9,2,0.7,3.2c-0.2,1.3-1.2,2.1-2.4,2.3c-0.4,0.1-0.8,0.1-1.3,0.1C26.1,28.5,19.6,28.5,15.9,28.5z M14.3,11.1\tc0.1,1.7,0.3,3.4,0.4,5c0.1,1.1,0.2,2.2,0.3,3.2c0.1,0.6,0.4,0.9,1,1c0.6,0,0.9-0.3,1-1c0-0.3,0.1-0.6,0.1-0.9\tc0.1-1.5,0.3-3,0.4-4.5c0.1-1.1,0.2-2.2,0.2-3.3c0-1.4-1.4-2.2-2.5-1.5C14.4,9.6,14.3,10.3,14.3,11.1z M16,25.5c1,0,1.7-0.7,1.7-1.7\ts-0.8-1.7-1.7-1.7c-0.9,0-1.7,0.7-1.7,1.7S15,25.5,16,25.5z"/></svg>\n            <!-- endinject -->\n    </div>\n    <div class="op-error-picto op-picto-info">\n            <!-- inject:info:svg -->\n            <svg version="1.1" focusable="false" baseProfile="tiny" id="Calque_1"\t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32"\t xml:space="preserve"><path fill="#444444" d="M16,1.3C7.9,1.3,1.3,7.9,1.3,16S7.9,30.7,16,30.7S30.7,24.1,30.7,16S24.1,1.3,16,1.3z M14.6,7.6\tC15,7.2,15.5,7,16,7c0.6,0,1,0.2,1.4,0.6S18,8.5,18,9c0,0.6-0.2,1-0.6,1.4S16.6,11,16,11s-1-0.2-1.4-0.6S14,9.6,14,9\tS14.2,8,14.6,7.6z M19.1,24.9C19.1,25,19,25,19,25h-6c-0.1,0-0.1-0.1-0.1-0.1v-0.3c0-0.1,0.1-0.2,0.1-0.2l0.7-0.2\tc0.1,0,0.2-0.1,0.2-0.2l0.3-1c0-0.1,0-0.2,0-0.3v-6.5c0-0.1,0-0.2,0-0.3c0,0-0.1-0.8-0.3-0.9S13,14.5,13,14.5\tc-0.1,0-0.1-0.1-0.1-0.2V14c0-0.1,0.1-0.1,0.1-0.1h4.7c0.1,0,0.1,0.1,0.1,0.1v8.8c0,0.1,0,0.2,0,0.3c0,0,0.1,0.8,0.2,1\ts0.8,0.3,0.8,0.3c0.1,0,0.1,0.1,0.1,0.2L19.1,24.9L19.1,24.9z"/><path display="none" fill="#444444" d="M15.9,28.5c-3.7,0-7.5,0-11.2,0c-0.5,0-1.1-0.1-1.6-0.3C1.8,27.8,1,26.4,1.3,25\tc0.1-0.7,0.3-1.3,0.7-2c3.5-6.2,7.1-12.3,10.7-18.5c0.6-1,1.3-1.8,2.5-2.1c1.6-0.4,3.1,0.3,4,1.9c0.8,1.4,1.6,2.8,2.4,4.2\tc2.8,4.8,5.5,9.6,8.3,14.4c0.6,1,0.9,2,0.7,3.2c-0.2,1.3-1.2,2.1-2.4,2.3c-0.4,0.1-0.8,0.1-1.3,0.1C26.1,28.5,19.6,28.5,15.9,28.5z\t M14.3,11.1c0.1,1.7,0.3,3.4,0.4,5c0.1,1.1,0.2,2.2,0.3,3.2c0.1,0.6,0.4,0.9,1,1c0.6,0,0.9-0.3,1-1c0-0.3,0.1-0.6,0.1-0.9\tc0.1-1.5,0.3-3,0.4-4.5c0.1-1.1,0.2-2.2,0.2-3.3c0-1.4-1.4-2.2-2.5-1.5C14.4,9.6,14.3,10.3,14.3,11.1z M16,25.5c1,0,1.7-0.7,1.7-1.7\ts-0.8-1.7-1.7-1.7c-0.9,0-1.7,0.7-1.7,1.7S15,25.5,16,25.5z"/></svg>\n            <!-- endinject -->\n    </div>\n    <div class="op-error-title">'+this.escapeExpression(o(null!=(r=null!=e?e.data:e)?r.title:r,e))+'</div>\n    <div class="op-error-description">'+(null!=(r=o(null!=(r=null!=e?e.data:e)?r.shortText:r,e))?r:"")+'</div>\n    <div class="op-error-description-long">'+(null!=(r=o(null!=(r=null!=e?e.data:e)?r.longText:r,e))?r:"")+"</div>\n"+(null!=(r=(t.unless_eq||e&&e.unless_eq||t.helperMissing).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.action:r)?r.type:r,{name:"unless_eq",hash:{compare:"DEFAULT"},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+"</div>"},useData:!0})},{"hbsfy/runtime":85}],13:[function(e,t,n){"use strict";var i=e("./error.hbs"),r=function(e){return function(t){var n=null,r="messageView",o=function(){n=$("#"+e+"-"+t.instanceId),h.initSubscribeControls()},s=function(e){var o=t.options.i18n[r],s=i({data:e,i18n:o});n.empty().append(s),"DEFAULT"!==e.type&&$(n.find(".op-picto-"+e.type.toLowerCase())[0]).addClass("op-visible")},a=function(n){s(n),h.initErrorControls(),t.on(e+"-open-window",d),l(),t.emit(e+"-force-show-osd"),t.emit(e+"-disable-osd-events")},l=function(){n.removeClass("op-hidden"),t.off(e+"-close-window",l)},u=function(){t.off(e+"-open-window",d),n.addClass("op-hidden"),t.emit(e+"-enable-osd-events")},d=function(){u(),t.on(e+"-close-window",l)},c=function(){n.empty(),u()},h={initErrorControls:function(){n.find(".op-error-button").on("click",u),n.find(".op-acknowledge-button").on("click",function(n){t.emit(e+"-on-ack",n.target.value)})},initSubscribeControls:function(){t.on(e+"-hasplayer-display-message",a),t.on(e+"-hasplayer-empty-message",c)}},f=function(){};return{init:o,destroy:f}}};t.exports=r},{"./error.hbs":12}],14:[function(e,t,n){"use strict";var i=function(e){return function(t){var n=null,i=null,r=function(){n=$("#"+e+"-"+t.instanceId),a.init()},o=function(e){n.empty(),n.empty().append(e),n.removeClass(t.classes.opFadeOut).addClass(t.classes.opFadeIn),clearTimeout(i),i=setTimeout(s,t.delayHideFeedback)},s=function(){n.removeClass(t.classes.opFadeIn).addClass(t.classes.opFadeOut)},a={init:function(){t.on(e+"-feedback-play-pause",function(n){var i=$('<div class="op-feedback-'+(n?"pause":"play")+'"><div class="op-icon"></div></div>');t.emit(e+"-feedback-message",i)}),t.on(e+"-feedback-message",o)}},l=function(){};return{init:r,destroy:l}}};t.exports=i},{}],15:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r;return null!=(r=t["if"].call(e,null!=(r=null!=e?e.data:e)?r.channel:r,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?r:""},2:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'        <div class="op-infoBanner-left">\n            <div class="op-channelTitle">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.zappingNumber:r,e))+". "+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.name:r,e))+"</div>\n"+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.logo:r,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?r:"")+"        </div>\n"},3:function(e,t,n,i){var r;return'            <img class="op-channelLogo" src="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.logo:r,e))+'" alt=""/>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r;return'<div class="op-infoBanner-gradient"></div>\n<div class="op-infoBanner-content">\n'+(null!=(r=t["if"].call(e,null!=e?e.data:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'    <div class="op-infoBanner-center">\n        <div class="op-infoVideo large">\n            <div class="op-infoVideo-title">'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.i18n:e)?r.currentProgram:r)?r.titleDefault:r,e))+"</div>\n        </div>\n    </div>\n</div>"},useData:!0})},{"hbsfy/runtime":85}],16:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'    <div class="op-infoBanner-left">\n        <div class="op-channelTitle">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.zappingNumber:r,e))+". "+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.name:r,e))+"</div>\n"+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.logo:r,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?r:"")+"    </div>\n"},2:function(e,t,n,i){var r;return'        <img class="op-channelLogo" src="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.channel:r)?r.logo:r,e))+'" alt=""/>\n'},4:function(e,t,n,i){var r;return'        <img class="op-imgVideo" src="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.currentProgram:r)?r.coverUrl:r,e))+'" alt=""/>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'<div class="op-infoBanner-gradient"></div>\n<div class="op-infoBanner-content">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=e?e.data:e)?r.channel:r,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'    <div class="op-infoBanner-center">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.streamData:r)?r.coverUrl:r,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+'        <div class="op-infoVideo">\n            <div class="op-infoVideo-title">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.streamData:r)?r.title:r,e))+'</div>\n            <div class="op-infoVideo-date">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.streamData:r)?r.date:r,e))+'</div>\n            <div class="op-infoVideo-subtitle">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.streamData:r)?r.subtitle:r,e))+'</div>\n            <div class="op-infoVideo-genre">'+s(o(null!=(r=null!=(r=null!=e?e.data:e)?r.streamData:r)?r.kind:r,e))+'</div>\n        </div>\n        <div class="op-info">\n            <div class="op-csa">\n                <div class="op-csa-10" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.csa10ToolTipLabel:r,e))+'">\n                    <!-- inject:csa10:svg -->\n                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M15.96 4.54c-5.88 0-10.722 4.428-11.382 10.13h4.044v2.736h-4.032c0.694 5.666 5.518 10.054 11.372 10.054 6.33 0 11.46-5.13 11.46-11.46s-5.13-11.46-11.462-11.46zM13.528 23.084h-2.71v-11.768h-1.346v-2.334h4.054v14.102zM19.442 23.26c-2.434 0-3.836-2.452-3.836-7.216 0-4.788 1.382-7.238 3.836-7.238 2.452 0 3.836 2.452 3.836 7.238 0 4.764-1.404 7.216-3.836 7.216zM19.444 10.778c-1.090 0-1.314 1.732-1.314 5.29 0 3.51 0.224 5.22 1.314 5.22 1.088 0 1.288-1.732 1.288-5.22-0.002-3.558-0.2-5.29-1.288-5.29z"></path></svg>\n                    <!-- endinject -->\n                </div>\n                <div class="op-csa-12" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.csa12ToolTipLabel:r,e))+'">\n                    <!-- inject:csa12:svg -->\n                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M15.962 4.528c-5.886 0-10.734 4.434-11.394 10.142h4.038v2.748h-4.026c0.7 5.668 5.524 10.054 11.382 10.054 6.332 0 11.468-5.136 11.468-11.474 0.002-6.334-5.136-11.47-11.468-11.47zM13.536 23.098h-2.71v-11.778h-1.346v-2.336h4.056v14.114zM22.682 20.66v2.438h-6.97l3.464-6.754c0.93-1.798 1.324-3.204 1.324-4.016 0-0.89-0.376-1.384-1.028-1.384-1.048 0-1.246 0.83-1.246 2.85h-2.294c-0.020-0.2-0.020-0.394-0.020-0.574 0-2.908 1.304-4.412 3.718-4.412 2.078 0 3.406 1.326 3.406 3.482 0 1.86-0.968 3.78-2.316 6.196l-1.206 2.174h3.168z"></path></svg>\n                    <!-- endinject -->\n                </div>\n                <div class="op-csa-16" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.csa16ToolTipLabel:r,e))+'">\n                    <!-- inject:csa16:svg -->\n                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.554 16.066c-0.88 0-1.244 0.882-1.244 2.714 0 1.54 0.384 2.308 1.152 2.308 0.816 0 1.246-0.836 1.246-2.488 0-1.694-0.338-2.534-1.154-2.534zM15.96 4.562c-5.874 0-10.708 4.43-11.358 10.128h4.026v2.708h-4.014c0.69 5.656 5.504 10.040 11.348 10.040 6.314 0 11.436-5.122 11.436-11.438s-5.122-11.438-11.438-11.438zM13.532 23.058h-2.704v-11.742h-1.344v-2.328h4.046v14.070zM19.488 23.254c-2.486 0-3.884-1.734-3.884-4.89 0-2.41 0.964-4.282 1.972-6.376l1.442-3h2.702l-2.25 4.422c-0.258 0.512-0.514 0.964-0.752 1.3 0.614-0.432 1.186-0.67 1.758-0.67 1.716 0 2.822 1.442 2.822 4.046 0 3.278-1.422 5.168-3.81 5.168z"></path></svg>\n                    <!-- endinject -->\n                </div>\n                <div class="op-csa-18" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.csa18ToolTipLabel:r,e))+'">\n                    <!-- inject:csa18:svg -->\n                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.462 16.47c-0.884 0-1.318 0.75-1.318 2.226 0 1.592 0.408 2.364 1.318 2.364s1.318-0.75 1.318-2.294c0.002-1.522-0.406-2.296-1.318-2.296zM19.462 14.272c0.794 0 1.092-0.568 1.092-1.772 0-1.206-0.342-1.774-1.114-1.774-0.75 0-1.070 0.544-1.070 1.658 0.002 1.298 0.274 1.888 1.092 1.888zM15.96 4.54c-5.88 0-10.724 4.428-11.382 10.13h4.042v2.736h-4.030c0.692 5.666 5.518 10.054 11.372 10.054 6.33 0 11.46-5.132 11.46-11.46 0-6.33-5.13-11.46-11.462-11.46zM13.534 23.068h-2.716v-11.796h-1.35v-2.342h4.066v14.138zM19.462 23.248c-2.378 0-3.788-1.566-3.788-4.144 0-2.042 0.792-3.332 2.182-3.708v-0.12c-1.13-0.278-1.784-1.31-1.784-2.994 0-2.282 1.23-3.532 3.39-3.532 2.162 0 3.39 1.25 3.39 3.532 0 1.666-0.654 2.716-1.784 2.994v0.12c1.386 0.376 2.182 1.686 2.182 3.708 0.002 2.578-1.406 4.144-3.788 4.144z"></path></svg>\n                    <!-- endinject -->\n                </div>\n            </div>\n            <div class="op-audio-infos">\n                <div class="op-hearingImpaired" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.hearingImpairedToolTipLabel:r,e))+'">\n                    <!-- inject:oreille:svg -->\n                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.19 18.37c0.828-0.988 1.28-2.246 1.268-3.54-0.018-1.434-0.584-2.778-1.602-3.78-1.010-1.002-2.354-1.548-3.774-1.53-2.14 0.022-4.050 1.33-4.864 3.332l1.032 0.428c0.644-1.582 2.152-2.614 3.844-2.632 1.122-0.016 2.178 0.416 2.984 1.21 0.8 0.792 1.25 1.852 1.262 2.984 0.012 1.022-0.344 2.018-1.004 2.796l0.854 0.732zM15.102 7.168c-3.856 0.042-7.114 2.984-7.584 6.842l1.11 0.138c0.4-3.3 3.188-5.818 6.486-5.852 1.762-0.018 3.432 0.658 4.694 1.904 1.256 1.248 1.962 2.914 1.98 4.7 0.024 2.046-0.866 3.952-2.438 5.242-0.052 0.044-0.098 0.082-0.098 0.082-1.602 1.298-2.88 2.982-3.706 4.872l-0.022 0.050c-0.464 1.006-1.462 1.662-2.562 1.674-0.714 0.008-1.4-0.252-1.934-0.73l-0.742 0.846c0.742 0.662 1.696 1.022 2.688 1.014 1.556-0.016 2.97-0.96 3.598-2.4l0.058-0.126c0.736-1.626 1.838-3.082 3.212-4.232 0.058-0.038 0.112-0.076 0.112-0.076 1.904-1.512 2.978-3.784 2.956-6.228-0.024-2.082-0.848-4.032-2.324-5.488-1.472-1.466-3.424-2.256-5.484-2.232zM26.496 2.126l-5.69 5.746c1.308 1.15 2.362 2.588 2.81 4.336l6.32-6.388v-3.694h-3.44zM8.868 19.932l-6.728 6.796v3.042h4.086l7.162-7.23-4.52-2.608z"></path></svg>\n                    <!-- endinject -->\n                </div>\n                <div class="op-audiodesc" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.audiodescToolTipLabel:r,e))+'">\n                    <!-- inject:AD:svg -->\n                    <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="-404 282.3 32 32" enable-background="new -404 282.3 32 32" xml:space="preserve"><g>\t<text transform="matrix(0.991 0 0 1 -397.4046 300.6718)" fill="#444444" font-family="\'HelveticaNeue-Bold\'" font-size="12.9418">AD</text>\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#444444" stroke-width="2" stroke-miterlimit="10" d="\t\tM-397.7,288.5h19.5c1.4,0,2.3,1,2.3,2.5v10.5c0,1.2-0.9,2.5-2.3,2.5h-2.3l2.5,4.9l-7.7-4.9h-12c-1.4,0-2.5-1.1-2.5-2.5V291\t\tC-400.2,289.6-399,288.5-397.7,288.5z"/></g></svg>\n                    <!-- endinject -->\n                </div>\n                <div class="op-language-vm op-lg-vm" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.multiLangToolTipLabel:r,e))+'"></div>\n                <div class="op-language-vost op-lg-vost" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.vostToolTipLabel:r,e))+'"></div>\n                <div class="op-language-vo op-lg-vo" title="'+s(o(null!=(r=null!=e?e.i18n:e)?r.voToolTipLabel:r,e))+'"></div>\n            </div>\n        </div>\n    </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":85}],17:[function(e,t,n){"use strict";var i=e("./info-banner.hbs"),r=e("./info-banner-currentProgram-unavailable.hbs"),o=e("../../../utils"),s=e("elementQuery"),a=function(e){return function(t){var n,a=null,l="infoBannerToolTip",u=function(){n=$("#"+e+"-"+t.instanceId),t.on(e+"-updateInfoBannerData",function(e){d(e)}),m.init()},d=function(e){var s=null,a=t.options.i18n[l],u=null,d=null,c="",h=null,f=null,p=null,m="",g=function(){s=r({data:e,i18n:t.options.i18n.windows.infoBar}),n.empty().append(s)};if(e)if(e.streamData){switch(s=i({data:e,i18n:a}),n.empty().append(s),o.handleEmptyableImg(n.find(".op-imgVideo"),e.streamData.coverUrl),e.streamData.csa){case 2:c="10";break;case 3:c="12";break;case 4:c="16";break;case 5:c="18"}""!==c&&$(n.find(".op-csa-"+c)[0]).show(),u=n.find(".op-audiodesc"),u.toggle(e.streamData.audioDescription),d=n.find(".op-hearingImpaired"),d.toggle(e.streamData.hearingImpaired),h=n.find(".op-language-vm"),f=n.find(".op-language-vost"),p=n.find(".op-language-vo"),h.hide(),f.hide(),p.hide(),m=e.streamData.languageVersion&&e.streamData.languageVersion.toLowerCase(),"vm"===m?h.show():"vost"===m?f.show():"vo"===m&&p.show()}else g();else g()},c=function(){n.removeClass(t.classes.opFadeOut).removeClass(t.classes.opHidden),m.svga11y()},h=function(){n.addClass(t.classes.opShowAnim).removeClass(t.classes.opFadeOut).removeClass(t.classes.opHidden),m.svga11y(),s.elementQuery()},f=function(){clearTimeout(a),n.removeClass(t.classes.opShowAnim).addClass(t.classes.opHidden)},p=function(){n.hasClass(t.classes.opHidden)||n.removeClass(t.classes.opShowAnim).addClass(t.classes.opFadeOut)},m={svga11y:function(){o.copyTitleToSVG(n.find("div[title]"),1)},init:function(){t.on(e+"-open-window",f),t.on(e+"-close-window",c),t.on(e+"-show-osd",h),t.on(e+"-hide-osd",p),n.on("mouseenter",function(){t.emit(e+"-keep-osd-visible")}),n.on("mouseleave",function(){t.emit(e+"-purge-osd-visible")})}},g=function(){};return{init:u,destroy:g}}};t.exports=a},{"../../../utils":71,"./info-banner-currentProgram-unavailable.hbs":15,"./info-banner.hbs":16,elementQuery:61}],18:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="spinner">\n    <div class="spinner-container container1">\n        <div class="circle1"></div>\n        <div class="circle2"></div>\n        <div class="circle3"></div>\n        <div class="circle4"></div>\n    </div>\n    <div class="spinner-container container2">\n        <div class="circle1"></div>\n        <div class="circle2"></div>\n        <div class="circle3"></div>\n        <div class="circle4"></div>\n    </div>\n    <div class="spinner-container container3">\n        <div class="circle1"></div>\n        <div class="circle2"></div>\n        <div class="circle3"></div>\n        <div class="circle4"></div>\n    </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":85}],19:[function(e,t,n){"use strict";var i=e("./loading.hbs"),r=function(e){return function(t){var n=null,r=function(){n=$("#"+e+"-"+t.instanceId),o(),a.init()},o=function(){var e=i();n.empty().append(e)},s=function(){},a={init:function(){t.on(e+"-video-play",function(){"op-loading"===n.attr("class")&&n.addClass("op-none")}),t.on(e+"-hasplayer-display-message",function(){"op-loading"===n.attr("class")&&n.addClass("op-none")}),t.on(e+"-hasplayer-empty-message",function(){"op-loading op-none"===n.attr("class")&&n.removeClass("op-none")}),t.on(e+"-video-waiting",function(){"op-loading op-none"===n.attr("class")&&n.removeClass("op-none")})}};return{init:r,destroy:s}}};t.exports=r},{"./loading.hbs":18}],20:[function(e,t,n){"use strict";var i=e("pubsub"),r=function(){var e=null,t=function(t){e=t,i.publish("init-setwording-done")},n=function(){return e},r=function(){return"fr"};return{setWording:t,getWording:n,getLanguage:r}}();t.exports=r},{pubsub:65}],21:[function(e,t,n){"use strict";var i=e("eventemitter2").EventEmitter2,r=e("hasplayer"),o=e("lodash.throttle"),s=e("lodash.assignin"),a=e("./i18n"),l=e("elementQuery"),u=e("../../../utils"),d=function(e,t,n){return function(d){var c=null,h=null,f=!1,p=function(){c=e,h=document.getElementById(t),g.init(),y.init(),v.init()},m={onError:"onError",onWarning:"onWarning",onManifestUrlUpdate:"onManifestUrlUpdate",onEvent:"onEvent",onAcknowledge:"onAcknowledge",onFullscreenChange:"onFullscreenChange",onHaveTerminalId:"onHaveTerminalId",onOpening:"onOpening",onPlayClick:"onPlayClick",onSticked:"onSticked"},g={init:function(){c.on("mouseenter",function(){d.emit(t+"-main-mouse-enter")}),c.on("mouseleave",function(){d.emit(t+"-main-mouse-leave")}),c.on("click",function(){d.emit(t+"-main-mouse-move")}),c.on("focus",function(){setTimeout(function(){d.emit(t+"-main-mouse-move")},0)}),c.on("mousewheel",function(){d.emit(t+"-main-mouse-move")}),c.on("mousemove",o(function(e){0===e.movementX&&0===e.movementY||d.emit(t+"-main-mouse-move")},1e3)),c.on("contextmenu",function(e){e.preventDefault()}),d.on(t+"-keydown-enter",function(e){d.emit(t+"-main-key-enter",e)}),d.on(t+"-keydown-space",function(){d.emit(t+"-play-pause")}),d.on([t+"-keydown-up",t+"-keydown-down"],function(e){c.find(".op-middle-container").hasClass("disabled")&&d.emit(t+"-main-volume",e)}),d.on(t+"-keydown-R",function(){d.emit(t+"-toggle-window","sumup")}),d.on(t+"-fullscreen",function(e){e?c.addClass("fullscreen"):c.removeClass("fullscreen")}),u.detectionMobileTablet()?c.addClass("touch"):c.addClass("no-touch"),setTimeout(function(){c.find(".stop-anchor").each(function(e,t){$(t).on("click",function(e){e.preventDefault()})})},0)}},y={init:function(){n.eventEmitter=new i,n.EVENTS=s(n.EVENTS,m),n.on=function(e,t){n.eventEmitter.on(e,t)},n.once=function(e,t){n.eventEmitter.once(e,t)},n.off=function(e){n.eventEmitter.off(e)},d.on(t+"-hasplayer-error",function(e){n.eventEmitter.emit(n.EVENTS.onError,e)}),d.on(t+"-hasplayer-warning",function(e){n.eventEmitter.emit(n.EVENTS.onWarning,e)}),d.on(t+"-hasplayer-manifestUrlUpdate",function(e){n.eventEmitter.emit(n.EVENTS.onManifestUrlUpdate,e)}),d.on(t+"-gstat",function(e){n.eventEmitter.emit(n.EVENTS.onEvent,e)}),d.on(t+"-close-window-enter",function(){d.emit(t+"-focus-first-element")}),d.on(t+"-fullscreen",function(e){f=e,d.emit(t+"-focus-first-element"),n.eventEmitter.emit(n.EVENTS.onFullscreenChange,e)}),d.on(t+"-on-opening",function(){n.eventEmitter.emit(n.EVENTS.onOpening)}),d.on(t+"-on-ack",function(e){n.eventEmitter.emit(n.EVENTS.onAcknowledge,{value:e})}),d.on(t+"-onPlayClick",function(e){n.eventEmitter.emit(n.EVENTS.onPlayClick,e)}),d.on(t+"-main-key-enter",function(e){e&&e.target&&("A"===e.target.tagName||"BUTTON"===e.target.tagName)?e.target.click():(d.emit(t+"-main-mouse-enter"),c.find(".op-control-menu").focus())}),d.on(t+"-onSticked",function(e){n.eventEmitter.emit(n.EVENTS.onSticked,e)}),d.on(t+"-hasplayer-haveTerminalId",function(e){n.eventEmitter.emit(n.EVENTS.onHaveTerminalId,e)})}},v={init:function(){n.load=function(e){l.elementQuery(),d.emit(t+"-load",e)},n.setConfig=function(e){d.playerConfig.setConfig(e),d.emit(t+"-setConfig")},n.refreshManifest=function(e){d.emit(t+"-refreshManifest",e)},n.loadMetricsAgent=function(e){d.emit(t+"-loadMetricsAgent",e)},n.setWording=function(e){a.setWording(e)},n.setDetailedProgram=function(e){d.emit(t+"-setDetailedProgram",e)},n.setPlayerFocus=function(e){e?d.emit(t+"-focus-last-element"):d.emit(t+"-focus-first-element")},n.setTimestamp=function(e){d.emit(t+"-setTimestamp",e)},n.seek=function(e){e>0&&d.emit(t+"-seek-video",e)},n.setBitrateLimit=function(e){},n.displayMessage=function(e){d.emit(t+"-hasplayer-display-message",e)},n.displayLoader=function(){d.emit(t+"-hasplayer-empty-message")},n.stop=function(){d.emit(t+"-stop-player")},n.error=function(){d.emit(t+"-hasplayer-display-message")},n.setFullscreen=function(e){d.emit(t+"-set-fullscreen",e)},n.hasMediaSourceExtension=function(){return r.hasMediaSourceExtension()},n.hasMediaKeysExtension=function(){return r.hasMediaKeysExtension()},n.getTerminalId=function(){d.emit(t+"-onGetTerminalId")},n.onDestroy=function(){d.emit(t+"-hasplayer-ondestroy")}}},_=function(){};return{init:p,destroy:_}}};t.exports=d},{"../../../utils":71,"./i18n":20,elementQuery:61,eventemitter2:76,hasplayer:63,"lodash.assignin":89,"lodash.throttle":91}],22:[function(e,t,n){"use strict";var i=function(){var e=null,t=function(t){e=t},n=function(){return e},i=function(t){return!(e&&e.config&&e.config.featureFlipping&&e.config.featureFlipping[t]===!1)};return{setConfig:t,getConfig:n,isFeatureEnabled:i}}();t.exports=i},{}],23:[function(e,t,n){"use strict";var i=function(e){var t=null,n=null;return function(i){var r=null,o=function(){r=$("#"+e+"-"+i.instanceId),s.init(),h.init()},s={init:function(){}},a=function(){r.addClass(i.classes.opShowTranslateUp).removeClass(i.classes.opHiddenTranslateUp).removeClass(i.classes.opHidden),t=!1,d()},l=function(){r.removeClass(i.classes.opShowTranslateUp).addClass(i.classes.opHiddenTranslateUp),t=!1,d()},u=function(e){t&&r.find(".op-menu-"+t).removeClass(i.classes.opMenuSelected),r.find(".op-menu-"+e).addClass(i.classes.opMenuSelected),t=e},d=function(){r.find(".op-menu-item").removeClass(i.classes.opMenuSelected)},c=function(n){u(n),i.myDelayInactivity="mosaic"===t?6e4:i.delayInactivity,i.emit(e+"-open-window",n)},h={init:function(){r.on("click",function(t){var n=t.target.dataset.menu;n&&(t.stopPropagation(),t.preventDefault(),r.find('.op-menu-item[data-menu="'+n+'"').hasClass(i.classes.opMenuSelected)?(i.emit(e+"-close-window"),i.emit(e+"-close-window-manual")):c(n),i.emit(e+"-gstat",{area:"menuPrincipal",action:{sumup:"resume",languages:"langue"}[n]}))}),i.on(e+"-open-menu",function(){t&&(t=!1,d()),a()}),i.on(e+"-close-window",function(){r.find(".op-menu-"+t).removeClass(i.classes.opMenuSelected),t=null}),i.on(e+"-video-play",function(){n=!0}),i.on(e+"-video-pause",function(){n=!1}),i.on(e+"-close-reglages",a),i.on(e+"-open-reglages",l),i.on(e+"-close-menu",l),i.on(e+"-hide-osd",l),i.on(e+"-show-osd",a),r.on("mouseenter",function(){i.emit(e+"-keep-osd-visible")}),r.on("mouseleave",function(){i.emit(e+"-purge-osd-visible")})}},f=function(){};return{init:o,destroy:f}}};t.exports=i},{}],24:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=t.helperMissing,s="function",a=this.escapeExpression;return'<div class="op-settings-format-summary">\n'+a((r=null!=(r=t.settingsDisplayViewTitleLabel||(null!=e?e.settingsDisplayViewTitleLabel:e))?r:o,typeof r===s?r.call(e,{name:"settingsDisplayViewTitleLabel",hash:{},data:i}):r))+'\n</div>\n<div class="op-settings-format-buttons">\n\t<button class="op-settings-normal" tabindex="0">\n\t\t<div class="op-settings-format-button-img">\n\t\t<!-- inject:size-Default:svg -->\n\t\t<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   xmlns:dc="http://purl.org/dc/elements/1.1/"   xmlns:cc="http://creativecommons.org/ns#"   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"   xmlns:svg="http://www.w3.org/2000/svg"   xmlns="http://www.w3.org/2000/svg"   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"   version="1.1"   x="0px"   y="0px"   viewBox="0 0 55 32"   enable-background="new 0 0 55 55"   xml:space="preserve"   id="svg2"   inkscape:version="0.48.4 r9939"   width="100%"   height="100%"   sodipodi:docname="size-Default.svg"><metadata     id="metadata38"><rdf:RDF><cc:Work         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs     id="defs36" /><sodipodi:namedview     pagecolor="#ffffff"     bordercolor="#666666"     borderopacity="1"     objecttolerance="10"     gridtolerance="10"     guidetolerance="10"     inkscape:pageopacity="0"     inkscape:pageshadow="2"     inkscape:window-width="1855"     inkscape:window-height="1056"     id="namedview34"     showgrid="false"     inkscape:zoom="12.136524"     inkscape:cx="27.04647"     inkscape:cy="24.014085"     inkscape:window-x="65"     inkscape:window-y="24"     inkscape:window-maximized="1"     inkscape:current-layer="svg2" /><g     id="SIZE_GD"     display="none"     style="display:none"     transform="translate(0,-23)"><g       display="inline"       id="g5"       style="display:inline"><g         id="g7"><rect           x="1.1"           y="12.8"           stroke-miterlimit="10"           width="52.700001"           height="29.299999"           id="rect9"           style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10" /></g></g><line       display="inline"       stroke-miterlimit="10"       x1="16.200001"       y1="12.8"       x2="16.200001"       y2="42.5"       id="line11"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10;display:inline" /><line       display="inline"       stroke-miterlimit="10"       x1="38.5"       y1="12.8"       x2="38.5"       y2="42.5"       id="line13"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10;display:inline" /><path       display="inline"       clip-rule="evenodd"       d="m 48.5,27.3 -4.7,2.9 v -2.5 h -5.1 v -0.9 h 5.1 v -2.5 l 4.7,3 z"       id="path15"       inkscape:connector-curvature="0"       style="fill:#1e1e1c;fill-rule:evenodd;display:inline" /><path       display="inline"       clip-rule="evenodd"       d="m 6.2,27.7 4.7,2.9 V 28.1 H 16 v -0.9 h -5.1 v -2.5 l -4.7,3 z"       id="path17"       inkscape:connector-curvature="0"       style="fill:#1e1e1c;fill-rule:evenodd;display:inline" /></g><g     id="Calque_2"     transform="translate(0.04999959,-11.45)"><g       id="g20"><g         id="g22"><rect           x="1.1"           y="12.8"           stroke-miterlimit="10"           width="52.700001"           height="29.299999"           id="rect24"           style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10" /></g></g><line       display="none"       stroke-miterlimit="10"       x1="53.299999"       y1="23.299999"       x2="1.4"       y2="23.299999"       id="line26"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10;display:none" /><line       display="none"       stroke-miterlimit="10"       x1="53.299999"       y1="31.5"       x2="1.4"       y2="31.5"       id="line28"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10;display:none" /><path       display="none"       clip-rule="evenodd"       d="m 27.3,40 -2.9,-4.7 h 2.5 v -4.1 h 0.9 v 4.1 h 2.5 l -3,4.7 z"       id="path30"       inkscape:connector-curvature="0"       style="fill:#1e1e1c;fill-rule:evenodd;display:none" /><path       display="none"       clip-rule="evenodd"       d="m 27,14.6 -2.9,4.7 h 2.5 v 4.1 h 0.9 V 19.3 H 30 l -3,-4.7 z"       id="path32"       inkscape:connector-curvature="0"       style="fill:#1e1e1c;fill-rule:evenodd;display:none" /></g></svg>\n\t\t<!-- endinject -->\n\t\t</div>\n\t\t<div class="op-settings-format-button-label">\n\t\t'+a((r=null!=(r=t.settingsDisplayViewNormalLabel||(null!=e?e.settingsDisplayViewNormalLabel:e))?r:o,
typeof r===s?r.call(e,{name:"settingsDisplayViewNormalLabel",hash:{},data:i}):r))+'\n\t\t</div>\n\t</button>\n\t<button class="op-settings-stretch" tabindex="0">\n\t\t<div class="op-settings-format-button-img">\n\t\t<!-- inject:size-HB:svg -->\n\t\t<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   xmlns:dc="http://purl.org/dc/elements/1.1/"   xmlns:cc="http://creativecommons.org/ns#"   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"   xmlns:svg="http://www.w3.org/2000/svg"   xmlns="http://www.w3.org/2000/svg"   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"   version="1.1"   id="Calque_1"   x="0px"   y="0px"   viewBox="0 0 55 32"   enable-background="new 0 0 55 55"   xml:space="preserve"   inkscape:version="0.48.4 r9939"   width="100%"   height="100%"   sodipodi:docname="size-HB.svg"><metadata     id="metadata22"><rdf:RDF><cc:Work         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs     id="defs20" /><sodipodi:namedview     pagecolor="#ffffff"     bordercolor="#666666"     borderopacity="1"     objecttolerance="10"     gridtolerance="10"     guidetolerance="10"     inkscape:pageopacity="0"     inkscape:pageshadow="2"     inkscape:window-width="1855"     inkscape:window-height="1056"     id="namedview18"     showgrid="false"     inkscape:zoom="8.5818182"     inkscape:cx="20.532334"     inkscape:cy="2.359127"     inkscape:window-x="65"     inkscape:window-y="24"     inkscape:window-maximized="1"     inkscape:current-layer="Calque_1" /><g     id="Calque_2"     transform="translate(0.04999959,-11.45)"><g       id="g4"><g         id="g6"><rect           x="1.1"           y="12.8"           stroke-miterlimit="10"           width="52.700001"           height="29.299999"           id="rect8"           style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10" /></g></g><line       stroke-miterlimit="10"       x1="53.299999"       y1="23.299999"       x2="1.4"       y2="23.299999"       id="line10"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10" /><line       stroke-miterlimit="10"       x1="53.299999"       y1="31.5"       x2="1.4"       y2="31.5"       id="line12"       style="fill:none;stroke:#1e1e1c;stroke-width:2;stroke-miterlimit:10" /><path       d="m 27.3,40 -2.9,-4.7 h 2.5 v -4.1 h 0.9 v 4.1 h 2.5 l -3,4.7 z"       id="path14"       inkscape:connector-curvature="0"       style="fill:#1e1e1c" /><path       d="m 27,14.6 -2.9,4.7 h 2.5 v 4.1 h 0.9 V 19.3 H 30 l -3,-4.7 z"       id="path16"       inkscape:connector-curvature="0"       style="fill:#1e1e1c" /></g></svg>\n\t\t<!-- endinject -->\n\t\t</div>\n\t\t<div class="op-settings-format-button-label">\n\t\t'+a((r=null!=(r=t.settingsDisplayViewStretchLabel||(null!=e?e.settingsDisplayViewStretchLabel:e))?r:o,typeof r===s?r.call(e,{name:"settingsDisplayViewStretchLabel",hash:{},data:i}):r))+"\n\t\t</div>\n\t</button>\n</div>"},useData:!0})},{"hbsfy/runtime":85}],25:[function(e,t,n){"use strict";var i=e("./settings-format.hbs"),r=e("../../../../utils"),o=function(e){var t=null,n="settingsDisplayView",o="format",s={NORMAL:0,STRETCHED:1},a=r.getPreferences()&&r.getPreferences().format||s.NORMAL;return function(l){var u=null,d=function(){u=$("#"+e+"-"+l.instanceId),t=l.options.i18n[n],c()},c=function(){var e=i(t);u.empty().append(e),p(a),g.init()},h=function(){u.removeClass("op-hidden"),m()},f=function(){u.addClass("op-hidden")},p=function(e){a=e,r.storePreferences({format:e}),a===s.NORMAL?(u.find(".op-settings-normal").addClass("selected-format"),u.find(".op-settings-stretch").removeClass("selected-format")):a===s.STRETCHED&&(u.find(".op-settings-stretch").addClass("selected-format"),u.find(".op-settings-normal").removeClass("selected-format"))},m=function(){var t=u.find(".op-settings-normal"),n=u.find(".op-settings-stretch");t.off(),n.off(),t.on("click",function(t){a!==s.NORMAL&&(p(s.NORMAL),l.emit(e+"-format-normal"))}),n.on("click",function(t){a!==s.STRETCHED&&(p(s.STRETCHED),l.emit(e+"-format-stretch"))})},g={init:function(){l.on(e+"-open-window",function(e){e===o?h():f()}),l.on(e+"-close-window",f)}},y=function(){};return{init:d,destroy:y}}};t.exports=o},{"../../../../utils":71,"./settings-format.hbs":24}],26:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="op-languages-container">\n  <div></div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":85}],27:[function(e,t,n){"use strict";var i=e("./languages.hbs"),r=e("../../commun/doublePanel/double-panel"),o=e("../../../../utils"),s=e("rangeslider-js"),a=function(t,n){var a=t+"-languages-double-panel",l=new r(a),u=null,d=null,c=null,h=null,f=null,p=null,m=null,g=null,y=null,v=null,_=null,b=null,E=null,x="languages",S="languageView";return function(r){var T=null,w=function(){T=$("#"+t+"-"+r.instanceId),r.sub.register("DoublePanelModule",l),f=r.options.i18n[S],D()},D=function(){var e=i(f);T.empty().append(e),T.find(".op-languages-container div").append('<div class="op-double-panel" id="'+a+'"></div>'),r.sub.start("DoublePanelModule"),k.init()},M=function(e){u=F(e.tracks),m=[{color:"white"},{color:"cyan"},{color:"blue"},{color:"green"},{color:"yellow"},{color:"magenta"},{color:"red"},{color:"black"}],g=[{font:"Serif"},{font:"Times New Roman"},{font:"Sans-serif"},{font:"Monospace"}],d=F(e.subtitles,!0),n&&"function"==typeof n.convertAudioFreCodeToSubtitle?n.convertAudioFreCodeToSubtitle(d,f.langs):P(d,"fre");var i=o.getPreferences();c=u.filter(function(e){return i.trackObj.lang===e.lang&&i.trackObj.subType===e.subType})[0],c=c||u.filter(function(e){return i.trackObj.lang===e.lang})[0];var s=["fra","fre","qad"];c=s.indexOf(i.trackObj.lang)!==-1?c||u[0]:c||u.filter(function(e){return s.indexOf(e.lang)===-1})[0],c=c||u[0],r.emit(t+"-select-languages",c),h=d.filter(function(e){return i.subtitleObj.lang===e.lang&&i.subtitleObj.subType===e.subType})[0];var a=d.filter(function(e){return["fra","fre"].indexOf(e.lang)!==-1});a.length&&["fra","fre"].indexOf(i.subtitleObj.lang)!==-1&&(h=h||a.filter(function(e){return i.subtitleObj.subType===e.subType})[0],h=h||a.filter(function(e){return i.subtitleObj.lang===e.lang})[0],h=h||a[0]),h=h||d.filter(function(e){return i.subtitleObj.lang===e.lang})[0],h=h||d[0],A(),r.emit(t+"-select-subtitles",h),p=i.subtitleRatio||"1","1"!==p&&r.emit(t+"-subtitle-size-change",p),y=i.colorSubtitle,v=i.fontSubtitle},I=function(){T.removeClass("op-hidden"),C()},L=function(){r.emit(t+"-attach-previous-next-channel-handler"),T.addClass("op-hidden")},C=function(){var n=e("./tracks.hbs")({i18n:f,languages:u,current:c&&c.id,containerId:t}),i=e("./subtitles.hbs")({i18n:f,subtitles:d,current:h&&h.id,colorSubtitles:m,defaultColor:_,defaultFont:b,currentColor:y,currentFont:v,defaultSliderValue:p,fontSubtitles:g,containerId:t});r.off(a+"-on-panel-loaded"),r.on(a+"-on-panel-loaded",R),r.emit(a+"-load-panel",{summary:n,details:i}),r.emit(t+"-detach-previous-next-channel-handler")},R=function(){E=T.find(".slider input"),s.create(E,{min:.75,max:2.25,value:p,step:.25,onSlide:function(e){},onSlideEnd:function(e){r.emit(t+"-gstat",{area:"menuPrincipal_langue",action:"choixTailleSsTitres"})}});var e=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,n=navigator.userAgent.toLowerCase().indexOf("edge")>-1;n?$(".slider input").css("margin-top","23px"):e&&$(".slider input").css("margin-top","38px");var i=T.find(".op-language-choice input");i.off(),i.on("change",function(){c=u.filter(function(e){return this.value===e.id}.bind(this))[0],c&&(o.storePreferences({trackObj:{lang:c.lang,subType:c.subType}}),r.emit(t+"-select-languages",c)),r.emit(t+"-gstat",{area:"menuPrincipal_langue",action:"choixLangues"})});var a=T.find(".op-subtitle-choice input");a.off(),a.on("change",function(){h=d.filter(function(e){return this.value===e.id}.bind(this))[0],h&&(A(),o.storePreferences({subtitleObj:{lang:h.lang,subType:h.subType}}),r.emit(t+"-select-subtitles",h)),r.emit(t+"-gstat",{area:"menuPrincipal_langue",action:"choixSsTitres"})}),T.find(".op-languages-container label").on("keydown",function(e){13===e.keyCode&&e.target.click()});var l=T.find(".slider > input");l.off(),l.on("change",function(){p=this.value,o.storePreferences({subtitleRatio:p}),r.emit(t+"-subtitle-size-change",this.value)});var f=T.find(".color-subtitles input");f.on("change",function(e){y=e.target.value,o.storePreferences({colorSubtitle:y}),r.emit(t+"-gstat",{area:"menuPrincipal_langue",action:"choixCouleurSsTitres"})});var m=T.find(".family-police input");m.on("change",function(e){v=e.target.value,o.storePreferences({fontSubtitle:v}),r.emit(t+"-gstat",{area:"menuPrincipal_langue",action:"choixPoliceSsTitres"})}),A()},A=function(){T.find(".subtitle-size").css("display","none"===h.lang?"none":"inherit"),T.find(".family-police").css("display","none"===h.lang?"none":"inherit"),T.find(".color-subtitles").css("display","none"===h.lang?"none":"inherit")},P=function(e,t){var n=0,i=e.length;for(n;n<i;n++)if(e[n].lang===t){e[n].i18nLang=f.langs[e[n].lang+"_sub"]||e[n].lang;break}},F=function(e,t){var n=0,i=e.length,r=["none","fra","fre","qad","qaa"],o=[];for(n;n<i;n++)e[n].i18nLang=f.langs&&f.langs[e[n].lang.toLowerCase()]||e[n].lang||f.langs.none;return t&&(e.some(function(e){return"none"===e.lang})||e.unshift({lang:"none",i18nLang:f.languageViewNothingChoiceLabel,id:"none_"+(new Date).getTime()})),r.forEach(function(t){var n=!1;e=e.filter(function(e){return!(!n&&e.lang===t)||(o.push(e),n=!0,!1)})}),o.concat(e)},N=!0,B=function(e){N&&e.data&&(_=e.data.style.color,b=e.data.style.fontFamily,v=v||b||"Sans-serif",y=y||_||"white",N=!1)},k={init:function(){r.on(t+"-open-window",function(e){e===x?I():L()}),r.on(t+"-close-window",L),r.on(t+"-loaded-data",M),r.on(t+"-hasplayer-cue-enter",B)}},O=function(){};return{init:w,destroy:O}}};t.exports=a},{"../../../../utils":71,"../../commun/doublePanel/double-panel":7,"./languages.hbs":26,"./subtitles.hbs":28,"./tracks.hbs":29,"rangeslider-js":97}],28:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i,r,o){var s;return'<div class="op-subtitle-choice">\n  <div class="op-languages-title">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.i18n:e)?s.languageViewSubtitleChoiceLabel:s,e))+"</div>\n"+(null!=(s=t.each.call(e,null!=e?e.subtitles:e,{name:"each",hash:{},fn:this.program(2,i,0,r,o),inverse:this.noop,data:i}))?s:"")+"</div>\n\n"+(null!=(s=(t.unless_eq||e&&e.unless_eq||t.helperMissing).call(e,null!=(s=null!=e?e.subtitles:e)?s.length:s,{name:"unless_eq",hash:{compare:1},fn:this.program(5,i,0,r,o),inverse:this.noop,data:i}))?s:"")},2:function(e,t,n,i,r,o){var s,a=this.lambda,l=this.escapeExpression;return'  <div class="op-languages-line">\n    <input tabindex="-1" type="radio" name="subtitle" id="subt_'+l(a(null!=e?e.id:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'" value="'+l(a(null!=e?e.id:e,e))+'" '+(null!=(s=(t.if_eq||e&&e.if_eq||t.helperMissing).call(e,null!=e?e.id:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.current},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/>\n    <label for="subt_'+l(a(null!=e?e.id:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'">\n          <span class="op-radio">\n          <!-- inject:radio:svg -->\n              <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n              <!-- endinject -->\n          </span>\n          <span class="op-radiocheck">\n          <!-- inject:radio-plein:svg -->\n              <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n              <!-- endinject -->\n          </span>\n        <span tabindex="0">'+l(a(null!=e?e.i18nLang:e,e))+"</span>\n    </label>\n  </div>\n"},3:function(e,t,n,i){return" checked=checked "},5:function(e,t,n,i,r,o){var s,a=this.lambda,l=this.escapeExpression,u=t.helperMissing;return'<div class="subtitle-size">\n  <div class="slider-title">'+l(a(null!=(s=null!=e?e.i18n:e)?s.languageViewSubtitleSizeLabel:s,e))+'</div>\n  <div class="slider">\n      <div class="min-letter">A</div>\n      <div class="max-letter">A</div>\n      <div class="sliderRange"></div>\n      <input type="range">\n      <div class="tick-content">\n          <div class="tick"></div>\n          <div class="tick"></div>\n          <div class="tick"></div>\n          <div class="tick"></div>\n          <div class="tick"></div>\n          <div class="tick"></div>\n          <div class="tick"></div>\n      </div>\n  </div>\n</div>\n\n<div class="family-police">\n    <div class="op-languages-title" tabindex="0">'+l(a(null!=(s=null!=e?e.i18n:e)?s.languageViewFontText:s,e))+'</div>\n    <div class="op-languages-line">\n      <input tabindex="-1" type="radio" name="subtitleFont" id="subt_font_default_'+l(a(null!=e?e.defaultFont:e,e))+"_"+l(a(null!=e?e.containerId:e,e))+'" value="" '+(null!=(s=(t.if_eq||e&&e.if_eq||u).call(e,null!=e?e.font:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.currentFont},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/>\n      <label for="subt_font_default_'+l(a(null!=e?e.defaultFont:e,e))+"_"+l(a(null!=e?e.containerId:e,e))+'">\n        <span class="op-radio">\n        <!-- inject:radio:svg -->\n            <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n            <!-- endinject -->\n        </span>\n        <span class="op-radiocheck">\n        <!-- inject:radio-plein:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n            <!-- endinject -->\n        </span>\n          <span tabindex="0">'+l(a(null!=(s=null!=e?e.i18n:e)?s.languageViewDefaultFontText:s,e))+"</span>\n      </label>\n    </div>\n"+(null!=(s=t.each.call(e,null!=e?e.fontSubtitles:e,{name:"each",hash:{},fn:this.program(6,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'</div>\n\n<div class="color-subtitles">\n    <div class="op-languages-title" tabindex="0">'+l(a(null!=(s=null!=e?e.i18n:e)?s.languageViewSubtitleColorText:s,e))+'</div>\n    <div class="op-languages-line">\n      <input tabindex="-1" type="radio" name="subtitleColor" id="subt_color_default_'+l(a(null!=e?e.defaultColor:e,e))+"_"+l(a(null!=e?e.containerId:e,e))+'" value="" '+(null!=(s=(t.if_eq||e&&e.if_eq||u).call(e,null!=e?e.color:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.currentColor},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/>\n      <label for="subt_color_default_'+l(a(null!=e?e.defaultColor:e,e))+"_"+l(a(null!=e?e.containerId:e,e))+'">\n        <span class="op-radio">\n        <!-- inject:radio:svg -->\n            <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n            <!-- endinject -->\n        </span>\n        <span class="op-radiocheck">\n        <!-- inject:radio-plein:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n            <!-- endinject -->\n        </span>\n          <span tabindex="0">'+l(a(null!=(s=null!=e?e.i18n:e)?s.languageViewSubtitleDefaultColor:s,e))+"</span>\n      </label>\n    </div>\n"+(null!=(s=t.each.call(e,null!=e?e.colorSubtitles:e,{name:"each",hash:{},fn:this.program(8,i,0,r,o),inverse:this.noop,data:i}))?s:"")+"</div>\n"},6:function(e,t,n,i,r,o){var s,a=this.lambda,l=this.escapeExpression;return'    <div class="op-languages-line">\n      <input tabindex="-1" type="radio" name="subtitleFont" id="subt_font_'+l(a(null!=e?e.font:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'" value="'+l(a(null!=e?e.font:e,e))+'" '+(null!=(s=(t.if_eq||e&&e.if_eq||t.helperMissing).call(e,null!=e?e.font:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.currentFont},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/>\n      <label for="subt_font_'+l(a(null!=e?e.font:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'">\n        <span class="op-radio">\n        <!-- inject:radio:svg -->\n            <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n            <!-- endinject -->\n        </span>\n        <span class="op-radiocheck">\n        <!-- inject:radio-plein:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n            <!-- endinject -->\n        </span>\n          <span class="font-subtitle" tabindex="0" style="font-family: '+l(a(null!=e?e.font:e,e))+'">'+l(a(null!=e?e.font:e,e))+"</span>\n      </label>\n    </div>\n"},8:function(e,t,n,i,r,o){var s,a=this.lambda,l=this.escapeExpression,u=t.helperMissing;return'    <div class="op-languages-line">\n      <input tabindex="-1" type="radio" name="subtitleColor" id="subt_color_'+l(a(null!=e?e.color:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'" value="'+l(a(null!=e?e.color:e,e))+'" '+(null!=(s=(t.if_eq||e&&e.if_eq||u).call(e,null!=e?e.color:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.currentColor},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/>\n      <label for="subt_color_'+l(a(null!=e?e.color:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'">\n        <span class="op-radio">\n        <!-- inject:radio:svg -->\n            <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n            <!-- endinject -->\n        </span>\n        <span class="op-radiocheck">\n        <!-- inject:radio-plein:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n            <!-- endinject -->\n        </span>\n          <span class="color-subtitle" tabindex="0" \n'+(null!=(s=(t.if_eq||e&&e.if_eq||u).call(e,null!=e?e.color:e,{name:"if_eq",hash:{compare:"black"},fn:this.program(9,i,0,r,o),inverse:this.program(11,i,0,r,o),data:i}))?s:"")+"          ></span>\n      </label>\n    </div>\n"},9:function(e,t,n,i){return'              style="border: 1px solid white; background-color:'+this.escapeExpression(this.lambda(null!=e?e.color:e,e))+'"\n'},11:function(e,t,n,i){return'              style="background-color:'+this.escapeExpression(this.lambda(null!=e?e.color:e,e))+'"\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,r,o){var s;return null!=(s=t["if"].call(e,null!=(s=null!=e?e.subtitles:e)?s.length:s,{name:"if",hash:{},fn:this.program(1,i,0,r,o),inverse:this.noop,data:i}))?s:""},useData:!0,useDepths:!0})},{"hbsfy/runtime":85}],29:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i,r,o){var s;return'<div class="op-language-choice">\n  <div class="op-languages-title">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.i18n:e)?s.languageViewLanguageChoiceLabel:s,e))+"</div>\n"+(null!=(s=t.each.call(e,null!=e?e.languages:e,{name:"each",hash:{},fn:this.program(2,i,0,r,o),inverse:this.noop,data:i}))?s:"")+"</div>\n"},2:function(e,t,n,i,r,o){var s,a=this.lambda,l=this.escapeExpression;return'    <div class="op-languages-line"><input tabindex="-1" type="radio" name="language" id="'+l(a(null!=e?e.id:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'" value="'+l(a(null!=e?e.id:e,e))+'" '+(null!=(s=(t.if_eq||e&&e.if_eq||t.helperMissing).call(e,null!=e?e.id:e,{name:"if_eq",hash:{compare:(s=this.data(i,1)&&this.data(i,1).root)&&s.current},fn:this.program(3,i,0,r,o),inverse:this.noop,data:i}))?s:"")+'/><label for="'+l(a(null!=e?e.id:e,e))+"_"+l(a((s=this.data(i,1)&&this.data(i,1).root)&&s.containerId,e))+'">\n    <span class="op-radio">\n    <!-- inject:radio:svg -->\n    <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1_1_">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g></svg>\n    <!-- endinject -->\n    </span>\n    <span class="op-radiocheck">\n    <!-- inject:radio-plein:svg -->\n    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Calque_3" display="none">\t<rect x="-0.1" y="0" display="inline" fill="none" width="32" height="32"/></g><g id="Calque_1">\t<g>\t\t<g>\t\t\t<circle fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" cx="15.9" cy="16" r="13"/>\t\t</g>\t</g></g><g id="Calque_2">\t<path fill-rule="evenodd" clip-rule="evenodd" d="M15.9,7.9c4.5,0,8.1,3.6,8.1,8.1s-3.6,8.1-8.1,8.1c-4.5,0-8.1-3.6-8.1-8.1\t\tS11.5,7.9,15.9,7.9z"/></g></svg>\n    <!-- endinject -->\n    </span>\n    <span tabindex="0">'+l(a(null!=e?e.i18nLang:e,e))+"</span></label></div>\n"},3:function(e,t,n,i){return" checked=checked "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,r,o){var s;return null!=(s=t["if"].call(e,null!=(s=null!=e?e.languages:e)?s.length:s,{name:"if",hash:{},fn:this.program(1,i,0,r,o),inverse:this.noop,data:i}))?s:""},useData:!0,useDepths:!0})},{"hbsfy/runtime":85}],30:[function(e,t,n){"use strict";var i=e("./format/settings-format"),r=e("./quality/settings-quality"),o=e("../commun/closeCross/closeCross"),s=function(e){var t=new i(e),n=new r(e),s=new o(e);return function(i){var r=null,o=!1,a=function(o){r=$("#"+e+"-"+i.instanceId),r.addClass("disabled"),i.sub.register("FormatModule",t,o),i.sub.register("QualityModule",n,o),i.sub.register("CloseCrossModule",s),c(),h.init()},l=function(t){o?i.emit(e+"-close-window",t):i.emit(e+"-open-window",t)},u=function(){o=!0,r.removeClass("disabled"),setTimeout(function(){r.find(".op-close a").focus()},0)},d=function(){o=!1,r.addClass("disabled")},c=function(){r.append('<div class="op-close op-hidden" id="'+e+'-CloseCrossModule"></div>'),i.sub.start("CloseCrossModule"),r.append('<div class="op-screen op-languages op-hidden" id="'+e+'-LanguagesModule"></div>'),i.sub.start("LanguagesModule"),r.append('<div class="op-screen op-shortcuts op-hidden" id="'+e+'-ShortcutsModule"></div>'),r.append('<div class="op-screen op-record op-hidden" id="'+e+'-RecordModule"></div>'),i.sub.start("RecordModule"),r.append('<div class="op-screen op-tvod op-hidden" id="'+e+'-TvodModule"></div>'),i.sub.start("TvodModule"),r.append('<div class="op-screen op-settings-format op-hidden" id="'+e+'-FormatModule"></div>'),i.sub.start("FormatModule"),r.append('<div class="op-screen op-settings-quality op-hidden" id="'+e+'-QualityModule"></div>'),i.sub.start("QualityModule"),r.append('<div class="op-screen op-towatch op-hidden" id="'+e+'-TowatchModule"></div>'),i.sub.start("TowatchModule")},h={init:function(){i.on(e+"-toggle-window",l),i.on(e+"-open-window",u),i.on(e+"-close-window",d)}},f=function(){};return{init:a,destroy:f}}};t.exports=s},{"../commun/closeCross/closeCross":5,"./format/settings-format":25,"./quality/settings-quality":32}],31:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'<div class="op-quality-title">'+s(o(null!=(r=null!=e?e.i18n:e)?r.settingsQualityViewTitleLabel:r,e))+'</div>\n<div class="wrapper-block-quality">\n    <div class="block-quality">\n        <div class="label">'+s(o(null!=(r=null!=e?e.i18n:e)?r.settingsQualityViewHighLabel:r,e))+'</div>\n        <div class="value">'+s(o(null!=(r=null!=e?e.datas:e)?r.max:r,e))+'</div>\n    </div>\n    <div class="block-quality orange">\n        <div class="label">'+s(o(null!=(r=null!=e?e.i18n:e)?r.settingsQualityViewReceivedLabel:r,e))+'</div>\n        <div class="value">'+s(o(null!=(r=null!=e?e.datas:e)?r.current:r,e))+s(o(null!=(r=null!=e?e.i18n:e)?r.settingsQualityViewHighQualityUnit:r,e))+'</div>\n    </div>\n    <div class="block-quality">\n        <div class="label">'+s(o(null!=(r=null!=e?e.i18n:e)?r.settingsQualityViewLowLabel:r,e))+'</div>\n        <div class="value">'+s(o(null!=(r=null!=e?e.datas:e)?r.min:r,e))+"</div>\n    </div>\n</div>"},useData:!0})},{"hbsfy/runtime":85}],32:[function(e,t,n){"use strict";var i=e("./settings-quality.hbs"),r=function(e){var t=null,n="quality",r="settingsQualityView";return function(o){var s=null,a=function(){s=$("#"+e+"-"+o.instanceId),t=o.options.i18n[r],o.on(e+"-videoBitrates",function(e){p.setMaxMinBitrates(e),f.init()}),o.on(e+"-bandwith",function(e){p.setCurrentBitrate(e),c()}),f.init()},l=function(){var e=i({i18n:t,datas:p.getBitrates()});s.empty().append(e),u()},u=function(){s.removeClass("op-hidden"),h()},d=function(){s.addClass("op-hidden")},c=function(){s.find("#bandwith-binding").html(p.getBitrates().current)},h=function(){var t=s.find(".op-settings-quality");t.on("change",function(n){t.off(),o.emit(e+"-quality-value-change",n.target.value)})},f={init:function(){o.on(e+"-open-window",function(e){e===n?l():d()}),o.on(e+"-close-window",d)}},p={bitrates:{current:0},setMaxMinBitrates:function(e){p.bitrates.max=m.formatBitrates(e[e.length-1]),p.bitrates.min=m.formatBitrates(e[0])},setCurrentBitrate:function(e){p.bitrates.current=(e/1e3).toFixed(1)},getBitrates:function(){return p.bitrates}},m={formatBitrates:function(e){return(e/1e6).toFixed(1)}},g=function(){};return{init:a,destroy:g}}};t.exports=r},{"./settings-quality.hbs":31}],33:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'            <div>\n                <div class="op-shortcuts-key">'+(null!=(r=t.each.call(e,null!=e?e.keys:e,{name:"each",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?r:"")+'</div>\n                <div class="op-shortcuts-key-fct">\n                    <div>'+s(o(null!=e?e.fct:e,e))+'</div>\n                    <div class="op-shortcuts-key-details">'+s(o(null!=e?e.detail:e,e))+"</div>\n                </div>\n            </div>\n"},2:function(e,t,n,i){var r;return null!=(r=(t.svgHelper||e&&e.svgHelper||t.helperMissing).call(e,e,{name:"svgHelper",hash:{},data:i}))?r:""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r;return'<div class="op-shortcuts-nav">\n    <div class="op-shortcuts-container">\n        <div class="op-shortcuts-table">\n'+(null!=(r=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+"        </div>\n    </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":85}],34:[function(e,t,n){"use strict";var i=function(e){var t="sumup";return function(n){var i=null,r=function(){i=$("#"+e+"-"+n.instanceId),a.init()},o=function(){i.removeClass("op-hidden")},s=function(){i.addClass("op-hidden")},a={init:function(){
n.on(e+"-open-window",function(e){e===t?o():s()}),n.on(e+"-close-window",s)}},l=function(){};return{init:r,destroy:l}}};t.exports=i},{}],35:[function(e,t,n){"use strict";var i=function(e){var t=null;return function(n){var i=null,r=function(){i=$("#"+e+"-"+n.instanceId),o.init(),h.init()},o={init:function(){}},s=function(){n.stayHidden=!1,i.removeClass(n.classes.opHiddenTranslateUp).removeClass(n.classes.opHidden).addClass(n.classes.opShowTranslateUp)},a=function(){n.stayHidden=!0,i.removeClass(n.classes.opShowTranslateUp).addClass(n.classes.opHiddenTranslateUp),t=!1,d()},l=function(){i.addClass(n.classes.opHidden)},u=function(e){t&&i.find(".op-settings-menu-"+t).removeClass(n.classes.opMenuSelected),i.find(".op-settings-menu-"+e).addClass(n.classes.opMenuSelected),t=e},d=function(){i.find(".op-settings-menu-item").removeClass(n.classes.opMenuSelected)},c=function(t){u(t),n.emit(e+"-open-window",t)},h={init:function(){i.on("click",function(t){var r=t.target.dataset.settings;r&&(i.find('.op-settings-menu-item[data-settings="'+r+'"').hasClass("op-menu-selected")?(n.emit(e+"-close-window"),n.emit(e+"-close-window-manual")):c(r),n.emit(e+"-gstat",{area:"menuParametres",action:{format:"modeAffichage",quality:"qualite",shortcuts:"aide"}[r]}))}),n.on(e+"-close-window",function(){i.find(".op-settings-menu-"+t).removeClass(n.classes.opMenuSelected),t=null}),n.on(e+"-open-reglages",s),n.on(e+"-close-reglages",a),n.on(e+"-open-menu",a),n.on(e+"-hide-osd",a),i.on("mouseenter",function(){n.emit(e+"-keep-osd-visible")}),i.on("mouseleave",function(){n.emit(e+"-purge-osd-visible")}),l()}},f=function(){};return{init:r,destroy:f}}};t.exports=i},{}],36:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<span class="op-subtitle-content">\n</span>'},useData:!0})},{"hbsfy/runtime":85}],37:[function(e,t,n){"use strict";var r=e("./subtitle-area.hbs"),o=e("../../../utils"),s=function(e){var t=null,n=1,s=null,a=0,l=[10,10],u={"default":"sans-serif",monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:"sans-serif",monospaceSerif:"monospace",proportionalSansSerif:"sans-serif",proportionalSerif:"serif"},d=function(e,t){var r=null,o=null;if(e.fontSize)if(o=e.fontSize,o&&"c"===o[o.length-1]){var s=o.replace(/\s/g,"").split("c");for(i=0;i<s.length;i+=1)s[i]=parseFloat(s[i]);r=isNaN(s[1])?s[0]*l[1]:s[1]*l[1],r=n*r+"px"}else{var a=/([0-9-.]*)(.*)/g.exec(e.fontSize),u=a[1],d=a[2];r=d?"%"===d?n*(t.height()*u/100)+"px":n*u+d:n*e.fontSize+"px"}else r=18*n+"px";return r},c=function(e){n=e},h=function(e){if(9===e.length&&"#"===e.charAt(0)){var t=e.slice(1,7),n=e.slice(7),i=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),s=parseInt(parseInt(n,16)/255*100)/100;e="rgba("+i+", "+r+", "+o+", "+s+")"}return e},f=function(e){if(e.data){var n=e.data.style,i=e.videoDom;t.css("bottom",.05*i.height()+a+"px"),t.width(i.width()),t.removeClass("op-hidden"),s.css("background-color",n.backgroundColor);var r=o.getPreferences().colorSubtitle,c=n.color||"white";s.css("color",h(void 0===r||""===r?c:r));var f=o.getPreferences().fontSubtitle,p=u[n.fontFamily]||"sans-serif";s.css("font-family",void 0===f||""===f?p:f);var m=n.cellResolution;l=[t.width()/m[0],i.height()/2/m[1]],s.css("font-size",d(n,i)),e.data.text&&s.append(e.data.text)}},p=function(){s.empty(),s.css("background-color","transparent")},m=function(){var e=t.css("bottom");a=150,t.css("bottom",parseInt(e,10)+a+"px")},g=function(){var e=t.css("bottom");a=0,t.css("bottom",parseInt(e,10)+a+"px")},y=function(e){"none"===e.lang?s.css("display","none"):s.css("display","inherit")},v=function(){s.empty()};return function(n){var i=function(){t=$("#"+e+"-"+n.instanceId),n.on(e+"-hasplayer-cue-enter",f),n.on(e+"-hasplayer-cue-exit",p),n.on(e+"-subtitle-size-change",c),n.on(e+"-hasplayer-display-message",p),n.on(e+"-hasplayer-empty-message",p),n.on(e+"-select-subtitles",function(e){y(e)}),n.on(e+"-show-osd",m),n.on(e+"-hide-osd",g),n.on(e+"-stop-player",v),o()},o=function(){var e=r();t.empty().append(e),s=t.find(".op-subtitle-content")},a=function(){};return{init:i,destroy:a}}};t.exports=s},{"../../../utils":71,"./subtitle-area.hbs":36}],38:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<video tabindex="-1"></video>'},useData:!0})},{"hbsfy/runtime":85}],39:[function(e,t,n){"use strict";var i=e("hasplayer"),r=e("metricsagent"),o=e("./video.hbs"),s=e("screenfull"),a=e("../../../utils"),l=e("lodash.assignin"),u=function(e,t){return function(n){var u=null,d=null,c=null,h=null,f=!1,p=!1,m=4e5,g=0,y={isPlaying:!1,hasplayer:null},v=function(){y.hasplayer=d=n.options.hasPlayer,y=l(t,y),u=$("#"+e+"-"+n.instanceId),T(),b(),E(),S(),x(),_()},_=function(){n.on(e+"-onGetTerminalId",function(){n.emit(e+"-hasplayer-haveTerminalId",{terminal:d.getTerminalId()})})},b=function(){function t(e){navigator.userAgent.toLowerCase().indexOf("edge")>-1;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function o(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function s(){n.emit(e+"-on-opening"),n.emit(e+"-start-load-sequence")}var l,m=null;c=u.find("video")[0],n.on(e+"-change-volume",function(e){d.setVolume(parseInt(e,10)/100)}),n.on(e+"-change-zoom",function(e){var n=(e?$("#"+e):u).closest(".player-container")[0];document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreen?o():t(n)}),n.on(e+"-onSticked",function(){n.emit(e+"-set-fullscreen",!1)}),n.on(e+"-set-fullscreen",function(e){e?t(u.closest(".player-container")[0]):o()}),n.on(e+"-stop-player",function(e){d.reset()}),n.on(e+"-restart",function(){c.pause(),c.currentTime=0,c.play()}),n.on(e+"-loadMetricsAgent",function(e){d.addPlugin(new r(e))}),n.on(e+"-refreshManifest",function(e){d.refreshManifest(e)}),n.on(e+"-select-languages",function(e){d.selectTrack(i.TRACKS_TYPE.AUDIO,e),d.setDefaultAudioLang(e.lang)}),n.on(e+"-hasplayer-display-message",function(){a.cancelTimeout(m),m=null,d.stop()}),n.on(e+"-select-subtitles",function(e){"none"===e.lang?d.enableSubtitles(!1):(d.setDefaultSubtitleLang(e.lang),d.selectTrack(i.TRACKS_TYPE.TEXT,e),d.enableSubtitles(!0))}),n.on(e+"-end-load-sequence",function(){n.emit(e+"-main-mouse-move"),a.destroyTimeout(m),m=null,"undefined"!=typeof l.autoplay&&l.autoplay&&(f=l.autoplay),n.emit(e+"-hasplayer-empty-message"),c.autoplay=f,d.load(l),"undefined"!=typeof l.muted&&l.muted&&(p=l.muted,c.volume=0)}),n.on(e+"-load",function(t){l=t,null!==m?(d.stop(),a.refreshTimeout(m)):(m=e+"hasload",a.initTimeout(m,s,300))}),u.on("touchstart",function(t){t.preventDefault(),n.emit(e+"-video-touch-start")}),u.on("click",function(t){n.emit(e+"-play-pause")}),n.on(e+"-format-normal",function(){h.removeClass("stretch"),void 0!==h[0].msZoom&&(h[0].msZoom=!1)}),n.on(e+"-format-stretch",function(){h.addClass("stretch"),void 0!==h[0].msZoom&&(h[0].msZoom=!0)})},E=function(){d.init(c),d.setDebug(!1),d.setParams({"ABR.minBandwidth":m}),c.autoplay=!1,d.enableSubtitleExternDisplay(!0);var e=a.getPreferences();e&&e.trackObj&&e.trackObj.lang?d.setDefaultAudioLang(e.trackObj.lang):(d.setDefaultAudioLang("fra"),a.storePreferences({trackObj:{lang:"fra"}})),e&&e.subtitleObj&&e.subtitleObj.lang?(d.setDefaultSubtitleLang(e.subtitleObj.lang),d.enableSubtitles("none"!==e.subtitleObj.lang)):(d.setDefaultSubtitleLang("none"),d.enableSubtitles(!1),a.storePreferences({subtitleObj:{lang:"none"}})),e&&e.volume||a.storePreferences({volume:50})},x=function(){h=$(u.find("video")[0]),h.on("play",function(){y.isPlaying=!0,n.emit(e+"-video-play")}),h.on("pause",function(){y.isPlaying=!1,n.emit(e+"-video-pause")}),h.on("volumechange",function(){}),h.on("loadstart",function(){}),h.on("loadedmetadata",function(){}),h.on("loadeddata",function(){n.emit(e+"-loaded-data",{tracks:d.getTracks(i.TRACKS_TYPE.AUDIO),subtitles:d.getTracks(i.TRACKS_TYPE.TEXT),track:d.getSelectedTrack(i.TRACKS_TYPE.AUDIO),subtitle:d.getSelectedTrack(i.TRACKS_TYPE.TEXT),duration:d.getDuration()})}),h.on("dblclick",function(t){s.isFullscreen;n.emit(e+"-change-zoom")}),h.on("state_changed",function(t){"playing"===t.detail.state?(y.isPlaying=!0,n.emit(e+"-video-play",{volume:c.volume})):"buffering"===t.detail.state&&n.emit(e+"-video-waiting")}),d.addEventListener("play_bitrate",function(t){var i=d.getVideoBitrates().filter(function(e){return e>=m});n.emit(e+"-videoBitrates",i),t&&t.detail&&"video"===t.detail.type&&(g=t.detail.bitrate/1e3,n.emit(e+"-bandwith",g))}),d.addEventListener("error",function(t){d.reset(2),n.emit(e+"-hasplayer-error",t)}),d.addEventListener("warning",function(t){n.emit(e+"-hasplayer-warning",t)}),d.addEventListener("manifestUrlUpdate",function(){n.emit(e+"-hasplayer-manifestUrlUpdate")}),d.addEventListener("cueEnter",function(t){n.emit(e+"-hasplayer-cue-enter",{data:t.data,videoDom:h})}),d.addEventListener("cueExit",function(){n.emit(e+"-hasplayer-cue-exit")}),h.on("stalled",function(){}),h.on("durationchange",function(){}),h.on("progress",function(){}),h.on("timeupdate",function(){n.emit(e+"-on-play",c.currentTime)}),n.emit(e+"-video-ready",{hasplayer:h,videonode:c})},S=function(){var t=function(t){var i=s.isFullscreen;n.emit(e+"-fullscreen",i)};document.msFullscreenEnabled?document.onmsfullscreenchange=t:document.mozFullScreenEnabled?document.onmozfullscreenchange=t:void 0!==document.onwebkitfullscreenchange?document.onwebkitfullscreenchange=t:document.onfullscreenchange=t},T=function(){u.append(o())},w=function(){};return{init:v,destroy:w}}};t.exports=u},{"../../../utils":71,"./video.hbs":38,hasplayer:63,"lodash.assignin":89,metricsagent:64,screenfull:100}],40:[function(e,t,n){"use strict";var i=e("zepto").$,r=e("scaleapp"),o=e("scaleapp.i18n"),s=e("scaleapp.submodule"),a=e("elementQuery"),l=e("handlebars-helpers"),u=e("pubsub"),d=e("hasplayer"),c=e("./common/modules/main/i18n"),h=e("./common/modules/main/playerConfig"),f=e("./service.js"),p=e("./loader.js"),m=function(t){r.plugins.i18n=o,r.plugins.submodule=s;var n=Date.now(),m=null,g=5e3,y=1e3,v=new p(this),_=this,b=function(e,t,n,i){return e._mediator.installTo(this),this.moduleId=i,this.instanceId=t,this.delayInactivity=g,this.delayHideFeedback=y,this.options=n,this.playerConfig=h,this.classes={opHiddenAnim:"op-hidden-anim",opHidden:"op-hidden",opShowAnim:"op-show-anim",opVisible:"op-visible",opShowTranslateUp:"op-show-translate-up",opHiddenTranslateUp:"op-hidden-translate-up",opMenuSelected:"op-menu-selected",opFadeIn:"op-fade-in",opFadeOut:"op-fade-out"},this};this.core=new r.Core(b),this.core.use(r.plugins.submodule,{inherit:!0,useGlobalMediator:!0}),this.core.use(r.plugins.i18n),this.hasPlayer=new d,this.uniqueId="player-instance-"+n,this.container=i("string"==typeof t?"#"+t:t),this.videoContainer=i('<div id="'+n+'-main-container" class="js-html5-video-player"></div>'),this.container.append(this.videoContainer),this.container.addClass("overflow"),this.container.addClass("op-noselect"),this.container.addClass("player-container"),v.load({name:"BackgroundErrorModule",constructor:e("./common/modules/background-error/background-error"),args:[n],options:{},template:'<div id="'+n+'-BackgroundErrorModule" class="op-background-error"></div>',priority:5,container:_.videoContainer}),v.load({name:"SubtitleAreaModule",constructor:e("./common/modules/subtitle-area/subtitle-area"),args:[n],template:'<div id="'+n+'-SubtitleAreaModule" class="op-subtitle-area op-hidden"></div>',priority:10,container:_.videoContainer}),v.load({name:"MouseHandlerModule",constructor:e("./common/modules/commun/mouseHandler/mouseHandler"),args:[n],options:_.videoContainer}),v.load({name:"KeyboardHandlerModule",constructor:e("./common/modules/commun/keyboardHandler/keyboardHandler"),args:[n],options:_.videoContainer}),f.init(_,n,v);var E=u.subscribe("init-setwording-done",function(){m=c.getWording(),l.setI18Nresource(c.getLanguage(),m),v.load({name:"ErrorModule",constructor:e("./common/modules/error/error"),args:[n],template:'<div id="'+n+'-ErrorModule" class="op-error op-hidden"></div>',priority:25,options:{i18n:m},container:_.videoContainer}),f.onInitSetwordingDone(_,{i18n:m},n,v),v.start(),a.elementQuery({".op-hidden-anim":{"min-width":["501px"]},".op-hidden-translate-up":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-show-translate-up":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-control-bar":{"max-width":["479px","688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-error":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-info-banner":{"max-width":["479px","688px","885px","1279px","1679px","2559px"],"min-width":["480px","689px","886px","1280px","1680px","2560px"]},".op-menu":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-middle-container":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-settings-menu":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-settings-format":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-languages":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["2560px","689px","886px","1280px","1680px"]},".op-settings-quality":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["2560px","689px","886px","1280px","1680px"]},".op-shortcuts":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","2560px","1280px","1680px"]},".op-seek-bar":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]},".op-mosaic":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","2560px","886px","1280px","1680px"]},".op-sumup":{"max-width":["688px","885px","1279px","1679px","2559px"],"min-width":["689px","886px","1280px","1680px","2560px"]}},!0),E.remove()})};t.exports=m},{"./common/modules/background-error/background-error":3,"./common/modules/commun/keyboardHandler/keyboardHandler":8,"./common/modules/commun/mouseHandler/mouseHandler":9,"./common/modules/error/error":13,"./common/modules/main/i18n":20,"./common/modules/main/playerConfig":22,"./common/modules/subtitle-area/subtitle-area":37,"./loader.js":60,"./service.js":70,elementQuery:61,"handlebars-helpers":62,hasplayer:63,pubsub:65,scaleapp:68,"scaleapp.i18n":66,"scaleapp.submodule":67,zepto:69}],41:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=t.helperMissing,s="function",a=this.escapeExpression;return'<div class="op-controls">\n    <div class="op-control-left">\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonMenuToolTipLabel||(null!=e?e.buttonMenuToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonMenuToolTipLabel",hash:{},data:i}):r))+'" class="tooltip first op-control-menu stop-anchor"><div class="op-control">\n            <!-- inject:menu:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M1 4h30v4.286h-30v-4.286z"></path><path fill="#000000" d="M1 14h30v4.286h-30v-4.286z"></path><path fill="#000000" d="M1 24h30v4.286h-30v-4.286z"></path></svg>\n            <!-- endinject -->\n        </div></a>\n\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonSettingsToolTipLabel||(null!=e?e.buttonSettingsToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonSettingsToolTipLabel",hash:{},data:i}):r))+'" class="tooltip op-reglages stop-anchor"><div class="op-control">\n            <!-- inject:reglages:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path id="svg_1" d="m20.044439,31.781786c-0.622219,0 -1.088884,-0.31111 -1.244442,-0.777779c0,-0.155552 -0.155554,-0.155552 -0.155554,-0.31111c-0.466671,-1.555555 -1.400005,-2.022226 -3.266667,-1.866667c-0.933334,0.155556 -1.555557,0.622221 -1.866668,1.555559c0,0 0,0.155552 0,0.155552c-0.466667,1.244444 -1.088889,1.555557 -2.333335,1.244444c-0.933332,-0.31111 -1.866666,-0.777779 -2.799998,-1.244444s-0.933335,-1.08889 -0.622224,-2.022217c0,0 0,0 0,-0.155558c0.933334,-1.866669 0,-2.955557 -1.4,-3.888887c-0.466667,-0.311115 -1.088886,-0.311115 -1.555554,-0.15556c-0.31111,0.15556 -0.777779,0.311115 -1.088889,0.466663c-0.466666,0.155558 -1.088889,0.155558 -1.400001,-0.311104c-0.933333,-1.244452 -1.555556,-2.488894 -1.711112,-4.044449c0,-0.466667 0.155556,-0.933334 0.622224,-1.08889c0.155555,-0.155556 0.311111,-0.155556 0.466667,-0.155556c1.4,-0.466665 2.022222,-1.399998 1.866666,-3.266665c-0.155556,-0.933334 -0.622222,-1.555555 -1.4,-1.866671c0,0 -0.155556,0 -0.155556,-0.155555c-1.244445,-0.466663 -1.555556,-1.088886 -1.244445,-2.33333c0.311112,-0.933335 0.777779,-1.866667 1.244445,-2.800001s1.088889,-0.933335 2.022222,-0.622222c0,0 0,0 0.155555,0c1.555556,0.777778 2.800001,0.31111 3.88889,-1.400001c0.311112,-0.466667 0.466667,-1.088889 0.155557,-1.711111c-0.155557,-0.311112 -0.155557,-0.466667 -0.311111,-0.777777c-0.31111,-0.933335 -0.155557,-1.400002 0.466667,-1.866668c1.088887,-0.777778 2.333335,-1.244445 3.733334,-1.4c0.622221,0 1.088886,0.155556 1.244445,0.777778c0,0.155555 0.155555,0.31111 0.155555,0.466667c0.466666,1.4 1.4,2.022223 3.266668,1.866667c0.933331,-0.155555 1.555553,-0.622222 2.022221,-1.555556c0,0 0,-0.155555 0,-0.155555c0.466665,-1.244445 1.08889,-1.555556 2.33333,-1.244445c0.933334,0.311112 1.866669,0.777778 2.800003,1.244445c0.622227,0.311111 0.622227,0.777778 0.311111,1.711112c0,0 0,0 0,0.155556c-0.933332,1.71111 -0.155552,2.955554 1.400002,3.888889c0.466669,0.31111 1.088888,0.31111 1.711107,0.155555c0.311113,-0.155555 0.622229,-0.311111 1.088896,-0.466668c0.622217,-0.155554 1.088886,-0.155554 1.399998,0.311113c0.933332,1.244443 1.555553,2.488888 1.555553,4.044442c0,0.466669 -0.155556,0.933334 -0.622221,1.08889c-0.155556,0.155558 -0.311111,0.155558 -0.466663,0.155558c-1.400005,0.466663 -2.022224,1.399997 -1.866667,3.266665c0.155556,0.933334 0.622217,1.4 1.399998,1.866665c0,0 0.155558,0 0.155558,0.155558c1.24444,0.466665 1.555553,1.08889 1.24444,2.33333c-0.311111,0.933336 -0.777777,1.866669 -1.24444,2.800003s-1.088894,1.088888 -2.022223,0.622227c0,0 0,0 0,0c-1.866667,-0.933336 -2.955561,0 -3.888889,1.399998c-0.311115,0.466665 -0.311115,1.08889 -0.15556,1.555555c0.15556,0.311111 0.311111,0.777779 0.466669,1.088892c0.155558,0.622217 0.155558,1.088882 -0.31111,1.399998c-1.24445,1.244442 -2.644449,1.711109 -4.044451,1.866663zm-4.199999,-7.311106c4.511112,0 8.24445,-3.733335 8.24445,-8.24445s-3.733337,-8.244444 -8.24445,-8.244444c-4.51111,0 -8.244442,3.733332 -8.244442,8.244444s3.733332,8.24445 8.244442,8.24445z" fill="#000000"/></svg>\n            <!-- endinject -->\n        </div></a>\n    </div>\n    <div class="op-control-center">\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonPreviousChannelToolTipLabel||(null!=e?e.buttonPreviousChannelToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonPreviousChannelToolTipLabel",hash:{},data:i}):r))+'" class="tooltip op-chainemoins stop-anchor op-control"><div class="op-control">\n            <!-- inject:chainemoins:svg -->\n            <?xml version="1.0" encoding="utf-8" ?><svg version="1.1" focusable="false" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve">    <g id="chaine-">        <g id="svg_5">            <path id="svg_6" d="m0.300001,4.670589v19.764704h5.435294v2.594118h20.629411v-2.594118h5.435293v-19.764704h-31.499998l0,0zm15.688235,20.505881c-0.617648,0 -1.111765,-0.494118 -1.111765,-1.111765c0,-0.617647 0.494117,-1.111763 1.111765,-1.111763c0.617646,0 1.111764,0.494116 1.111764,1.111763c0.123529,0.617647 -0.494118,1.111765 -1.111764,1.111765zm13.217647,-3.705883h-26.435294v-14.082351h26.435294v14.082351l0,0z" fill="#434343" />            <g id="svg_7">                <rect id="svg_8" height="2.470588" width="9.388235" fill="#434343" y="13.194118" x="11.294118" />            </g>        </g>    </g></svg>\n            <!-- endinject -->\n        </div></a>\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonPauseToolTipLabel||(null!=e?e.buttonPauseToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonPauseToolTipLabel",hash:{},data:i}):r))+'" class="tooltip op-play stop-anchor op-control"><div class="">\n            <!-- inject:play2:svg -->\n            <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path id="svg_1" d="m3.626999,31.24099l26.127003,-15.241442l-26.127003,-15.235536l0,30.476978z" fill="#000000"/></svg>\n            <!-- endinject -->\n            <!-- inject:pause:svg -->\n            <?xml version="1.0" encoding="utf-8" ?><svg version="1.1" focusable="false" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve">    <g id="pause">        <g>            <rect id="svg_12" height="27.126805" width="11.517526" fill="#424242" fill-rule="evenodd" y="2.286598" x="1.3"/>    \t\t<rect id="svg_13" height="27.126805" width="11.517526" fill="#424242" fill-rule="evenodd" y="2.286598" x="19.182475"/>        </g>    </g></svg>\n            <!-- endinject -->\n        </div></a>\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonNextChannelToolTipLabel||(null!=e?e.buttonNextChannelToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonNextChannelToolTipLabel",hash:{},data:i}):r))+'" class="tooltip op-chaineplus stop-anchor op-control"><div class="op-control">\n            <!-- inject:chaineplus:svg -->\n            <?xml version="1.0" encoding="utf-8" ?><svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" xml:space="preserve">    <g id="chaine_x2B__1_">        <g id="svg_1">            <path id="svg_2" d="m0.299999,4.774015v19.655905h5.43937v2.596062h20.521259v-2.596062h5.439371v-19.655905h-31.4l0,0zm15.7,20.397637c-0.61811,0 -1.112599,-0.494488 -1.112599,-1.112598c0,-0.618109 0.49449,-1.112597 1.112599,-1.112597c0.618112,0 1.112597,0.494488 1.112597,1.112597c0.123621,0.618111 -0.494486,1.112598 -1.112597,1.112598zm13.227559,-3.70866h-26.331496v-14.092914h26.331496v14.092914l0,0z" fill="#424242" />            <g id="svg_3">                <rect id="svg_4" height="9.395276" width="2.472441" fill="#424242" y="9.842519" x="14.763778" />                <rect id="svg_5" height="2.472441" width="9.395276" fill="#424242" y="13.180314" x="11.302361" />            </g>        </g>    </g></svg>\n            <!-- endinject -->\n        </div></a>\n    </div>\n    <div class="op-control-right">\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonStopVolumeToolTipLabel||(null!=e?e.buttonStopVolumeToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonStopVolumeToolTipLabel",hash:{},data:i}):r))+'" class="first op-sound stop-anchor op-control"><div>\n            <!-- inject:son:svg -->\n            <?xml version="1.0" encoding="utf-8" ?><svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">    <g id="svg_11">        <path fill="#000000" d="m20.561682,27.761684v2.641121c0,0 -3.081308,-2.641121 -3.521494,-3.081308c-1.46729,-1.320564 -2.934581,-2.641123 -4.401871,-3.961685c-0.440186,-0.440184 -1.027103,-0.586912 -1.614017,-0.586912c-3.228038,0 -6.309347,0 -9.537384,0c-0.146729,0 -0.440187,0 -0.586916,0v-13.645797c0,0 7.189721,0 10.1243,0c0.586914,0 1.173832,-0.293457 1.760747,-0.586917c2.494391,-2.200934 4.988786,-4.548598 7.483178,-6.749532c0.14673,-0.146729 0.14673,-0.146729 0.293457,-0.293458v26.264489l0,0l0,0z" id="svg_8" />        <path fill="#000000" d="m27.164488,23.653273l-0.146729,-0.14673c-0.440189,-0.440187 -0.58692,-1.027103 -0.293459,-1.614019c1.17383,-1.760748 1.907476,-3.814955 1.907476,-6.015887s-0.586916,-4.25514 -1.760748,-6.015888c-0.293459,-0.586916 -0.146729,-1.173832 0.293459,-1.614018l0.146729,-0.146729c0.586914,-0.440187 1.32056,-0.293459 1.760746,0.293457c2.787851,3.961682 3.228037,10.271029 -0.14673,14.966354c-0.440184,0.586918 -1.173828,0.733648 -1.760744,0.293461l0,0z" id="svg_9" />        <path fill="#000000" d="m23.496264,11.328037v0c0.586916,-0.440187 1.467289,-0.293458 1.760746,0.293458c1.32056,2.200934 1.614019,5.72243 -0.146729,8.51028c-0.440184,0.586916 -1.173832,0.733644 -1.760746,0.293459v0c-0.440189,-0.440186 -0.58692,-1.027103 -0.293459,-1.614017c0.586918,-0.880379 0.880373,-1.907478 0.880373,-2.934581s-0.293455,-2.054206 -0.733644,-2.934581c-0.293459,-0.586915 -0.146729,-1.17383 0.293459,-1.614017l0,0z" id="svg_10" />    </g></svg>\n            <!-- endinject -->\n            <!-- inject:mute:svg -->\n            <?xml version="1.0" encoding="utf-8" ?><svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">    <g id="svg_7">        <path id="svg_4" d="m20.89936,27.96454v2.68648c0,0 -3.13423,-2.68648 -3.58197,-3.13422c-1.49249,-1.34324 -2.98498,-2.68649 -4.47747,-4.02972c-0.44775,-0.44774 -1.04474,-0.59699 -1.64174,-0.59699c-3.28348,0 -6.41771,0 -9.70118,0c-0.14925,0 -0.44775,0 -0.597,0v-13.88015c0,0 7.3132,0 10.29818,0c0.59699,0 1.19399,-0.2985 1.79099,-0.597c2.53723,-2.23873 5.07446,-4.62672 7.6117,-6.86545c0.14925,-0.14925 0.14925,-0.14925 0.29849,-0.2985v26.71556l0,0z" fill="#000000" />        <path id="svg_5" d="m24.32462,11.58148l6.88038,5.9625l-1.95516,2.25515l-6.88038,-5.9625l1.95516,-2.25515z" fill="#000000" />        <path id="svg_6" d="m31.12889,13.49038l-6.43711,6.43711l-2.11038,-2.11038l6.43711,-6.43711l2.11038,2.11038z" fill="#000000" />    </g></svg>\n            <!-- endinject -->\n        </div></a>\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonOffscreenToolTipLabel||(null!=e?e.buttonOffscreenToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonOffscreenToolTipLabel",hash:{},data:i}):r))+'" class="tooltip op-format stop-anchor op-control">\n            <div class="fill-none">\n                <!-- inject:format-vignette:svg -->\n                <svg version="1.1" focusable="false" id="Calque_12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><rect x="4.9" y="7.9" fill="none" stroke="#fff" stroke-width="3" stroke-miterlimit="10" width="22.3" height="14.3"/></svg>\n                <!-- endinject -->\n            </div>\n        </a>\n        <a tabindex="0" role="button" title="'+a((r=null!=(r=t.buttonFullScreenToolTipLabel||(null!=e?e.buttonFullScreenToolTipLabel:e))?r:o,typeof r===s?r.call(e,{name:"buttonFullScreenToolTipLabel",hash:{},data:i}):r))+'" class="tooltip last op-zoom stop-anchor op-control"><div>\n            <!-- inject:zoom_Big:svg -->\n            <svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="-15 0 32 32" enable-background="new -15 0 32 32" xml:space="preserve"><path d="M11.1,9.2v3.9h2.4V6.8H6.8v2.4L11.1,9.2z"/><path d="M11.1,22.5H6.8v2.4h6.7v-6.4h-2.4V22.5z"/><path d="M-9.1,22.5v-4h-2.4v6.4h6.7v-2.4H-9.1z"/><path d="M-9.1,9.2h4.3V6.8h-6.7v6.3h2.4L-9.1,9.2z"/></svg>\n            <!-- endinject -->\n            <div>\n                <div class="op-zoom-normal">\n                <!-- inject:zoom_normal:svg -->\n                <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="-15 0 32 32" enable-background="new -15 0 32 32" xml:space="preserve"><g id="Calque_1" display="none">\t<path display="inline" d="M11.1,9.2v3.9h2.4V6.8H6.8v2.4L11.1,9.2z"/>\t<path display="inline" d="M11.1,22.5H6.8v2.4h6.7v-6.4h-2.4V22.5z"/>\t<path display="inline" d="M-9.1,22.5v-4h-2.4v6.4h6.7v-2.4H-9.1z"/>\t<path display="inline" d="M-9.1,9.2h4.3V6.8h-6.7v6.3h2.4L-9.1,9.2z"/></g><g id="Calque_1_-_copie">\t<path d="M9.2,10.7V6.8H6.8v6.3h6.7v-2.4L9.2,10.7z"/>\t<path d="M9.2,20.9h4.3v-2.4H6.8v6.4h2.4V20.9z"/>\t<path d="M-7.2,20.9v4h2.4v-6.4h-6.7v2.4H-7.2z"/>\t<path d="M-7.2,10.7l-4.3,0v2.4h6.7V6.8h-2.4L-7.2,10.7z"/></g></svg>\n                <!-- endinject -->\n                </div>\n                <div class="op-zoom-vignette fill-none">\n                <!-- inject:format-vignette:svg -->\n                <svg version="1.1" focusable="false" id="Calque_12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><rect x="4.9" y="7.9" fill="none" stroke="#fff" stroke-width="3" stroke-miterlimit="10" width="22.3" height="14.3"/></svg>\n                <!-- endinject -->\n                </div>\n            </div>\n        </div></a>\n        <div role="slide" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" aria-valuetext="100% '+a((r=null!=(r=t.sound||(null!=e?e.sound:e))?r:o,typeof r===s?r.call(e,{name:"sound",hash:{},data:i}):r))+'" class="op-container-volume op-hidden">\n            <span class="op-volume-value">100</span>\n            <input tabindex="-1" class="op-volume op-range100" type="range" min="0" max="100" value="100" role="slider"  aria-valuemin="0" aria-valuemax="100" aria-valuenow="100"/>\n        </div>\n    </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":85}],42:[function(e,t,n){"use strict";var i=e("./control-bar.hbs"),r=e("./seek-bar/seek-bar"),o=e("../../../common/modules/control-bar/control-bar"),s=function(e){var t=new r(e),n="controlBarToolTip",s=null,a=new o(e);return function(r){var o=null,l=function(){o=$("#"+e+"-"+r.instanceId),r.sub.register("SeekBarModule",t,r.options),r.sub.register(r.instanceId,a,r.options),u()},u=function(){s=r.options.i18n[n];var t=i(s);o.append(t),o.prepend('<div class="op-seek-bar" id="'+e+'-SeekBarModule"></div>'),r.sub.start("SeekBarModule"),r.sub.start(r.instanceId),d.init()},d={initVideoControls:function(){o.find(".op-chaineplus").on("click",function(t){t.stopPropagation(),setTimeout(function(){r.emit(e+"-next-channel")},0)}),o.find(".op-chainemoins").on("click",function(t){t.stopPropagation(),setTimeout(function(){r.emit(e+"-previous-channel")},0)})},init:function(){this.initVideoControls()}},c=function(){};return{init:l,destroy:c}}};t.exports=s},{"../../../common/modules/control-bar/control-bar":11,"./control-bar.hbs":41,"./seek-bar/seek-bar":44}],43:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=t.helperMissing,s="function",a=this.escapeExpression;return'<div class="op-seek-bar-time op-seek-bar-time-elapsed">\n    <span>'+a((r=null!=(r=t.startTime||(null!=e?e.startTime:e))?r:o,typeof r===s?r.call(e,{name:"startTime",hash:{},data:i}):r))+'</span>\n</div>\n<div class="bar-container">\n    <div class="bar-background"></div>\n    <div class="bar-seek"></div>\n</div>\n<div class="op-seek-bar-time op-seek-bar-time-remaining">\n    <span>'+a((r=null!=(r=t.endTime||(null!=e?e.endTime:e))?r:o,typeof r===s?r.call(e,{name:"endTime",hash:{},data:i}):r))+"</span>\n</div>"},useData:!0})},{"hbsfy/runtime":85}],44:[function(e,t,n){"use strict";var i=e("./seek-bar.hbs"),r=e("../../../../utils"),o=(e("moment"),function(e){return function(t){var n=null,o=null,s=null,a=1e3,l=null,u=null,d=null,c=function(){n=$("#"+e+"-"+t.instanceId),t.on(e+"-setCurrentChannel",function(e){d=e.currentProgram&&null!==e.currentProgram.diffusionDate&&null!==e.currentProgram.duration?{diffusionDate:e.currentProgram.diffusionDate,duration:e.currentProgram.duration}:null,m()}),t.on(e+"-setTimestamp",function(e){var t=e,n=Date.now();u=t-n,m()}),t.on(e+"-video-pause",function(){clearInterval(l)}),t.on(e+"-video-play",function(){null!==d&&f()})},h=function(e){var t=i(e);n.empty().append(t),g.init()},f=function(){clearInterval(l),l=setInterval(p,a)},p=function(){var e=Date.now()-d.diffusionDate,t=Math.min(100,100*e/d.duration);n.find(".bar-seek").css("width",t+"%")},m=function(){var e={startTime:"00:00",endTime:"00:00"};null!==u&&null!==d?(e.startTime=r.setTimeWithTimestamp(d.diffusionDate,0),e.endTime=r.setFinalTimeWithTimestampAndDuration(d.diffusionDate,d.duration,0,!0),f()):clearTimeout(l),h(e)},g={init:function(){t.on(e+"-video-ready",function(e){o=e.videonode,s=e.hasplayer,g.start()})},start:function(){s.on("timeupdate",function(){})}},y=function(){};return{init:c,destroy:y}}});t.exports=o},{"../../../../utils":71,"./seek-bar.hbs":43,moment:92}],45:[function(e,t,n){"use strict";var i=e("../../../common/modules/info-banner/info-banner"),r=function(e){return function(t){var n=new i(e),r=function(){t.on(e+"-setCurrentChannel",function(n){t.emit(e+"-updateInfoBannerData",o(n))}),t.sub.register(t.instanceId,n,t.options),t.sub.start(t.instanceId)},o=function(e){
var t,n=null;return e&&("undefined"==typeof e.zappingNumber&&"undefined"==typeof e.name&&"undefined"==typeof e.logos||(n={},n.channel={zappingNumber:e.zappingNumber||0,name:e.name||""},e.logos&&(e.logos instanceof Array?n.channel.logo=e.logos[0].url:n.channel.logo=e.logos.url,n.channel.logo=n.channel.logo||"")),e.currentProgram&&(n||(n={}),n.streamData={coverUrl:e.currentProgram.coverUrl||"",kind:e.currentProgram.kindDetailed||"",csa:e.currentProgram.csa||0,audioDescription:e.currentProgram.audioDescription||!1,hearingImpaired:e.currentProgram.hearingImpaired||!1,languageVersion:e.currentProgram.languageVersion||""},t=e.currentProgram.season,t&&t.serie&&e.currentProgram.title!==t.serie.title&&e.currentProgram.episodeNumber>0&&t.number>0?n.streamData.title=t.serie.title+" - S"+t.number+" Ep."+e.currentProgram.episodeNumber||"":n.streamData.title=e.currentProgram.title||"")),n},s=function(){};return{init:r,destroy:s}}};t.exports=r},{"../../../common/modules/info-banner/info-banner":17}],46:[function(e,t,n){"use strict";var i=e("../../../common/modules/main/main"),r=function(e,t,n){return function(r){var o=new i(e,t,n),s=null,a=function(){s=e,u.init(),d.init(),c.init(),r.sub.register(r.instanceId,o,r.options),r.sub.start(r.instanceId)},l={onChangeChannel:"onChangeChannel",onNextChannel:"onNextChannel",onPreviousChannel:"onPreviousChannel",onDisplayMosaic:"onDisplayMosaic",onSetBrowserFocus:"onSetBrowserFocus"},u={init:function(){r.on(t+"-keydown-left",function(){r.emit(t+"-previous-channel")}),r.on(t+"-keydown-right",function(){r.emit(t+"-next-channel")}),r.on(t+"-keydown-L",function(){r.emit(t+"-toggle-window","mosaic")})}},d={init:function(){n.EVENTS=l;var e=r.on(t+"-previous-channel",function(e){r.emit(t+"-close-window"),n.eventEmitter.emit(n.EVENTS.onPreviousChannel,e),r.emit(t+"-main-mouse-enter")}),i=r.on(t+"-next-channel",function(e){r.emit(t+"-close-window"),n.eventEmitter.emit(n.EVENTS.onNextChannel,e),r.emit(t+"-main-mouse-enter")});r.on(t+"-detach-previous-next-channel-handler",function(){e.detach(),i.detach()}),r.on(t+"-attach-previous-next-channel-handler",function(){e.detach(),i.detach(),e.attach(),i.attach()}),r.on(t+"-change-channel",function(e){r.emit(t+"-close-window"),n.eventEmitter.emit(n.EVENTS.onChangeChannel,{id:e})}),r.on(t+"-onPlayClick",function(e){n.eventEmitter.emit(n.EVENTS.onPlayClick,e)}),r.on(t+"-leave-player",function(e){n.eventEmitter.emit(n.EVENTS.onSetBrowserFocus,e)})}},c={init:function(){n.setChannelList=function(e){r.emit(t+"-setChannelList",e)},n.setCurrentChannel=function(e){r.emit(t+"-close-window"),r.emit(t+"-setCurrentChannel",e)}}},h=function(){};return{init:a,destroy:h}}};t.exports=r},{"../../../common/modules/main/main":21}],47:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=t.helperMissing,s="function",a=this.escapeExpression;return'<div class="op-menu-items">\n\t<a tabindex="0" class="op-menu-item op-menu-sumup stop-anchor" data-menu="sumup" role="button">\n\t    '+a((r=null!=(r=t.menuSummaryLabel||(null!=e?e.menuSummaryLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuSummaryLabel",hash:{},data:i}):r))+'\n\t</a>\n\t<a tabindex="0" class="op-menu-item op-menu-languages stop-anchor" data-menu="languages" role="button">\n\t    '+a((r=null!=(r=t.menuLanguageLabel||(null!=e?e.menuLanguageLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuLanguageLabel",hash:{},data:i}):r))+'\n\t</a>\n\t<a tabindex="0" class="op-menu-item op-menu-mosaic stop-anchor" data-menu="mosaic" role="button">\n\t    '+a((r=null!=(r=t.menuMosaicLabel||(null!=e?e.menuMosaicLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuMosaicLabel",hash:{},data:i}):r))+'\n\t</a>\n\t<a tabindex="0" class="op-menu-item op-menu-shortcuts stop-anchor" data-menu="shortcuts" role="button">\n\t    '+a((r=null!=(r=t.menuHelpLabel||(null!=e?e.menuHelpLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuHelpLabel",hash:{},data:i}):r))+"\n\t</a>\n</div>\n"},useData:!0})},{"hbsfy/runtime":85}],48:[function(e,t,n){"use strict";var i=e("../../../common/modules/menu/menu"),r=e("./menu.hbs"),o=function(e){var t=new i(e),n="menus";return function(i){var o=null,s=function(){o=$("#"+e+"-"+i.instanceId),i.sub.register(i.instanceId,t),a()},a=function(){var e=i.options.i18n[n],t=r(e);o.empty().append(t),i.sub.start(i.instanceId)},l=function(){};return{init:s,destroy:l}}};t.exports=o},{"../../../common/modules/menu/menu":23,"./menu.hbs":47}],49:[function(e,t,n){"use strict";var i=e("../../../common/modules/middle-container/middle-container"),r=e("../../../common/modules/middle-container/languages/languages"),o=e("./mosaic/mosaic"),s=e("./sumup/sumup"),a=e("./shortcuts/shortcuts"),l=function(e){var t=new i(e),n=new r(e),l=new o(e),u=new s(e),d=new a(e);return function(i){var r=null,o=function(o){r=$("#"+e+"-"+i.instanceId),i.sub.register(i.instanceId,t,i.options),i.sub.start(i.instanceId),i.sub.register("LanguagesModule",n,o),i.sub.register("MosaicModule",l,o),i.sub.register("SumupModule",u,o),i.sub.register("ShortcutsModule",d,o),s()},s=function(){r.append('<div class="op-screen op-mosaic op-hidden" id="'+e+'-MosaicModule"></div>'),i.sub.start("MosaicModule"),r.append('<div class="op-screen op-sumup op-hidden" id="'+e+'-SumupModule"></div>'),i.sub.start("LanguagesModule"),i.sub.start("SumupModule"),i.sub.start("ShortcutsModule")},a=function(){};return{init:o,destroy:a}}};t.exports=l},{"../../../common/modules/middle-container/languages/languages":27,"../../../common/modules/middle-container/middle-container":30,"./mosaic/mosaic":52,"./shortcuts/shortcuts":53,"./sumup/sumup":56}],50:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r;return this.escapeExpression((r=null!=(r=t.url||(null!=e?e.url:e))?r:t.helperMissing,"function"==typeof r?r.call(e,{name:"url",hash:{},data:i}):r))},3:function(e,t,n,i){var r;return"\n          "+(null!=(r=(t.programTime||e&&e.programTime||t.helperMissing).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.currentProgram:r)?r.diffusionDate:r,{name:"programTime",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+" "+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.currentProgram:r)?r.title:r,e))+"\n"},4:function(e,t,n,i){return""},6:function(e,t,n,i){var r;return"          "+this.escapeExpression(this.lambda(null!=(r=null!=e?e.i18n:e)?r.mosaicViewCurProgHasNoInformationLabel:r,e))+"\n        "},8:function(e,t,n,i){var r;return"\n          "+(null!=(r=(t.programTime||e&&e.programTime||t.helperMissing).call(e,null!=(r=null!=(r=null!=e?e.data:e)?r.nextProgram:r)?r.diffusionDate:r,{name:"programTime",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+" "+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.data:e)?r.nextProgram:r)?r.title:r,e))+"\n"},10:function(e,t,n,i){var r;return"          "+this.escapeExpression(this.lambda(null!=(r=null!=e?e.i18n:e)?r.mosaicViewNextProgHasNoInformationLabel:r,e))+"\n        "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=this.lambda,s=this.escapeExpression;return'<a href="#" class="op-program-button stop-anchor" role="button" data-channelid="'+s(o(null!=(r=null!=e?e.data:e)?r.id:r,e))+'">\n\t<div class="op-program">\n    <img src="'+(null!=(r=(t.channelLogo||e&&e.channelLogo||t.helperMissing).call(e,null!=(r=null!=e?e.data:e)?r.logos:r,{name:"channelLogo",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'" alt="'+s(o(null!=(r=null!=e?e.data:e)?r.name:r,e))+'"/>\n\t\t<div class="op-program-details">\n\t\t\t<div class="op-current-program-title">'+(null!=(r=t["if"].call(e,null!=(r=null!=e?e.data:e)?r.currentProgram:r,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.program(6,i,0),data:i}))?r:"")+'</div>\n\t\t\t<div class="op-next-program-title">'+(null!=(r=t["if"].call(e,null!=(r=null!=e?e.data:e)?r.nextProgram:r,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.program(10,i,0),data:i}))?r:"")+"</div>\n\t\t</div>\n\t</div>\n</a>\n"},useData:!0})},{"hbsfy/runtime":85}],51:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="op-mosaic-nav">\n\t<div class="op-mosaic-container">\n\t</div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":85}],52:[function(e,t,n){"use strict";var i=e("./mosaic.hbs"),r=e("./mosaic-item.hbs"),o=function(e){var t="mosaic",n=null,o="mosaicView";return function(s){var a=null,l=function(t){a=$("#"+e+"-"+s.instanceId),s.on(e+"-setChannelList",function(e){p.setChannelsList(e),n=s.options.i18n[o],u()}),s.on(e+"-setCurrentChannel",function(e){p.setChannelData(e)})},u=function(){var e=p.getChannelsList(),t=null;t=i(),a.empty().append(t),d(e),f.init()},d=function(e){var t=a.find(".op-mosaic-container"),i=0;for(t.innerHTML="",i=0;i<e.length;i++)t.append(r({data:e[i],i18n:n}))},c=function(){a.removeClass("op-hidden"),s.emit(e+"-change-osd-timeout",6e4),setTimeout(function(){a.find('a[data-channelid="'+p.getChannelData().id+'"]').focus()},0)},h=function(){a.addClass("op-hidden"),s.emit(e+"-change-osd-timeout")},f={init:function(){s.on(e+"-open-window",function(e){e===t?c():h()}),s.on(e+"-close-window",h),a.find(".op-program-button").on("click",function(t){s.emit(e+"-change-channel",t.currentTarget.dataset.channelid),t.preventDefault()}),a.find(".op-mosaic-container").on("scroll",function(){s.emit(e+"-main-mouse-move")})}},p=function(){var e=null,t=null;return{getChannelsList:function(){return e},setChannelsList:function(t){e=t},getChannelData:function(){return t},setChannelData:function(e){t=e}}}(),m=function(){};return{init:l,destroy:m}}};t.exports=o},{"./mosaic-item.hbs":50,"./mosaic.hbs":51}],53:[function(e,t,n){"use strict";var i=e("../../../../common/modules/middle-container/shortcuts/shortcuts.hbs"),r=function(e){var t="shortcuts",n="helpView",r=null;return function(o){var s=null,a=function(){s=$("#"+e+"-"+o.instanceId),l()},l=function(){var e=null;r=o.options.i18n[n],e=i({i18n:r,items:h.getShortcuts()}),s.empty().append(e),c.init()},u=function(){s.removeClass("op-hidden")},d=function(){s.addClass("op-hidden")},c={init:function(){o.on(e+"-open-window",function(e){e===t?u():d()}),o.on(e+"-close-window",d)}},h={init:function(){},getShortcuts:function(){var e=[{keys:["esc","echap"],fct:r.helpViewFullscreenTitleLabel,detail:r.helpViewFullscreenDescriptionLabel},{keys:["enter"],fct:r.helpViewInfoPrgSummaryTitleLabel,detail:r.helpViewInfoPrgSummaryDescriptionLabel},{keys:["espace"],fct:r.helpViewKeySpaceTitleLabel,detail:r.helpViewKeySpaceDescriptionLabel},{keys:["aide-fleche-g","aide-fleche-d"],fct:r.helpViewNavigationChannelTitleLabel,detail:r.helpViewNavigationChannelDescriptionLabel},{keys:["aide-fleche-h","aide-fleche-b"],fct:r.helpViewVolumeTitleLabel,detail:r.helpViewVolumeDescriptionLabel},{keys:["aide-r"],fct:r.helpViewSummaryTitleLabel,detail:r.helpViewSummaryDescriptionLabel},{keys:["aide-tab","aide-tab-2"],fct:r.helpViewKeyNavigationTitleLabel,detail:r.helpViewKeyNavigationDescriptionLabel}];return e}},f=function(){};return{init:a,destroy:f}}};t.exports=r},{"../../../../common/modules/middle-container/shortcuts/shortcuts.hbs":33}],54:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r;return'    <img class="op-sumup-logo large" src="'+this.escapeExpression((r=null!=(r=t.url||(null!=e?e.url:e))?r:t.helperMissing,"function"==typeof r?r.call(e,{name:"url",hash:{},data:i}):r))+'"/>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r;return'<div class="op-sumup-details">\n\t<div class="op-sumup-info">\n'+(null!=(r=(t.channelLogo||e&&e.channelLogo||t.helperMissing).call(e,null!=(r=null!=e?e.channelData:e)?r.logos:r,{name:"channelLogo",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'\t</div>\n\t<div class="op-sumup-description">'+this.escapeExpression(this.lambda(null!=(r=null!=e?e.labels:e)?r.summaryViewHasNoInformationLabel:r,e))+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":85}],55:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({1:function(e,t,n,i){var r;return'        <img class="op-sumup-img" src="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.channelData:e)?r.currentProgram:r)?r.coverUrl:r,e))+'" alt=""/>\n'},3:function(e,t,n,i){var r;return'        <img class="op-sumup-logo op-hidden" src="'+this.escapeExpression((r=null!=(r=t.url||(null!=e?e.url:e))?r:t.helperMissing,"function"==typeof r?r.call(e,{name:"url",hash:{},data:i}):r))+'"/>\n'},5:function(e,t,n,i){return""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o,s=t.helperMissing,a="function",l=this.escapeExpression,u=this.lambda;return'<div class="op-sumup-details">\n\t<div class="op-sumup-info">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.channelData:e)?r.currentProgram:r)?r.coverUrl:r,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=(t.channelLogo||e&&e.channelLogo||s).call(e,null!=(r=null!=e?e.channelData:e)?r.logos:r,{name:"channelLogo",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?r:"")+'\t\t<div class="op-sumup-video">\n\t\t\t<div class="op-sumup-title">'+l((o=null!=(o=t._computedTitle||(null!=e?e._computedTitle:e))?o:s,typeof o===a?o.call(e,{name:"_computedTitle",hash:{},data:i}):o))+'\n\t\t\t\t<div class="op-sumup-csa">\n                    <div class="op-sumup-csa-symbol op-sumup-csa-10">\n                        <!-- inject:csa10:svg -->\n                        <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M15.96 4.54c-5.88 0-10.722 4.428-11.382 10.13h4.044v2.736h-4.032c0.694 5.666 5.518 10.054 11.372 10.054 6.33 0 11.46-5.13 11.46-11.46s-5.13-11.46-11.462-11.46zM13.528 23.084h-2.71v-11.768h-1.346v-2.334h4.054v14.102zM19.442 23.26c-2.434 0-3.836-2.452-3.836-7.216 0-4.788 1.382-7.238 3.836-7.238 2.452 0 3.836 2.452 3.836 7.238 0 4.764-1.404 7.216-3.836 7.216zM19.444 10.778c-1.090 0-1.314 1.732-1.314 5.29 0 3.51 0.224 5.22 1.314 5.22 1.088 0 1.288-1.732 1.288-5.22-0.002-3.558-0.2-5.29-1.288-5.29z"></path></svg>\n                        <!-- endinject -->\n                    </div>\n                    <div class="op-sumup-csa-symbol op-sumup-csa-12">\n                        <!-- inject:csa12:svg -->\n                        <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M15.962 4.528c-5.886 0-10.734 4.434-11.394 10.142h4.038v2.748h-4.026c0.7 5.668 5.524 10.054 11.382 10.054 6.332 0 11.468-5.136 11.468-11.474 0.002-6.334-5.136-11.47-11.468-11.47zM13.536 23.098h-2.71v-11.778h-1.346v-2.336h4.056v14.114zM22.682 20.66v2.438h-6.97l3.464-6.754c0.93-1.798 1.324-3.204 1.324-4.016 0-0.89-0.376-1.384-1.028-1.384-1.048 0-1.246 0.83-1.246 2.85h-2.294c-0.020-0.2-0.020-0.394-0.020-0.574 0-2.908 1.304-4.412 3.718-4.412 2.078 0 3.406 1.326 3.406 3.482 0 1.86-0.968 3.78-2.316 6.196l-1.206 2.174h3.168z"></path></svg>\n                        <!-- endinject -->\n                    </div>\n                    <div class="op-sumup-csa-symbol op-sumup-csa-16">\n                        <!-- inject:csa16:svg -->\n                        <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.554 16.066c-0.88 0-1.244 0.882-1.244 2.714 0 1.54 0.384 2.308 1.152 2.308 0.816 0 1.246-0.836 1.246-2.488 0-1.694-0.338-2.534-1.154-2.534zM15.96 4.562c-5.874 0-10.708 4.43-11.358 10.128h4.026v2.708h-4.014c0.69 5.656 5.504 10.040 11.348 10.040 6.314 0 11.436-5.122 11.436-11.438s-5.122-11.438-11.438-11.438zM13.532 23.058h-2.704v-11.742h-1.344v-2.328h4.046v14.070zM19.488 23.254c-2.486 0-3.884-1.734-3.884-4.89 0-2.41 0.964-4.282 1.972-6.376l1.442-3h2.702l-2.25 4.422c-0.258 0.512-0.514 0.964-0.752 1.3 0.614-0.432 1.186-0.67 1.758-0.67 1.716 0 2.822 1.442 2.822 4.046 0 3.278-1.422 5.168-3.81 5.168z"></path></svg>\n                        <!-- endinject -->\n                    </div>\n                    <div class="op-sumup-csa-symbol op-sumup-csa-18">\n                        <!-- inject:csa18:svg -->\n                        <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.462 16.47c-0.884 0-1.318 0.75-1.318 2.226 0 1.592 0.408 2.364 1.318 2.364s1.318-0.75 1.318-2.294c0.002-1.522-0.406-2.296-1.318-2.296zM19.462 14.272c0.794 0 1.092-0.568 1.092-1.772 0-1.206-0.342-1.774-1.114-1.774-0.75 0-1.070 0.544-1.070 1.658 0.002 1.298 0.274 1.888 1.092 1.888zM15.96 4.54c-5.88 0-10.724 4.428-11.382 10.13h4.042v2.736h-4.030c0.692 5.666 5.518 10.054 11.372 10.054 6.33 0 11.46-5.132 11.46-11.46 0-6.33-5.13-11.46-11.462-11.46zM13.534 23.068h-2.716v-11.796h-1.35v-2.342h4.066v14.138zM19.462 23.248c-2.378 0-3.788-1.566-3.788-4.144 0-2.042 0.792-3.332 2.182-3.708v-0.12c-1.13-0.278-1.784-1.31-1.784-2.994 0-2.282 1.23-3.532 3.39-3.532 2.162 0 3.39 1.25 3.39 3.532 0 1.666-0.654 2.716-1.784 2.994v0.12c1.386 0.376 2.182 1.686 2.182 3.708 0.002 2.578-1.406 4.144-3.788 4.144z"></path></svg>\n                        <!-- endinject -->\n                    </div>\n                </div>\n\t\t\t</div>\n      <div class="op-sumup-seasontitle">'+l(u(null!=(r=null!=(r=null!=e?e.season:e)?r.serie:r)?r.title:r,e))+'</div>\n\t\t\t<div class="op-sumup-subinfos">\n\t\t\t\t<div class="op-sumup-genre">'+l((o=null!=(o=t.kindDetailed||(null!=e?e.kindDetailed:e))?o:s,typeof o===a?o.call(e,{name:"kindDetailed",hash:{},data:i}):o))+'</div>\n\t\t\t\t<div class="op-sumup-audio-infos">\n\t\t\t\t\t<div class="op-sumup-audiodesc">\n\t\t\t\t\t\t<!-- inject:AD:svg -->\n\t\t\t\t\t\t<svg version="1.1" focusable="false" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="-404 282.3 32 32" enable-background="new -404 282.3 32 32" xml:space="preserve"><g>\t<text transform="matrix(0.991 0 0 1 -397.4046 300.6718)" fill="#444444" font-family="\'HelveticaNeue-Bold\'" font-size="12.9418">AD</text>\t<path fill-rule="evenodd" clip-rule="evenodd" fill="none" stroke="#444444" stroke-width="2" stroke-miterlimit="10" d="\t\tM-397.7,288.5h19.5c1.4,0,2.3,1,2.3,2.5v10.5c0,1.2-0.9,2.5-2.3,2.5h-2.3l2.5,4.9l-7.7-4.9h-12c-1.4,0-2.5-1.1-2.5-2.5V291\t\tC-400.2,289.6-399,288.5-397.7,288.5z"/></g></svg>\n\t\t\t\t\t\t<!-- endinject -->\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="op-sumup-hearingImpaired">\n\t                    <!-- inject:oreille:svg -->\n\t                    <svg version="1.1" focusable="false" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><path fill="#000000" d="M19.19 18.37c0.828-0.988 1.28-2.246 1.268-3.54-0.018-1.434-0.584-2.778-1.602-3.78-1.010-1.002-2.354-1.548-3.774-1.53-2.14 0.022-4.050 1.33-4.864 3.332l1.032 0.428c0.644-1.582 2.152-2.614 3.844-2.632 1.122-0.016 2.178 0.416 2.984 1.21 0.8 0.792 1.25 1.852 1.262 2.984 0.012 1.022-0.344 2.018-1.004 2.796l0.854 0.732zM15.102 7.168c-3.856 0.042-7.114 2.984-7.584 6.842l1.11 0.138c0.4-3.3 3.188-5.818 6.486-5.852 1.762-0.018 3.432 0.658 4.694 1.904 1.256 1.248 1.962 2.914 1.98 4.7 0.024 2.046-0.866 3.952-2.438 5.242-0.052 0.044-0.098 0.082-0.098 0.082-1.602 1.298-2.88 2.982-3.706 4.872l-0.022 0.050c-0.464 1.006-1.462 1.662-2.562 1.674-0.714 0.008-1.4-0.252-1.934-0.73l-0.742 0.846c0.742 0.662 1.696 1.022 2.688 1.014 1.556-0.016 2.97-0.96 3.598-2.4l0.058-0.126c0.736-1.626 1.838-3.082 3.212-4.232 0.058-0.038 0.112-0.076 0.112-0.076 1.904-1.512 2.978-3.784 2.956-6.228-0.024-2.082-0.848-4.032-2.324-5.488-1.472-1.466-3.424-2.256-5.484-2.232zM26.496 2.126l-5.69 5.746c1.308 1.15 2.362 2.588 2.81 4.336l6.32-6.388v-3.694h-3.44zM8.868 19.932l-6.728 6.796v3.042h4.086l7.162-7.23-4.52-2.608z"></path></svg>\n\t                    <!-- endinject -->\n\t                </div>\n\t\t\t\t\t<div class="op-sumup-language-vm op-lg-vm"></div>\n\t\t\t\t\t<div class="op-sumup-language-vost op-lg-vost"></div>\n\t\t\t\t\t<div class="op-sumup-language-vo op-lg-vo"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>'+l(u(null!=(r=null!=e?e.labels:e)?r.summaryViewDurationLabel:r,e))+(null!=(r=(t.millisecondsToHours||e&&e.millisecondsToHours||s).call(e,null!=e?e.duration:e,{name:"millisecondsToHours",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?r:"")+'</div>\n\t\t</div>\n\t</div>\n\t<div class="op-sumup-description">'+l((o=null!=(o=t.longSummary||(null!=e?e.longSummary:e))?o:s,typeof o===a?o.call(e,{name:"longSummary",hash:{},data:i}):o))+"</div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":85}],56:[function(e,t,n){"use strict";var i=e("../../../../common/modules/middle-container/sumup/sumup"),r=e("./sumup.hbs"),o=e("./sumup-unavailable.hbs"),s=e("../../../../utils"),a=function(e){var t=new i(e),n="summaryView",a="sumup";return function(i){var l=null,u=function(){i.sub.register(i.instanceId,t,i.options),i.sub.start(i.instanceId),l=$("#"+e+"-"+i.instanceId),i.on(e+"-setDetailedProgram",function(e){p.setSumup(e)}),i.on(e+"-setCurrentChannel",function(e){p.setChannelData(e)}),f.init()},d=function(){var e=p.getSumup()||{},t=null,a=null,u=null,d=null,h=null,f=null,m="",g=null,y=i.options.i18n[n],v=!(e.longSummary||e.synopsis);if(e.labels=y,e.channelData=p.getChannelData(),e.season&&e.season.serie&&e.title!==e.season.serie.title&&e.episodeNumber>0&&e.season.number>0?e._computedTitle="S"+e.season.number+" Ep."+e.episodeNumber+" : "+e.title:e._computedTitle=e.title,t=v?o(e):r(e),l.empty().append(t),s.handleEmptyableImg(l.find(".op-sumup-img"),e.channelData&&e.channelData.currentProgram&&e.channelData.currentProgram.coverUrl),e.covers&&e.covers.length||!e.channelData||!e.channelData.logos||l.find(".op-sumup-logo").removeClass("op-hidden").addClass("large"),!v){switch(g=e.csa,e.csa){case 2:g="10";break;case 3:g="12";break;case 4:g="16";break;case 5:g="18"}l.find(".op-sumup-csa-symbol").hide(),""!==g&&l.find(".op-sumup-csa-"+g).show(),a=l.find(".op-sumup-audiodesc"),a.toggle(e.audioDescription),u=l.find(".op-sumup-hearingImpaired"),u.toggle(e.hearingImpaired),h=l.find(".op-sumup-language-vm"),d=l.find(".op-sumup-language-vost"),f=l.find(".op-sumup-language-vo"),h.hide(),d.hide(),f.hide(),m=e.languageVersion.toLowerCase(),"vm"===m?h.show():"vost"===m?d.show():"vo"===m&&f.show()}c()},c=function(){l.removeClass("op-hidden")},h=function(){l.addClass("op-hidden")},f={init:function(){i.on(e+"-open-window",function(e){e===a?d():h()}),i.on(e+"-close-window",h)}},p=function(){var e=null,t=null;return{getSumup:function(){return e},setSumup:function(t){e=t},getChannelData:function(){return t},setChannelData:function(e){t=e}}}(),m=function(){};return{init:u,destroy:m}}};t.exports=a},{"../../../../common/modules/middle-container/sumup/sumup":34,"../../../../utils":71,"./sumup-unavailable.hbs":54,"./sumup.hbs":55}],57:[function(e,t,n){var i=e("hbsfy/runtime");t.exports=i.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,o=t.helperMissing,s="function",a=this.escapeExpression;return'<div class="op-settings-menu-items">\n\t<a tabindex="0" class="op-settings-menu-item op-settings-menu-format stop-anchor selected" data-settings="format" role="button">\n\t\t'+a((r=null!=(r=t.menuDisplayLabel||(null!=e?e.menuDisplayLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuDisplayLabel",hash:{},data:i}):r))+'\n\t</a>\n\t<a tabindex="0" class="op-settings-menu-item op-settings-menu-quality stop-anchor" data-settings="quality" role="button">\n\t\t'+a((r=null!=(r=t.menuVideoQualityLabel||(null!=e?e.menuVideoQualityLabel:e))?r:o,typeof r===s?r.call(e,{name:"menuVideoQualityLabel",hash:{},data:i}):r))+"\n\t</a>\n</div>\n"},useData:!0})},{"hbsfy/runtime":85}],58:[function(e,t,n){"use strict";var i=e("../../../common/modules/settings-menu/settings-menu"),r=e("./settings-menu.hbs"),o=function(e){var t=new i(e),n="menus";return function(i){var o=null,s=function(){o=$("#"+e+"-"+i.instanceId),i.sub.register(i.instanceId,t),a()},a=function(){var e=i.options.i18n[n],t=r(e);o.empty().append(t),i.sub.start(i.instanceId)},l=function(){};return{init:s,destroy:l}}};t.exports=o},{"../../../common/modules/settings-menu/settings-menu":35,"./settings-menu.hbs":57}],59:[function(e,t,n){"use strict";var i=e("../../../common/modules/video/video"),r=function(e){return function(t){var n=null,r=null,o={},s=function(){n=new i(e,o),t.sub.register(t.instanceId,n,t.options),t.sub.start(t.instanceId),r=$("#"+e+"-"+t.instanceId),a(),o.hasplayer.setParams({"Protection.licensePersistence":!0})},a=function(){t.on(e+"-start-load-sequence",function(){t.emit(e+"-end-load-sequence")}),t.on(e+"-play-pause",function(){this.playerConfig.isFeatureEnabled("play-pause")&&(o.isPlaying?o.hasplayer.stop():t.emit(e+"-onPlayClick"))})},l=function(){};return{init:s,destroy:l}}};t.exports=r},{"../../../common/modules/video/video":39}],60:[function(e,t,n){"use strict";var i=function(e){function t(e,t){function n(){return e.apply(this,t)}return n.prototype=e.prototype,new n}function n(e){for(var t,n=e-1;n>0&&!(t=r.loaded[n]&&r.loaded[n].domNode);)n--;return t}function i(n){r.started.indexOf(n)===-1&&(e.core.register(n.name,t(n.constructor,n.args),n.options),e.core.start(n.name),r.started.push(n))}var r={loaded:[],started:[]};this.load=function(t){var o,s,a=0;if(t.constructor&&t.name){for(t.args=t.args||[],t.options=t.options||{},t.priority=t.priority||0,t.container=t.container||e.container,t.template&&(t.domNode=$(t.template));a<=r.loaded.length;){if(o=r.loaded[a],s=n(a),!o){t.domNode&&t.container.append(t.domNode),r.loaded.push(t);break}if(t.priority<o.priority){t.domNode&&(s?s.after(t.domNode):t.container.prepend(t.domNode)),r.loaded.splice(a,0,t);break}a++}t.startOnLoad&&i(t)}},this.start=function(){r.loaded.forEach(i)}};t.exports=i},{}],61:[function(e,t,n){!function(t,n,i){"use strict";var r=e("sizzle"),o={},s=function(e,t,n,s,a){if(e=l(e),""!=e){var u;s||a||(u=/^([0-9]*.?[0-9]+)(px|em)$/.exec(n),null!=u&&(s=Number(u[1]),s+""!="NaN"&&(a=u[2]))),a&&(r.compile&&r.compile(e),o[e]===i&&(o[e]={}),o[e][t]===i&&(o[e][t]={}),o[e][t][n]=[s,a])}},a=function(e,t){var n,i,r;for(n in e)for(i in e[n])if("string"==typeof e[n][i])s(n,i,e[n][i]);else if("object"==typeof e[n][i])for(r=0;r<e[n][i].length;r++)s(n,i,e[n][i][r]);1==t&&h()},l=function(e){if(null==e)return"";var t="".trim;return t&&!t.call("\ufeff ")?t.call(e):(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},u=function(e,t){var n=e.getAttribute(t);return n?(" "+n+" ").replace(/[\t\r\n]/g," "):" "},d=function(e,t,n){if(1===e.nodeType){var i=l(n);if(""!=i){var r=u(e,t);r.indexOf(" "+i+" ")<0&&e.setAttribute(t,l(r+i))}}},c=function(e,t,n){if(1===e.nodeType){var i=l(n);if(""!=i){for(var r=u(e,t),o=!1;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," "),o=!0;o&&e.setAttribute(t,l(r))}}},h=function(){var e,i,s,a,l,u,h;for(e in o)if(l=r(e),l.length>0)for(i=0;i<l.length;i++){u=l[i];for(s in o[e])for(a in o[e][s])h=o[e][s][a][0],"em"==o[e][s][a][1]&&(h*=t.getEmPixels?getEmPixels(u):16),"min-width"==s&&u.offsetWidth>=h||"max-width"==s&&u.offsetWidth<=h||"min-height"==s&&u.offsetHeight>=h||"max-height"==s&&u.offsetHeight<=h?d(u,s,a):c(u,s,a)}if(!t.addEventListener&&t.attachEvent){var f=n.documentElement.className;n.documentElement.className=" "+f,n.documentElement.className=f}},f=function(e,t){!e||"object"!=typeof e||e.cssRules||e.rules?e||t||h():a(e,t)};t.elementQuery=f,t.elementQuery.selectors=function(){},addEventListener?(addEventListener("resize",h,!1),addEventListener("DOMContentLoaded",h,!1),addEventListener("load",h,!1)):attachEvent&&(attachEvent("onresize",h),attachEvent("onload",h))}(this,document,void 0),function(e,t){"use strict";var n="!important;",i="position:absolute"+n+"visibility:hidden"+n+"width:1em"+n+"font-size:1em"+n+"padding:0"+n;window.getEmPixels=function(r){var o;r||(r=o=e.createElement("body"),o.style.cssText="font-size:1em"+n,t.insertBefore(o,e.body));var s=e.createElement("i");s.style.cssText=i,r.appendChild(s);var a=s.clientWidth;return o?t.removeChild(o):r.removeChild(s),a}}(document,document.documentElement)},{sizzle:101}],62:[function(e,t,n){"use strict";var i=e("handlebars/runtime")["default"],r=function(){var t,n;return i.registerHelper("if_eq",function(e,t){return e===t.hash.compare?t.fn(this):t.inverse(this)}),i.registerHelper("unless_eq",function(e,t){return e===t.hash.compare?t.inverse(this):t.fn(this)}),i.registerHelper("i18nHelper",function(e){return n[t]&&n[t][e]||e}),i.registerHelper("svgHelper",function(t){var n=e("../../common/modules/commun/svgHelper/svgHelper.hbs"),i=n(),r=i.split("</div>").filter(function(e,n,i){return e.indexOf(t)!==-1});return r&&r[0]?r[0]+"</div>":t}),i.registerHelper("channelLogo",function(e,t){var n="";if(e)for(var i=0,r=e.length;i<r;i++)"DEFAULT"===e[i].format&&(n+=t.fn(e[i]));return n}),i.registerHelper("programCover",function(e,t){var n="";if(e)for(var i=0,r=e.length;i<r;i++)"RATIO_4_3"===e[i].format&&(n+=t.fn(e[i]));return n}),i.registerHelper("minutesToHours",function(e,t){var n=Math.floor(e/60),i=e%60;return i<10&&(i="0"+i),n+"h"+i}),i.registerHelper("secondsToHours",function(e,t){var n=Math.floor(e/60),i=Math.floor(n/60),r=n%60;return r<10&&(r="0"+r),i+"h"+r}),i.registerHelper("millisecondsToHours",function(e,t){var n=Math.floor(e/6e4),i=Math.floor(n/60),r=n%60;r<10&&(r="0"+r);var o=i?i+"h"+r:r+" min";return o}),i.registerHelper("programTime",function(e,t){var n=new Date(e);return n.getHours()+"h"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())}),{setI18Nresource:function(e,i){t=e,n=i}}}();t.exports=r},{"../../common/modules/commun/svgHelper/svgHelper.hbs":10,"handlebars/runtime":84}],63:[function(t,n,r){(function(t){!function(t,i){"function"==typeof e&&e.amd?e([],function(){return t.MediaPlayer=i()}):"object"==typeof r?n.exports=i():t.MediaPlayer=i()}(this,function(){function e(e){var t;for(t=[],i=0,len=e.length;i<len;i+=1)e[i].isRoot?t.push("root"):t.push(e[i].name);var n=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},r=function(e,t,i){var r,o,s,a,l;if(null!==e&&0!==e.length)for(r=0,o=e.length;r<o;r+=1)s=e[r],t.hasOwnProperty(s.name)&&(i.hasOwnProperty(s.name)?s.merge&&(a=t[s.name],l=i[s.name],"object"==typeof a&&"object"==typeof l?n(a,l):null!=s.mergeFunction?i[s.name]=s.mergeFunction(a,l):i[s.name]=a+l):i[s.name]=t[s.name])},o=function(e,t){var n,i,s,a,l,u,d,c=e;if(null!==c.children&&0!==c.children.length)for(n=0,i=c.children.length;n<i;n+=1)if(u=c.children[n],t.hasOwnProperty(u.name))if(u.isArray)for(l=t[u.name+"_asArray"],s=0,a=l.length;s<a;s+=1)d=l[s],r(c.properties,t,d),o(u,d);else d=t[u.name],r(c.properties,t,d),o(u,d)},s=function(n){var i,r,a,l,u,d,c;if(null===n)return n;if("object"!=typeof n)return n;for(i=0,r=t.length;i<r;i+=1)"root"===t[i]&&(u=e[i],d=n,o(u,d));for(l in n)if(n.hasOwnProperty(l)){if(a=t.indexOf(l),a!==-1)if(u=e[a],u.isArray)for(c=n[l+"_asArray"],i=0,r=c.length;i<r;i+=1)d=c[i],o(u,d);else d=n[l],o(u,d);s(n[l])}return n};return{run:s}}function r(e,t,n){function i(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return e.prefix}function o(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function s(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function a(o){if(o.nodeType==b.DOCUMENT_NODE){var l,u,d,c=o.firstChild;for(u=0,d=o.childNodes.length;u<d;u+=1)if(o.childNodes[u].nodeType!==b.COMMENT_NODE){c=o.childNodes[u];break}if(n)l=a(c);else{l={};var h=i(c);l[h]=a(c)}return l}if(o.nodeType==b.ELEMENT_NODE){var l=new Object;
l.__cnt=0;for(var f=o.childNodes,p=0;p<f.length;p++){var c=f.item(p),h=i(c);if(l.__cnt++,null==l[h])l[h]=a(c),l[h+"_asArray"]=new Array(1),l[h+"_asArray"][0]=l[h];else{if(null!=l[h]&&!(l[h]instanceof Array)){var m=l[h];l[h]=new Array,l[h][0]=m,l[h+"_asArray"]=l[h]}for(var g=0;null!=l[h][g];)g++;l[h][g]=a(c)}}for(var y=0;y<o.attributes.length;y++){var v=o.attributes.item(y);l.__cnt++;for(var E=v.value,x=0,S=e.length;x<S;x++){var T=e[x];T.test.call(this,v.value)&&(E=T.converter.call(this,v.value))}l[t+v.name]=E}var w=r(o);return null!=w&&""!=w&&(l.__cnt++,l.__prefix=w),1==l.__cnt&&null!=l["#text"]&&(l=l["#text"]),null!=l["#text"]&&(l.__text=l["#text"],_&&(l.__text=s(l.__text)),delete l["#text"],delete l["#text_asArray"]),null!=l["#cdata-section"]&&(l.__cdata=l["#cdata-section"],delete l["#cdata-section"],delete l["#cdata-section_asArray"]),null==l.__text&&null==l.__cdata||(l.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),l}return o.nodeType==b.TEXT_NODE||o.nodeType==b.CDATA_SECTION_NODE?o.nodeValue:o.nodeType==b.COMMENT_NODE?null:void 0}function l(e,t,n,i){var r="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=n)for(var o=0;o<n.length;o++){var s=n[o],a=e[s];r+=" "+s.substr(1)+"='"+a+"'"}return r+=i?"/>":">"}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function d(e,t){return e.indexOf(t,e.length-t.length)!==-1}function c(e,t){return!!(d(t.toString(),"_asArray")||0==t.toString().indexOf("_")||e[t]instanceof Function)}function h(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function f(e){var t=[];if(e instanceof Object)for(var n in e)n.toString().indexOf("__")==-1&&0==n.toString().indexOf("_")&&t.push(n);return t}function p(e){var t="";return null!=e.__cdata&&(t+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(t+=_?o(e.__text):e.__text),t}function m(e){var t="";return e instanceof Object?t+=p(e):null!=e&&(t+=_?o(e):e),t}function g(e,t,n){var i="";if(0==e.length)i+=l(e,t,n,!0);else for(var r=0;r<e.length;r++)i+=l(e[r],t,f(e[r]),!1),i+=y(e[r]),i+=u(e[r],t);return i}function y(e){var t="",n=h(e);if(n>0)for(var i in e)if(!c(e,i)){var r=e[i],o=f(r);if(null==r||void 0==r)t+=l(r,i,o,!0);else if(r instanceof Object)if(r instanceof Array)t+=g(r,i,o);else{var s=h(r);s>0||null!=r.__text||null!=r.__cdata?(t+=l(r,i,o,!1),t+=y(r),t+=u(r,i)):t+=l(r,i,o,!0)}else t+=l(r,i,o,!1),t+=m(r),t+=u(r,i)}return t+=m(e)}null!==t&&void 0!==t||(t="_"),null!==n&&void 0!==n||(n=!1);var v="1.0.11",_=!1,b={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t;if(window.DOMParser)try{var n=new window.DOMParser;if(t=n.parseFromString(e,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(i){return null}return t},this.xml2json=function(e){return a(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null===t?t:this.xml2json(t)},this.json2xml_str=function(e){return y(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return v},this.escapeMode=function(e){_=e}}function o(){"use strict";var e,t,n;try{e=navigator.userAgent.toLowerCase(),/msie (\d+\.\d+);/.test(e)?(n=Number(RegExp.$1),e.indexOf("trident/6")>-1&&(n=10),e.indexOf("trident/5")>-1&&(n=9),e.indexOf("trident/4")>-1&&(n=8),t="Internet Explorer"):e.indexOf("trident/7")>-1?(n=11,t="Internet Explorer"):/edge[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Edge"):/firefox[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Firefox"):/opera[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Opera"):/chrome[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Chrome"):/version[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Safari"):/rv[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/mozilla[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/binget[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (BinGet)"):/curl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (cURL)"):/java[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Java)"):/libwww-perl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (libwww-perl)"):/microsoft url control -[\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Microsoft URL Control)"):/peach[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Peach)"):/php[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PHP)"):/pxyscand[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (pxyscand)"):/pycurl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PycURL)"):/python-urllib[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Python URLlib)"):/appengine-google/.test(e)?(n=Number(RegExp.$1),t="Cloud (Google AppEngine)"):/trident/.test(e)?(n=Number(RegExp.$1),t="Trident"):/adventurer/.test(e)?(n=Number(RegExp.$1),t="Adventurer"):(n="unknown",t="unknown")}catch(i){t="error",n="error"}return{name:t.replace(/\s+/g,""),version:n}}function l(){"use strict";var e,t,n,i;try{e=navigator.userAgent.toLowerCase(),n=e.indexOf("windows nt 10.0")!==-1?"Windows 10":e.indexOf("windows nt 6.3")!==-1?"Windows 8.1":e.indexOf("windows nt 6.2")!==-1?"Windows 8":e.indexOf("windows nt 6.1")!==-1?"Windows 7":e.indexOf("windows nt 6.0")!==-1?"Windows Vista/Windows Server 2008":e.indexOf("windows nt 5.2")!==-1?"Windows XP x64/Windows Server 2003":e.indexOf("windows nt 5.1")!==-1?"Windows XP":e.indexOf("windows nt 5.01")!==-1?"Windows 2000, Service Pack 1 (SP1)":e.indexOf("windows xp")!==-1?"Windows XP":e.indexOf("windows 2000")!==-1?"Windows 2000":e.indexOf("windows nt 5.0")!==-1?"Windows 2000":e.indexOf("windows nt 4.0")!==-1?"Windows NT 4.0":e.indexOf("windows nt")!==-1?"Windows NT 4.0":e.indexOf("winnt4.0")!==-1?"Windows NT 4.0":e.indexOf("winnt")!==-1?"Windows NT 4.0":e.indexOf("windows me")!==-1?"Windows ME":e.indexOf("win 9x 4.90")!==-1?"Windows ME":e.indexOf("windows 98")!==-1?"Windows 98":e.indexOf("win98")!==-1?"Windows 98":e.indexOf("windows 95")!==-1?"Windows 95":e.indexOf("windows_95")!==-1?"Windows 95":e.indexOf("win95")!==-1?"Windows 95":e.indexOf("ce")!==-1?"Windows CE":e.indexOf("win16")!==-1?"Windows 3.11":e.indexOf("iemobile")!==-1?"Windows Mobile":e.indexOf("wm5 pie")!==-1?"Windows Mobile":e.indexOf("windows phone 10.0")!==-1?"Windows Phone 10":e.indexOf("windows")!==-1?"Windows (Unknown Version)":e.indexOf("openbsd")!==-1?"Open BSD":e.indexOf("sunos")!==-1?"Sun OS":e.indexOf("ubuntu")!==-1?"Ubuntu":e.indexOf("ipad")!==-1?"iOS (iPad)":e.indexOf("ipod")!==-1?"iOS (iTouch)":e.indexOf("iphone")!==-1?"iOS (iPhone)":e.indexOf("mac os x beta")!==-1?"Mac O SX Beta":e.indexOf("mac os x 10")!==-1?/mac os x 10_(\d+)\_(\d+)/.test(e)?"Mac OS X 10."+RegExp.$1:"Mac OS X 10":e.indexOf("mac os x")!==-1?"Mac OS X":e.indexOf("mac_68000")!==-1?"Mac OS Classic (68000)":e.indexOf("68K")!==-1?"Mac OS Classic (68000)":e.indexOf("mac_powerpc")!==-1?"Mac OS Classic (PowerPC)":e.indexOf("ppc mac")!==-1?"Mac OS Classic (PowerPC)":e.indexOf("macintosh")!==-1?"Mac OS Classic":e.indexOf("googletv")!==-1?"Android (GoogleTV)":e.indexOf("xoom")!==-1?"Android (Xoom)":e.indexOf("htc_flyer")!==-1?"Android (HTC Flyer)":e.indexOf("android")!==-1?"Android":e.indexOf("symbian")!==-1?"Symbian":e.indexOf("series60")!==-1?"Symbian (Series 60)":e.indexOf("series70")!==-1?"Symbian (Series 70)":e.indexOf("series80")!==-1?"Symbian (Series 80)":e.indexOf("series90")!==-1?"Symbian (Series 90)":e.indexOf("x11")!==-1?"UNIX":e.indexOf("nix")!==-1?"UNIX":e.indexOf("linux")!==-1?"Linux":e.indexOf("qnx")!==-1?"QNX":e.indexOf("os/2")!==-1?"IBM OS/2":e.indexOf("beos")!==-1?"BeOS":e.indexOf("blackberry95")!==-1?"Blackberry (Storm 1/2)":e.indexOf("blackberry97")!==-1?"Blackberry (Bold)":e.indexOf("blackberry96")!==-1?"Blackberry (Tour)":e.indexOf("blackberry89")!==-1?"Blackberry (Curve 2)":e.indexOf("blackberry98")!==-1?"Blackberry (Torch)":e.indexOf("playbook")!==-1?"Blackberry (Playbook)":e.indexOf("wnd.rim")!==-1?"Blackberry (IE/FF Emulator)":e.indexOf("blackberry")!==-1?"Blackberry":e.indexOf("palm")!==-1?"Palm OS":e.indexOf("webos")!==-1?"WebOS":e.indexOf("hpwos")!==-1?"WebOS (HP)":e.indexOf("blazer")!==-1?"Palm OS (Blazer)":e.indexOf("xiino")!==-1?"Palm OS (Xiino)":e.indexOf("kindle")!==-1?"Kindle":e.indexOf("wii")!==-1?"Nintendo (Wii)":e.indexOf("nintendo ds")!==-1?"Nintendo (DS)":e.indexOf("playstation 3")!==-1?"Sony (Playstation Console)":e.indexOf("playstation portable")!==-1?"Sony (Playstation Portable)":e.indexOf("webtv")!==-1?"MSN TV (WebTV)":e.indexOf("inferno")!==-1?"Inferno":"Unknown",t=navigator.platform.toLowerCase(),i=t.indexOf("x64")!==-1?"64":e.indexOf("x86_64")!==-1?"64":e.indexOf("x86-64")!==-1?"64":e.indexOf("win64")!==-1?"64":e.indexOf("x64;")!==-1?"64":e.indexOf("amd64")!==-1?"64":e.indexOf("wow64")!==-1?"64":e.indexOf("x64_64")!==-1?"64":e.indexOf("ia65")!==-1?"64":e.indexOf("sparc64")!==-1?"64":e.indexOf("ppc64")!==-1?"64":e.indexOf("irix64")!==-1?"64":e.indexOf("irix64")!==-1?"64":"32"}catch(r){n="error",i="error"}return{name:n.replace(/\s+/g,""),bits:"x"+i}}var u,d,c,h={},f={},p={},m={};m=function(){var e,t="1.2.0",n="1.10.1",i="14708636",r="2017-5-2_14:58:33",s=new m.di.Context,a=new c.System,d=!1,h=null,f=null,p=null,g=[],y=[],v=null,_=null,b="und",E="und",x=!1,S={video:-1,audio:-1},T=null,w=!1,D=!1,M=!0,I=null,L=!1,C={},R=function(){if(!d)throw new Error("MediaPlayer not initialized !!!")},A=function(){if(!e.getElement())throw new Error("MediaPlayer.play(): Video element not attached to MediaPlayer")},P=function(){if(!I)throw new Error("MediaPlayer.play(): Source not attached to MediaPlayer")},F=function(){return R(),A(),P(),m.hasMediaSourceExtension()?(D=!0,this.metricsModel.addSession(null,I.url,e.getElement().loop,null,"MediaPlayer.js_"+this.getVersion()),this.debug.log("[MediaPlayer] Version: "+this.getVersionFull()+" - "+this.getBuildDate()),this.debug.log("[MediaPlayer] user-agent: "+navigator.userAgent),this.debug.log("[MediaPlayer] Load stream:\n",JSON.stringify(I,null,"  ")),T||(T=a.getObject("streamController"),T.setVideoModel(e),T.setAutoPlay(M)),T.setDefaultAudioLang(b),T.setDefaultSubtitleLang(E),T.enableSubtitles(x),T.load(I),a.mapValue("scheduleWhilePaused",L),void a.mapOutlet("scheduleWhilePaused","stream")):void this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE,"MediaSource extension not supported by the browser")},N=function(){return d&&e.getElement()&&I&&!w},B=function(){N()&&F.call(this)},k=function(t,n){var i=document.createEvent("CustomEvent");i.initCustomEvent(t,!1,!1,{type:n.streamType,bitrate:n.switchedQuality,representationId:n.representationId,time:e.getCurrentTime(),width:n.width,height:n.height}),e.getElement().dispatchEvent(i)},O=function(t){var n;switch(t.data.metric){case"ManifestReady":R(),this.debug.log("[MediaPlayer] ManifestReady"),f=this.metricsExt.getBitratesForType("video"),this.debug.log("[MediaPlayer] video bitrates: "+JSON.stringify(f)),n=document.createEvent("CustomEvent"),n.initCustomEvent("manifest_loaded",!1,!1,{}),e.getElement().dispatchEvent(n);break;case"RepresentationSwitch":R(),"video"==t.data.stream?(f=this.metricsExt.getBitratesForType(t.data.stream),f&&(k("download_bitrate",{streamType:t.data.stream,switchedQuality:f[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+f[t.data.value.lto]))):"audio"==t.data.stream&&(p=this.metricsExt.getBitratesForType(t.data.stream),p&&(k("download_bitrate",{streamType:t.data.stream,switchedQuality:p[t.data.value.to],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+f[t.data.value.lto])));break;case"BufferedSwitch":R(),"video"==t.data.stream?g.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:f[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}):"audio"==t.data.stream&&y.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:p[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)});break;case"BufferLevel":n=document.createEvent("CustomEvent"),n.initCustomEvent("bufferLevel_updated",!1,!1,{type:t.data.stream,level:t.data.value.level}),e.getElement().dispatchEvent(n);break;case"State":n=document.createEvent("CustomEvent"),n.initCustomEvent("state_changed",!1,!1,{type:t.data.stream,state:t.data.value.current}),e.getElement().dispatchEvent(n)}},U=function(e){v=e.data,this.reset(2)},H=function(e){_=e.data},V=function(e,t){var n=0;for(n=t.length-1;n>=0;n-=1)e.splice(n,1)},j=function(t){var n=e.getCurrentTime(),i=null,r=[],o=0;for(o=0;o<t.length;o+=1)i=t[o],n>=i.mediaStartTime&&(k("play_bitrate",i),this.debug.log("[MediaPlayer]["+i.streamType+"] send play_bitrate - b="+i.switchedQuality+", t="+i.mediaStartTime+"("+e.getPlaybackRate()+")"),r.push(o));V(t,r)},q=function(){0!==e.getPlaybackRate()&&(j.call(this,g),j.call(this,y))},z=function(){this.addEventListener("metricAdded",O.bind(this)),this.addEventListener("error",U.bind(this)),this.addEventListener("warning",H.bind(this)),this.addEventListener("timeupdate",q.bind(this))},Y=function(e){if(D&&T){if(!w){w=!0;var t={};t[m.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE]=function(){T=null,D=!1,w=!1,this.debug.log("[MediaPlayer] Player is stopped"),N.call(this)&&B.call(this)}.bind(this),T.subscribe(m.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE,t,void 0,!0),T.reset(e)}}else N.call(this)&&B.call(this)},K=function(e){if(!e)return null;var t={};return e.id&&(t.id=e.id),e.lang&&(t.lang=e.lang),e.subType&&(t.subType=e.subType),t},W=function(e){if(!T)return null;switch(e){case m.TRACKS_TYPE.AUDIO:return T.getAudioTracks();case m.TRACKS_TYPE.TEXT:return T.getSubtitleTracks()}return null},G=function(e){if(!T)return null;switch(e){case m.TRACKS_TYPE.AUDIO:return T.getSelectedAudioTrack();case m.TRACKS_TYPE.TEXT:return T.getSelectedSubtitleTrack()}return null},X=function(e,t){if(!T)return null;switch(e){case m.TRACKS_TYPE.AUDIO:T.setAudioTrack(t);break;case m.TRACKS_TYPE.TEXT:T.setSubtitleTrack(t)}return null},$=function(e,t){return!e&&!t||e===t},Q=function(e,t){return $(e.id,t.id)&&$(e.lang,t.lang)&&$(e.subType,t.subType)},Z=function(){if(arguments&&arguments.length>0){var e={};return"string"==typeof arguments[0]&&(e.url=arguments[0]),arguments[1]&&(e.protData=arguments[1]),e}},J=function(){var e=this.metricsModel.getReadOnlyMetricsFor("video"),t=e?this.metricsExt.getCurrentDVRInfo(e):null;return t};return a.mapValue("system",a),a.mapOutlet("system"),a.injectInto(s),{notifier:void 0,debug:void 0,eventBus:void 0,metricsExt:void 0,abrController:void 0,metricsModel:void 0,errHandler:void 0,config:void 0,getVersion:function(){return n},getVersionFull:function(){return i.indexOf("@@")===-1?n+"_"+i:n},getVersionDashJS:function(){return t},getBuildDate:function(){return r.indexOf("@@")===-1?r:"Not a builded version"},init:function(t){if(!t)throw new Error("MediaPlayer.init(): Invalid Argument");d||(a.injectInto(this),d=!0,this.debug.log("[MediaPlayer] Version: "+this.getVersionFull()+" - "+this.getBuildDate()),this.debug.log("[MediaPlayer] user-agent: "+navigator.userAgent)),e=a.getObject("videoModel"),e.setElement(t),z.call(this),h=a.getObject("debugController")},addEventListener:function(t,n,i){R(),"hasplayer"===m.PUBLIC_EVENTS[t]?this.eventBus.addEventListener(t,n,i):e.listen(t,n,i)},removeEventListener:function(t,n){R(),"hasplayer"===m.PUBLIC_EVENTS[t]?this.eventBus.removeEventListener(t,n):e.unlisten(t,n)},getVideoModel:function(){return e},getDebug:function(){return this.debug},getMetricsExt:function(){return this.metricsExt},setConfig:function(e){this.config&&e&&(this.debug.log("[MediaPlayer] set config: "+JSON.stringify(e,null,"\t")),this.config.setParams(e))},setParams:function(e){this.setConfig(e)},setDebug:function(e){if(R(),"boolean"!=typeof e)throw new Error("MediaPlayer.setDebug(): Invalid Arguments");e===!0?this.debug.setLevel(4):this.debug.setLevel(0)},getAutoPlay:function(){return M},setAutoPlay:function(e){M=e},setInitialQualityFor:function(e,t){S[e]=t},getQualityFor:function(e){return R(),this.abrController.getQualityFor(e)},setQualityFor:function(e,t){if(R(),"number"!=typeof t)throw new Error("MediaPlayer.setQualityFor(): Invalid Arguments");this.abrController.setQualityFor(e,t)},getAutoSwitchQuality:function(){return R(),this.abrController.getAutoSwitchBitrate()},setAutoSwitchQuality:function(e){if(R(),"boolean"!=typeof e)throw new Error("MediaPlayer.setAutoSwitchQuality(): Invalid Arguments");this.abrController.setAutoSwitchBitrate(e)},getScheduleWhilePaused:function(){return L},setScheduleWhilePaused:function(e){if("boolean"!=typeof e)throw new Error("MediaPlayer.setScheduleWhilePaused(): Invalid Arguments");L=e},setDefaultAudioLang:function(e){if("string"!=typeof e)throw new Error("MediaPlayer.setDefaultAudioLang(): Invalid Arguments");b=e},getDefaultAudioLang:function(){return b},setDefaultSubtitleLang:function(e){if("string"!=typeof e)throw new Error("MediaPlayer.setDefaultSubtitleLang(): Invalid Arguments");E=e},getDefaultSubtitleLang:function(){return E},load:function(e){var t,n=[],i=[],r={video:{"ABR.keepBandwidthCondition":!0},audio:{"ABR.keepBandwidthCondition":!0}};if(arguments&&arguments.length>0&&"object"!=typeof arguments[0]&&(console.warn('You are using "deprecated" call of the method load, please refer to the documentation to change prameters call'),e=Z.apply(null,arguments)),!e||!e.url)throw new Error("MediaPlayer.load(): stream has no url.");g=[],y=[],R(),this.reset(0),S.video>=0&&(this.abrController.setQualityFor("video",S.video),r.video["ABR.keepBandwidthCondition"]=!1,S.video=-1),S.audio>=0&&(this.abrController.setQualityFor("audio",S.audio),r.audio["ABR.keepBandwidthCondition"]=!1,S.audio=-1),this.setConfig(r),v=null,_=null;for(var o in C)n.push(C[o].deferInit.promise);u.all(n).then(function(){for(var n in C)t=C[n],t.deferLoad=u.defer(),i.push(t.deferLoad.promise),t.load(e,function(){this.deferLoad.resolve()}.bind(t));u.all(i).then(function(){I=e,Y.call(this,0)}.bind(this))}.bind(this))},play:function(){R(),e.play()},seek:function(t){var n=null,i=0;if(R(),"number"!=typeof t)throw new Error("MediaPlayer.seek(): Invalid Arguments");if(this.isLive()){if(n=this.getDVRWindowRange(),i=T.getLiveDelay(),null===n)throw new Error("MediaPlayer.seek(): impossible for live stream");if(t<n.start||t>n.end)throw new Error("MediaPlayer.seek(): seek value outside available time range");t>n.end-i&&(t=n.end-i),T.seek(t,!0)}else{if(t<0||t>e.getDuration())throw new Error("MediaPlayer.seek(): seek value outside available time range");e.setCurrentTime(t)}},pause:function(){R(),e.pause()},stop:function(){R(),e.pause(),this.isLive()||e.setCurrentTime(0);for(var t in C)C[t].stop()},reset:function(e){R(),this.setQualityFor("video",0),this.setQualityFor("audio",0),I=null,Y.call(this,e);for(var t in C)C[t].reset()},refreshManifest:function(e){R(),T.refreshManifest(e)},getDuration:function(){return R(),e.getDuration()},isLive:function(){return R(),e.getDuration()===Number.POSITIVE_INFINITY},getPosition:function(){return R(),this.isLive()?void 0:e.getCurrentTime()},getDVRWindowRange:function(){if(R(),!this.isLive())return null;var e=J.call(this);return e?e.range:null},getDVRWindowSize:function(){return R(),this.isLive(),null},getDVRSeekOffset:function(e){if(R(),!this.isLive())return null;var t=J.call(this),n=t?t.range.start+e:null;return n&&n>t.range.end&&(n=t.range.end),n},getVideoBitrates:function(){return R(),f},getMetricsFor:function(e){var t=this.metricsModel.getReadOnlyMetricsFor(e);return t},getTrickModeSpeed:function(){return T?T.getTrickModeSpeed():0},setTrickModeSpeed:function(t){R(),T&&(T.getTrickModeSpeed()!==t&&1===t?e.play():T.setTrickModeSpeed(t))},getError:function(){return v},getWarning:function(){return _},getTracks:function(e){if(R(),!e||e!==m.TRACKS_TYPE.AUDIO&&e!==m.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');var t=W(e);if(!t)return[];for(var n=[],i=0;i<t.length;i+=1)n.push(K(t[i]));return n},selectTrack:function(e,t){if(R(),!e||e!==m.TRACKS_TYPE.AUDIO&&e!==m.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');if(!t||!(t.id||t.lang||t.subType))throw new Error("MediaPlayer.selectTrack(): track parameter is not in valid");var n=W(e);if(!n)return void this.debug.error("[MediaPlayer] No available track for type "+e);var i=G(e);if(i&&Q(i,t))return void this.debug.log("[MediaPlayer] "+e+" track ["+t.id+" - "+t.lang+"] is already selected");for(var r=0;r<n.length;r+=1)if(Q(n[r],t))return void X(e,n[r])},getSelectedTrack:function(e){if(R(),!e||e!==m.TRACKS_TYPE.AUDIO&&e!==m.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');return K(G(e))},enableSubtitles:function(e){if(R(),"boolean"!=typeof e)throw new Error("MediaPlayer.enableSubtitles(): Invalid Arguments");x=e,T&&T.enableSubtitles(x)},isSubtitlesEnabled:function(){return R(),x},enableSubtitleExternDisplay:function(e){if("boolean"!=typeof e)throw new Error("MediaPlayer.enableSubtitleExternDisplay(): Invalid Arguments");this.config.setParams({"TextTrackExtensions.displayModeExtern":e})},getTTMLRenderingDiv:function(){return e?e.getTTMLRenderingDiv():null},attachTTMLRenderingDiv:function(t){R(),e.setTTMLRenderingDiv(t)},getMute:function(){return R(),e.getMute()},setMute:function(t){if(R(),"boolean"!=typeof t)throw new Error("MediaPlayer.setMute(): Invalid Arguments");e.setMute(t)},getVolume:function(){return R(),e.getVolume()},setVolume:function(t){if(R(),"number"!=typeof t||t<0||t>1)throw new Error("MediaPlayer.setVolume(): Invalid Arguments");e.setVolume(t)},getTerminalId:function(){var e=o(),t=l();return t.name+"-"+t.bits+"-"+e.name},addPlugin:function(e){if(R(),void 0===e)throw new Error("MediaPlayer.addPlugin(): plugin undefined");if("function"!=typeof e.getName||"function"!=typeof e.getVersion||"function"!=typeof e.init||"function"!=typeof e.load||"function"!=typeof e.stop||"function"!=typeof e.reset)throw new Error("MediaPlayer.addPlugin(): plugin API not compliant");C[e.getName()]&&C[e.getName()].destroy(),this.debug.log("[MediaPlayer] Add plugin '"+e.getName()+"' (v"+e.getVersion()+")"),C[e.getName()]=e,e.deferInit=u.defer(),d&&e.init(this,function(){this.deferInit.resolve()}.bind(e))},removePlugin:function(e){var t;if(void 0===e)throw new Error("MediaPlayer.removePlugin(): plugin undefined");if("string"==typeof e)t=e;else{if("function"!=typeof e.getName)throw new Error("MediaPlayer.removePlugin(): plugin API not compliant");t=e.getName()}C[t]&&(this.debug.log("[MediaPlayer] Remove plugin '"+t),C[t].destroy(),C[t]=null,delete C[t])}}},m.prototype={constructor:m},m.dependencies={},m.dependencies.protection={},m.dependencies.protection.servers={},m.utils={},m.models={},m.modules={},m.vo={},m.vo.metrics={},m.vo.protection={},m.rules={},m.rules.o={},m.di={},m.PUBLIC_EVENTS={error:"hasplayer",warning:"hasplayer",manifestUrlUpdate:"hasplayer",metricAdded:"hasplayer",metricChanged:"hasplayer",cueEnter:"hasplayer",cueExit:"hasplayer",play_bitrate:"video",download_bitrate:"video",bufferLevel_updated:"video",state_changed:"video"},m.TRACKS_TYPE={AUDIO:"audio",TEXT:"text"},m.hasMediaSourceExtension=function(){return(new m.utils.Capabilities).supportsMediaSource()},m.hasMediaKeysExtension=function(){return(new m.utils.Capabilities).supportsMediaKeys()},m.dependencies.AbrController=function(){"use strict";var e=!0,t={},n={},i={},r={},o="",s=function(e){return t.hasOwnProperty(e)||(t[e]=!0),t[e]},a=function(e,n){t[e]=n},l=function(e){var t;return n.hasOwnProperty(e)||(n[e]=0),t=n[e]},u=function(e,t){n[e]=t},d=function(e){var t;return r.hasOwnProperty(e)||(r[e]=0),t=r[e]},c=function(e,t){r[e]=t},h=function(t,n){var r,a,u,c,h,f,p=this,g=s(t),y=l(t),v=d(t),_=m.rules.SwitchRequest.prototype.NO_CHANGE,b=m.rules.SwitchRequest.prototype.NO_CHANGE,E=m.rules.SwitchRequest.prototype.NO_CHANGE,x=[],S={};if(!e||!g)return p.debug.log("[AbrController]["+t+"] ABR disabled"),{quality:y,confidence:v};for(p.debug.log("[AbrController]["+t+"] Check rules...."),u=p.getMetricsFor(n),h=p.abrRulesCollection.getRules(m.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES),r=0,a=h.length;r<a;r+=1)x.push(h[r].checkIndex(y,u,n,o));for(S[m.rules.SwitchRequest.prototype.STRONG]=m.rules.SwitchRequest.prototype.NO_CHANGE,S[m.rules.SwitchRequest.prototype.WEAK]=m.rules.SwitchRequest.prototype.NO_CHANGE,S[m.rules.SwitchRequest.prototype.DEFAULT]=m.rules.SwitchRequest.prototype.NO_CHANGE,r=0,a=x.length;r<a;r+=1)c=x[r],c.quality!==m.rules.SwitchRequest.prototype.NO_CHANGE&&(p.debug.log("[AbrController]["+t+"] Request for quality "+c.quality+", priority = "+c.priority+" ("+h[r].name+")"),S[c.priority]=Math.min(S[c.priority],c.quality)),c.max===!0&&(E=Math.min(E,c.quality));return S[m.rules.SwitchRequest.prototype.WEAK]!==m.rules.SwitchRequest.prototype.NO_CHANGE&&(b=m.rules.SwitchRequest.prototype.WEAK,_=S[m.rules.SwitchRequest.prototype.WEAK]),S[m.rules.SwitchRequest.prototype.DEFAULT]!==m.rules.SwitchRequest.prototype.NO_CHANGE&&(b=m.rules.SwitchRequest.prototype.DEFAULT,_=S[m.rules.SwitchRequest.prototype.DEFAULT]),S[m.rules.SwitchRequest.prototype.STRONG]!==m.rules.SwitchRequest.prototype.NO_CHANGE&&(b=m.rules.SwitchRequest.prototype.STRONG,_=S[m.rules.SwitchRequest.prototype.STRONG]),_!==m.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==_&&(y=_),b!==m.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==b&&(v=b),E!==m.rules.SwitchRequest.prototype.NO_CHANGE&&(i[t]=E),f=p.manifestExt.getRepresentationCount(n),y<0&&(y=0),y>=f&&(y=f-1),v!==m.rules.SwitchRequest.prototype.STRONG&&v!==m.rules.SwitchRequest.prototype.WEAK&&(v=m.rules.SwitchRequest.prototype.DEFAULT),p.debug.info("[AbrController]["+t+"] Request quality: "+y),{quality:y,confidence:v}},f=function(e,t){var n,i=this.metricsExt.getBitratesForType(e,t),r=this.config.getParamFor(e,"ABR.minQuality","number",-1),o=this.config.getParamFor(e,"ABR.maxQuality","number",-1),s=this.config.getParamFor(e,"ABR.minBandwidth","number",-1),a=this.config.getParamFor(e,"ABR.maxBandwidth","number",-1),l=i.length;if(s!==-1)for(n=0;n<i.length;n++)if(i[n]>=s){r=r===-1?n:Math.max(n,r);break}if(a!==-1)for(n=i.length-1;n>=0;n--)if(i[n]<=a){o=o===-1?n:Math.min(n,o);break}return r=r>=l?l-1:r,r=r<0?0:r,o=o>=l||o<0?l-1:o,{min:r,max:o}};return{debug:void 0,abrRulesCollection:void 0,manifestExt:void 0,metricsModel:void 0,metricsExt:void 0,config:void 0,getAutoSwitchBitrate:function(){return e},setAutoSwitchBitrate:function(t){this.debug.log("[AbrController] Set auto switch: "+t),e=t},getMetricsFor:function(e){var t,n;return t=this.manifestExt.getIsVideo(e),t?this.metricsModel.getMetricsFor("video"):(n=this.manifestExt.getIsAudio(e),n?this.metricsModel.getMetricsFor("audio"):this.metricsModel.getMetricsFor("stream"))},getPlaybackQuality:function(e,t){var n,r,o,s=this,a=this.getQualityFor(e),l=-1,d=-1,p=this.config.getParamFor(e,"ABR.switchUpIncrementally","boolean",!1);if(o=h.call(this,e,t),n=o.quality,r=o.confidence,s.getAutoSwitchBitrate()){p&&n>a&&(s.debug.log("[AbrController]["+e+"] Incremental switch => quality: "+n),n=a+1);var m=f.call(s,e,t);l=m.min,d=m.max,n<l&&(n=l,s.debug.log("[AbrController]["+e+"] New quality < min => "+n)),n>d&&(n=d,s.debug.log("[AbrController]["+e+"] New quality > max => "+n)),n>i[e]&&(n=i[e],s.debug.log("[AbrController]["+e+"] Max allowed quality = "+n))}return u.call(s,e,n),c.call(s,e,r),s.debug.info("[AbrController]["+e+"] Set quality: "+n),{quality:n,confidence:r}},getAutoSwitchFor:function(e){return s(e)},setAutoSwitchFor:function(e,t){var n=s(e);t!==n&&(this.debug.log("[AbrController]["+e+"] Set auto switch: "+t),a(e,t))},getQualityFor:function(e){return l(e)},setQualityFor:function(e,t){var n=l(e);t!==n&&(this.debug.log("[AbrController]["+e+"] Set playback quality: "+t),u(e,t))},isMinQuality:function(e,t,n){var i=f.call(this,e,t);return n<=i.min},setPlayerState:function(e){o=e}}},m.dependencies.AbrController.prototype={constructor:m.dependencies.AbrController},m.dependencies.AbrController.BANDWIDTH_SAFETY=.9,m.dependencies.BufferController=function(){"use strict";var e,t,n,i,r,s,a,l,d,c,h="READY",f=h,g=!1,y=!1,v=!1,_=!0,b=[],x=!1,S=-1,T=!0,w=!1,D=!1,M=-1,I=-1,L=!1,C=!1,R=!1,A=null,P=null,F=0,N=null,B=0,k=!1,O=null,U=!1,H=null,V=null,j=!1,q=0,z=!0,Y=!1,K=null,W=null,G=!0,X=!1,$=-1,Q=0,Z=1,J=$,ee=-1,te=null,ne=3,ie=0,re=null,oe=-1,se=null,ae=NaN,le="Safari"===o().name,ue="Firefox"===o().name,de=function(){Ie.call(this)&&null!==N&&this.fragmentController.onBufferControllerStateChange()},ce=function(e,t){var n=0,i=null;G===!1&&(i=W.start,n=e.getTime()-i.getTime(),W.duration=n,W.stopreason=t,G=!0)},he=function(e){"text"!==i&&(this.debug.info("[BufferController]["+i+"] stalled = "+e),L=e,this.videoModel.stallStream(i,L),this.abrController.setPlayerState(L?"buffering":"playing"))},fe=function(){g&&y&&(this.debug.info("[BufferController]["+i+"] startPlayback"),he.call(this,!0),je.call(this))},pe=function(){var e;if(y!==!0&&null===te){if(x===!1&&(e=new Date,ce(e,m.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),K=this.metricsModel.addPlayList(i,e,0,m.vo.metrics.PlayList.INITIAL_PLAY_START_REASON)),R){if("application/ttml+xml"===H.mimeType)return;R=!1}y=!0,this.debug.info("[BufferController]["+i+"] START"),v=!0,J=$,ee=-1,re=null,this.fragmentController.clearExecutedRequests(N),fe.call(this)}},me=function(e){var t=new Date,n=this;x===!0&&S===e||(this.debug.info("[BufferController]["+i+"] SEEK: "+e),y===!0&&ye.call(this),K=this.metricsModel.addPlayList(i,t,S,m.vo.metrics.PlayList.SEEK_START_REASON),x=!0,S=e,u.when(!te||te.promise).then(function(){pe.call(n)}))},ge=function(){this.debug.info("[BufferController]["+i+"] SEEKED"),x=!1,S=-1},ye=function(){y&&(this.debug.info("[BufferController]["+i+"] STOP"),clearTimeout(d),clearTimeout(c),y=!1,v=!1,x=!1,S=-1,ce(new Date,m.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),this.fragmentController.abortRequestsForModel(N))},ve=function(t){return e[t]},_e=function(e){this.debug.info("[BufferController]["+i+"] Load request ",null!==e.url?e.url:e.quality)},be=function(e,t){void 0!==e.sequenceNumber&&(oe=e.sequenceNumber),this.fragmentController.isInitializationRequest(e)?Ee.call(this,e,t):xe.call(this,e,t)},Ee=function(e,t){if(Ie.call(this)){var n=t.data,r=e.quality,o=this;this.debug.log("[BufferController]["+i+"] Initialization loaded ",r);try{this.fragmentController.process(n).then(function(t){t?(b[r]=t,o.debug.info("[BufferController]["+i+"] Buffer initialization segment ",null!==e.url?e.url:e.quality),Se.call(o,t,e.quality).then(function(){Ie.call(o)&&Ne.call(o)})):Ne.call(o)},function(e){Le.call(o),e.name?o.errHandler.sendError(e.name,e.message,e.data):o.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)})}catch(s){Le.call(o),s.name?o.errHandler.sendError(s.name,s.message,s.data):o.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",s.message)}}},xe=function(e,n){if(Ie.call(this)){var r,o=this.manifestExt.getEventStreamForAdaptationSet(this.getData()),s=this.manifestExt.getEventStreamForRepresentation(this.getData(),t),a=this;ae=e.duration,
ie=0,this.debug.log("[BufferController]["+i+"] Media loaded ",e.url),this.chunkAborted===!0&&(this.chunkAborted=!1),1===this.chunkMissingCount&&(this.chunkMissingCount=0);try{this.fragmentController.process(n.data,e,t).then(function(n){n?((o.length>0||s.length>0)&&(r=De.call(a,n,e,o,s),a.eventController.addInbandEvents(r)),a.debug.info("[BufferController]["+i+"] Buffer segment from url ",e.url),n=Me.call(a,n),u.when(!D||Re.call(a)).then(function(){D=!1,ue&&(V.timestampOffset=-we(n,e)),Se.call(a,n,e.quality,e).then(function(){M!==e.quality&&(a.debug.log("[BufferController]["+i+"] Buffered quality changed: "+e.quality),a.metricsModel.addBufferedSwitch(i,e.startTime,t.id,e.quality),M=e.quality),Le.call(a),je.call(a)})})):(a.debug.error("[BufferController]["+i+"] Error with segment data, no bytes to push"),Le.call(a),je.call(a))},function(e){Le.call(a),e.name?a.errHandler.sendError(e.name,e.message,e.data):a.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)})}catch(l){Le.call(a),l.name?a.errHandler.sendError(l.name,l.message,l.data):a.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",l.message)}}},Se=function(e,n,r){var o=u.defer(),s=this.videoModel.getCurrentTime(),l=new Date,d=this;if(G===!0&&(G=!1,W=this.metricsModel.appendPlayListTrace(K,t.id,null,l,s,null,1,null)),ke())return Ce.call(this).then(function(){ke()&&(d.debug.log("[BufferController]["+i+"] Buffering segment"),d.sourceBufferExt.append(V,e,r).then(function(){if(d.debug.log("[BufferController]["+i+"] Segment buffered"),k=!1,B>1&&!le)Re.call(d,-1,Ue.call(d)-a).then(function(){Te.call(d),o.resolve()});else if(j){var e=Y?-1:Ue.call(d)+ae,t=Y?Ue.call(d)-ae:-1;Re.call(d,e,t).then(function(){Te.call(d),o.resolve()})}else Te.call(d),o.resolve();d.system.notify("bufferUpdated")},function(t){d.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER,"Failed to append data into "+i+" source buffer",new m.vo.Error(t.err.code,t.err.name,t.err.message)),t.err.code===m.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED&&(O={data:e,quality:n},A=o,k=!0,F=0,ye.call(d))}))}),o.promise},Te=function(){var e,t,n=null;if(this.debug.getLevel()>=this.debug.INFO&&V){if(n=this.sourceBufferExt.getAllRanges(V),null===n||0===n.length)return;for(e=0,t=n.length;e<t;e+=1)this.debug.info("[BufferController]["+i+"] Buffered range ["+e+"]: "+n.start(e)+" - "+n.end(e)+" ("+this.getVideoModel().getCurrentTime()+")")}},we=function(e,t){var n,i,r=E.deserialize(e),o=r.getBoxByType("moov"),s=r.getBoxByType("moof"),a=null===s?null:s.getBoxByType("traf"),l=null===a?null:a.getBoxByType("trun");if(null===l||0===l.samples_table.length)return 0;if(n=l.samples_table[0].sample_composition_time_offset,void 0===n)return 0;if(o){var u=o.getBoxByType("mvhd");i=u.timescale}else i=t.timescale;return n/i},De=function(e,t,n,i){var r,o,s,a=[],l=0,u=Math.pow(256,2),d=Math.pow(256,3),c=Math.max(isNaN(t.startTime)?0:t.startTime,0),h=[];X=!1,s=n.concat(i);for(var f=0;f<s.length;f++)h[s[f].schemeIdUri]=s[f];for(;l<e.length&&(r=String.fromCharCode(e[l+4],e[l+5],e[l+6],e[l+7]),o=e[l]*d+e[l+1]*u+256*e[l+2]+1*e[l+3],"moov"!==r&&"moof"!==r);){if("emsg"===r){X=!0;for(var m=["","",0,0,0,0,""],g=0,y=l+12;y<o+l;)0===g||1===g||6===g?(0!==e[y]?m[g]+=String.fromCharCode(e[y]):g+=1,y+=1):(m[g]=e[y]*d+e[y+1]*u+256*e[y+2]+1*e[y+3],y+=4,g+=1);var v=m[0],_=m[1],b=m[2],E=m[3],x=m[4],S=m[5],T=m[6],w=c*b+E;if(h[v]){var D=new p.vo.Event;D.eventStream=h[v],D.eventStream.value=_,D.eventStream.timescale=b,D.duration=x,D.id=S,D.presentationTime=w,D.messageData=T,D.presentationTimeDelta=E,a.push(D)}}l+=o}return a},Me=function(e){if(!X)return e;for(var t,n,i=e.length,r=0,o=0,s=0,a=Math.pow(256,2),l=Math.pow(256,3),u=new Uint8Array(e.length);r<i;){if(t=String.fromCharCode(e[r+4],e[r+5],e[r+6],e[r+7]),n=e[r]*l+e[r+1]*a+256*e[r+2]+1*e[r+3],"emsg"!==t)for(s=r;s<r+n;s++)u[o]=e[s],o+=1;r+=n}return u.subarray(0,o)},Ie=function(){return!!y||(Le.call(this),!1)},Le=function(){te&&(te.resolve(),te=null)},Ce=function(){var e,t,n=u.defer(),i=0;return k?(t=function(){var r,o,s=this.videoModel.getCurrentTime(),a=0;o=this.fragmentController.getExecutedRequestForTime(N,s),r=o&&!isNaN(o.startTime)?o.startTime:Math.floor(s),e=o&&!isNaN(o.duration)?o.duration:1,Re.call(this,a,r).then(function(r){i+=r,i>=e?n.resolve():setTimeout(t,1e3*e)})},t.call(this),n.promise):u.when(!0)},Re=function(e,t){var r,o,s=u.defer(),a=this;return 0===V.buffered.length?(s.resolve(0),s.promise):(r=void 0!==e&&e!==-1?e:V.buffered.start(0),o=void 0!==t&&t!==-1?t:V.buffered.end(V.buffered.length-1),o<=r?(s.resolve(0),s.promise):(this.debug.info("[BufferController]["+i+"] Remove from "+r+" to "+o+" ("+this.getVideoModel().getCurrentTime()+")"),"text"!==i&&this.sourceBufferExt.abort(n,V),this.sourceBufferExt.remove(V,r,o,P.duration,n).then(function(){a.fragmentController.removeExecutedRequestsBeforeTime(N,o+1),a.fragmentController.cancelPendingRequestsForModel(N),s.resolve(o-r)},function(e){a.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER,"Failed to remove data from "+i+" source buffer",new m.vo.Error(e.code,e.name,e.message)),s.resolve(0)}),s.promise))},Ae=function(e){if(Ie.call(this)){if(Le.call(this),e.aborted)return void ze.call(this);if("text"===i)return void this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status});ie+=1,ie===ne?this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}):(this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}),re=e,J===Q&&Xe.call(this))}},Pe=function(){this.debug.log("[BufferController]["+i+"] Stream is complete."),R=!0,ce(new Date,m.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON),Le.call(this),ye.call(this),this.system.notify("bufferingCompleted")},Fe=function(t){if(!Ie.call(this))return u.when(null);var n=this;return b[t]?(this.debug.info("[BufferController]["+i+"] Buffer initialization segment, quality = ",t),Se.call(this,b[t],t).then(function(){n.debug.log("[BufferController]["+i+"] Initialization segment buffered"),Ie.call(n)&&Ne.call(n)}),u.when(null)):this.indexHandler.getInitRequest(e[t])},Ne=function(){if(Ie.call(this)){var e,n,r=Ue.call(this);D?n=r:(e=this.sourceBufferExt.getBufferRange(V,r),n=e?e.end:r),oe===-1||x||D?(this.debug.log("[BufferController]["+i+"] loadNextFragment for time: "+n),this.indexHandler.getSegmentRequestForTime(t,n).then(Be.bind(this),function(){I=-1,Pe.call(this)})):(this.debug.log("[BufferController]["+i+"] loadNextFragment for sequence number: "+oe),this.indexHandler.getNextSegmentRequestFromSN(t,oe).then(Be.bind(this)))}},Be=function(e){if(Ie.call(this)){var n=this.manifestModel.getValue();return null!==e&&e.action===e.ACTION_COMPLETE?void Pe.call(this):void(null!==e?(j&&(e=this.indexHandler.getIFrameRequest(e)),this.fragmentController.isFragmentLoadedOrPending(this,e)?(this.debug.log("[BufferController]["+i+"] new fragment request => already loaded or pending "+e.url),this.indexHandler.getNextSegmentRequest(t).then(Be.bind(this))):(this.fragmentController.prepareFragmentForLoading(this,e,_e,be,Ae,null),de.call(this))):(this.debug.log("[BufferController]["+i+"] loadNextFragment failed"),Le.call(this),C?"M3U"===n.name&&qe.call(this):Pe.call(this)))}},ke=function(){return!!H&&!!V},Oe=function(){var e=this.videoModel.getCurrentTime();return P.start+P.duration-e},Ue=function(){var e=-1,t=this.videoModel.getCurrentTime();return e=x?S:t},He=function(){var e,n=u.defer(),r=t.segmentAvailabilityRange.end,o=this;return this.debug.log("[BufferController]["+i+"] Manifest live edge = "+r),e=Math.max(r-l,t.segmentAvailabilityRange.start),this.indexHandler.getSegmentRequestForTime(t,e).then(function(e){P.liveEdge=e.startTime,o.debug.log("[BufferController]["+i+"] Live edge = "+P.liveEdge),n.resolve(P.liveEdge)}),n.promise},Ve=function(e){if(ke()){var t=Ue.call(this);B=this.sourceBufferExt.getBufferLength(V,t),this.debug.log("[BufferController]["+i+"] Working time = "+t+", Buffer level = "+B.toFixed(3)),e&&this.metricsModel.addBufferLevel(i,new Date,B),this.updateBufferState()}},je=function(){if(Ie.call(this)){var e,t;this.debug.log("[BufferController]["+i+"] Check buffer..."),Ve.call(this,!0),L&&B>s&&he.call(this,!1),e=Oe.call(this),this.debug.log("[BufferController]["+i+"] time to end = "+e),j?B<1&&ze.call(this):w||D||B<r&&(r<e||r>=e&&!R)?ze.call(this):(t=B-r+.5,qe.call(this,t))}},qe=function(e){var t=this;e=e?e:1,this.debug.log("[BufferController]["+i+"] Check buffer in = "+e.toFixed(3)+" ms (bufferLevel = "+B+")"),clearTimeout(d),d=setTimeout(function(){d=null,je.call(t)},1e3*e)},ze=function(){var e,n=new Date,r=this.videoModel.getCurrentTime(),o=this.manifestModel.getValue(),s=!1,a=null,l=this;null!==te&&this.debug.error("[BufferController]["+i+"] deferredFragmentBuffered has not been resolved, create a new one is not correct."),te=u.defer(),this.debug.log("[BufferController]["+i+"] Start buffering process..."),We.call(this),s=0===b.length&&"M3U"!==o.name,e=this.abrController.getPlaybackQuality(i,H).quality,t=ve.call(this,e),e!==I&&(this.debug.log("[BufferController]["+i+"] currentDownloadQuality changed : "+e),I=e,s=!0,ce(new Date,m.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON),this.debug.log("[BufferController]["+i+"] Send RepresentationSwitch with quality = "+e),this.metricsModel.addRepresentationSwitch(i,n,r,t.id,e),a=Ye.call(this)),u.when(!a||a).then(function(){s===!0?Fe.call(l,e).then(function(e){null!==e&&(l.fragmentController.prepareFragmentForLoading(l,e,_e,be,Ae,null),de.call(l))},function(e){Le.call(l),e.name===m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED?l.errHandler.sendError(e.name,e.message,e.data):l.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing initialization segment",e.message)}):Ne.call(l)},function(e){Le.call(l),e&&l.errHandler.sendError(e.name,e.message,e.data)})},Ye=function(){var n,r,o,s=this.manifestModel.getValue(),a=this;return"M3U"!==s.name?u.when(!0):C||"SegmentList"!==t.segmentInfoType?(se&&(clearTimeout(se),se=null),n=u.defer(),o=this.manifestExt.getDataIndex(H,s,P.index),r=s.Period_asArray[P.index].AdaptationSet_asArray[o].Representation_asArray[I],this.debug.log("[BufferController]["+i+"] Update playlist for representation "+r.id),this.parser.hlsParser.updatePlaylist(r,H).then(function(){e=Ke.call(a,H,P),t=ve.call(a,I),r=s.Period_asArray[P.index].AdaptationSet_asArray[o].Representation_asArray[I];var i=r.SegmentList.SegmentURL_asArray,l=i[i.length-1];se=setTimeout(function(){Ye.call(a)},1e3*(l.duration-1)),n.resolve()},function(e){e&&a.errHandler.sendWarning(e.name,e.message,e.data),n.reject(e)}),n.promise):u.when(!0)},Ke=function(e,t){var n,i,r=this.manifestModel.getValue();return n=this.manifestExt.getDataIndex(e,r,t.index),i=this.manifestExt.getAdaptationsForPeriod(r,t),this.manifestExt.getRepresentationsForAdaptation(r,i[n])},We=function(){return T!==!1&&(this.debug.log("[BufferController]["+i+"] Data changed"),e=Ke.call(this,H,P),t=ve.call(this,this.abrController.getPlaybackQuality(i,H).quality),this.bufferExt.updateData(H,i),w&&(b=[],this.fragmentController.clearExecutedRequests(N),D=!0,"text"===i&&(V.UpdateLang(H.id,H.lang),"application/ttml+xml"===H.mimeType&&Re.call(this))),T=!1,void(w=!1))},Ge=function(e){var t,n,r=this.abrController.getQualityFor(i);if(!this.abrController.isMinQuality(i,H,r)){n=this.abrRulesCollection.getRules(m.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES);var o=function(e){e.quality<r&&(this.fragmentController.abortRequestsForModel(N),this.debug.info("[BufferController]["+i+"] Abandon current segment download"))};for(t=0;t<n.length;t++)n[t].execute(e.data.request,o.bind(this))}},Xe=function(){null!==re&&(this.debug.log("[BufferController]["+i+"] Signal segment loading failed"),this.system.notify("segmentLoadingFailed",re),re=null)};return{videoModel:void 0,metricsModel:void 0,manifestExt:void 0,manifestModel:void 0,bufferExt:void 0,sourceBufferExt:void 0,abrController:void 0,parser:void 0,fragmentExt:void 0,indexHandler:void 0,debug:void 0,system:void 0,errHandler:void 0,config:void 0,abrRulesCollection:void 0,initialize:function(e,t,n,i,o,u,d){var c=this.manifestModel.getValue();this.debug.log("[BufferController]["+e+"] Initialize"),this[m.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS]=Ge,C=this.manifestExt.getIsDynamic(c),this.setMediaSource(u),this.setType(e),this.setBuffer(i),this.setFragmentController(o),this.setEventController(d),r=this.config.getParamFor(e,"BufferController.minBufferTime","number",-1),s=this.config.getParamFor(e,"BufferController.minBufferTimeForPlaying","number",0),a=this.config.getParamFor(e,"BufferController.bufferToKeep","number",m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME),l=this.config.getParamFor(e,"BufferController.liveDelay","number",-1),this.updateData(n,t),this.load(),g=!0},load:function(){var e=this.manifestModel.getValue(),n=this;We.call(this),t=ve.call(this,this.abrController.getPlaybackQuality(i,H).quality),I=-1,Re.call(this).then(function(){t&&(n.indexHandler.setIsDynamic(C),r===-1&&(r=n.bufferExt.decideBufferLength(e.minBufferTime,P.duration,v)),(l===-1||l<r)&&(l=r),e.minBufferTime=r,"video"===i&&(C?n.indexHandler.updateSegmentList(t).then(function(){He.call(n).then(function(e){n.system.notify("startTimeFound",e)})}):n.indexHandler.getCurrentTime(t).then(function(e){e<t.segmentAvailabilityRange.start&&(e=t.segmentAvailabilityRange.start),n.system.notify("startTimeFound",e)})))})},getIndexHandler:function(){return this.indexHandler},getType:function(){return i},setType:function(e){i=e,void 0!==this.indexHandler&&this.indexHandler.setType(e)},getPeriodInfo:function(){return P},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getFragmentController:function(){return this.fragmentController},setFragmentController:function(e){e&&(this.fragmentController=e,N=this.fragmentController.attachBufferController(this),N.fragmentLoader.subscribe(m.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,this),N.setType(i))},setEventController:function(e){this.eventController=e},getData:function(){return H},updateData:function(e,t){this.debug.log("[BufferController]["+i+"] Update data"),w=null!==H&&(H.id!==e.id||H.lang!==e.lang||H.subType!==e.subType),H=e,P=t,T=!0,w&&(this.debug.log("[BufferController]["+i+"] Track changed"),clearTimeout(d),d=null,R=!1,pe.call(this),null===te&&je.call(this))},getHtmlVideoState:function(){return J},getAvailableRepresentations:function(){return e},getCurrentRepresentation:function(){return t},getBuffer:function(){return V},setBuffer:function(e){V=e},getMinBufferTime:function(){return r},setMinBufferTime:function(e){r=e},getLiveDelay:function(){return l},setMediaSource:function(e){n=e},isReady:function(){return f===h},isBufferingCompleted:function(){return R},clearMetrics:function(){null!==i&&""!==i&&this.metricsModel.clearCurrentMetricsForType(i)},updateManifest:function(){this.system.notify("manifestUpdate")},updateBufferState:function(){var e,t=this.videoModel.getCurrentTime(),n=ee===-1?t:ee,r=t-n,o=this;if(clearTimeout(c),c=null,y!==!1&&"text"!==i&&!j){switch(J){case $:J=Q,this.debug.info("[BufferController]["+i+"] BUFFERING - "+t+" - "+B),this.metricsModel.addState(i,"buffering",t);break;case Q:!this.getVideoModel().isPaused()&&r>0&&B>=1?(J=Z,this.debug.info("[BufferController]["+i+"] PLAYING - "+t),this.metricsModel.addState(i,"playing",t),x=!1,S=-1,ie=0):this.getVideoModel().isStalled()||(e=this.sourceBufferExt.getAllRanges(V));break;case Z:if(!this.getVideoModel().isPaused()&&!this.getVideoModel().isSeeking()&&(r<=0&&B<=1||0===B))if(J=Q,this.debug.info("[BufferController]["+i+"] BUFFERING - "+t+" - "+B),this.metricsModel.addState(i,"buffering",t),re)Xe.call(this);else if(!C){e=this.sourceBufferExt.getAllRanges(V);var s;for(s=0;s<e.length&&!(t<e.start(s));s++);s<e.length&&this.videoModel.setCurrentTime(e.start(s))}c=setTimeout(function(){c=null,Ve.call(o,!1)},1e3)}t>0&&(ee=t)}},updateStalledState:function(){L=this.videoModel.isStalled()},reset:function(e){var t=function(e){e&&(e.reject(),e=null)},r=u.defer(),o=this;return ye.call(this),this.sourceBufferExt.abort(n,V),se&&(clearTimeout(se),se=null),u.when(!te||te.promise).then(function(){t(A),t(te),N&&(N.fragmentLoader.unsubscribe(m.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,o.abrController),o.fragmentController.abortRequestsForModel(N),o.fragmentController.detachBufferController(N),N=null),o.clearMetrics(),b=[],_=!0,k=!1,O=null,U=!1,j&&(o.abrController.setAutoSwitchFor(i,z),o.abrController.setQualityFor(i,q)),e||o.sourceBufferExt.removeSourceBuffer(n,V),H=null,V=null,r.resolve()},function(){r.reject()}),r.promise},getSegmentDuration:function(){return ae},setTrickMode:function(e,t){var n=u.defer();return this.debug.log("[BufferController]["+i+"] setTrickMode - enabled = "+e),j===e?(n.resolve(),n.promise):(j=e,j?(Y=t,q=this.abrController.getQualityFor(i),z=this.abrController.getAutoSwitchFor(i),this.abrController.setAutoSwitchFor(i,!1),this.abrController.setQualityFor(i,0),n.resolve()):(this.abrController.setAutoSwitchFor(i,z),this.abrController.setQualityFor(i,q),Re.call(this).then(function(){n.resolve()})),n.promise)},start:pe,seek:me,stop:ye,seeked:ge,updateBufferLevel:Ve}},m.dependencies.BufferController.prototype={constructor:m.dependencies.BufferController},m.dependencies.BufferExtensions=function(){"use strict";var e,t,n=0,i=0,r=null,o=null,s=function(e){var t=this.metricsExt.getCurrentHttpRequest(e);return null!==t?(t.tresponse.getTime()-t.trequest.getTime())/1e3:0},a=function(){var e,t,s,a=this;return e=r?a.abrController.getQualityFor("audio"):n,t=o?a.abrController.getQualityFor("video"):i,s=e===n&&t===i};return{system:void 0,videoModel:void 0,metricsExt:void 0,metricsModel:void 0,abrController:void 0,bufferMax:void 0,updateData:function(e,t){if(e){var s=e.Representation_asArray.length-1;"audio"===t?(n=s,r=e):"video"===t&&(i=s,o=e)}},getTopQualityIndex:function(e){var t=null;return"audio"===e?t=n:"video"===e&&(t=i),t},decideBufferLength:function(t,n){return e=isNaN(n)||m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME<n&&t<n?Math.max(m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME,t):t>=n?Math.min(n,m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME):Math.min(n,t)},getLeastBufferLevel:function(){var e=this.metricsModel.getReadOnlyMetricsFor("video"),t=this.metricsExt.getCurrentBufferLevel(e),n=this.metricsModel.getReadOnlyMetricsFor("audio"),i=this.metricsExt.getCurrentBufferLevel(n),r=null;return r=null===t||null===i?null!==i?i.level:null!==t?t.level:null:Math.min(i.level,t.level)},getRequiredBufferLength:function(n,i,r,o){var l,d=this,c=d.metricsModel.getReadOnlyMetricsFor("video"),h=d.metricsModel.getReadOnlyMetricsFor("audio"),f=o>=m.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD,p=u.defer(),g=!1;return d.bufferMax===m.dependencies.BufferExtensions.BUFFER_SIZE_MIN?(l=e,p.resolve(l)):d.bufferMax===m.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY?(l=o,p.resolve(l)):d.bufferMax===m.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED?(t=e,r||n||(g=a.call(d)),g&&(t=f?m.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM:m.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY),l=t+i+Math.max(s.call(d,c),s.call(d,h)),p.resolve(l)):p.reject("invalid bufferMax value: "+d.bufferMax),p.promise},getBufferTarget:function(){return void 0===t?e:t}}},m.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED="required",m.dependencies.BufferExtensions.BUFFER_SIZE_MIN="min",m.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY="infinity",m.dependencies.BufferExtensions.BUFFER_TIME_AT_STARTUP=1,m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME=16,m.dependencies.BufferExtensions.DEFAULT_BUFFER_TO_KEEP=30,m.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY=16,m.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY=30,m.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=300,m.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD=600,m.dependencies.BufferExtensions.prototype.constructor=m.dependencies.BufferExtensions,m.utils.Capabilities=function(){},m.utils.Capabilities.prototype={constructor:m.utils.Capabilities,system:void 0,supportsMediaSource:function(){"use strict";var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsMediaKeys:function(){"use strict";var e="WebKitMediaKeys"in window,t="MSMediaKeys"in window,n="MediaKeys"in window;return e||t||n},supportsEncryptedMedia:function(){return this.system.hasMapping("protectionModel")},supportsCodec:function(e,t){"use strict";if(!(e instanceof HTMLMediaElement))throw"element must be of type HTMLMediaElement.";var n=e.canPlayType(t);return"probably"===n||"maybe"===n}},m.utils.Config=function(){"use strict";var e=["video","audio"],t={"BufferController.minBufferTimeForPlaying":-1,"BufferController.minBufferTime":-1,"BufferController.bufferToKeep":-1,"BufferController.liveDelay":-1,"ABR.minBandwidth":-1,"ABR.maxBandwidth":-1,"ABR.minQuality":-1,"ABR.maxQuality":-1,"ABR.switchUpIncrementally":-1,"ABR.switchUpRatioSafetyFactor":-1,"ABR.latencyInBandwidth":-1,"ABR.switchDownBufferTime":-1,"ABR.switchDownBufferRatio":-1,"ABR.switchLowerBufferTime":-1,"ABR.switchLowerBufferRatio":-1,"ABR.switchUpBufferTime":-1,"ABR.switchUpBufferRatio":-1,"ABR.keepBandwidthCondition":-1,"ABR.droppedFramesMinRatio":-1,"ABR.droppedFramesMaxRatio":-1,"ManifestLoader.RetryAttempts":-1,"ManifestLoader.RetryInterval":-1,"FragmentLoader.RetryAttempts":-1,"FragmentLoader.RetryInterval":-1,"Protection.licensePersistence":-1,video:{},audio:{}},n=function(n){var i,r,o;for(i in n)if(n.hasOwnProperty(i)&&i.indexOf("//")===-1)if(e.indexOf(i)>-1){r=n[i];for(o in r)r.hasOwnProperty(o)&&(t[i][o]=n[i][o])}else t[i]=n[i]},i=function(e,t,n,i){var r=e[t];if(void 0===r||r===-1)return i;if(void 0!==n&&typeof r!==n)switch(n){case"number":r=Number(r);break;case"boolean":r="true"===r||"1"===r||1===r}return r},r=function(e,n,r){return i(t,e,n,r)},o=function(e,n,r,o){var s=t[e];return void 0!==s&&void 0!==s[n]?i(s,n,r,o):i(t,n,r,o)};return{debug:void 0,setup:function(){},setParams:function(e){n(e);var t=this.getParam("Debug.level","number",-1);t!==-1&&this.debug.setLevel(t)},getParam:function(e,t,n){return r(e,t,n)},getParamFor:function(e,t,n,i){return o(e,t,n,i)}}},m.utils.Config.prototype={constructor:m.utils.Config},m.di.Context=function(){"use strict";var e=function(){var e=document.createElement("video"),t=this.system.getObject("debug");m.models.ProtectionModel_21Jan2015.detect(e)?this.system.mapSingleton("protectionModel",m.models.ProtectionModel_21Jan2015):m.models.ProtectionModel_3Feb2014.detect(e)?this.system.mapClass("protectionModel",m.models.ProtectionModel_3Feb2014):m.models.ProtectionModel_01b.detect(e)?this.system.mapClass("protectionModel",m.models.ProtectionModel_01b):(t.log("No supported version of EME detected on this user agent!"),t.log("Attempts to play encrypted content will fail!"))};return{system:void 0,setup:function(){this.system.autoMapOutlets=!0,this.system.mapSingleton("capabilities",m.utils.Capabilities),this.system.mapSingleton("config",m.utils.Config),this.system.mapSingleton("debug",m.utils.Debug),this.system.mapSingleton("debugController",m.utils.DebugController),this.system.mapClass("domParser",m.utils.DOMParser),this.system.mapSingleton("eventBus",m.utils.EventBus),this.system.mapSingleton("textTrackExtensions",m.utils.TextTrackExtensions),this.system.mapSingleton("tokenAuthentication",m.utils.TokenAuthentication),this.system.mapSingleton("vttParser",m.utils.VTTParser),this.system.mapSingleton("ttmlParser",m.utils.TTMLParser),this.system.mapSingleton("ttmlRenderer",m.utils.TTMLRenderer),this.system.mapSingleton("manifestModel",m.models.ManifestModel),this.system.mapClass("metrics",m.models.MetricsList),this.system.mapSingleton("metricsModel",m.models.MetricsModel),this.system.mapSingleton("uriQueryFragModel",m.models.URIQueryAndFragmentModel),this.system.mapSingleton("videoModel",m.models.VideoModel),this.system.mapSingleton("abrController",m.dependencies.AbrController),this.system.mapClass("bufferController",m.dependencies.BufferController),this.system.mapSingleton("bufferExt",m.dependencies.BufferExtensions),this.system.mapSingleton("errHandler",m.dependencies.ErrorHandler),this.system.mapClass("eventController",m.dependencies.EventController),this.system.mapClass("fragmentController",m.dependencies.FragmentController),this.system.mapClass("fragmentInfoController",m.dependencies.FragmentInfoController),this.system.mapClass("fragmentLoader",m.dependencies.FragmentLoader),this.system.mapClass("fragmentModel",m.dependencies.FragmentModel),this.system.mapClass("manifestLoader",m.dependencies.ManifestLoader),this.system.mapSingleton("manifestUpdater",m.dependencies.ManifestUpdater),this.system.mapSingleton("mediaSourceExt",m.dependencies.MediaSourceExtensions),this.system.mapSingleton("notifier",m.dependencies.Notifier),this.system.mapSingleton("sourceBufferExt",m.dependencies.SourceBufferExtensions),this.system.mapClass("stream",m.dependencies.Stream),this.system.mapSingleton("streamController",m.dependencies.StreamController),this.system.mapClass("textController",m.dependencies.TextController),this.system.mapSingleton("textSourceBuffer",m.dependencies.TextSourceBuffer),this.system.mapSingleton("textTTMLXMLMP4SourceBuffer",m.dependencies.TextTTMLXMLMP4SourceBuffer),this.system.mapSingleton("videoExt",m.dependencies.VideoModelExtensions),this.system.mapClass("protectionController",m.dependencies.ProtectionController),this.system.mapSingleton("protectionExt",m.dependencies.ProtectionExtensions),this.system.mapSingleton("ksClearKey",m.dependencies.protection.KeySystem_ClearKey),this.system.mapSingleton("ksPlayReady",m.dependencies.protection.KeySystem_PlayReady),this.system.mapSingleton("ksWidevine",m.dependencies.protection.KeySystem_Widevine),this.system.mapSingleton("serverClearKey",m.dependencies.protection.servers.ClearKey),this.system.mapSingleton("serverDRMToday",m.dependencies.protection.servers.DRMToday),this.system.mapSingleton("serverPlayReady",m.dependencies.protection.servers.PlayReady),this.system.mapSingleton("serverWidevine",m.dependencies.protection.servers.Widevine),e.call(this),this.system.mapClass("abrRulesCollection",m.rules.BaseRulesCollection),this.system.mapClass("abandonRequestRule",m.rules.AbandonRequestsRule),this.system.mapClass("downloadRatioRule",m.rules.DownloadRatioRule),this.system.mapClass("droppedFramesRule",m.rules.DroppedFramesRule),this.system.mapClass("insufficientBufferRule",m.rules.InsufficientBufferRule),this.system.mapClass("limitSwitchesRule",m.rules.LimitSwitchesRule),this.system.mapClass("baseURLExt",p.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",p.dependencies.FragmentExtensions),this.system.mapClass("indexHandler",p.dependencies.DashHandler),this.system.mapSingleton("manifestExt",p.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",m.dependencies.MetricsExtensions),this.system.mapSingleton("timelineConverter",p.dependencies.TimelineConverter),this.system.mapSingleton("parser",m.dependencies.Parser),this.system.mapClass("dashParser",p.dependencies.DashParser),this.system.mapClass("mssParser",h.dependencies.MssParser),this.system.mapClass("hlsParser",f.dependencies.HlsParser),this.system.mapSingleton("hlsDemux",f.dependencies.HlsDemux),this.system.mapSingleton("contextManager",m.modules.ContextManager),this.system.mapHandler("setContext","contextManager","setContext")}}},m.modules.ContextManager=function(){"use strict";return{system:void 0,debug:void 0,setContext:function(e){this.system.autoMapOutlets=!0,"MSS"===e?(this.system.mapClass("mp4Processor",m.dependencies.Mp4Processor),this.system.mapClass("indexHandler",h.dependencies.MssHandler),this.system.mapClass("fragmentController",h.dependencies.MssFragmentController)):"HLS"===e?(this.system.mapClass("mp4Processor",m.dependencies.Mp4Processor),this.system.mapClass("fragmentController",f.dependencies.HlsFragmentController),this.system.mapClass("indexHandler",f.dependencies.HlsHandler)):(this.system.mapClass("fragmentController",m.dependencies.FragmentController),this.system.mapClass("indexHandler",p.dependencies.DashHandler))}}},m.modules.ContextManager.prototype={constructor:m.modules.ContextManager},m.utils.Debug=function(){"use strict";Date.prototype.HHMMSSmmm=function(){var e=this.getHours().toString(),t=this.getMinutes().toString(),n=this.getSeconds().toString(),i=this.getMilliseconds().toString(),r=e[1]?e:"0"+e[0],o=t[1]?t:"0"+t[0],s=n[1]?n:"0"+n[0],a=i[2]?i:"0"+(i[1]?i:"0"+i[0]);return r+":"+o+":"+s+"."+a},Date.prototype.MMSSmmm=function(){var e=this.getMinutes().toString(),t=this.getSeconds().toString(),n=this.getMilliseconds().toString(),i=e[1]?e:"0"+e[0],r=t[1]?t:"0"+t[0],o=n[2]?n:"0"+(n[1]?n:"0"+n[0]);return i+":"+r+"."+o};var e=function(){this.logArray=[],this.showLevel=!0};e.prototype.error=e.prototype.warn=e.prototype.info=e.prototype.debug=function(e){this.logArray.push(e)},e.prototype.getLogs=function(){return this.logArray};var t=0,n=1,i=2,r=3,o=4,s=4,a=0,l=!0,u=!1,d=new Date,c=console,h=function(e,t){if(e<=m()){var s=f(e,t);switch(e){case n:c.error(s);break;case i:c.warn(s);break;case r:c.info(s);break;case o:c.debug(s)}}},f=function(e,t){var n="",i=null;return l&&(i=new Date,n+="["+i.HHMMSSmmm()+"]"),c&&c.showLevel&&(n+="["+p(e)+"]"),u&&(n+="["+new Date(i-d).MMSSmmm()+"]"),Array.apply(null,t).forEach(function(e){n+=e+" "}),n},p=function(e){switch(e){case n:return"ERROR";case i:return"WARN";case r:return"INFO";case o:return"DEBUG";default:return""}},m=function(){return a},g=function(){return c};return{NONE:t,ERROR:n,WARN:i,INFO:r,DEBUG:o,ALL:s,getLevel:m,getLogger:g,setLevel:function(e){a=e},setLogger:function(t){switch(t){case"log4javascript":var n=new log4javascript.PopUpAppender,i=new log4javascript.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m%n");n.setLayout(i),c.addAppender(n),c.setLevel(log4javascript.Level.ALL),c.initialized=!0;break;case"memory":c=new e;break;case"console":c=console;break;default:c=null}},error:function(){h.call(this,n,arguments)},warn:function(){h.call(this,i,arguments)},info:function(){h.call(this,r,arguments)},log:function(){h.call(this,o,arguments)}}},m.utils.DebugController=function(){"use strict";var e={isInDebug:!1,level:0,loggerType:"console"},t=function(t){t.altKey!==!0||t.ctrlKey!==!0||t.shiftKey!==!0||68!==t.keyCode&&90!==t.keyCode||(e.isInDebug?(e.isInDebug=!1,console.log("hasplayer.js debug OFF"),90===t.keyCode&&n(this.debug.getLogger().getLogs()),this.debug.setLevel(e.level),this.debug.setLogger(e.loggerType)):(e.isInDebug=!0,console.log("hasplayer.js debug ON"),e.level=this.debug.getLevel(),this.debug.setLevel(68===t.keyCode?4:3),this.debug.setLogger(68===t.keyCode?"console":"memory")))},n=function(e){if(e&&e.length>0){var t="hasplayer_logs.txt",n=JSON.stringify(e,null,"\r\n"),i=new Blob([n],{type:"text/json"});if(navigator.msSaveBlob)navigator.msSaveBlob(i,t);else{var r=document.createEvent("MouseEvents"),o=document.createElement("a");o.download=t,o.href=window.URL.createObjectURL(i),o.dataset.downloadurl=["text/json",o.download,o.href].join(":"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}}};return{debug:void 0,setup:function(){window.addEventListener("keydown",t.bind(this))}}},m.utils.DebugController.prototype={constructor:m.utils.DebugController},m.dependencies.ErrorHandler=function(){"use strict";return{eventBus:void 0,debug:void 0,sendWarning:function(e,t,n){
this.debug.warn("[Warn] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t")),this.eventBus.dispatchEvent({type:"warning",data:{code:e,message:t,data:n}})},sendError:function(e,t,n){this.debug.error("[Error] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t")),this.eventBus.dispatchEvent({type:"error",data:{code:e,message:t,data:n}})}}},m.dependencies.ErrorHandler.prototype={constructor:m.dependencies.ErrorHandler},m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR="INTERNAL_ERROR",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED",m.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE="CAPABILITY_ERR_MEDIASOURCE",m.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS="CAPABILITY_ERR_MEDIAKEYS",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE="MEDIA_ERR_CREATE_MEDIASOURCE",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED="MEDIA_ERR_CODEC_UNSUPPORTED",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER="MEDIA_ERR_CREATE_SOURCEBUFFER",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER="MEDIA_ERR_APPEND_SOURCEBUFFER",m.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER="MEDIA_ERR_REMOVE_SOURCEBUFFER",m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE="MANIFEST_ERR_PARSE",m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM="MANIFEST_ERR_NO_STREAM",m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO="MANIFEST_ERR_NO_VIDEO",m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO="MANIFEST_ERR_NO_AUDIO",m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_TEXT="MANIFEST_ERR_NO_TEXT",m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST="DOWNLOAD_ERR_MANIFEST",m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX="DOWNLOAD_ERR_SIDX",m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT="DOWNLOAD_ERR_INIT",m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT="DOWNLOAD_ERR_CONTENT",m.dependencies.ErrorHandler.prototype.CC_ERR_PARSE="CC_ERR_PARSE",m.dependencies.ErrorHandler.prototype.HLS_INVALID_PACKET_ERROR="HLS_INVALID_PACKET_ERROR",m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR="HLS_DEMUX_ERROR",m.dependencies.ErrorHandler.prototype.HLS_INVALID_KEY_ERROR="HLS_INVALID_KEY_ERROR",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR="MEDIA_KEYERR",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN="MEDIA_KEYERR_UNKNOWN",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT="MEDIA_KEYERR_CLIENT",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE="MEDIA_KEYERR_SERVICE",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT="MEDIA_KEYERR_OUTPUT",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE="MEDIA_KEYERR_HARDWARECHANGE",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN="MEDIA_KEYERR_DOMAIN",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_EXPIRED="MEDIA_KEYERR_EXPIRED",m.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED="MEDIA_KEYSYSERR_ACCESS_DENIED",m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN="MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN",m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE="MEDIA_KEYMESSERR_NO_CHALLENGE",m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR="MEDIA_KEYMESSERR_LICENSER_ERROR",m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION="MEDIA_KEYMESSERR_NO_SESSION",m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE="MEDIA_KEYERR_SERVER_CERTIFICATE",m.dependencies.ErrorHandler.prototype.DOM_ERR_INDEX_SIZE=1,m.dependencies.ErrorHandler.prototype.DOM_ERR_HIERARCHY_REQUEST=3,m.dependencies.ErrorHandler.prototype.DOM_ERR_WRONG_DOCUMENT=4,m.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_CHARACTER=5,m.dependencies.ErrorHandler.prototype.DOM_ERR_NO_MODIFICATION_ALLOWED=7,m.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_FOUND=8,m.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_SUPPORTED=9,m.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_STATE=11,m.dependencies.ErrorHandler.prototype.DOM_ERR_SYNTAX=12,m.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_MODIFICATION=13,m.dependencies.ErrorHandler.prototype.DOM_ERR_NAMESPACE=14,m.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_ACCESS=15,m.dependencies.ErrorHandler.prototype.DOM_ERR_SECURITY=18,m.dependencies.ErrorHandler.prototype.DOM_ERR_NETWORK=19,m.dependencies.ErrorHandler.prototype.DOM_ERR_ABORT=20,m.dependencies.ErrorHandler.prototype.DOM_ERR_URL_MISMATCH=21,m.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED=22,m.dependencies.ErrorHandler.prototype.DOM_ERR_TIMEOUT=23,m.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_NODE_TYPE=24,m.dependencies.ErrorHandler.prototype.DOM_ERR_DATA_CLONE=25,m.utils.EventBus=function(){"use strict";var e,t=function(t,n){var i=(n?"1":"0")+t;return i in e||(e[i]=[]),e[i]},n=function(){e={}};return n(),{addEventListener:function(e,n,i){var r=t(e,i),o=r.indexOf(n);o===-1&&r.push(n)},removeEventListener:function(e,n,i){var r=t(e,i),o=r.indexOf(n);o!==-1&&r.splice(o,1)},dispatchEvent:function(e){var n=t(e.type,!1).slice(),i=0;for(i=0;i<n.length;i+=1)n[i].call(this,e);return!e.defaultPrevented}}},m.dependencies.EventController=function(){"use strict";var e=[],t=[],n=[],i=null,r=100,o=r/1e3,s="urn:mpeg:dash:event:2012",a=1,l=function(){null!==i&&(clearInterval(i),i=null),e=null,t=null,n=null},u=function(){null!==i&&(clearInterval(i),i=null)},d=function(){var e=this;e.debug.log("[EventController] Start Event Controller"),isNaN(r)||(i=setInterval(f.bind(this),r))},c=function(t){var n=this;e=[],t&&t.length>0&&(e=t),n.debug.log("[EventController] Added "+t.length+" inline events")},h=function(e){var n,i=this,r=0;for(r=0;r<e.length;r++)n=e[r],t[n.id]=n,i.debug.log("[EventController] Add inband event with id "+n.id)},f=function(){p.call(this,t),p.call(this,e),m.call(this)},p=function(e){var t,i,r=this,l=this.videoModel.getCurrentTime(),u=0;if(e)for(u=0;u<e.length;u++)i=e[u],void 0!==i&&(t=i.presentationTime/i.eventStream.timescale,(0===t||t<=l&&t+o>l)&&(r.debug.log("[EventController] Start Event at "+l),i.duration>0&&n.push(i),i.eventStream.schemeIdUri===s&&i.eventStream.value===a&&g.call(this),e.splice(u,1)))},m=function(){var e,t,i=this,r=0;if(n)for(e=this.videoModel.getCurrentTime(),r=0;r<n.length;r++)t=n[r],null!==t&&(t.duration+t.presentationTime)/t.eventStream.timescale<e&&(i.debug.log("[EventController] Remove Event at time "+e),t=null,n.splice(r,1))},g=function(){var e=this,t=e.manifestModel.getValue(),n=t.mpdUrl;t.hasOwnProperty("Location")&&(n=t.Location),e.debug.log("[EventController] Refresh manifest @ "+n),e.manifestLoader.load(n).then(function(t){e.manifestModel.setValue(t)})};return{manifestModel:void 0,manifestLoader:void 0,debug:void 0,system:void 0,videoModel:void 0,addInlineEvents:c,addInbandEvents:h,reset:l,clear:u,start:d}},m.dependencies.EventController.prototype={constructor:m.dependencies.EventController},m.dependencies.FragmentController=function(){"use strict";var e=[],t=function(t){var n=e.length,i=0;for(i=0;i<n;i+=1)if(e[i].getContext()===t)return e[i];return null},n=function(){var t=!0,n=e.length,i=0;for(i=0;i<n;i+=1)if(!e[i].isReady()){t=!1;break}return t},i=function(){var t=0;for(t=0;t<e.length;t+=1)e[t].executeCurrentRequest()};return{system:void 0,debug:void 0,process:function(e){var t=null;return null!==e&&void 0!==e&&e.byteLength>0&&(t=new Uint8Array(e)),u.when(t)},attachBufferController:function(n){var i;return n?(i=t(n),i||(i=this.system.getObject("fragmentModel"),i.setContext(n),e.push(i)),i):null},detachBufferController:function(t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},onBufferControllerStateChange:function(){n()&&i.call(this)},isFragmentLoadedOrPending:function(e,n){var i,r=t(e);return!!r&&(i=r.isFragmentLoadedOrPending(n))},getPendingRequests:function(e){var n=t(e);return n?n.getPendingRequests():null},getLoadingRequests:function(e){var n=t(e);return n?n.getLoadingRequests():null},isInitializationRequest:function(e){return e&&e.type&&"initialization segment"===e.type.toLowerCase()},getLoadingTime:function(e){var n=t(e);return n?n.getLoadingTime():null},getExecutedRequestForTime:function(e,t){return e?e.getExecutedRequestForTime(t):null},removeExecutedRequest:function(e,t){e&&e.removeExecutedRequest(t)},removeExecutedRequestsBeforeTime:function(e,t){e&&e.removeExecutedRequestsBeforeTime(t)},clearExecutedRequests:function(e){e&&e.clearExecutedRequests()},cancelPendingRequestsForModel:function(e){e&&e.cancelPendingRequests()},abortRequestsForModel:function(e){e&&e.abortRequests()},prepareFragmentForLoading:function(e,n,i,r,o,s){var a=t(e);return a&&n?(a.addRequest(n),a.setCallbacks(i,r,o,s),!0):null}}},m.dependencies.FragmentController.prototype={constructor:m.dependencies.FragmentController},m.dependencies.FragmentLoader=function(){"use strict";var e,t=2,n=500,i=t,r=n,o=0,s=[],a=function(e){var t=new XMLHttpRequest,n=!1;t.open("HEAD",e.url,!0),t.onload=function(){t.status<200||t.status>399||(n=!0,e.deferred.resolve(e))},t.onloadend=t.onerror=function(){n||e.deferred.reject(t)},t.send()},l=function(t){var n=u.defer(),i=new XMLHttpRequest,r=null,o=!0,a=!0,l=null,d=this;return s.push(i),t.requestStartDate=new Date,r=d.metricsModel.addHttpRequest(t.streamType,null,t.type,t.url,null,t.range,t.requestStartDate,null,null,null,null,t.duration,t.startTime,t.quality),d.metricsModel.appendHttpTrace(r,t.requestStartDate,t.requestStartDate.getTime()-t.requestStartDate.getTime(),[0]),l=t.requestStartDate,i.open("GET",d.tokenAuthentication.addTokenAsQueryArg(t.url),!0),i.responseType="arraybuffer",i=d.tokenAuthentication.setTokenInRequestHeader(i),t.range&&i.setRequestHeader("Range","bytes="+t.range),i.onprogress=function(e){var n=new Date;o&&(o=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(t.firstByteDate=n,r.tresponse=n)),e.lengthComputable&&(t.bytesLoaded=e.loaded,t.bytesTotal=e.total),d.metricsModel.appendHttpTrace(r,n,n.getTime()-l.getTime(),[t.bytesLoaded?t.bytesLoaded:0]),l=n,d.notify(m.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,{request:t,httpRequestMetrics:r,lastTraceTime:l})},i.onload=function(){if(!(i.status<200||i.status>399)){a=!1;var o,s,u=new Date,c=i.response,h=c?c.byteLength:0;t.firstByteDate||(t.firstByteDate=t.requestStartDate),t.requestEndDate=u,o=t.firstByteDate.getTime()-t.requestStartDate.getTime(),s=t.requestEndDate.getTime()-t.firstByteDate.getTime(),d.debug.log("[FragmentLoader]["+e+"] Loaded: "+t.url+" ("+i.status+", "+o+"ms, "+s+"ms)"),r.tresponse=t.firstByteDate,r.tfinish=t.requestEndDate,r.responsecode=i.status,r.bytesLength=h,d.metricsModel.appendHttpTrace(r,u,u.getTime()-l.getTime(),[h]),l=u,n.resolve({data:c,request:t})}},i.onabort=function(){var e,n,o=new Date;i.aborted=!0,0!==r.trace.length&&(e=r.trace[r.trace.length-1],n=e.b[0],t.requestEndDate=o,r.tresponse=t.firstByteDate,r.tfinish=t.requestEndDate,r.responsecode=i.status,r.bytesLength=n)},i.onloadend=i.onerror=function(){s.indexOf(i)!==-1&&(s.splice(s.indexOf(i),1),a&&(a=!1,r.responsecode=i.status,n.reject(i)))},d.debug.log("[FragmentLoader]["+e+"] Load: "+t.url),i.send(),n.promise},d=function(e,t){var n=this;l.call(n,e).then(function(e){o=0,t.resolve(e)},function(s){s.aborted?(e.status=0,e.aborted=!0,t.reject(e)):o>=i?(o=0,e.status=s.status,t.reject(e)):setTimeout(function(){o++,d.call(n,e,t)},r)})};return{metricsModel:void 0,debug:void 0,tokenAuthentication:void 0,config:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){i=this.config.getParam("FragmentLoader.RetryAttempts","number",t),r=this.config.getParam("FragmentLoader.RetryInterval","number",n)},setType:function(t){e=t},load:function(e){var t=u.defer();return"Initialization Segment"===e.type&&e.data?t.resolve(e,{data:e.data}):d.call(this,e,t),t.promise},abort:function(){var t=0;for(t=0;t<s.length;t+=1)this.debug.log("[FragmentLoader]["+e+"] Abort XHR "+(s[t].responseURL?s[t].responseURL:"")),s[t].abort()},checkForExistence:function(e){return e?(e.deferred=u.defer(),a.call(this,e),e.deferred.promise):u.when(null)}}},m.dependencies.FragmentLoader.prototype={constructor:m.dependencies.FragmentLoader},m.dependencies.FragmentLoader.eventList={ENAME_LOADING_PROGRESS:"loadingProgress"},m.dependencies.FragmentModel=function(){"use strict";var e,t,n,i,r,o,s=[],a=[],l=[],u=2,d=function(r){var o,a,u=this;t.call(e,r),o=function(t,i){l.splice(l.indexOf(t),1),s.push(t),n.call(e,t,i),t.deferred=null},a=function(t){l.splice(l.indexOf(t),1),i.call(e,t),t.deferred=null},u.fragmentLoader.load(r).then(o.bind(e,r),a.bind(e,r))},c=function(e,t){var n=function(e,n){return e[t]<n[t]?-1:e[t]>n[t]?1:0};e.sort(n)},h=function(e){var t=s.indexOf(e);t!==-1&&s.splice(t,1)};return{system:void 0,debug:void 0,fragmentLoader:void 0,setContext:function(t){e=t},getContext:function(){return e},setType:function(e){o=e,this.fragmentLoader&&this.fragmentLoader.setType(e)},addRequest:function(e){if(e){if(this.isFragmentLoadedOrPending(e))return;a.push(e),c.call(this,a,"index")}},setCallbacks:function(e,o,s,a){t=e,r=a,i=s,n=o},isFragmentLoadedOrPending:function(e){var t,n=!1,i=0;for(i=0;i<s.length;i++)if(t=s[i],e.startTime===t.startTime||"complete"===t.action&&e.action===t.action){if(e.url===t.url){n=!0;break}s.splice(i,1),i--}if(!n)for(i=0;i<a.length;i++)t=a[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);if(!n)for(i=0;i<l.length;i++)t=l[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},isReady:function(){return e.isReady()},getPendingRequests:function(){return a},getLoadingRequests:function(){return l},getLoadingTime:function(){var e,t,n=0;for(t=s.length-1;t>=0;t-=1)if(e=s[t],e.requestEndDate instanceof Date&&e.firstByteDate instanceof Date){n=e.requestEndDate.getTime()-e.firstByteDate.getTime();break}return n},getExecutedRequestForTime:function(e){var t,n=s.length-1,i=NaN,r=NaN,o=null;for(t=n;t>=0;t-=1)if(o=s[t],i=o.startTime,r=i+o.duration,!isNaN(i)&&!isNaN(r)&&e>i&&e<r)return o;return null},getExecutedRequestForQualityAndIndex:function(e,t){var n,i=s.length-1,r=null;for(n=i;n>=0;n-=1)if(r=s[n],r.quality===e&&r.index===t)return r;return null},removeExecutedRequest:function(e){h.call(this,e)},removeExecutedRequestsBeforeTime:function(e){var t,n=s.length-1,i=NaN,r=null;for(t=n;t>=0;t-=1)r=s[t],i=r.startTime,!isNaN(i)&&i<e&&h.call(this,r)},clearExecutedRequests:function(){s=[]},cancelPendingRequests:function(){a=[]},abortRequests:function(){this.fragmentLoader.abort(),l=[]},executeCurrentRequest:function(){var t,n=this;if(0!==a.length&&!(l.length>=u))switch(t=a.shift(),t.action){case"complete":s.push(t),r.call(e,t);break;case"download":l.push(t),d.call(n,t);break;default:this.debug.log("Unknown request action."),t.deferred?(t.deferred.reject(),t.deferred=null):i.call(e,t)}}}},m.dependencies.FragmentModel.prototype={constructor:m.dependencies.FragmentModel},m.dependencies.FragmentInfoController=function(){"use strict";var e,t,n,i,r="READY",o=r,s=!1,a=!1,l=null,d=3,c=!1,h=0,f=null,p=null,g=0,y=NaN,v=function(){this.debug.info("[FragmentInfoController]["+e+"] sendRequest"),T.call(this)&&null!==l&&this.fragmentController.onBufferControllerStateChange()},_=function(){s&&a&&(f=(new Date).getTime(),p=n,this.debug.info("[FragmentInfoController]["+e+"] startPlayback"),I.call(this))},b=function(){var t,r=this;a!==!0&&(a=!0,r.debug.info("[FragmentInfoController]["+e+"] START"),t=i.getCurrentRepresentation().segments,t?(n=t[t.length-1].presentationStartTime-t[t.length-1].duration,_.call(r)):r.indexHandler.updateSegmentList(i.getCurrentRepresentation()).then(function(e){t=e,n=t[t.length-1].presentationStartTime-t[t.length-1].duration,_.call(r)}))},E=function(){a&&(this.debug.info("[FragmentInfoController]["+e+"] STOP"),clearTimeout(t),a=!1,f=null,p=null,this.fragmentController.abortRequestsForModel(l))},x=function(t){this.debug.info("[FragmentInfoController]["+e+"] Load request ",null!==t.url?t.url:t.quality)},S=function(t,r){var o,s,a=this;y=t.duration,c=!1,h=0,this.debug.log("[FragmentInfoController]["+e+"] FragmentInfo loaded ",t.url);try{this.fragmentController.process(r.data,t,i.getCurrentRepresentation()).then(function(){o=((new Date).getTime()-f)/1e3,s=n+y-p,g=s-o>0?s-o:0,M.call(a,g)})}catch(l){this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing fragment info segment",l.message)}},T=function(){return a},w=function(e){if(T.call(this)){if(e.aborted)return void I.call(this);h+=1,h===d?this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download fragmentInfo segment",{url:e.url,status:e.status}):this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download fragmentInfo segment",{url:e.url,status:e.status})}},D=function(t){var r=this;if(null!==t&&t.action===t.ACTION_COMPLETE)return void E.call(r);if(null!==t){if(n=t.startTime+t.duration,t=r.indexHandler.getFragmentInfoRequest(t),r.fragmentController.isFragmentLoadedOrPending(r,t))return void r.indexHandler.getNextSegmentRequest(i.getCurrentRepresentation()).then(D.bind(r));r.debug.log("[FragmentInfoController]["+e+"] onFragmentRequest "+t.url),r.fragmentController.prepareFragmentForLoading(r,t,x,S,w,null),v.call(r)}else r.debug.log("[FragmentInfoController]["+e+"] bufferFragmentInfo failed")},M=function(n){var i=this,r=Math.round(Math.min(1e3*n,2e3));i.debug.log("[FragmentInfoController]["+e+"] Check buffer delta = "+r+" ms"),clearTimeout(t),t=setTimeout(function(){t=null,I.call(i)},r)},I=function(){var t,r=this;T.call(r)&&(r.debug.log("[FragmentInfoController]["+e+"] Start buffering process..."),t=n,r.debug.log("[FragmentInfoController]["+e+"] loadNextFragment for time: "+t),this.indexHandler.getSegmentRequestForTime(i.getCurrentRepresentation(),t).then(D.bind(this)))};return{sourceBufferExt:void 0,abrController:void 0,debug:void 0,system:void 0,errHandler:void 0,abrRulesCollection:void 0,indexHandler:void 0,initialize:function(e,t,n){var r=this;r.debug.log("[FragmentInfoController]["+e+"] Initialize"),i=n,r.setType(e),r.setFragmentController(t),s=!0},setType:function(t){e=t,void 0!==this.indexHandler&&(this.indexHandler.setType(t),this.indexHandler.setIsDynamic(!0))},isReady:function(){return o===r},setFragmentController:function(t){t&&(this.fragmentController=t,l=this.fragmentController.attachBufferController(this),l.setType(e))},reset:function(){var e=this;return E.call(e),l&&(e.fragmentController.abortRequestsForModel(l),e.fragmentController.detachBufferController(l),l=null),u.when(null)},start:b,stop:E}},m.dependencies.FragmentInfoController.prototype={constructor:m.dependencies.FragmentInfoController},m.dependencies.ManifestLoader=function(){"use strict";var e=2,t=500,n=e,i=t,r=null,o=function(e){var t,n="",i=0;if(e.length<1)return e;if(15360!==e.charCodeAt(0))return e;for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),n+=String.fromCharCode((255&t)<<8|(65280&t)>>8);return n},s=function(e){var t=null;return e.indexOf("/")!==-1&&(e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},a=function(){null!==r&&r.abort(),this.parser.abort()},l=function(e){var t=s(e),a=u.defer(),l=this;return r=new m.dependencies.XHRLoader,r.initialize(null,n,i),r.load(e).then(function(n){n.responseURL&&(l.debug.log("[ManifestLoader] Redirect URL: "+n.responseURL),t=s(n.responseURL)),l.tokenAuthentication.checkRequestHeaderForToken(n),l.metricsModel.addHttpRequest("stream",null,"MPD",e,null,null,n.startDate,n.endDate,n.status,null,null),l.parser.parse(o(n.responseText),t).then(function(t){t?(t.mpdUrl=e,t.mpdLoadedTime=n.endDate,l.metricsModel.addManifestUpdate("stream",t.type,n.startDate,n.endDate,t.availabilityStartTime),a.resolve(t)):a.reject()},function(t){t&&t.name&&t.message?a.reject(t):(l.debug.error("[ManifestLoader] Manifest parsing error"),a.reject({name:m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse manifest",data:{url:e}}))})},function(t){!t||t.aborted?a.reject():(l.metricsModel.addHttpRequest("stream",null,"MPD",e,null,null,t.startDate,t.endDate,t.status,null,null),a.reject({name:m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download manifest",data:{url:e,status:t.status}}))}),a.promise};return{debug:void 0,parser:void 0,config:void 0,metricsModel:void 0,tokenAuthentication:void 0,setup:function(){n=this.config.getParam("ManifestLoader.RetryAttempts","number",e),i=this.config.getParam("ManifestLoader.RetryInterval","number",t)},load:l,abort:a}},m.dependencies.ManifestLoader.prototype={constructor:m.dependencies.ManifestLoader},m.dependencies.ManifestUpdater=function(){"use strict";var e,t=NaN,n=null,i=!1,r=function(){null!==n&&(clearInterval(n),n=null)},o=function(){r.call(this),isNaN(t)||(this.debug.log("Refresh manifest in "+t+" seconds."),n=setTimeout(a.bind(this),Math.min(1e3*t,Math.pow(2,31)-1),this))},s=function(){var e,n,i=this,r=i.manifestModel.getValue();void 0!==r&&null!==r&&(n=i.manifestExt.getRefreshDelay(r),e=((new Date).getTime()-r.mpdLoadedTime.getTime())/1e3,t=Math.max(n-e,0),o.call(i))},a=function(){var t,n,r=this;u.when(!e||e.promise).then(function(){e=u.defer(),t=r.manifestModel.getValue(),n=t.mpdUrl,t.hasOwnProperty("Location")&&(n=t.Location),r.manifestLoader.load(n).then(function(e){r.manifestModel.setValue(e),r.debug.log("Manifest has been refreshed."),i||s.call(r)})})},l=function(){e&&e.resolve()};return{debug:void 0,system:void 0,manifestModel:void 0,manifestExt:void 0,manifestLoader:void 0,setup:function(){s.call(this),this.system.mapHandler("streamsComposed",void 0,l.bind(this))},start:function(){i=!1,s.call(this)},stop:function(){i=!0,r.call(this)}}},m.dependencies.ManifestUpdater.prototype={constructor:m.dependencies.ManifestUpdater},m.models.ManifestModel=function(){"use strict";var e=null;return{system:void 0,eventBus:void 0,getValue:function(){return e},setValue:function(t){e=t,e&&this.system.notify("manifestUpdated"),null!==e&&this.eventBus.dispatchEvent({type:"manifestLoaded",data:t})}}},m.models.ManifestModel.prototype={constructor:m.models.ManifestModel},m.dependencies.MediaSourceExtensions=function(){},m.dependencies.MediaSourceExtensions.prototype={constructor:m.dependencies.MediaSourceExtensions,createMediaSource:function(){"use strict";var e="WebKitMediaSource"in window,t="MediaSource"in window;return t?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){"use strict";return t.setSource(window.URL.createObjectURL(e)),!0},detachMediaSource:function(e){"use strict";return e.setSource(null),!0},setDuration:function(e,t){"use strict";var n,i=!1;if("open"!==e.readyState)return e.duration;for(n=0;n<e.sourceBuffers.length;n++)if(e.sourceBuffers[n].updating){i=!0;break}return i||(e.duration=t),e.duration},signalEndOfStream:function(e){"use strict";var t=e.sourceBuffers,n=t.length,i=0;if("open"===e.readyState){for(i;i<n;i++){if(t[i].updating)return;if(0===t[i].buffered.length)return}return e.endOfStream(),!0}}},m.dependencies.MetricsExtensions=function(){"use strict";var e={42:"Baseline","4D":"Main",58:"Extended",64:"High"},t=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):"text"===t?(this.manifestExt.getIsText(e),"text"===e.type&&(n=!0)):n=!1,n},i=m.utils.copyMethods(p.dependencies.DashMetricsExtensions);return i.config=void 0,i.getDuration=function(){var e=this,t=e.manifestModel.getValue(),n=t?t.Period.duration:null;return n!==1/0?n:-1},i.getFormatForType=function(e){var t,n=this,i=n.manifestModel.getValue(),r=0;for(r=0;r<i.Period.AdaptationSet.length;r++)if(t=i.Period.AdaptationSet[r],t.type===e)return t.mimeType;return null},i.getCodecForType=function(e){var t,n=this,i=n.manifestModel.getValue(),r=0;for(r=0;r<i.Period.AdaptationSet.length;r++)if(t=i.Period.AdaptationSet[r],t.type===e||t.contentType===e)return t.Representation[0].codecs;return null},i.getVideoWidthForRepresentation=function(e){var n,i,r=this,o=r.manifestModel.getValue();return o?(i=o.Period_asArray,n=t.call(r,i,e),null===n?null:n.width):null},i.getVideoHeightForRepresentation=function(e){var n,i,r=this,o=r.manifestModel.getValue();return o?(i=o.Period_asArray,n=t.call(r,i,e),null===n?null:n.height):null},i.getCodecsForRepresentation=function(e){var n,i=this,r=i.manifestModel.getValue(),o=r.Period_asArray;return n=t.call(i,o,e),null===n?null:n.codecs},i.getH264ProfileLevel=function(t){if(t.indexOf("avc1")<0)return"";var n=e[t.substr(5,2)],i=parseInt(t.substr(9,2),16)/10;return n+"@"+i.toString()},i.getBitratesForType=function(e,t){var i,r,o,s,a,l,u,d,c=this,h=c.manifestModel.getValue(),f=null,p=[];if(!(null!==h&&void 0!==h||null!==t&&void 0!==t))return null;if(t)f=t;else for(i=h.Period_asArray,o=0;o<i.length;o+=1)for(r=i[o],s=r.AdaptationSet_asArray,u=0;u<s.length;u+=1)if(f=s[u],n.call(c,s[u],e)){f=s[u];break}if(null!==f)for(f=c.manifestExt.processAdaptation(f),l=f.Representation_asArray,d=0;d<l.length;d+=1)a=l[d],p.push(a.bandwidth);return p},i.getBitratesWithResolutionForType=function(e){var t,i,r,o,s,a,l,u,d,c=this,h=c.manifestModel.getValue(),f=[];if(null===h||void 0===h)return null;for(t=h.Period_asArray,r=0;r<t.length;r+=1)for(i=t[r],s=i.AdaptationSet_asArray,u=0;u<s.length;u+=1)if(o=s[u],n.call(c,o,e)){for(o=c.manifestExt.processAdaptation(o),l=o.Representation_asArray,d=0;d<l.length;d+=1){a=l[d];var p={bitrate:a.bandwidth,width:a.width,height:a.height};f.push(p)}return f}return f},i},m.dependencies.MetricsExtensions.prototype={constructor:m.dependencies.MetricsExtensions},m.models.MetricsModel=function(){"use strict";return{system:void 0,eventBus:void 0,config:void 0,streamMetrics:{},metricsChanged:function(){this.eventBus.dispatchEvent({type:"metricsChanged",data:{}})},metricChanged:function(e){this.eventBus.dispatchEvent({type:"metricChanged",data:{stream:e}}),this.metricsChanged()},metricUpdated:function(e,t,n){this.eventBus.dispatchEvent({type:"metricUpdated",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},metricAdded:function(e,t,n){this.eventBus.dispatchEvent({type:"metricAdded",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},clearCurrentMetricsForType:function(e){var t=this.config.getParamFor(e,"ABR.keepBandwidthCondition","boolean",!0);for(var n in this.streamMetrics[e])!this.streamMetrics[e].hasOwnProperty(n)||"HttpList"===n&&t!==!1||(this.streamMetrics[e][n]=[]);this.metricChanged(e)},clearAllCurrentMetrics:function(){var e=this;for(var t in this.streamMetrics)this.streamMetrics.hasOwnProperty(t)&&"stream"===t&&delete this.streamMetrics[t];this.metricsChanged.call(e)},getReadOnlyMetricsFor:function(e){return this.streamMetrics.hasOwnProperty(e)?this.streamMetrics[e]:null},getMetricsFor:function(e){var t;return this.streamMetrics.hasOwnProperty(e)?t=this.streamMetrics[e]:(t=this.system.getObject("metrics"),this.streamMetrics[e]=t),t},addTcpConnection:function(e,t,n,i,r,o){var s=new m.vo.metrics.TCPConnection;return s.tcpid=t,s.dest=n,s.topen=i,s.tclose=r,s.tconnect=o,this.getMetricsFor(e).TcpList.push(s),this.metricAdded(e,"TcpConnection",s),s},addHttpRequest:function(e,t,n,i,r,o,s,a,l,u,d,c,h,f){var p=new m.vo.metrics.HTTPRequest,g=this.getMetricsFor(e).HttpList;return p.stream=e,p.tcpid=t,p.type=n,p.url=i,p.actualurl=r,p.range=o,p.trequest=s,p.tresponse=a,p.tfinish=l,p.responsecode=u,p.interval=d,p.mediaduration=c,p.startTime=h,p.quality=f,g.push(p),this.metricAdded(e,"HttpRequest",p),g.length>10&&g.shift(),p},appendHttpTrace:function(e,t,n,i){var r=new m.vo.metrics.HTTPRequest.Trace;return r.s=t,r.d=n,r.b=i,e.trace.push(r),this.metricUpdated(e.stream,"HttpRequestTrace",e),r},addRepresentationSwitch:function(e,t,n,i,r){var o=new m.vo.metrics.RepresentationSwitch;return o.t=t,o.mt=n,o.to=i,o.lto=r,this.getMetricsFor(e).RepSwitchList.push(o),this.metricAdded(e,"RepresentationSwitch",o),o},addBufferedSwitch:function(e,t,n,i){var r=new m.vo.metrics.BufferedSwitch;return r.mt=t,r.to=n,r.lto=i,this.getMetricsFor(e).BufferedSwitchList.push(r),this.metricAdded(e,"BufferedSwitch",r),r},addState:function(e,t,n,i){var r=new m.vo.metrics.State;return r.current=t,r.position=n,r.reason=i,this.metricAdded(e,"State",r),r},addSession:function(e,t,n,i,r){var o=new m.vo.metrics.Session;return o.uri=t,n?o.loopMode=1:o.loopMode=0,o.endTime=i,o.playerType=r,this.metricAdded(e,"Session",o),o},addCondition:function(e,t,n,i,r,o){var s=new m.vo.metrics.Condition;return s.isFullScreen=t,s.windowSize=n+"x"+i,s.fps=o,s.droppedFrames=r,this.metricAdded(e,"Condition",s),s},addMetaData:function(){this.metricAdded(null,"ManifestReady",null)},addBufferLevel:function(e,t,n){var i=new m.vo.metrics.BufferLevel,r=this.getMetricsFor(e).BufferLevel;return i.t=t,i.level=Number(n.toFixed(3)),r.push(i),this.metricAdded(e,"BufferLevel",i),r.length>10&&r.shift(),i},addDVRInfo:function(e,t,n){var i=new m.vo.metrics.DVRInfo,r=this.getMetricsFor(e).DVRInfo;return i.t=t,i.range=n,r.push(i),this.metricAdded(e,"DVRInfo",i),r.length>10&&r.shift(),i},addDroppedFrames:function(e,t){var n=new m.vo.metrics.DroppedFrames,i=this.getMetricsFor(e).DroppedFrames;return n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,n.decodedFrameCount=t.totalVideoFrames,i.length>0&&i[i.length-1]===n?i[i.length-1]:(i.push(n),this.metricAdded(e,"DroppedFrames",n),n)},addPlaybackQuality:function(e,t,n,i){var r=new m.vo.metrics.PlaybackQuality,o=this.getMetricsFor(e).PlaybackQuality;return r.t=t,r.mt=i,r.droppedFrames=n.droppedVideoFrames,r.totalVideoFrames=n.totalVideoFrames,o.length>0&&r.droppedFrames===o[o.length-1].droppedFrames&&r.totalVideoFrames===o[o.length-1].totalVideoFrames?o[o.length-1]:(o.push(r),this.metricAdded(e,"PlaybackQuality",r),o.length>10&&o.shift(),r)},addVideoResolution:function(e,t,n,i,r){var o=new m.vo.metrics.VideoResolution,s=this.getMetricsFor(e).VideoResolution;return o.t=t,o.mt=r,o.width=n,o.height=i,s.length>0&&o.width===s[s.length-1].width&&o.height===s[s.length-1].height?s[s.length-1]:(s.push(o),this.metricAdded(e,"VideoResolution",o),o)},addManifestUpdate:function(e,t,n,i,r,o,s,a,l,u){var d=new m.vo.metrics.ManifestUpdate,c=this.getMetricsFor("stream");return d.streamType=e,d.type=t,d.requestTime=n,d.fetchTime=i,d.availabilityStartTime=r,d.presentationStartTime=o,d.clientTimeOffset=s,d.currentTime=a,d.buffered=l,d.latency=u,c.ManifestUpdate.push(d),this.metricAdded(e,"ManifestUpdate",d),d},updateManifestUpdateInfo:function(e,t){if(e&&t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);this.metricUpdated(e.streamType,"ManifestUpdate",e)}},addManifestUpdatePeriodInfo:function(e,t,n,i,r){var o=new m.vo.metrics.ManifestUpdate.PeriodInfo;return o.id=t,o.index=n,o.start=i,o.duration=r,e.periodInfo.push(o),this.metricUpdated(e.streamType,"ManifestUpdatePeriodInfo",e),o},addManifestUpdateRepresentationInfo:function(e,t,n,i,r,o,s,a){var l=new m.vo.metrics.ManifestUpdate.RepresentationInfo;return l.id=t,l.index=n,l.periodIndex=i,l.streamType=r,l.startNumber=s,l.segmentInfoType=a,l.presentationTimeOffset=o,e.representationInfo.push(l),this.metricUpdated(e.streamType,"ManifestUpdateRepresentationInfo",e),l},addPlayList:function(e,t,n,i){var r=new m.vo.metrics.PlayList,o=this.getMetricsFor(e).PlayList;return r.stream=e,r.start=t,r.mstart=n,r.starttype=i,o.push(r),this.metricAdded(e,"PlayList",r),o.length>10&&o.shift(),r},appendPlayListTrace:function(e,t,n,i,r,o,s,a){var l=new m.vo.metrics.PlayList.Trace;
return l.representationid=t,l.subreplevel=n,l.start=i,l.mstart=r,l.duration=o,l.playbackspeed=s,l.stopreason=a,e.trace.push(l),this.metricUpdated(e.stream,"PlayListTrace",e),e.trace.length>10&&e.trace.shift(),l}}},m.models.MetricsModel.prototype={constructor:m.models.MetricsModel},m.dependencies.Mp4Processor=function(){"use strict";var e=function(e){var t=new E.boxes.MovieHeaderBox,n=e[e.length-1];return t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=n.timescale,t.duration=Math.round(n.duration*n.timescale),t.rate=65536,t.volume=256,t.reserved=0,t.reserved_2=[0,0],t.matrix=[65536,0,0,0,65536,0,0,0,1073741824],t.pre_defined=[0,0,0,0,0,0],t.next_track_ID=n.trackId+1,t.flags=0,t},t=function(e){var t,n,r;return t=new E.boxes.TrackBox,n=new E.boxes.TrackHeaderBox,n.version=1,n.flags=7,n.creation_time=0,n.modification_time=0,n.track_id=e.trackId,n.reserved=0,n.duration=Math.round(e.duration*e.timescale),n.reserved_2=[0,0],n.layer=0,n.alternate_group=0,n.volume=256,n.reserved_3=0,n.matrix=[65536,0,0,0,65536,0,0,0,1073741824],n.width=e.width<<16,n.height=e.height<<16,t.boxes.push(n),r=new E.boxes.MediaBox,r.boxes.push(i(e)),r.boxes.push(o(e)),r.boxes.push(s(e)),t.boxes.push(r),t},n=function(e){var t,n,i,r=0;return t=e.charCodeAt(0)-96<<10,n=e.charCodeAt(1)-96<<5,i=e.charCodeAt(2)-96,r=t|n|i},i=function(e){var t=new E.boxes.MediaHeaderBox;return t.flags=0,t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=e.timescale,t.duration=Math.round(e.duration*e.timescale),t.pad=0,t.language=n(e.language),t.pre_defined=0,t},r=function(e){var t,n=0;for(t=0;t<e.length;t+=1)n|=e.charCodeAt(t)<<8*(e.length-t-1);return n},o=function(e){var t=new E.boxes.HandlerBox;switch(t.version=0,t.pre_defined=0,e.type){case"video":t.handler_type=r(t.HANDLERTYPEVIDEO),t.name=t.HANDLERVIDEONAME;break;case"audio":t.handler_type=r(t.HANDLERTYPEAUDIO),t.name=t.HANDLERAUDIONAME;break;default:t.handler_type=r(t.HANDLERTYPETEXT),t.name=t.HANDLERTEXTNAME}return t.name+="\0",t.reserved=[0,0,0],t.flags=0,t},s=function(e){var t=new E.boxes.MediaInformationBox;switch(e.type){case"video":t.boxes.push(C(e));break;case"audio":t.boxes.push(R(e))}return t.boxes.push(a(e)),t.boxes.push(L(e)),t},a=function(){var e,t,n;return e=new E.boxes.DataInformationBox,t=new E.boxes.DataReferenceBox,t.version=0,t.entry_count=1,t.flags=0,n=new E.boxes.DataEntryUrlBox,n.location="",n.version=0,n.flags=1,t.boxes.push(n),e.boxes.push(t),e},l=function(){var e=new E.boxes.TimeToSampleBox;return e.version=0,e.entry_count=0,e.flags=0,e.entry=[],e},u=function(){var e=new E.boxes.SampleToChunkBox;return e.flags=0,e.version=0,e.entry_count=0,e.entry=[],e},d=function(){var e=new E.boxes.ChunkOffsetBox;return e.version=0,e.entry_count=0,e.flags=0,e.chunk_offset=[],e},c=function(){var e=new E.boxes.SampleSizeBox;return e.version=0,e.flags=0,e.sample_count=0,e.sample_size=0,e},h=function(e){var t,n=new Uint8Array(e.length/2);for(t=0;t<e.length/2;t+=1)n[t]=parseInt(""+e[2*t]+e[2*t+1],16);return n},f=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n},p=function(e){var t,n,i,r,o,s,a,l,u,d=new RegExp("^[A-Z0-9]7","gi"),c=new RegExp("^[A-Z0-9]8","gi");for(t=new E.boxes.AVCConfigurationBox,t.configurationVersion=1,t.lengthSizeMinusOne=3,t.reserved=63,t.SPS_NAL=[],t.PPS_NAL=[],n=new Uint8Array(0),i=e.codecPrivateData,r=i.split("00000001"),r.splice(0,1),o=0,s=0,a=0;a<r.length;a+=1)l=h(r[a]),r[a].match(d)&&(t.SPS_NAL[o++]={NAL_length:l.length,NAL:l},t.AVCProfileIndication=parseInt(r[a].substr(2,2),16),t.profile_compatibility=parseInt(r[a].substr(4,2),16),t.AVCLevelIndication=parseInt(r[a].substr(6,2),16)),r[a].match(c)&&(t.PPS_NAL[s++]={NAL_length:l.length,NAL:l}),u=new Uint8Array(l.length+4),u[3]=l.length,u.set(l,4),n=f(n,u);return t.numOfSequenceParameterSets=o,t.numOfPictureParameterSets=s,t},g=function(e){var t=null;return t=void 0!==e.contentProtection?new E.boxes.EncryptedVideoBox:new E.boxes.AVC1VisualSampleEntryBox,t.data_reference_index=1,t.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t.depth=24,t.reserved=[0,0,0,0,0,0],t.reserved_2=0,t.reserved_3=0,t.pre_defined=0,t.pre_defined_2=[0,0,0],t.pre_defined_3=65535,t.frame_count=1,t.horizresolution=4718592,t.vertresolution=4718592,t.height=e.height,t.width=e.width,t.boxes.push(p(e)),void 0!==e.contentProtection&&t.boxes.push(x(e)),t},y=function(e){var t=new E.boxes.OriginalFormatBox;return t.data_format=r(e.codecs.substring(0,e.codecs.indexOf("."))),t},v=function(){var e=new E.boxes.SchemeTypeBox;return e.flags=0,e.version=0,e.scheme_type=1667591779,e.scheme_version=65536,e},_=function(e){var t=new E.boxes.SchemeInformationBox;return t.boxes.push(b(e)),t},b=function(e){var t=new E.boxes.TrackEncryptionBox;return t.flags=0,t.version=0,t.default_IsEncrypted=1,t.default_IV_size=8,t.default_KID=e.contentProtection&&e.contentProtection.length>0&&e.contentProtection[0]["cenc:default_KID"]?e.contentProtection[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t},x=function(e){var t=new E.boxes.ProtectionSchemeInformationBox;return t.boxes.push(y(e)),t.boxes.push(v()),t.boxes.push(_(e)),t},S=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"avc1":return g(e);default:throw{name:m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Video codec is not supported (MP4)",data:{codec:t}}}},T=function(e){for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t},w=function(e){var t,n,i,r,o,s,a;return t=T(e.codecPrivateData),n=t.length,i=new Uint8Array(2+n),i[0]=5,i[1]=n,i.set(t,2),r=13+i.length,o=new Uint8Array(2+r),o[0]=4,o[1]=r,o[2]=64,o[3]=20,o[3]|=0,o[3]|=1,o[4]=255,o[5]=255,o[6]=255,o[7]=(4278190080&e.bandwidth)>>24,o[8]=(16711680&e.bandwidth)>>16,o[9]=(65280&e.bandwidth)>>8,o[10]=255&e.bandwidth,o[11]=(4278190080&e.bandwidth)>>24,o[12]|=(16711680&e.bandwidth)>>16,o[13]|=(65280&e.bandwidth)>>8,o[14]|=255&e.bandwidth,o.set(i,15),s=3+o.length,a=new Uint8Array(2+s),a[0]=3,a[1]=s,a[2]=(65280&e.trackId)>>8,a[3]=255&e.trackId,a[4]=0,a.set(o,5),a},D=function(e){var t,n,i=null;return i=void 0!==e.contentProtection?new E.boxes.EncryptedAudioBox:new E.boxes.MP4AudioSampleEntryBox,i.reserved=[0,0,0,0,0,0],i.data_reference_index=1,i.reserved_2=[0,0],i.channelcount=e.channels,i.samplesize=16,i.pre_defined=0,i.reserved_3=0,i.samplerate=e.samplingRate<<16,t=new E.boxes.ESDBox,n=w(e),t.ES_tag=n[0],t.ES_length=n[1],t.ES_data=n.subarray(2,n.length),t.version=0,t.flags=0,i.boxes.push(t),void 0!==e.contentProtection&&i.boxes.push(x(e)),i},M=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"mp4a":return D(e);default:throw{name:m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Audio codec is not supported (MP4)",data:{codec:t}}}return null},I=function(e){var t=new E.boxes.SampleDescriptionBox;switch(t.version=0,t.flags=0,e.type){case"video":t.boxes.push(S(e));break;case"audio":t.boxes.push(M(e))}return t},L=function(e){var t=new E.boxes.SampleTableBox;return t.boxes.push(l(e)),t.boxes.push(u(e)),t.boxes.push(d(e)),t.boxes.push(c(e)),t.boxes.push(I(e)),t},C=function(){var e=new E.boxes.VideoMediaHeaderBox;return e.version=0,e.flags=1,e.graphicsmode=0,e.opcolor=[0,0,0],e},R=function(){var e=new E.boxes.SoundMediaHeaderBox;return e.version=0,e.balance=0,e.reserved=0,e.flags=1,e},A=function(){var e=new E.boxes.FileTypeBox;return e.major_brand=1769172790,e.minor_brand=1,e.compatible_brands=[],e.compatible_brands[0]=1769172845,e.compatible_brands[1]=1769172790,e.compatible_brands[2]=1836278888,e},P=function(e){var t,n,i,r=e[e.length-1];for(t=new E.boxes.MovieExtendsBox,i=0;i<e.length;i+=1)r=e[i],n=new E.boxes.TrackExtendsBox,n.version=0,n.flags=0,n.track_ID=r.trackId,n.default_sample_description_index=1,n.default_sample_duration=0,n.default_sample_flags=0,n.default_sample_size=0,t.boxes.push(n);return t},F=function(e){var t,n,i,r=[];for(i=0;i<e.length;i+=1)t=new Uint8Array(e[i].initData),n=new E.boxes.ProtectionSystemSpecificHeaderBox,n.read(t,8,t.length),r.push(n);return r},N=function(n){var i,r,o,s=[];for(i=new E.boxes.MovieBox,i.boxes.push(e(n)),o=0;o<n.length;o+=1)i.boxes.push(t(n[o]));for(i.boxes.push(P(n)),o=0;o<n.length;o++)void 0!==n[o].contentProtection&&(r=this.protectionExt.getSupportedKeySystemsFromContentProtection(n[o].contentProtection),i.boxes.push.apply(i.boxes,F(r)));return s.push(A()),s.push(i),s},B=1,k=function(){var e=new E.boxes.MovieFragmentHeaderBox;return e.version=0,e.flags=0,e.sequence_number=B++,e},O=function(e){var t=new E.boxes.TrackFragmentBox;return t.version=0,t.flags=0,t.boxes.push(U(e)),t.boxes.push(H(e)),t.boxes.push(V(e)),t.boxes.push(j(e)),t},U=function(e){var t=new E.boxes.TrackFragmentHeaderBox;return t.version=0,t.flags=131072,t.track_ID=e.trackId,t},H=function(e){var t=new E.boxes.TrackFragmentBaseMediaDecodeTimeBox;return t.version=1,t.flags=0,t.baseMediaDecodeTime=e.samples.length>0?e.samples[0].dts:0,t},V=function(e){var t,n,i,r,o=new E.boxes.TrackFragmentRunBox;for(n=e.samples[0].cts,i=e.samples[0].duration>0?256:0,o.version=0,o.flags=1|i|512|1024|("video"===e.type?2048:0),o.data_offset=0,o.samples_table=[],o.sample_count=e.samples.length,t=0;t<e.samples.length;t++)r={sample_duration:e.samples[t].duration,sample_size:e.samples[t].size,sample_composition_time_offset:e.samples[t].cts-e.samples[t].dts,sample_flags:e.samples[t].flags},r.sample_composition_time_offset<0&&(o.version=1),o.samples_table.push(r);return o},j=function(e){var t,n=new E.boxes.SampleDependencyTableBox;for(n.version=0,n.flags=0,n.sample_dependency_table=[],t=0;t<e.samples.length;t++)n.sample_dependency_table.push((267386880&e.samples[t].flags)>>20);return n},q=function(e){var t=new E.boxes.MediaDataBox;return t.data=e.data,t},z=function(e){var t,n,i,r,o=[],s=0,a={},l=[],u=0;if(t=new E.boxes.MovieFragmentBox,t.boxes.push(k()),e)for(n=0;n<e.length;n+=1)t.boxes.push(O(e[n]));if(o.push(t),t.computeLength(),i=t.size,r=t.getBoxesByType("traf"),i+=8,e&&e.length&&(l=[e.length]),e)for(n=0;n<e.length;n+=1)r[n].getBoxByType("trun").data_offset=i,i+=e[n].data.length,l[n]=e[n].data,s+=l[n].length;for(a.data=new Uint8Array(s),n=0;n<l.length;n++)a.data.set(l[n],u),u+=l[n].length;return o.push(q(a)),o};return{protectionExt:void 0,generateInitSegment:function(e){var t=new E.boxes.File;return t.boxes=N.call(this,e),E.serialize(t)},generateMediaSegment:function(e){var t=new E.boxes.File;return t.boxes=z.call(this,e),E.serialize(t)},generateInitMediaSegment:function(e){var t=new E.boxes.File;return t.boxes=N.call(this,e),t.boxes=t.boxes.concat(z.call(this,e)),E.serialize(t)}}},m.dependencies.Mp4Processor.prototype={constructor:m.dependencies.Mp4Processor},m.dependencies.Notifier=function(){"use strict";var e,t="observableId",n=0,i=function(){return this[t]||(n+=1,this[t]="_id_"+n),this[t]};return{system:void 0,setup:function(){e=this.system,e.mapValue("notify",this.notify),e.mapValue("subscribe",this.subscribe),e.mapValue("unsubscribe",this.unsubscribe)},notify:function(){var t=arguments[0]+i.call(this),n=new m.vo.Event;n.sender=this,n.type=arguments[0],n.data=arguments[1],n.error=arguments[2],n.timestamp=(new Date).getTime(),e.notify.call(e,t,n)},subscribe:function(t,n,r,o){if(!r&&n[t]&&(r=n[t]=n[t].bind(n)),!n)throw"observer object cannot be null or undefined";if(!r)throw"event handler cannot be null or undefined";t+=i.call(this),e.mapHandler(t,void 0,r,o)},unsubscribe:function(t,n,r){r=r||n[t],t+=i.call(this),e.unmapHandler(t,void 0,r)}}},m.dependencies.Notifier.prototype={constructor:m.dependencies.Notifier},m.dependencies.Parser=function(){"use strict";var e=null,t=function(t,n){if(null===e)if(t.indexOf("SmoothStreamingMedia")>-1&&"undefined"!=typeof this.mssParser)this.system.notify("setContext","MSS"),e=this.mssParser;else if(t.indexOf("#EXTM3U")>-1&&"undefined"!=typeof this.hlsParser)this.system.notify("setContext","HLS"),e=this.hlsParser;else{if(!(t.indexOf("MPD")>-1&&"undefined"!=typeof this.dashParser))return u.reject("manifest cannot be parsed, protocol is unsupported!");this.system.notify("setContext","MPD"),e=this.dashParser}return e.parse(t,n)},n=function(){null!==e&&void 0!==e.abort&&e.abort()},i=function(){e=null};return{debug:void 0,system:void 0,dashParser:void 0,mssParser:void 0,hlsParser:void 0,metricsModel:void 0,parse:t,abort:n,reset:i}},m.dependencies.Parser.prototype={constructor:m.dependencies.Parser},m.dependencies.SourceBufferExtensions=function(){"use strict";this.system=void 0,this.manifestExt=void 0},m.dependencies.SourceBufferExtensions.prototype={constructor:m.dependencies.SourceBufferExtensions,createSourceBuffer:function(e,t){"use strict";var n=null;if(!e)return null;try{n=e.addSourceBuffer(t)}catch(i){if(!this.manifestExt.getIsTextTrack(t))throw i;if("text/vtt"===t||"text/ttml"===t)n=this.system.getObject("textSourceBuffer");else{if("application/ttml+xml+mp4"!==t&&"application/mp4"!==t&&"application/ttml+xml"!==t)throw i;n=this.system.getObject("textTTMLXMLMP4SourceBuffer")}}return n},removeSourceBuffer:function(e,t){"use strict";try{e.removeSourceBuffer(t)}catch(n){}},getBufferRange:function(e,t,n){"use strict";var i,r,o=null,s=0,a=0,l=null,u=null,d=0,c=n||.03;try{o=e.buffered}catch(h){return null}if(o){for(r=0,i=o.length;r<i;r+=1)if(s=o.start(r),a=o.end(r),null===l){if(d=Math.abs(s-t),t>=s&&t<a){l=s,u=a;continue}if(d<=c){l=s,u=a;continue}}else{if(d=s-u,!(d<=c))break;u=a}if(null!==l)return{start:l,end:u}}return null},getAllRanges:function(e){var t=null;try{return t=e.buffered}catch(n){return null}},getBufferLength:function(e,t,n){"use strict";var i,r,o=this;return i=o.getBufferRange(e,t,n),r=null===i?0:i.end-t},waitForUpdateEnd:function(e){"use strict";var t,n=u.defer(),i=50,r=function(){e.updating||(clearInterval(t),n.resolve(!0))},o=function(){e.updating||(e.removeEventListener("updateend",o,!1),n.resolve(!0))};if(!e.updating)return n.resolve(!0),n.promise;if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",o,!1)}catch(s){t=setInterval(r,i)}else t=setInterval(r,i);return n.promise},append:function(e,t,n){var i=u.defer(),r=this;return r.waitForUpdateEnd(e).then(function(){try{"append"in e?e.append(t,n):"appendBuffer"in e&&e.appendBuffer(t),r.waitForUpdateEnd(e,n).then(function(){i.resolve()})}catch(o){i.reject({err:o,data:t})}}),i.promise},remove:function(e,t,n,i,r){var o=u.defer(),s=this;return s.waitForUpdateEnd(e).then(function(){try{t>=0&&t<i&&n>t&&"ended"!==r.readyState&&e.remove(t,n),isNaN(n)&&"ended"!==r.readyState&&e.remove(t),s.waitForUpdateEnd(e).then(function(){o.resolve()})}catch(a){o.reject(a)}}),o.promise},abort:function(e,t){"use strict";try{"open"===e.readyState&&t.abort()}catch(n){}}},Math.sign||(Math.sign=function(e){"use strict";return e<0?-1:0===e?0:1}),m.dependencies.Stream=function(){"use strict";var e,t,n,i,r,o,s,a,l,d,c,h,f,p,g,y,v,_,b,E,x,S,T,w,D,M,I,L,C=null,R=null,A=-1,P=null,F=-1,N=null,B=!1,k=!1,O=null,U=null,H=null,V=-1,j=!0,q=!1,z=!1,Y="und",K="und",W=null,G=-1,X=-1,$="Stopped",Q=1,Z=!1,J=!1,ee=null,te=!0,ne=null,ie=!1,re=-1,oe=-1,se=function(e){this.errHandler.sendError(e.data.code,e.data.message,e.data.data)},ae=function(){q&&(this.debug.info("[Stream] Play."),this.videoModel.play())},le=function(){this.debug.info("[Stream] Pause."),this.videoModel.pause()},ue=function(t,n){q&&(this.debug.info("[Stream] Seek: "+t),this.manifestExt.getIsDynamic(e)&&!ie&&0!==this.videoModel.getCurrentTime()&&ye.call(this),n===!0?(v=t,this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,qe.bind(this)),Ne.call(this,v)):this.videoModel.setCurrentTime(t))},de=function(e){var t=u.defer(),n=this,i=function(){e.removeEventListener("sourceopen",i),e.removeEventListener("webkitsourceopen",i),t.resolve(e)};return e.addEventListener("sourceopen",i,!1),e.addEventListener("webkitsourceopen",i,!1),n.mediaSourceExt.attachMediaSource(e,n.videoModel),t.promise},ce=function(){var n=this,i=[],r=u.defer(),o=function(){R&&i.push(R.reset(z)),O&&i.push(O.reset(z)),P&&i.push(P.reset(z)),U&&i.push(U.reset(z)),N&&i.push(N.reset(z)),H&&i.push(H.reset(z)),u.all(i).then(function(){ee&&(ee.reset(),ee=void 0),t&&n.mediaSourceExt.detachMediaSource(n.videoModel),q=!1,C=null,R=null,P=null,N=null,t=null,e=null,r.resolve()})};return u.when(te).then(function(){o()}),r.promise},he=function(e,n){var i=null,r=null;if(("video"===e.type||"audio"===e.type)&&!this.capabilities.supportsCodec(this.videoModel.getElement(),n))return this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Codec is not supported (HTMLMediaElement)",{codec:n}),null;try{r=this.sourceBufferExt.createSourceBuffer(t,n)}catch(o){return this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER,"Failed to create "+e.type+" source buffer",new m.vo.Error(o.code,o.name,o.message)),null}return i=this.system.getObject("bufferController"),i.initialize(e.type,W,e,r,this.fragmentController,t,ee),"text"===e.type&&r.hasOwnProperty("initialize")&&r.initialize(n,i,e),i},fe=function(e,t){var n=null;return e&&t&&t.type&&(n=this.system.getObject("fragmentInfoController"),n.initialize(t.type,this.fragmentController,e)),n},pe=function(){var t,n,i=null,r=null,o=null,s=this;return t=this.manifestExt.getVideoData(e,W.index),t&&(o=this.manifestExt.getCodec(t),C=this.manifestExt.getContentProtectionData(t)),t=this.manifestExt.getSpecificAudioData(e,W.index,Y),t&&(r=this.manifestExt.getCodec(t)),C?this.capabilities.supportsEncryptedMedia()?I?(i=u.defer(),n={},n[m.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(){s.debug.log("[Stream] ProtectionController initialized"),I.unsubscribe(m.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,n),i.resolve(!0)},I.subscribe(m.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,n),this.debug.log("[Stream] Initialize ProtectionController"),I.init(C,r,o),i.promise):u.when(!0):(this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS,"EME is not supported/enabled",null),u.when(!1)):u.when(!0)},me=function(){var t,n,i,r;if(e){if(te=!1,ee=this.system.getObject("eventController"),t=this.manifestExt.getVideoData(e,W.index),null===t?this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO,"No Video data in manifest"):(Ye.call(this,t),A=this.manifestExt.getDataIndex(t,e,W.index),n=this.manifestExt.getCodec(t),C=this.manifestExt.getContentProtectionData(t),null===n?this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Video codec information not available",{codec:""}):(R=he.call(this,t,n),this.manifestExt.getIsDynamic(e)&&(O=fe.call(this,R,t)))),null===R)return void(te=!0);if(t=this.manifestExt.getSpecificAudioData(e,W.index,Y),null===t)this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO,"No audio data in manifest");else if(Ye.call(this,t),F=this.manifestExt.getDataIndex(t,e,W.index),i=this.manifestExt.getCodec(t),null===i)this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Audio codec information not available",{codec:""});else{if(P=he.call(this,t,i),null===P)return void(te=!0);this.manifestExt.getIsDynamic(e)&&(U=fe.call(this,P,t))}t=this.manifestExt.getSpecificTextData(e,W.index,K),null!==t&&(V=this.manifestExt.getDataIndex(t,e,W.index),r=this.manifestExt.getMimeType(t),null===r?this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_TEXT,"Text codec information not available"):(N=he.call(this,t,r),this.manifestExt.getIsDynamic(e)&&(H=fe.call(this,N,t)))),ee&&ee.addInlineEvents(this.manifestExt.getEventsForPeriod(e,W)),te=!0}},ge=function(){this.debug.log("[Stream] Setting duration: "+W.duration),this.mediaSourceExt.setDuration(t,W.duration),q=!0},ye=function(){"MSS"===e.name&&this.manifestExt.getIsDynamic(e)&&(O&&k===!1&&(k=!0,O.start()),U&&U.start(),H&&B&&H.start())},ve=function(){O&&(k=!1,O.stop()),U&&U.stop(),H&&H.stop()},_e=function(){this.debug.info("[Stream] <video> loadedmetadata event")},be=function(){this.debug.info("[Stream] <video> canplay event")},Ee=function(){this.debug.info("[Stream] <video> playing event"),re=(new Date).getTime()/1e3,oe=this.getVideoModel().getCurrentTime()},xe=function(){this.debug.info("[Stream] <video> loadstart event")},Se=function(){this.debug.info("[Stream] <video> play event"),1!==Q?this.setTrickModeSpeed(1):X>=0?(He.call(this,X),X=-1):Ne.call(this),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"play")},Te=function(){this.debug.info("[Stream] <video> ended event"),this.metricsModel.addState("video","stopped",this.videoModel.getCurrentTime(),1)},we=function(){this.debug.info("[Stream] <video> pause event"),re=-1,oe=-1,this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"pause"),Oe.call(this),"MSS"===e.name&&this.manifestExt.getIsDynamic(e)&&ye.call(this)},De=function(e){var t,n=e.target.error,i="[Stream] <video> error: ";if(n.code!==-1){switch(n.code){case 1:t=m.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED,i+="fetching process aborted";break;case 2:t=m.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK,i+="network error";break;case 3:t=m.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE,i+="media decoding error";break;case 4:t=m.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED,i+="media format not supported";break;case 5:t=m.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,i+="media is encrypted"}z=!0,this.errHandler.sendError(t,i)}},Me=function(){var e=this.videoModel.getCurrentTime();return this.debug.info("[Stream] <video> seeking event: "+e),1!==Q&&e.toFixed(3)!==M.toFixed(3)?void this.setTrickModeSpeed(1):(e=e<this.getStartTime()?this.getStartTime():e,void Ne.call(this,e))},Ie=function(){var e,t,n,i,r,o,s,l,u,d=this,c=.9,h=function(e,t){return d.videoModel.getCurrentTime()===d.getStartTime()||Z?(d.debug.log("[Stream] Trick mode (x"+Q+"): stop"),void(Z&&(l=document.createEvent("Event"),l.initEvent("ended",!0,!0),d.videoModel.getElement().dispatchEvent(l)))):(t<d.getStartTime()?t=d.getStartTime():t>=d.videoModel.getDuration()&&(t=d.videoModel.getDuration()-S,Z=!0),e>0&&d.debug.log("[Stream] Trick mode (x"+Q+"): wait "+e.toFixed(3)+" s"),void(D=setTimeout(function(){w=(new Date).getTime()/1e3,d.debug.log("[Stream] Trick mode (x"+Q+"): seek time = "+t.toFixed(3)),M=t,d.videoModel.setCurrentTime(t)},e>0?1e3*e:0)))};if(this.debug.info("[Stream] <video> seeked event"),ke.call(this),1!==Q){if(e=(new Date).getTime()/1e3,t=d.videoModel.getCurrentTime(),n=e-E,i=e-w,r=Math.abs(t-x),o=r/n,d.debug.log("[Stream] Trick mode (x"+Q+"): elapsed time = "+n.toFixed(3)+", elapsed video time = "+r.toFixed(3)+", speed = "+o.toFixed(3)),"Changed"===$)clearTimeout(D),$="Running",E=(new Date).getTime()/1e3,x=t,d.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+x),T=Math.abs(b/Q)>1?T/Math.abs(b/Q):T,s=t+T*Math.sign(Q),u=0;else if(o<Math.abs(Q)*c){var f=Math.abs(Q/o);T*=Math.round(f)+Math.round(f%S),d.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+T),s=t+T*Math.sign(Q),u=0}else s=t+T*Math.sign(Q),u=Math.abs(s-x)/Math.abs(Q)-n-i;h.call(d,u,s)}this.videoModel.listen("seeking",a),ie=!1,re=-1,oe=-1},Le=function(){this.debug.info("[Stream] <video> progress event"),Fe.call(this)},Ce=function(){this.debug.info("[Stream] <video> timeupdate event: "+this.videoModel.getCurrentTime()),Fe.call(this)},Re=function(){var e=this.videoModel.getDuration(),n=Number(W.duration.toFixed(3));this.debug.info("[Stream] <video> durationchange event: "+e),!isNaN(e)&&e!==1/0&&e>n&&(this.debug.log("[Stream] Setting duration: "+n),this.mediaSourceExt.setDuration(t,n))},Ae=function(){this.debug.info("[Stream] <video> ratechange event: "+this.videoModel.getPlaybackRate()),R&&R.updateStalledState(),P&&P.updateStalledState(),N&&N.updateStalledState()},Pe=function(){le.call(this),ie=!0,this.system.notify("manifestUpdate",!0)},Fe=function(){R&&R.updateBufferLevel(!0),P&&P.updateBufferLevel(!0),N&&N.updateBufferLevel(!0)},Ne=function(e){this.debug.log("[Stream] startBuffering"+(void 0===e?"":" at time "+e)),R&&(void 0===e?R.start():R.seek(e)),P&&(void 0===e?P.start():P.seek(e)),N&&B&&1===Q&&(void 0===e?N.start():N.seek(e))},Be=function(){this.debug.log("[Stream] stopBuffering"),R&&R.stop(),P&&P.stop(),N&&N.stop()},ke=function(){R&&R.seeked(),P&&P.seeked(),N&&N.seeked()},Oe=function(){this.scheduleWhilePaused&&!this.manifestExt.getIsDynamic(e)||Be.call(this),clearInterval(_)},Ue=function(n){var i=this;e=n,i.debug.log("[Stream] Create MediaSource");try{t=i.mediaSourceExt.createMediaSource()}catch(r){i.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE,"Failed to create MediaSource",{name:r.name,message:r.message})}null!==t&&pe.call(i).then(function(){i.debug.log("[Stream] Setup MediaSource"),de.call(i,t).then(function(e){t=e,i.debug.log("[Stream] Initialize MediaSource"),me.call(i),i.debug.log("[Stream] Initialize playback"),ge.call(i),i.debug.log("[Stream] Playback initialized")})})},He=function(e){this.debug.log("[Stream] Set video model current time: "+e),this.videoModel.unlisten("seeking",a),this.videoModel.setCurrentTime(e)},Ve=function(){R&&!R.isBufferingCompleted()||P&&!P.isBufferingCompleted()||t&&(this.debug.info("[Stream] Signal end of stream"),this.mediaSourceExt.signalEndOfStream(t))},je=function(t){this.debug.info("[Stream] Start time = "+t),G!==-1&&!this.manifestExt.getIsDynamic(e)&&G<W.duration&&(this.debug.info("[Stream] Initial start time = "+G),t=G),ue.call(this,t,0===W.index&&j)},qe=function(){var e,t,n;if(this.debug.info("[Stream] Check start time"),e=this.sourceBufferExt.getBufferRange(R.getBuffer(),v,R.getSegmentDuration()),null!==e){if(n=Math.max(v,e.start),P){if(t=this.sourceBufferExt.getBufferRange(P.getBuffer(),v,P.getSegmentDuration()),null===t)return;if(this.debug.info("[Stream] Check start time: A["+t.start+"-"+t.end+"], V["+e.start+"-"+e.end+"]"),t.end<n)return;n=Math.max(n,t.start)}this.debug.info("[Stream] Check start time: OK => "+n),this.system.unmapHandler("bufferUpdated"),this.videoModel.isPaused()?X=n:He.call(this,n),ae.call(this)}},ze=function(t,n,i){var r=-1;return t?i===-1?i:(r=this.manifestExt.getDataIndex(n,e,W.index),r!==i&&("MSS"===e.name&&this.manifestExt.getIsDynamic(e)?this.system.notify("manifestUpdate"):t.updateData(n,W)),r):i},Ye=function(e){var t,n;for(n=1;n<e.Representation_asArray.length;)t=this.manifestExt.getCodecForRepresentation(e.Representation_asArray[n]),t&&(this.capabilities.supportsCodec(this.videoModel.getElement(),t)||(this.debug.warn("[Stream] codec not supported: "+t),e.Representation_asArray.splice(n,1),n--)),n++},Ke=function(t){var n,i;if(e=this.manifestModel.getValue(),W=t,this.debug.log("[Stream] Manifest updated ... set new data on buffers."),R&&(n=R.getData(),i=n&&n.hasOwnProperty("id")?this.manifestExt.getDataForId(n.id,e,W.index):this.manifestExt.getDataForIndex(A,e,W.index),Ye.call(this,i),R.updateData(i,W)),P&&(i=this.manifestExt.getDataForIndex(F,e,W.index),Ye.call(this,i),P.updateData(i,W)),N&&(i=this.manifestExt.getDataForIndex(V,e,W.index),N.updateData(i,W)),ee){var r=this.manifestExt.getEventsForPeriod(e,W);ee.addInlineEvents(r)}ie&&R&&(this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,qe.bind(this)),R.load()),k&&ye.call(this)},We=function(){var e=this.videoModel.getCurrentTime();N.seek(e),N.seeked()},Ge=function(t){var n=this;if(this.debug.log("[Stream] Segment loading failed: start time = "+t.startTime+", duration = "+t.duration),this.manifestExt.getIsDynamic(e)&&null===ne){ie=!0;var i=t.duration;this.debug.info("[Stream] Reload session in "+i+" s."),ne=setTimeout(function(){ne=null,ie=!0,n.debug.info("[Stream] Reload session (update manifest)"),n.system.notify("manifestUpdate",!0),ve.call(n)},1e3*i)}else ue.call(this,t.startTime+t.duration)},Xe=function(){if(document.hidden!==!0&&re!==-1){var e=(new Date).getTime()/1e3,t=this.getVideoModel().getCurrentTime(),n=e-re,i=t-oe;this.debug.log("[Stream] VisibilityChange: elapsedClockTime = "+n+", elapsedStreamTime = "+i+" ("+(n-i)+")"),n-i>1&&Pe.call(this)}};return{system:void 0,videoModel:void 0,manifestLoader:void 0,manifestModel:void 0,mediaSourceExt:void 0,sourceBufferExt:void 0,manifestExt:void 0,fragmentController:void 0,fragmentExt:void 0,protectionExt:void 0,capabilities:void 0,debug:void 0,metricsExt:void 0,errHandler:void 0,timelineConverter:void 0,scheduleWhilePaused:void 0,textTrackExtensions:void 0,metricsModel:void 0,eventBus:void 0,notify:void 0,setup:function(){this.system.mapHandler("startTimeFound",void 0,je.bind(this)),this.system.mapHandler("segmentLoadingFailed",void 0,Ge.bind(this)),this.system.mapHandler("bufferingCompleted",void 0,Ve.bind(this)),this[m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR]=se.bind(this),r=Se.bind(this),o=we.bind(this),s=De.bind(this),a=Me.bind(this),l=Ie.bind(this),h=Le.bind(this),f=Ae.bind(this),d=Ce.bind(this),c=Re.bind(this),i=_e.bind(this),p=be.bind(this),g=Ee.bind(this),y=xe.bind(this),n=Te.bind(this),L=Xe.bind(this)},load:function(e,t){W=t,Ue.call(this,e)},setVideoModel:function(e){this.videoModel=e,this.videoModel.listen("play",r),this.videoModel.listen("pause",o),this.videoModel.listen("error",s),this.videoModel.listen("seeking",a),this.videoModel.listen("seeked",l),this.videoModel.listen("timeupdate",d),this.videoModel.listen("durationchange",c),this.videoModel.listen("progress",h),this.videoModel.listen("ratechange",f),this.videoModel.listen("loadedmetadata",i),this.videoModel.listen("ended",n),this.videoModel.listen("canplay",p),this.videoModel.listen("playing",g),this.videoModel.listen("loadstart",y)},setInitialStartTime:function(e){var t=parseFloat(e);isNaN(t)||(G=t)},setAudioTrack:function(e){U&&U.stop(),F=ze.call(this,P,e,F)},getSelectedAudioTrack:function(){if(P)return this.manifestExt.getDataForIndex(F,e,W.index)},setSubtitleTrack:function(e){H&&H.stop(),V=ze.call(this,N,e,V)},getSelectedSubtitleTrack:function(){if(N&&B)return this.manifestExt.getDataForIndex(V,e,W.index)},initProtection:function(e){I=e,I&&I.subscribe(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,this)},getVideoModel:function(){return this.videoModel},getManifestExt:function(){var e=this;return e.manifestExt},setAutoPlay:function(e){j=e},setDefaultAudioLang:function(e){Y=e},setDefaultSubtitleLang:function(e){K=e},getAutoPlay:function(){return j},reset:function(){var e=u.defer(),t=this;return this.debug.info("[Stream] Reset"),Be.call(this),ve.call(this),le.call(this),clearTimeout(D),clearTimeout(ne),1!==Q&&this.videoModel.setMute(J),this.videoModel.unlisten("play",r),this.videoModel.unlisten("pause",o),this.videoModel.unlisten("error",s),this.videoModel.unlisten("seeking",a),this.videoModel.unlisten("seeked",l),this.videoModel.unlisten("timeupdate",d),this.videoModel.unlisten("durationchange",c),this.videoModel.unlisten("progress",h),this.videoModel.unlisten("ratechange",f),this.videoModel.unlisten("loadedmetadata",i),this.videoModel.unlisten("ended",n),this.videoModel.unlisten("canplay",p),this.videoModel.unlisten("playing",g),this.videoModel.unlisten("loadstart",y),this.system.unmapHandler("streamsComposed",void 0,We),this.system.unmapHandler("bufferUpdated"),this.system.unmapHandler("startTimeFound"),this.system.unmapHandler("segmentLoadingFailed"),this.system.unmapHandler("bufferingCompleted"),ce.call(this).then(function(){I&&I.unsubscribe(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,t),I=void 0,t.fragmentController=void 0,e.resolve()}),e.promise},getDuration:function(){return W.duration},getStartTime:function(){return W.start},getPeriodIndex:function(){return W.index},getId:function(){return W.id},getPeriodInfo:function(){return W},getMinbufferTime:function(){return R?R.getMinbufferTime():m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME;
},getLiveDelay:function(){return R?R.getLiveDelay():m.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},startEventController:function(){ee.start()},resetEventController:function(){ee.reset()},enableSubtitles:function(t){var n;t!==B&&(B=t,n=this.textTrackExtensions.getCurrentTextTrack(this.videoModel.getElement()),this.textTrackExtensions.cleanSubtitles(),N&&(t?("MSS"===e.name&&this.manifestExt.getIsDynamic(e)?(this.system.mapHandler("streamsComposed",void 0,We.bind(this),!0),this.system.notify("manifestUpdate")):We.call(this),n&&"metadata"!==n.kind&&"showing"!==n.mode?n.mode="showing":n&&(n.mode="hidden")):(H&&H.stop(),n&&(n.mode="disabled"),N.stop())))},setTrickModeSpeed:function(e){var t,n,i=[],r=this,o=1!==e,s=function(){r.videoModel.getCurrentTime()>t+1&&(r.videoModel.unlisten("timeupdate",s),r.debug.info("[Stream] Set mute: "+J+", the mute state before using trick mode."),r.videoModel.setMute(J))};e!==Q&&R&&(r.debug.info("[Stream] Trick mode: speed = "+e),o&&"Stopped"===$?(r.debug.info("[Stream] Set mute: true"),J=r.videoModel.getMute(),J||r.videoModel.setMute(!0),r.videoModel.pause()):o||(Q=1,clearTimeout(D),this.videoModel.pause(),Be.call(r)),i.push(R.setTrickMode(o,e>1)),P&&i.push(P.setTrickMode(o,e>1)),u.all(i).then(function(){b=Q,Q=e,t=r.videoModel.getCurrentTime(),o?"Running"===$?$="Changed":"Stopped"===$&&(Z=!1,$="Running",T=S=R.getSegmentDuration(),E=w=(new Date).getTime()/1e3,x=t,r.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+x),n=t+T*Math.sign(Q),n=Math.round(1e3*(n-n%S))/1e3,r.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+T),M=n,ue.call(r,n)):(r.debug.info("[Stream] Trick mode: Stopped, current time = "+t),$="Stopped",r.videoModel.listen("timeupdate",s),t=Z?r.getStartTime():t,ue.call(r,t,!0))}))},getTrickModeSpeed:function(){return Q},updateData:Ke,play:ae,seek:ue,pause:le}},m.dependencies.Stream.prototype={constructor:m.dependencies.Stream},m.dependencies.StreamController=function(){"use strict";var e,t,n,i,r,o,s,a,l,d,c,h=!1,f=[],p=!1,g=6,y=.2,v=!0,_=!1,b="und",E="und",x=!1,S=!1,T=null,w=function(e,t){var n=e.getElement(),i=t.getElement();return i.parentNode||n.parentNode.insertBefore(i,n),n.style.width="0px",i.style.width="100%",I(n,i),M.call(this,e),D.call(this,t),!0},D=function(e){e.listen("seeking",r),e.listen("progress",o),e.listen("timeupdate",i),e.listen("pause",s),e.listen("play",a)},M=function(e){e.unlisten("seeking",r),e.unlisten("progress",o),e.unlisten("timeupdate",i),e.unlisten("pause",s),e.unlisten("play",a)},I=function(e,t){["controls","loop","muted","playbackRate","volume"].forEach(function(n){t[n]=e[n]})},L=function(){var e=t.getVideoModel().getElement().buffered;if(e.length){var n=e.length-1,i=e.end(n),r=t.getStartTime()+t.getDuration()-i;r<g&&(t.getVideoModel().unlisten("progress",o),N())}},C=function(e,n,i){!_&&e&&n&&e!==n&&(_=!0,e.pause(),t=n,w.call(this,e.getVideoModel(),n.getVideoModel()),i?this.seek(e.getVideoModel().getCurrentTime()):this.seek(n.getStartTime()),this.play(),e.resetEventController(),t.startEventController(),_=!1)},R=function(){if(t){var e=this,n=new Date,i=t.getStartTime()+t.getDuration(),r=t.getVideoModel().getElement(),o=r.currentTime,s=e.videoExt.getPlaybackQuality(r);e.metricsModel.addPlaybackQuality("video",n,s,o),e.metricsModel.addVideoResolution("video",n,r.videoWidth,r.videoHeight,o),B()&&(t.getVideoModel().getElement().seeking||i-o<y&&C.call(this,t,B()))}},A=function(){var e=t.getVideoModel().getCurrentTime(),n=k(e);this.metricsModel.addState("video","seeking",t.getVideoModel().getCurrentTime()),n&&n!==t&&C.call(this,t,n,e)},P=function(){this.manifestUpdater.stop(),this.metricsModel.addState("video","paused",t.getVideoModel().getCurrentTime())},F=function(){this.manifestUpdater.start()},N=function(){var e=B();e&&e.seek(e.getStartTime())},B=function(){var e=t.getPeriodIndex()+1;return e<f.length?f[e]:null},k=function(e){var t=0,n=null,i=f.length,r=0;for(i>0&&(t+=f[0].getStartTime()),r=0;r<i;r+=1)if(n=f[r],t+=n.getDuration(),e<t)return n},O=function(){var e=this.system.getObject("videoModel"),t=document.createElement("video");return e.setElement(t),e},U=function(e){e.parentNode&&e.parentNode.removeChild(e)},H=function(){var i,r,o,s,a,l,u,d,h,m=this,g=m.manifestModel.getValue(),y=m.metricsModel.getMetricsFor("stream"),_=m.metricsExt.getCurrentManifestUpdate(y);if(!g)return!1;if(this.debug.info("[StreamController] composeStreams"),m.capabilities.supportsEncryptedMedia()&&(n||(n=m.system.getObject("protectionController"),p=!0),n.setMediaElement(m.videoModel.getElement()),c&&n.setProtectionData(c)),d=m.manifestExt.getMpd(g),t&&(i=t.getPeriodInfo(),d.isClientServerTimeSyncCompleted=i.mpd.isClientServerTimeSyncCompleted,d.clientServerTimeShift=i.mpd.clientServerTimeShift),r=m.manifestExt.getRegularPeriods(g,d),0===r.length)return!1;for(a=0,o=r.length;a<o;a+=1){for(u=r[a],l=0,s=f.length;l<s;l+=1)f[l].getId()===u.id&&(h=f[l],this.debug.info("[StreamController] update stream data"),h.updateData(u));h||(this.debug.info("[StreamController] Create stream"),h=m.system.getObject("stream"),h.setVideoModel(0===a?m.videoModel:O.call(m)),h.initProtection(n),h.setAutoPlay(v),h.setDefaultAudioLang(b),h.setDefaultSubtitleLang(E),h.enableSubtitles(x),h.setInitialStartTime(e.startTime),h.load(g,u),f.push(h)),m.metricsModel.addManifestUpdatePeriodInfo(_,u.id,u.index,u.start,u.duration),h=null}return t||(t=f[0],D.call(m,t.getVideoModel())),m.metricsModel.updateManifestUpdateInfo(_,{currentTime:m.videoModel.getCurrentTime(),buffered:m.videoModel.getElement().buffered,presentationStartTime:r[0].start,clientTimeOffset:d.clientServerTimeShift}),T&&(T.resolve(),T=null),!0},V=function(){t&&(l=this.manifestExt.getAudioDatas(this.manifestModel.getValue(),t.getPeriodIndex()),this.system.notify("audioTracksUpdated"))},j=function(){t&&(d=this.manifestExt.getTextDatas(this.manifestModel.getValue(),t.getPeriodIndex()),this.system.notify("subtitleTracksUpdated"))},q=function(e){e===!0&&(S=!0),this.refreshManifest()},z=function(){if(!h)return void(T&&(T.resolve(),T=null));this.debug.info("[StreamController] Manifest updated");var e=H.call(this);e?(V.call(this),j.call(this),this.system.notify("streamsComposed")):this.errHandler.sendError(m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM,"No stream/period is provided in the manifest"),T&&(T.resolve(),T=null)};return{system:void 0,videoModel:void 0,parser:void 0,manifestLoader:void 0,manifestUpdater:void 0,manifestModel:void 0,manifestExt:void 0,fragmentExt:void 0,capabilities:void 0,debug:void 0,metricsModel:void 0,metricsExt:void 0,videoExt:void 0,errHandler:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this.system.mapHandler("manifestUpdate",void 0,q.bind(this)),this.system.mapHandler("manifestUpdated",void 0,z.bind(this)),i=R.bind(this),o=L.bind(this),r=A.bind(this),s=P.bind(this),a=F.bind(this)},getManifestExt:function(){return t.getManifestExt()},setAutoPlay:function(e){v=e},getAutoPlay:function(){return v},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getAudioTracks:function(){return l},getSelectedAudioTrack:function(){if(t)return t.getSelectedAudioTrack()},setAudioTrack:function(e){t&&t.setAudioTrack(e)},getSubtitleTracks:function(){return d},setSubtitleTrack:function(e){t&&t.setSubtitleTrack(e)},getSelectedSubtitleTrack:function(){if(t)return t.getSelectedSubtitleTrack()},getMinbufferTime:function(){return t?t.getMinbufferTime():m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME},getLiveDelay:function(){return t?t.getLiveDelay():m.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},load:function(t){var n=this;h=!0,e=t,e.protData&&(c=e.protData),S=!1,T=u.defer(),n.debug.info("[StreamController] load url: "+e.url),n.manifestLoader.load(e.url).then(function(e){n.manifestModel.setValue(e),n.metricsModel.addMetaData(),n.debug.info("[StreamController] Manifest has loaded."),n.manifestUpdater.start()},function(e){T.resolve(),T=null,e&&n.errHandler.sendError(e.name,e.message,e.data)})},refreshManifest:function(e){var t=this.manifestModel.getValue(),n=e?e:t.hasOwnProperty("Location")?t.Location:t.mpdUrl;this.debug.log("[StreamController] Refresh manifest: "+n);var i=this;this.manifestLoader.abort(),this.manifestLoader.load(n,!0).then(function(e){i.manifestModel.setValue(e),i.debug.log("[StreamController] Manifest has been refreshed"),S=!1},function(t){void 0!==t&&(e?S&&i.errHandler.sendError(t.name,t.message,t.data):(i.errHandler.sendWarning(t.name,t.message,t.data),i.eventBus.dispatchEvent({type:"manifestUrlUpdate",data:{url:n}})))})},reset:function(e){var i,r,o={},s=[],a=this;this.debug.info("[StreamController] Reset"),t&&M.call(this,t.getVideoModel()),h=!1,a.manifestLoader.abort(),a.manifestUpdater.stop(),a.parser.reset(),o[m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]=function(){p=!1,n=null,c=null,a.manifestModel.setValue(null),a.metricsModel.addState("video","stopped",a.videoModel.getCurrentTime(),e),a.metricsModel.clearAllCurrentMetrics(),a.notify(m.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE)},u.when(!T||T.promise).then(function(){for(a.pause(),_=!1,r=0;r<f.length;r+=1)i=f[r],s.push(i.reset()),i!==t&&U(i.getVideoModel().getElement());a.videoModel.reset(),u.all(s).then(function(){f=[],t=null,n?p?(n.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,o,void 0,!0),n.teardown()):(n.setMediaElement(null),o[m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()):o[m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()})})},setDefaultAudioLang:function(e){b=e},setDefaultSubtitleLang:function(e){E=e},enableSubtitles:function(e){x=e,t&&t.enableSubtitles(e)},setTrickModeSpeed:function(e){t&&t.setTrickModeSpeed(e)},getTrickModeSpeed:function(){return t?t.getTrickModeSpeed():0},play:function(){t.play()},pause:function(){t&&t.pause()},seek:function(e,n){t&&t.seek(e,n)}}},m.dependencies.StreamController.prototype={constructor:m.dependencies.StreamController},m.dependencies.StreamController.eventList={ENAME_STREAMS_COMPOSED:"streamsComposed",ENAME_TEARDOWN_COMPLETE:"streamTeardownComplete"},m.utils.TokenAuthentication=function(){"use strict";var e={type:m.utils.TokenAuthentication.TYPE_QUERY};return{debug:void 0,getTokenAuthentication:function(){return e},setTokenAuthentication:function(t){e=t},checkRequestHeaderForToken:function(t){void 0!==e.name&&null!==t.getResponseHeader(e.name)&&(e.token=t.getResponseHeader(e.name),this.debug.log(e.name+" received: "+e.token))},addTokenAsQueryArg:function(t){if(void 0!==e.name&&void 0!==e.token&&e.type===m.utils.TokenAuthentication.TYPE_QUERY){var n=t.indexOf("?")===-1?"?":"&";t+=n+e.name+"="+e.token,this.debug.log(e.name+" is being appended on the request url with a value of : "+e.token)}return t},setTokenInRequestHeader:function(t){return e.type===m.utils.TokenAuthentication.TYPE_HEADER&&(t.setRequestHeader(e.name,e.token),this.debug.log(e.name+" is being set in the request header with a value of : "+e.token)),t}}},m.utils.TokenAuthentication.TYPE_QUERY="query",m.utils.TokenAuthentication.TYPE_HEADER="header",m.models.URIQueryAndFragmentModel=function(){"use strict";var e=new m.vo.URIFragmentData,t=[],n=function(){e=new m.vo.URIFragmentData,t=[]},i=function(n){function i(e,t,n,i){var r=i[0].split(/[=]/);return i.push({key:r[0],value:r[1]}),i.shift(),i}function r(e,n,i){return n>0&&(u&&0===t.length?t=i[n].split(/[&]/):d&&(s=i[n].split(/[&]/))),i}var o,s=[],a=new RegExp(/[?]/),l=new RegExp(/[#]/),u=a.test(n),d=l.test(n);return o=n.split(/[?#]/).map(r),t.length>0&&(t=t.reduce(i,null)),s.length>0&&(s=s.reduce(i,null),s.forEach(function(t){e[t.key]=t.value})),n};return{parseURI:i,reset:n,getURIFragmentData:function(){return e},getURIQueryData:t}},m.models.URIQueryAndFragmentModel.prototype={constructor:m.models.URIQueryAndFragmentModel},m.models.VideoModel=function(){"use strict";var e,t={},n=null,i=function(){for(var e in t)if(t[e]===!0)return!0;return!1},r=function(n,r){t[n]=r,i()?(this.debug.info("<video> setPlaybackRate(0)"),e.playbackRate=0):(this.debug.info("<video> setPlaybackRate(1)"),e.playbackRate=1)};return{system:void 0,debug:void 0,setup:function(){},reset:function(){t=[]},play:function(){this.debug.info("<video> play()"),e.play()},pause:function(){this.debug.info("<video> pause()"),e.pause()},isPaused:function(){return e.paused},isSeeking:function(){return e.seeking},getDuration:function(){return e.duration},getPlaybackRate:function(){return e.playbackRate},setPlaybackRate:function(t){this.debug.info("<video> setPlaybackRate("+t+")"),e.playbackRate=t},getMute:function(){return e.muted},setMute:function(t){e.muted=t},getVolume:function(){return e.volume},setVolume:function(t){e.volume=t},getCurrentTime:function(){return e.currentTime},setCurrentTime:function(t){this.debug.info("<video> setCurrentTime ("+t+")"),e.currentTime=t},listen:function(t,n){e.addEventListener(t,n,!1)},unlisten:function(t,n){e.removeEventListener(t,n,!1)},listenOnParent:function(t,n){e.parentElement.addEventListener(t,n,!1)},unlistenOnParent:function(t,n){e.parentElement.removeEventListener(t,n,!1)},getElement:function(){return e},setElement:function(t){e=t},setSource:function(t){t?e.src=t:(e.removeAttribute("src"),e.load())},isStalled:function(){return 0===e.playbackRate},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){n=e,n.style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0},stallStream:r}},m.models.VideoModel.prototype={constructor:m.models.VideoModel},m.dependencies.VideoModelExtensions=function(){"use strict";return{getPlaybackQuality:function(e){var t="webkitDroppedFrameCount"in e,n="getVideoPlaybackQuality"in e,i=null;return n?i=e.getVideoPlaybackQuality():t&&(i={droppedVideoFrames:e.webkitDroppedFrameCount,creationTime:new Date,totalVideoFrames:e.webkitDecodedFrameCount}),i}}},m.dependencies.VideoModelExtensions.prototype={constructor:m.dependencies.VideoModelExtensions},m.dependencies.XHRLoader=function(){"use strict";var e=null,t=null,n=null,i=null,r=null,o=0,s=0,a=0,l=null,d=null,c=function(){null!==e&&e.readyState>0&&e.readyState<4?e.abort():l&&(clearTimeout(l),l=null,d.reject())},h=function(){var u=!0,c=function(t){r&&r(e,t)},f=function(){e.aborted=!0},p=function(){e.status<200||e.status>299||200===e.status&&4===e.readyState&&(u=!1,e.endDate=new Date,d.resolve(e))},m=function(){u&&(u=!1,e.endDate=new Date,a++,!e.aborted&&o>0&&a<=o?l=setTimeout(function(){h()},s):d.reject(e))};try{e=new XMLHttpRequest,e.open("GET",t,!0),n&&(e.responseType=n),i&&e.setRequestHeader("Range","bytes="+i),e.onprogress=c,e.onabort=f,e.onload=p,e.onloadend=m,e.onerror=m,e.startDate=new Date,e.send()}catch(g){e.onerror()}};return{initialize:function(e,t,i,a){n=e,o=t,s=i,r=a},load:function(e,n){return t=e,i=n,a=0,d=u.defer(),h(),d.promise},abort:c}},m.dependencies.XHRLoader.prototype={constructor:m.dependencies.XHRLoader},m.utils.TTMLParser=function(){"use strict";var e=3600,t=60,n="http://www.w3.org/2006/10/ttaf1",i="http://www.w3.org/2006/10/ttaf1#parameter",r="http://www.w3.org/2006/10/ttaf1#styling",o="http://www.w3.org/ns/ttml",s="http://www.w3.org/ns/ttml#parameter",a="http://www.w3.org/ns/ttml#styling",l="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",d=[o,n],c=[a,r],h=[s,i],f=[l],p=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])((\.[0-9][0-9][0-9])|(:[0-9][0-9]))$/,m=/^\d+(\.\d+|)(h|m|s|ms|f)$/,g=null,y=null,v=null,_=null,b=null,E=null,x=null,S=[],T=[],w=[],D=function(n){var i,r,o;if(p.test(n))return i=n.split(":"),r=parseFloat(i[0])*e+parseFloat(i[1])*t+parseFloat(i[2]),i[3]&&x&&!isNaN(x)&&(r+=parseFloat(i[3])/x),r;if(m.test(n)){switch("ms"==n.substr(n.length-2)?(r=parseFloat(n.substr(0,n.length-3)),o=n.substr(n.length-2)):(r=parseFloat(n.substr(0,n.length-2)),o=n.substr(n.length-1)),o){case"h":r=60*r*60;break;case"m":r=60*r;break;case"s":break;case"ms":r=.01*r;break;case"f":if(!x||isNaN(x))return NaN;r/=x}return r}return NaN},M=function(){var e=!1;return y=g?this.domParser.getChildNode(g,"tt"):null,v=y?this.domParser.getChildNode(y,"head"):null,_=v?this.domParser.getChildNode(v,"layout"):null,b=v?this.domParser.getChildNode(v,"styling"):null,E=y?this.domParser.getChildNode(y,"body"):null,y&&v&&E&&(e=!0),e},I=function(e,t,n){var i,r,o=null,s=0;for(s=0;s<e.length;s+=1){if(o=C.call(this,[e[s]],c,t))return o;if(i=C.call(this,[e[s]],d,"style")){if(o=L.call(this,S,i,t))return o;for(i=L.call(this,S,i,"style");i;){if(o=L.call(this,S,i,t))return o;i=L.call(this,S,i,"style")}}if(r=C.call(this,[e[s]],d,"region")){if(o=L.call(this,T,r,t))return o;if(i=L.call(this,T,r,"style")){if(o=L.call(this,S,i,t))return o;for(i=L.call(this,S,i,"style");i;){if(o=L.call(this,S,i,t))return o;i=L.call(this,S,i,"style")}}}}return void 0!==n?n:null},L=function(e,t,n){var i=0,r=null,o=0;for(i=0;i<e[t].length;i+=1){for(o=0;o<c.length;o+=1)if(r=e[t].getNamedItem(n),r||(r=e[t].getNamedItemNS(c[o],n)),r)return r.nodeValue;for(o=0;o<d.length;o+=1)if(r=e[t].getNamedItem(n),r||(r=e[t].getNamedItemNS(d[o],n)),r)return r.nodeValue}return null},C=function(e,t,n){var i=null,r=0,o=0;for(r=0;r<e.length;r+=1)for(o=0;o<t.length;o+=1)if(i=this.domParser.getAttributeValue(e[r],n,t[o]))return i;return i},R=function(e){e||(e="32 15");var t=e,n=0;for(t=t.split(" "),n=0;n<t.length;n+=1)t[n]=parseFloat(t[n]);return t},A=function(e,t){var n={backgroundColor:null,color:null,fontSize:null,fontFamily:null,fontStyle:null,textOutline:{color:null,"with":null},textAlign:null,displayAlign:null,origin:null,extent:null,cellResolution:null,rootExtent:t,showBackground:null};return n.backgroundColor=I.call(this,e,"backgroundColor","transparent"),n.color=I.call(this,e,"color"),n.fontSize=I.call(this,e,"fontSize"),n.fontFamily=I.call(this,e,"fontFamily"),n.fontStyle=I.call(this,e,"fontStyle","normal"),n.textOutline=I.call(this,e,"textOutline"),n.extent=I.call(this,e,"extent"),n.origin=I.call(this,e,"origin"),n.textAlign=I.call(this,e,"textAlign","start"),n.displayAlign=I.call(this,e,"displayAlign","before"),n.showBackground=I.call(this,e,"showBackground"),n.cellResolution=C.call(this,e,h,"cellResolution"),n.cellResolution=R(n.cellResolution),n},P=function(e){var t,n,i,r,o,s,a,l,c,p,m,v,_,b,L,R=[],P=null,F=null,N=null,B="",k="";try{if(null!==this.videoModel.getTTMLRenderingDiv()&&(k="html"),g=this.domParser.createXmlTree(e),!M.call(this))return t="TTML document has incorrect structure",u.reject(t);for(l=0;l<h.length;l+=1)x=this.domParser.getAttributeValue(y,"frameRate",h[l])?parseInt(x,10):null;if(a=this.domParser.getChildNodes(E,"div"),!a||0===a.length)return t="TTML body document does not contain any div",u.reject(t);for(S=this.domParser.getAllSpecificNodes(y,"style"),T=this.domParser.getAllSpecificNodes(y,"region"),w=this.domParser.getAllSpecificNodes(y,"image"),v=I.call(this,[y],"extent"),m=0;m<a.length;m+=1)if(b=C.call(this,[a[m]],f,"backgroundImage"),b&&void 0!==w[b.substring(1)]&&(r=D(C.call(this,[a[m]],d,"begin")),o=D(C.call(this,[a[m]],d,"end")),N=A.call(this,[a[m],y],v),s={start:r,end:o,data:"data:image/"+w[b.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(w[b.substring(1)],"#text").nodeValue,type:"image",line:80,style:N},R.push(s)),n=this.domParser.getChildNodes(a[m],"p"),n&&0!==n.length)for(l=0;l<n.length;l+=1)if(s=null,N=null,i=n[l],r=D(C.call(this,[i],d,"begin")),o=D(C.call(this,[i],d,"end")),isNaN(r)||isNaN(o)||o<r)t="TTML document has incorrect timing value";else if(b=C.call(this,[i],f,"backgroundImage"),b&&void 0!==w[b.substring(1)]&&(N=A.call(this,[i,a[m],y],v),s={start:r,end:o,data:"data:image/"+w[b.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(w[b.substring(1)],"#text").nodeValue,type:"image",line:80,style:N}),c=this.domParser.getChildNodes(i,"span"),c.length>0){for(p=0;p<c.length;p++){p>0&&(B+="\n"),0===p&&(N=A.call(this,[c[p],i,E,y,a[m]],v)),_=this.domParser.getTextNodesIn(c[p]);for(var O=0;O<_.length;O+=1)O>0&&(B+="\n"),B+=_[O].textContent}s={start:r,end:o,data:B,type:"text",line:80,style:N},B="",R.push(s)}else{if(N=A.call(this,[i,E,y],v),l>0&&(P=D(C.call(this,[n[l-1]],d,"begin")),F=D(C.call(this,[n[l-1]],d,"end"))),r===P&&o===F||r>=P&&o<=F)""!==i.textContent&&("html"===k?s={start:r,end:o,data:i.textContent,type:"text",line:80,style:N}:(r>=P&&o<=F?(L=R[R.length-1],L.end=r):L=R.pop(),s={start:r,end:o,data:L.data+"\n"+i.textContent,type:"text",line:80,style:N}));else{for(_=this.domParser.getTextNodesIn(i),p=0;p<_.length;p+=1)p>0&&(B+="\n"),B+=_[p].textContent;""!==B&&(s={start:r,end:o,data:B,type:"text",line:80,style:N},B="")}null!==s&&R.push(s)}else t="TTML document does not contain any cues";return R.length>0?u.when(R):u.reject(t)}catch(U){return t=U.message,u.reject(t)}};return{domParser:void 0,videoModel:void 0,parse:P}},m.utils.TTMLRenderer=function(){"use strict";var e,t=[],n=function(){var n=0;for(n=0;n<t.length;n++)d(t[n],t[n].ttmlStyle,e)},i=function(){this.cleanSubtitles()},r=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.display="flex",t.style.flexDirection="row",t.style.overflow="initial",t.style.pointerEvents="none",e.appendChild(t),t},o=function(t){e.hasChildNodes()&&e.removeChild(t)},s=function(e,t){var n,i;if(e&&"%"===e[e.length-1])n=parseFloat(e.substr(0,e.length-1))/100*t[1]+"px";else if(e&&"x"===e[e.length-1])n=e;else if(e&&"c"===e[e.length-1]){var r=e.replace(/\s/g,"").split("c");for(i=0;i<r.length;i+=1)r[i]=parseFloat(r[i]);n=isNaN(r[1])?r[0]*t[1]+"px":r[1]*t[1]+"px"}else n=t[1]+"px";return n},a=function(e,t,n){var i,r={color:n,width:null},o=0;if(e&&(e=e.split(" "),e[0]&&isNaN(e[0][0])?(r.color=e[0],o=1):r.color=n,r.color&&"#"===r.color[0]&&(r.color=l(r.color)),e[o]))switch(i=e[o][e[o].length-1]){case"c":e[o]=e[o].split("c"),e[o][0]&&(r.width=e[o][0]*t[1]+"px");break;case"x":r.width=e[o]}return r},l=function(e){e=e.replace("#","");var t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),r=e.length>6?parseInt(e.substring(6,8),16):255,o="rgba("+t+","+n+","+i+","+r+")";return o},u=function(e){var t,n,i=e;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),t[t.length-1]>1&&(n=parseInt(t[t.length-1],10)/255,i="rgba("+t[0]+","+t[1]+","+t[2]+","+n+")"),i},d=function(e,t,n){var i,r,o,d,c=[n.clientWidth/t.cellResolution[0],n.clientHeight/t.cellResolution[1]];if(e){if(t.backgroundColor&&"#"===t.backgroundColor[0]?t.backgroundColor=l(t.backgroundColor):t.backgroundColor&&"a"===t.backgroundColor[3]&&(t.backgroundColor=u(t.backgroundColor)),t.color&&"#"===t.color[0]?t.color=l(t.color):t.color&&"a"===t.color[3]&&(t.color=u(t.color)),t.origin&&"%"===t.origin[t.origin.length-1])i=t.origin.split("%"),e.style.left=parseInt(i[0],10)+"%",e.style.top=parseInt(i[1],10)+"%",t.extent&&"%"===t.extent[t.extent.length-1]&&(r=t.extent.split("%"),e.style.width=parseInt(r[0],10)+"%",e.style.height=parseInt(r[1],10)+"%");else if(t.origin&&"x"===t.origin[t.origin.length-1])if(i=t.origin.split("px"),t.rootExtent&&"x"===t.rootExtent[t.rootExtent.length-1]){d=t.rootExtent.split("px");var h=i[0]/d[0]*n.clientWidth;e.style.left=h/n.clientWidth*100+"%",h=i[1]/d[1]*n.clientHeight,e.style.top=h/n.clientHeight*100+"%",t.extent&&"x"===t.extent[t.extent.length-1]&&(r=t.extent.split("px"),h=r[0]/d[0]*n.clientWidth,e.style.width=h/n.clientWidth*100+"%",h=r[1]/d[1]*n.clientHeight,e.style.height=h/n.clientHeight*100+"%")}else e.style.left=i[0]+"px",e.style.top=i[1]+"px";else t.origin&&"c"===t.origin[t.origin.length-1]&&(i=t.origin.split("c"),e.style.left=i[0]*c[0]+"px",e.style.top=i[1]*c[1]+"px",t.extent&&"c"===t.extent[t.extent.length-1]&&(r=t.extent.split("c"),e.style.width=r[0]*c[0]+"px",e.style.height=r[1]*c[1]+"px"));switch(o=a(t.textOutline,c,t.color),e.style.webkitTextStrokeWidth=o.width,e.style.webkitTextStroke=o.color,t.textAlign){case"start":e.style.justifyContent="flex-start";break;case"end":e.style.justifyContent="flex-end";break;case"center":e.style.justifyContent="center";break;case"right":e.style.justifyContent="flex-end";break;case"left":e.style.justifyContent="flex-start";break;default:e.style.justifyContent="flex-start"}switch(t.displayAlign){case"before":e.style.alignItems="flex-start";break;case"center":e.style.alignItems=t.displayAlign;break;case"after":e.style.alignItems="flex-end";break;default:e.style.alignItems="flex-start"}e.style.fontStyle=t.fontStyle,t.showBackground&&"whenActive"===t.showBackground?e.style.backgroundColor="transparent":e.style.backgroundColor=t.backgroundColor,e.style.color=t.color,e.style.fontSize=s(t.fontSize,c),e.style.fontFamily=t.fontFamily}};return{videoModel:void 0,initialize:function(t){e=t,document.addEventListener("webkitfullscreenchange",n.bind(this)),document.addEventListener("mozfullscreenchange",n.bind(this)),document.addEventListener("fullscreenchange",n.bind(this)),this.videoModel.listen("seeking",i.bind(this))},cleanSubtitles:function(){var e=0;for(e=0;e<t.length;e++)o(t[e]);t=[]},onCueEnter:function(n){var i=r();if(n.currentTarget.style&&(d(i,n.currentTarget.style,e),i.ttmlStyle=n.currentTarget.style),"image"!==n.currentTarget.type){var o=document.createElement("p");i.appendChild(o),o.innerText=n.currentTarget.text,o.style.marginTop="auto",i.ttmlStyle&&i.ttmlStyle.showBackground&&"whenActive"===i.ttmlStyle.showBackground&&(o.style.backgroundColor=n.currentTarget.style.backgroundColor)}else{var s=new Image;s.style.height="auto",s.style.width="auto",s.src=n.currentTarget.text,i.appendChild(s)}i.data=n.currentTarget.text,t.push(i)},onCueExit:function(e){var n=0;for(n=0;n<t.length&&(e.currentTarget.text!==t[n].data||t[n].ttmlStyle!==e.currentTarget.style);n++);o(t[n]),t.splice(n,1)}}},m.dependencies.TextController=function(){var e,t,n,i,r="LOADING",o="READY",s=!1,a=null,l=o,u=function(e){this.debug.log("TextController setState to:"+e),l=e},d=function(){if(s&&l===o){var e=this;e.indexHandler.getInitRequest(i[0]).then(function(t){e.fragmentLoader.load(t).then(f.bind(e,t),p.bind(e,t)),u.call(e,r)})}},c=function(){d.call(this)},h=function(e,t){var n,i,r=this.manifestModel.getValue();return i=this.manifestExt.getDataIndex(e,r,t.index),n=this.manifestExt.getAdaptationsForPeriod(r,t),this.manifestExt.getRepresentationsForAdaptation(r,n[i])},f=function(e,t){var i=this;i.fragmentController.process(t.data,e).then(function(e){null!==e&&i.sourceBufferExt.append(n,e,i.videoModel)})},p=function(){};return{videoModel:void 0,fragmentLoader:void 0,fragmentController:void 0,indexHandler:void 0,sourceBufferExt:void 0,manifestModel:void 0,manifestExt:void 0,debug:void 0,initialize:function(e,t,n,i,r){var o=this;o.setVideoModel(i),o.setBuffer(n),o.setMediaSource(r),o.updateData(t,e),s=!0,d.call(o)},setPeriodInfo:function(e){a=e},getPeriodIndex:function(){return a.index},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getData:function(){return t},setData:function(e){t=e},getBuffer:function(){return n},setBuffer:function(e){n=e},setMediaSource:function(t){e=t},updateData:function(e,n){t=e,a=n,i=h.call(this,t,a),u.call(this,o),d.call(this)},reset:function(t){t||(this.sourceBufferExt.abort(e,n),this.sourceBufferExt.removeSourceBuffer(e,n))},start:c}},m.dependencies.TextController.prototype={constructor:m.dependencies.TextController},m.dependencies.TextSourceBuffer=function(){var e,t,n,i=function(e){var t="",n=0,i=0,r=0,o=0,s=new Uint8Array(e);for(s.length>=3&&239===s[0]&&187===s[1]&&191===s[2]&&(n=3);n<s.length;)if(i=s[n],i<128)t+=String.fromCharCode(i),n++;else if(i>191&&i<224){if(n+1>=s.length)throw"UTF-8 Decode failed. Two byte character was truncated.";r=s[n+1],t+=String.fromCharCode((31&i)<<6|63&r),n+=2}else{if(n+2>=s.length)throw"UTF-8 Decode failed. Multi byte character was truncated.";r=s[n+1],o=s[n+2],t+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o),n+=3}return t},r={length:0,ranges:[],start:function(e){return this.ranges[e].start},end:function(e){return this.ranges[e].end},addRange:function(e,t){var n=0,i=!1,r=.01;for(n=0;n<this.ranges.length;n++)this.ranges[n].end<=e+r&&this.ranges[n].end>=e-r&&(i=!0,this.ranges[n].end=t),this.ranges[n].start<=t+r&&this.ranges[n].start>=t-r&&(i=!0,this.ranges[n].start=e);i||(this.ranges.push({start:e,end:t}),this.length=this.length+1,this.ranges.sort(function(e,t){return e.start-t.start}))},removeRange:function(e,t){var n=0;for(n=this.ranges.length-1;n>=0;n-=1)(void 0===t||t===-1||this.ranges[n].end<=t)&&(void 0===e||e===-1||this.ranges[n].start>=e)&&this.ranges.splice(n,1);this.length=this.ranges.length},reset:function(){this.length=0,this.ranges=[]}};return{system:void 0,eventBus:void 0,errHandler:void 0,textTrackExtensions:void 0,buffered:r,initialize:function(i,o){n=i,e=o.getVideoModel().getElement(),t=o.getData(),r.reset()},remove:function(t,n){if(t<0||t>=n)throw"INVALID_ACCESS_ERR";this.textTrackExtensions.deleteCues(e,!1,t,n),this.buffered.removeRange(t,n)},append:function(n,r){var o=this,s=i(n),a=o.getParser().parse(s,r);0===e.textTracks.length&&o.textTrackExtensions.addTextTrack(e,[],t.Representation_asArray[0].id,t.lang,!0),0!==e.textTracks.length&&(o.textTrackExtensions.addCues(e.textTracks[0],a),r&&o.buffered.addRange(r.startTime,r.startTime+r.duration))},abort:function(){this.textTrackExtensions.deleteCues(e),this.buffered.reset()},getParser:function(){var e;return"text/vtt"===n&&(e=this.system.getObject("vttParser")),e},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n)},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},m.dependencies.TextSourceBuffer.prototype={constructor:m.dependencies.TextSourceBuffer},m.dependencies.TextTTMLXMLMP4SourceBuffer=function(){var e,t,n,i,r={length:0,ranges:[],start:function(e){return this.ranges[e].start},end:function(e){return this.ranges[e].end},addRange:function(e,t){var n=0,i=!1,r=.01;for(n=0;n<this.ranges.length;n++)this.ranges[n].end<=e+r&&this.ranges[n].end>=e-r&&(i=!0,this.ranges[n].end=t),this.ranges[n].start<=t+r&&this.ranges[n].start>=t-r&&(i=!0,this.ranges[n].start=e);i||(this.ranges.push({start:e,end:t}),this.length=this.length+1,this.ranges.sort(function(e,t){return e.start-t.start}))},removeRange:function(e,t){var n=0;for(n=this.ranges.length-1;n>=0;n-=1)(void 0===t||t===-1||this.ranges[n].end<=t)&&(void 0===e||e===-1||this.ranges[n].start>=e)&&this.ranges.splice(n,1);this.length=this.ranges.length},reset:function(){this.length=0,this.ranges=[]}};return{updating:!1,system:void 0,eventBus:void 0,buffered:r,textTrackExtensions:void 0,ttmlParser:void 0,debug:void 0,manifestModel:void 0,initialize:function(o,s,a){t=o,e=s.getVideoModel().getElement(),r.reset(),n=a.lang,i=a.id},remove:function(t,n){if(t<0||t>=n)throw"INVALID_ACCESS_ERR";this.getTextTrackExtensions().deleteCues(e,!1,t,n),this.buffered.removeRange(t,n)},append:function(r){var o,s,a,l,u,d,c,h,f=this,p=E.deserialize(r),m=p.getBoxByType("moov"),g=0,y="utf-8";return"application/ttml+xml"===t?(this.track=this.textTrackExtensions.addTextTrack(e,[],i,n,!0),f.isUTF16(r)&&(y="utf-16"),void this.convertUTFToString(r,y).then(function(t){f.ttmlParser.parse(t).then(function(t){t&&(f.textTrackExtensions.addCues(f.track,t),f.buffered.addRange(0,e.duration),f.eventBus.dispatchEvent({type:"updateend"}))},function(){})})):m?(o=m.getBoxByType("mvhd"),f.timescale=o.timescale,this.track=this.textTrackExtensions.addTextTrack(e,[],i,n,!0),void this.eventBus.dispatchEvent({type:"updateend"})):(s=p.getBoxByType("moof"),void(s&&(a=p.getBoxByType("mdat"),l=s.getBoxByType("traf"),u=l.getBoxByType("tfhd"),d=l.getBoxByType("tfdt"),c=l.getBoxByType("trun"),h=d.baseMediaDecodeTime/f.timescale,g=0,g=256&c.flags?c.samples_table[0].sample_duration/f.timescale:u.default_sample_duration/f.timescale,f.buffered.addRange(h,h+g),f.isUTF16(a.data)&&(y="utf-16"),f.convertUTFToString(a.data,y).then(function(e){f.ttmlParser.parse(e).then(function(e){var t,n=f.manifestModel.getValue();if(e){if("MSS"===n.name)for(t=0;t<e.length;t+=1)e[t].start=e[t].start+h,
e[t].end=e[t].end+h;f.textTrackExtensions.addCues(f.track,e),f.eventBus.dispatchEvent({type:"updateend"})}},function(){})}))))},convertUTFToString:function(e,t){var n=u.defer(),i=new Blob([e],{type:"text/xml"}),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.readAsText(i,t),n.promise},isUTF16:function(e){var t,n,i,r,o=0,s=e&&e.length,a=null;if(s<2){if(e[0]>255)return!1}else{if(t=e[0],n=e[1],255===t&&254===n)return!0;if(254===t&&255===n)return!0;for(;o<s;o++){if(0===e[o]){a=o;break}if(e[o]>255)return!1}if(null===a)return!1;if(i=e[a+1],void 0!==i&&i>0&&i<128)return!0;if(r=e[a-1],void 0!==r&&r>0&&r<128)return!0}return!1},UpdateLang:function(e,t){i=e,n=t},abort:function(){this.getTextTrackExtensions().deleteCues(e,!0)},getTextTrackExtensions:function(){return this.textTrackExtensions},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n),this.updating||this.eventBus.dispatchEvent({type:"updateend"})},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},m.dependencies.TextTTMLXMLMP4SourceBuffer.prototype={constructor:m.dependencies.TextTTMLXMLMP4SourceBuffer},m.utils.TextTrackExtensions=function(){"use strict";var e,t="",n=null;return{system:void 0,eventBus:void 0,videoModel:void 0,debug:void 0,config:void 0,setup:function(){e=window.VTTCue||window.TextTrackCue},cueEnter:function(e,t,n){this.eventBus.dispatchEvent({type:"cueEnter",data:{text:t,style:e,type:n}})},cueExit:function(e,t,n){this.eventBus.dispatchEvent({type:"cueExit",data:{text:t,style:e,type:n}})},getCurrentTextTrack:function(e){for(var t=0;t<e.textTracks.length;t++)if("hascaption"===e.textTracks[t].label)return e.textTracks[t];return null},addTextTrack:function(i,r,o,s,a){var l,u=null,d=null,c="subtitles",h=this.videoModel.getTTMLRenderingDiv();for(u=this.getCurrentTextTrack(i),u?(this.cleanSubtitles(),u["default"]=a,"showing"!==u.mode&&"metadata"!==u.kind&&(u.mode="showing"),t=s):(h&&(n=this.system.getObject("ttmlRenderer"),n.initialize(h)),c=null!==h?"metadata":"subtitles","subtitles"===c&&(c=this.config.getParam("TextTrackExtensions.displayModeExtern","boolean")===!0?"metadata":"subtitles"),u=i.addTextTrack(c,"hascaption",s),t=s,u["default"]=a,"metadata"!==c?u.mode="showing":u.mode="hidden"),l=0;l<r.length;l+=1)d=r[l],u.addCue(new e(d.start,d.end,d.data));return u},onCueEnter:function(e){var t=this.videoModel.getTTMLRenderingDiv();"image"===e.currentTarget.type&&null===t&&this.debug.warn("[TextTrackExtensions] Rendering image subtitles without div is impossible"),t&&n.onCueEnter(e),this.cueEnter(e.currentTarget.style,e.currentTarget.text,e.currentTarget.type)},onCueExit:function(e){var t=this.videoModel.getTTMLRenderingDiv();t&&n.onCueExit(e),this.cueExit(e.currentTarget.style,e.currentTarget.text)},addCues:function(n,i){var r=0,o=null,s=null;for(r=0;r<i.length;r+=1)o=i[r],o.start<o.end&&(s=new e(o.start,o.end,o.data),s.id=t,s.type=o.type,s.onenter=this.onCueEnter.bind(this),s.onexit=this.onCueExit.bind(this),s.snapToLines=!1,s.line=o.line,o.style&&(s.style=o.style),n.addCue(s))},deleteCues:function(e,t,n,i){var r,o=null,s=null,a=null,l=0;if(e&&(o=e.textTracks[0])){if(r=o.mode,"disabled"===r&&(o.mode="hidden"),s=o.cues)for(a=s.length-1,l=a;l>=0;l-=1)(void 0===i||i===-1||s[l].endTime<=i)&&(void 0===n||n===-1||s[l].startTime>=n)&&o.removeCue(s[l]);o.mode=r}},cleanSubtitles:function(){var e=this.videoModel.getTTMLRenderingDiv();e&&n&&n.cleanSubtitles()}}},m.utils.VTTParser=function(){"use strict";var e=/X-TIMESTAMP-MAP=(.+)/,t=/\s*(.+?)\s*:((?:\".*?\")|.*?)(?:,|$)/g,n=/(\S*)[\s]*-->[\s]*(\S*)(.*)/g,i=/(?:\r\n|\r|\n)/gm,r=function(e){for(var t=e.split(":"),n=t.length,i=0,r=0;r<n;r++)i+=parseFloat(t[r],10)*Math.pow(60,n-r-1);return i},o=function(n){var i,o,s,a,l=null,u=null;if(i=e.exec(n),!i)return-1;for(o=i[1];null!==(i=t.exec(o));)switch(s=i[1],a=i[2],s){case"MPEGTS":u=parseInt(a,10);break;case"LOCAL":l=r(a)}return null===l||null===u?-1:{local:l,mpegts:u}},s=function(e,t){if(e===-1)return 0;var n=this.manifestModel.getValue().timestampMap;if(!n)return e.local-t.startTime;var i=(e.mpegts-n.mpegts)/9e4;return e.local-n.local-i};return{manifestModel:void 0,parse:function(e,t){var a,l,u,d=[],c=null,h=s.call(this,o(e),t),f=e.split(i);for(u=0;u<f.length;u++)a=f[u].trim(),0!==a.length&&(f[u].match(n)?(null!==c&&d.push(c),l=f[u].split(n),c={type:"text",line:80,start:r(l[1])-h,end:r(l[2])-h,data:""}):null!==c&&(c.data+=(0===c.data.length?"":"\n")+f[u]));return null!==c&&d.push(c),d}}},m.rules.AbandonRequestsRule=function(){"use strict";var e=.5,t=2;return{debug:void 0,metricsExt:void 0,name:"AbandonRequestRule",execute:function(n,i){var r,o,s,a=(new Date).getTime(),l=n.streamType,u=new m.rules.SwitchRequest(m.rules.SwitchRequest.prototype.NO_CHANGE,m.rules.SwitchRequest.prototype.WEAK);return null===n.firstByteDate||n.aborted?(this.debug.log("[AbandonRequestsRule]["+l+"] Request has already been aborted."),void i(u)):(r=(a-n.firstByteDate.getTime())/1e3,n.bytesLoaded<n.bytesTotal&&r>=n.duration*e&&(o=n.bytesLoaded/r,s=n.bytesTotal/o,s>n.duration*t&&(u=new m.rules.SwitchRequest(0,m.rules.SwitchRequest.prototype.STRONG),this.debug.info("[AbandonRequestsRule]["+l+"] BW = "+(8*o/1e3).toFixed(3)+" kb/s => switch to lowest quality"))),void i(u))}}},m.rules.AbandonRequestsRule.prototype={constructor:m.rules.AbandonRequestsRule},m.rules.BaseRulesCollection=function(){"use strict";var e=[],t=[];return{downloadRatioRule:void 0,insufficientBufferRule:void 0,droppedFramesRule:void 0,abandonRequestRule:void 0,getRules:function(n){switch(n){case m.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES:return e;case m.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES:return t;default:return null}},setup:function(){e.push(this.downloadRatioRule),e.push(this.insufficientBufferRule),e.push(this.droppedFramesRule),t.push(this.abandonRequestRule)}}},m.rules.BaseRulesCollection.prototype={constructor:m.rules.BaseRulesCollection,QUALITY_SWITCH_RULES:"qualitySwitchRules",ABANDON_FRAGMENT_RULES:"abandonFragmentRules"},m.rules.DownloadRatioRule=function(){"use strict";return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DownloadRatioRule",checkIndex:function(e,t,n){var i,r,o,s,a,l,u,d,c,h=this.metricsExt.getHttpRequests(t),f=null,p=[],g=m.rules.SwitchRequest.prototype.NO_CHANGE,y=0,v=m.rules.SwitchRequest.prototype.DEFAULT;if(n&&n.hasOwnProperty("type")){if(a=this.config.getParamFor(n.type,"ABR.latencyInBandwidth","boolean",!0),l=this.config.getParamFor(n.type,"ABR.switchUpRatioSafetyFactor","number",1.5),this.debug.log("[DownloadRatioRule]["+n.type+"] Checking download ratio rule... (current = "+e+")"),!t)return this.debug.log("[DownloadRatioRule]["+n.type+"] No metrics, bailing."),new m.rules.SwitchRequest;for(c=h.length-1;c>=0&&null===f;)h[c].tfinish&&h[c].trequest&&h[c].tresponse&&h[c].bytesLength>0&&(f=h[c]),c--;if(null===f)return this.debug.log("[DownloadRatioRule]["+n.type+"] No valid requests made for this stream yet, bailing."),new m.rules.SwitchRequest;if(r=(f.tfinish.getTime()-f.trequest.getTime())/1e3,i=(f.tfinish.getTime()-f.tresponse.getTime())/1e3,r<=0)return this.debug.log("[DownloadRatioRule]["+n.type+"] Don't know how long the download of the last fragment took, bailing."),new m.rules.SwitchRequest;if(null===f.mediaduration||void 0===f.mediaduration||f.mediaduration<=0||isNaN(f.mediaduration))return this.debug.log("[DownloadRatioRule]["+n.type+"] Don't know the duration of the last media fragment, bailing."),new m.rules.SwitchRequest;for(y=f.bytesLength,this.debug.log("[DownloadRatioRule]["+n.type+"] DL: "+Number(i.toFixed(3))+"s, Total: "+Number(r.toFixed(3))+"s, Length: "+y),d=1;c>=0&&d<3;){if(h[c].tfinish&&h[c].trequest&&h[c].tresponse&&h[c].bytesLength>0){var _=(h[c].tfinish.getTime()-h[c].trequest.getTime())/1e3,b=(h[c].tfinish.getTime()-h[c].tresponse.getTime())/1e3;this.debug.log("[DownloadRatioRule]["+n.type+"] DL: "+Number(b.toFixed(3))+"s, Total: "+Number(_.toFixed(3))+"s, Length: "+h[c].bytesLength),r+=_,i+=b,y+=h[c].bytesLength,d+=1}c--}if(y*=8,o=a?y/r:y/i,this.debug.log("[DownloadRatioRule]["+n.type+"] BW = "+Math.round(o/1e3)+" kb/s"),isNaN(o))return new m.rules.SwitchRequest;for(d=this.manifestExt.getRepresentationCount(n),u=this.manifestExt.getRepresentationFor(e,n),s=this.manifestExt.getBandwidth(u),c=0;c<d;c+=1)p.push(this.manifestExt.getRepresentationBandwidth(n,c));if(o<=s){for(c=e-1;c>0&&!(p[c]<=o);c-=1);return g=c,v=m.rules.SwitchRequest.prototype.WEAK,this.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(d-1)+" ("+p[g]+"), p="+v),new m.rules.SwitchRequest(g,v)}for(c=d-1;c>e&&!(o>p[c]*l);c-=1);return g=c,v=m.rules.SwitchRequest.prototype.STRONG,this.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(d-1)+" ("+p[g]+"), p="+v),new m.rules.SwitchRequest(g,v)}return new m.rules.SwitchRequest}}},m.rules.DownloadRatioRule.prototype={constructor:m.rules.DownloadRatioRule},m.rules.DroppedFramesRule=function(){"use strict";var e=1,t=null,n=-1,i=-1,r=function(r){var o;return null===t?void(t=r):(o=r.mt-t.mt,void(o<e||(n=r.droppedFrames-t.droppedFrames,i=r.totalVideoFrames-t.totalVideoFrames,t=r)))};return{debug:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DroppedFramesRule",checkIndex:function(e,o,s,a){var l,u=this.config.getParamFor(s.type,"ABR.droppedFramesMaxRatio","number",.3),d=this.config.getParamFor(s.type,"ABR.droppedFramesMinRatio","number",.1),c=this.metricsExt.getCurrentPlaybackQuality(o),h=m.rules.SwitchRequest.prototype.NO_CHANGE,f=m.rules.SwitchRequest.prototype.DEFAULT;return null===s?new m.rules.SwitchRequest:"video"!==s.type?new m.rules.SwitchRequest:null===c?(t=null,n=i=-1,new m.rules.SwitchRequest):"buffering"===a?(t=null,n=i=-1,new m.rules.SwitchRequest):(r(c),n===-1?new m.rules.SwitchRequest:(l=n/i,this.debug.info("[DroppedFramesRule]["+s.type+"] DroppedFrames:"+n+", totalVideoFrames:"+i+" => ratio = "+l),l>u&&e>0?(h=e-1,f=m.rules.SwitchRequest.prototype.STRONG):l>d&&(h=e,f=m.rules.SwitchRequest.prototype.STRONG),this.debug.info("[DroppedFramesRule]["+s.type+"] SwitchRequest: q="+h+", p="+f),new m.rules.SwitchRequest(h,f)))}}},m.rules.DroppedFramesRule.prototype={constructor:m.rules.DroppedFramesRule},m.rules.InsufficientBufferRule=function(){"use strict";return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,isStartBuffering:{},name:"InsufficientBufferRule",checkIndex:function(e,t,n,i){var r,o,s,a,l,u,d,c,h=this.metricsExt.getCurrentBufferLevel(t),f=e,p=m.rules.SwitchRequest.prototype.DEFAULT;if(null===n)return new m.rules.SwitchRequest;if("buffering"===i&&(this.isStartBuffering[n.type]=!0),null===h)return new m.rules.SwitchRequest;if(this.debug.info("[InsufficientBufferRule]["+n.type+"] Checking buffer level ... (current = "+e+", buffer level = "+Math.round(100*h.level)/100+", buffering = "+this.isStartBuffering[n.type]+")"),c=this.manifestExt.getMpd(this.manifestModel.getValue())){if(r=this.config.getParamFor(n.type,"BufferController.minBufferTime","number",c.manifest.minBufferTime),o=this.config.getParamFor(n.type,"ABR.switchLowerBufferRatio","number",.25),s=this.config.getParamFor(n.type,"ABR.switchLowerBufferTime","number",o*r),a=this.config.getParamFor(n.type,"ABR.switchDownBufferRatio","number",.5),l=this.config.getParamFor(n.type,"ABR.switchDownBufferTime","number",a*r),u=this.config.getParamFor(n.type,"ABR.switchUpBufferRatio","number",.75),d=this.config.getParamFor(n.type,"ABR.switchUpBufferTime","number",u*r),h.level<l&&this.isStartBuffering[n.type])return new m.rules.SwitchRequest;h.level>=l&&(this.isStartBuffering[n.type]=!1);var g=this.manifestExt.getRepresentationCount(n);return g-=1,h.level<=s?(f=0,p=m.rules.SwitchRequest.prototype.STRONG):h.level<=l&&(f=e>0?e-1:0,p=m.rules.SwitchRequest.prototype.DEFAULT),this.debug.info("[InsufficientBufferRule]["+n.type+"] SwitchRequest: q="+f+", p="+p),new m.rules.SwitchRequest(f,p)}return this.debug.log("[InsufficientBufferRule]["+n.type+"] Manifest not present yet"),new m.rules.SwitchRequest}}},m.rules.InsufficientBufferRule.prototype={constructor:m.rules.OInsufficientBufferRule},m.rules.LimitSwitchesRule=function(){"use strict";var e=10,t=2e4,n=5,i=0;return{debug:void 0,name:"LimitSwitchesRule",checkIndex:function(r,o){if(i>0)return i-=1,new m.rules.SwitchRequest(r,m.rules.SwitchRequest.prototype.STRONG);var s,a,l,u=this,d=!1,c=(new Date).getTime(),h=o.RepSwitchList.length;for(l=h-1;l>=0;l-=1){if(s=o.RepSwitchList[l],a=c-s.t.getTime(),a>=t){u.debug.log("Reached time limit, bailing.");break}if(l>=e){u.debug.log("Found too many switches within validation time, force the stream to not change."),d=!0;break}}return d?(u.debug.log("Wait some time before allowing another switch."),i=n,new m.rules.SwitchRequest(r,m.rules.SwitchRequest.prototype.STRONG)):new m.rules.SwitchRequest(m.rules.SwitchRequest.prototype.NO_CHANGE,m.rules.SwitchRequest.prototype.STRONG)}}},m.rules.LimitSwitchesRule.prototype={constructor:m.rules.LimitSwitchesRule},m.rules.SwitchRequest=function(e,t){"use strict";this.quality=e,this.priority=t,void 0===this.quality&&(this.quality=999),void 0===this.priority&&(this.priority=.5)},m.rules.SwitchRequest.prototype={constructor:m.rules.SwitchRequest,NO_CHANGE:999,DEFAULT:.5,STRONG:1,WEAK:0},m.vo.Error=function(e,t,n){"use strict";this.code=e||null,this.message=t||null,this.data=n||null},m.vo.Error.prototype={constructor:m.vo.Error},m.vo.Event=function(){"use strict";this.type=null,this.sender=null,this.data=null,this.error=null,this.timestamp=NaN},m.vo.Event.prototype={constructor:m.vo.Event},m.models.MetricsList=function(){"use strict";return{TcpList:[],HttpList:[],RepSwitchList:[],BufferedSwitchList:[],BufferLevel:[],PlayList:[],DroppedFrames:[],PlaybackQuality:[],VideoResolution:[],DVRInfo:[],ManifestUpdate:[]}},m.models.MetricsList.prototype={constructor:m.models.MetricsList},m.vo.Mp4Track=function(){"use strict";this.type="und",this.trackId=0,this.timescale=0,this.duration=0,this.codecs="",this.codecPrivateData="",this.bandwidth="",this.width=0,this.height=0,this.language="und",this.channels=0,this.samplingRate=0,this.contentProtection=void 0,this.samples=[],this.data=null},m.vo.Mp4Track.prototype={constructor:m.vo.Mp4Track},m.vo.Mp4Track.Sample=function(){"use strict";this.dts=0,this.cts=0,this.duration=0,this.flags=0,this.data=null,this.size=0},m.vo.Mp4Track.Sample.prototype={constructor:m.vo.Mp4Track.Sample},m.vo.SegmentRequest=function(){"use strict";this.action="download",this.startTime=NaN,this.streamType=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.deferred=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null},m.vo.SegmentRequest.prototype={constructor:m.vo.SegmentRequest,ACTION_DOWNLOAD:"download",ACTION_COMPLETE:"complete"},m.vo.URIFragmentData=function(){"use strict";this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null},m.vo.URIFragmentData.prototype={constructor:m.vo.URIFragmentData},m.vo.metrics.BufferLevel=function(){"use strict";this.t=null,this.level=null},m.vo.metrics.BufferLevel.prototype={constructor:m.vo.metrics.BufferLevel},m.vo.metrics.BufferedSwitch=function(){"use strict";this.mt=null,this.to=null,this.lto=null},m.vo.metrics.BufferedSwitch.prototype={constructor:m.vo.metrics.BufferedSwitch},m.vo.metrics.Condition=function(){"use strict";this.isFullScreen=null,this.windowSize=null,this.droppedFrames=null,this.fps=null,this.bandwidth=null},m.vo.metrics.Condition.prototype={constructor:m.vo.metrics.Condition},m.vo.metrics.DVRInfo=function(){"use strict";this.time=null,this.range=null},m.vo.metrics.DVRInfo.prototype={constructor:m.vo.metrics.DVRInfo},m.vo.metrics.DroppedFrames=function(){"use strict";this.time=null,this.droppedFrames=null},m.vo.metrics.DroppedFrames.prototype={constructor:m.vo.metrics.DroppedFrames},m.vo.metrics.HTTPRequest=function(){"use strict";this.stream=null,this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.tfinish=null,this.responsecode=null,this.interval=null,this.mediaduration=null,this.trace=[],this.startTime=null,this.quality=null,this.bytesLength=null},m.vo.metrics.HTTPRequest.prototype={constructor:m.vo.metrics.HTTPRequest},m.vo.metrics.HTTPRequest.Trace=function(){"use strict";this.s=null,this.d=null,this.b=[]},m.vo.metrics.HTTPRequest.Trace.prototype={constructor:m.vo.metrics.HTTPRequest.Trace},m.vo.metrics.ManifestUpdate=function(){"use strict";this.streamType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.periodInfo=[],this.representationInfo=[]},m.vo.metrics.ManifestUpdate.PeriodInfo=function(){"use strict";this.id=null,this.index=null,this.start=null,this.duration=null},m.vo.metrics.ManifestUpdate.RepresentationInfo=function(){"use strict";this.id=null,this.index=null,this.streamType=null,this.periodIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.segmentInfoType=null},m.vo.metrics.ManifestUpdate.prototype={constructor:m.vo.metrics.ManifestUpdate},m.vo.metrics.ManifestUpdate.PeriodInfo.prototype={constructor:m.vo.metrics.ManifestUpdate.PeriodInfo},m.vo.metrics.ManifestUpdate.RepresentationInfo.prototype={constructor:m.vo.metrics.ManifestUpdate.RepresentationInfo},m.vo.metrics.PlayList=function(){"use strict";this.stream=null,this.start=null,this.mstart=null,this.starttype=null,this.trace=[]},m.vo.metrics.PlayList.Trace=function(){"use strict";this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null},m.vo.metrics.PlayList.prototype={constructor:m.vo.metrics.PlayList},m.vo.metrics.PlayList.INITIAL_PLAY_START_REASON="initial_start",m.vo.metrics.PlayList.SEEK_START_REASON="seek",m.vo.metrics.PlayList.Trace.prototype={constructor:m.vo.metrics.PlayList.Trace()},m.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON="user_request",m.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",m.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON="end_of_content",m.vo.metrics.PlayList.Trace.REBUFFERING_REASON="rebuffering",m.vo.metrics.PlaybackQuality=function(){"use strict";this.t=null,this.mt=null,this.droppedFrames=null,this.totalVideoFrames=null},m.vo.metrics.PlaybackQuality.prototype={constructor:m.vo.metrics.PlaybackQuality},m.vo.metrics.RepresentationSwitch=function(){"use strict";this.t=null,this.mt=null,this.to=null,this.lto=null},m.vo.metrics.RepresentationSwitch.prototype={constructor:m.vo.metrics.RepresentationSwitch},m.vo.metrics.Session=function(){"use strict";this.uri=null,this.loopMode=null,this.endTime=null,this.playerType=null},m.vo.metrics.Session.prototype={constructor:m.vo.metrics.Session},m.vo.metrics.State=function(){"use strict";this.t=null,this.current=null,this.position=null,this.reason=null},m.vo.metrics.State.prototype={constructor:m.vo.metrics.State},m.vo.metrics.TCPConnection=function(){"use strict";this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null},m.vo.metrics.TCPConnection.prototype={constructor:m.vo.metrics.TCPConnection},m.vo.metrics.VideoResolution=function(){"use strict";this.t=null,this.mt=null,this.width=null,this.height=null},m.vo.metrics.VideoResolution.prototype={constructor:m.vo.metrics.VideoResolution},p=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}(),p.dependencies.BaseURLExtensions=function(){"use strict";var e=function(e,t){for(var n,i,r,o,s,a,l,u,d,c,h=new DataView(e),f={},p=0;"sidx"!==u&&p<h.byteLength;){for(d=h.getUint32(p),p+=4,u="",o=0;o<4;o+=1)c=h.getInt8(p),u+=String.fromCharCode(c),p+=1;"moof"!==u&&"traf"!==u&&"sidx"!==u?p+=d-8:"sidx"===u&&(p-=8)}if(r=h.getUint32(p,!1)+p,r>e.byteLength)throw"sidx terminates after array buffer";for(f.version=h.getUint8(p+8),p+=12,f.timescale=h.getUint32(p+4,!1),p+=8,0===f.version?(f.earliest_presentation_time=h.getUint32(p,!1),f.first_offset=h.getUint32(p+4,!1),p+=8):(f.earliest_presentation_time=b.Math.to64BitNumber(h.getUint32(p+4,!1),h.getUint32(p,!1)),f.first_offset=(h.getUint32(p+8,!1)<<32)+h.getUint32(p+12,!1),p+=16),f.first_offset+=r+(t||0),f.reference_count=h.getUint16(p+2,!1),p+=4,f.references=[],n=f.first_offset,i=f.earliest_presentation_time,o=0;o<f.reference_count;o+=1)a=h.getUint32(p,!1),s=a>>>31,a=2147483647&a,l=h.getUint32(p+4,!1),p+=12,a>0&&f.references.push({size:a,type:s,offset:n,duration:l,time:i,timescale:f.timescale}),n+=a,i+=l;if(p!==r)throw"Error: final pos "+p+" differs from SIDX end "+r;return f},t=function(t,n,i){var r,o,s,a,l,u,d,c;for(r=e.call(this,t,i),o=r.references,s=[],l=0,u=o.length;l<u;l+=1)a=new p.vo.Segment,a.duration=o[l].duration,a.media=n,a.startTime=o[l].time,a.timescale=o[l].timescale,d=o[l].offset,c=o[l].offset+o[l].size-1,a.mediaRange=d+"-"+c,s.push(a);return this.debug.log("Parsed SIDX box: "+s.length+" segments."),s},n=function(e,t){var i,r,o,s,a,l,d,c,h,f=u.defer(),p=new DataView(e),m=0,g="",y=0,v=!1,_=this;for(_.debug.log("Searching for initialization.");"moov"!==g&&m<p.byteLength;){for(y=p.getUint32(m),m+=4,g="",l=0;l<4;l+=1)d=p.getInt8(m),g+=String.fromCharCode(d),m+=1;"ftyp"===g&&(i=m-8),"moov"===g&&(r=m-8),"moov"!==g&&(m+=y-8)}return a=p.byteLength-m,"moov"!==g?(_.debug.log("Loading more bytes to find initialization."),t.range.start=0,t.range.end=t.bytesLoaded+t.bytesToLoad,c=new XMLHttpRequest,c.onloadend=function(){v||f.reject("Error loading initialization.")},c.onload=function(){v=!0,t.bytesLoaded=t.range.end,n.call(_,c.response).then(function(e){f.resolve(e)})},c.onerror=function(){f.reject("Error loading initialization.")},c.open("GET",_.tokenAuthentication.addTokenAsQueryArg(t.url)),c.responseType="arraybuffer",c.setRequestHeader("Range","bytes="+t.range.start+"-"+t.range.end),c=_.tokenAuthentication.setTokenInRequestHeader(c),c.send(null)):(o=void 0===i?r:i,s=r+y-1,h=o+"-"+s,_.debug.log("Found the initialization.  Range: "+h),f.resolve(h)),f.promise},i=function(e){var t=u.defer(),i=new XMLHttpRequest,r=!0,o=this,s={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:i};return o.debug.log("Start searching for initialization."),s.range.start=0,s.range.end=s.bytesToLoad,i.onload=function(){i.status<200||i.status>299||(r=!1,s.bytesLoaded=s.range.end,n.call(o,i.response,s).then(function(e){t.resolve(e)},function(){t.reject()}))},i.onloadend=i.onerror=function(){if(r){r=!1;var e={};e.url=s.url,e.request=i,o.errHandler.sendError(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT,null,e),t.reject(i)}},i.open("GET",o.tokenAuthentication.addTokenAsQueryArg(s.url)),i.responseType="arraybuffer",i.setRequestHeader("Range","bytes="+s.range.start+"-"+s.range.end),i=o.tokenAuthentication.setTokenInRequestHeader(i),i.send(null),o.debug.log("Perform init search: "+s.url),t.promise},r=function(e,n){var i,o,s,a,l,d,c,h,f=u.defer(),p=new DataView(e),g=new XMLHttpRequest,y=0,v="",_=0,b=!0,E=!1,x=this;for(x.debug.log("Searching for SIDX box."),x.debug.log(n.bytesLoaded+" bytes loaded.");"sidx"!==v&&y<p.byteLength;){for(_=p.getUint32(y),y+=4,v="",l=0;l<4;l+=1)d=p.getInt8(y),v+=String.fromCharCode(d),y+=1;"sidx"!==v&&(y+=_-8)}if(i=p.byteLength-y,"sidx"!==v)f.reject();else if(i<_-8)x.debug.log("Found SIDX but we don't have all of it."),n.range.start=0,n.range.end=n.bytesLoaded+(_-i),g.onload=function(){g.status<200||g.status>299||(b=!1,n.bytesLoaded=n.range.end,r.call(x,g.response,n).then(function(e){f.resolve(e)}))},g.onloadend=g.onerror=function(){if(b){b=!1;var e={};e.url=n.url,e.request=g,x.errHandler.sendError(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),f.reject(g)}},g.open("GET",x.tokenAuthentication.addTokenAsQueryArg(n.url)),g.responseType="arraybuffer",g.setRequestHeader("Range","bytes="+n.range.start+"-"+n.range.end),g=x.tokenAuthentication.setTokenInRequestHeader(g),g.send(null);else if(n.range.start=y-8,n.range.end=n.range.start+_,x.debug.log("Found the SIDX box.  Start: "+n.range.start+" | End: "+n.range.end),o=new ArrayBuffer(n.range.end-n.range.start),a=new Uint8Array(o),s=new Uint8Array(e,n.range.start,n.range.end-n.range.start),a.set(s),c=this.parseSIDX.call(this,o,n.range.start),h=c.references,null!==h&&void 0!==h&&h.length>0&&(E=1===h[0].type),E){x.debug.log("Initiate multiple SIDX load.");var S,T,w,D,M,I,L=[];for(S=0,T=h.length;S<T;S+=1)w=h[S].offset,D=h[S].offset+h[S].size-1,M=w+"-"+D,L.push(this.loadSegments.call(x,n.url,M));u.all(L).then(function(e){for(I=[],S=0,T=e.length;S<T;S+=1)I=I.concat(e[S]);f.resolve(I)},function(e){f.reject(e)})}else x.debug.log("Parsing segments from SIDX."),f.resolve(t.call(x,o,n.url,n.range.start));return f.promise},o=function(e,n){var i,o=u.defer(),s=new XMLHttpRequest,a=!0,l=this,d={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:s};return null===n?(l.debug.log("No known range for SIDX request."),d.searching=!0,d.range.start=0,d.range.end=d.bytesToLoad):(i=n.split("-"),d.range.start=parseFloat(i[0]),d.range.end=parseFloat(i[1])),s.onload=function(){s.status<200||s.status>299||(a=!1,d.searching?(d.bytesLoaded=d.range.end,r.call(l,s.response,d).then(function(e){o.resolve(e)},function(){o.reject()})):o.resolve(t.call(l,s.response,d.url,d.range.start)))},s.onloadend=s.onerror=function(){if(a){a=!1;var e={};e.url=d.url,e.request=s,l.errHandler.sendError(m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),o.reject(s)}},s.open("GET",l.tokenAuthentication.addTokenAsQueryArg(d.url)),s.responseType="arraybuffer",s.setRequestHeader("Range","bytes="+d.range.start+"-"+d.range.end),s=l.tokenAuthentication.setTokenInRequestHeader(s),s.send(null),l.debug.log("Perform SIDX load: "+d.url),o.promise};return{debug:void 0,errHandler:void 0,tokenAuthentication:void 0,loadSegments:o,loadInitialization:i,parseSegments:t,parseSIDX:e,findSIDX:r}},p.dependencies.BaseURLExtensions.prototype={constructor:p.dependencies.BaseURLExtensions},p.di.DashContext=function(){"use strict";return{system:void 0,setup:function(){p.di.DashContext.prototype.setup.call(this),this.system.mapClass("parser",p.dependencies.DashParser),this.system.mapClass("indexHandler",p.dependencies.DashHandler),this.system.mapClass("baseURLExt",p.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",p.dependencies.FragmentExtensions),this.system.mapSingleton("manifestExt",p.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",p.dependencies.DashMetricsExtensions),this.system.mapSingleton("timelineConverter",p.dependencies.TimelineConverter)}}},p.di.DashContext.prototype=new m.di.Context,p.di.DashContext.prototype.constructor=p.di.DashContext,p.dependencies.DashHandler=function(){"use strict";var e,t,n=-1,i=null,r=function(e,t){for(;e.length<t;)e="0"+e;return e},o=function(e,t,n){for(var i,o,s,a,l=0,u=0,d=t.length,c="%0",h=c.length;;){if(l=e.indexOf("$"+t),l<0)return e;if(u=e.indexOf("$",l+d),u<0)return e;if(i=e.indexOf(c,l+d),i>l&&i<u)switch(o=e.charAt(u-1),s=parseInt(e.substring(i+h,u-1),10),o){case"d":case"i":case"u":a=r(n.toString(),s);break;case"x":a=r(n.toString(16),s);break;case"X":a=r(n.toString(16),s).toUpperCase();break;case"o":a=r(n.toString(8),s);break;default:return this.debug.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),e}else a=n;e=e.substring(0,l)+a+e.substring(u+1)}},s=function(e){return e.split("$$").join("$")},a=function(e,t){if(null===t||e.indexOf("$RepresentationID$")===-1)return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},l=function(e,t){return e.representation.startNumber+t},d=function(e,t){var n,i=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].BaseURL;return n=e===i?e:e.indexOf("http://")!==-1||e.indexOf("https://")!==-1?e:i+e},c=function(t,n){var i,r,o=this,s=new m.vo.SegmentRequest;return i=t.adaptation.period,s.streamType=n,s.type="Initialization Segment",s.url=d(t.initialization,t),s.range=t.range,r=i.start,s.availabilityStartTime=o.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(r,t.adaptation.period.mpd,e),s.availabilityEndTime=o.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(r+i.duration,i.mpd,e),s.quality=t.index,s},h=function(e){var n=u.defer(),i=null,r=null,o=this;return e?(e.initialization?(i=c.call(o,e,t),n.resolve(i)):(r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,o.baseURLExt.loadInitialization(r).then(function(s){e.range=s,e.initialization=r,i=c.call(o,e,t),n.resolve(i)},function(e){n.reject(e)})),n.promise):u.reject("no represenation")},f=function(t){var i,r,o,s=t.adaptation.period,a=!1;return e?a=!1:n<0?a=!1:n<t.availableSegmentsNumber+t.segmentStartIndex?(r=I(n,t),r&&(o=r.presentationStartTime-s.start,i=t.adaptation.period.duration,a=o>=i)):a=!0,a},g=function(t,n){var i,r,o,s,a=this;return r=t.segmentDuration,o=t.adaptation.period.start+n*r,s=o+r,i=new p.vo.Segment,i.representation=t,i.duration=r,i.presentationStartTime=o,i.mediaStartTime=a.timelineConverter.calcMediaTimeFromPresentationTime(i.presentationStartTime,t),i.availabilityStartTime=a.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(i.presentationStartTime,t.adaptation.period.mpd,e),i.availabilityEndTime=a.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(s,t.adaptation.period.mpd,e),i.wallStartTime=a.timelineConverter.calcWallTimeForSegment(i,e),i.replacementNumber=l(i,n),i.availabilityIdx=n,i},y=function(e){var t,n,r,o,s,a,l,d,c,h,f,p,m,g=this,y=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,v=y.SegmentTimeline,_=e.availableSegmentsNumber>0,E=10,S=[],T=0,w=-1,D=!1,M=function(t){return x.call(g,e,T,t.d,m,y.media,t.mediaRange,w,t.tManifest)};for(m=e.timescale,t=v.S_asArray,c=b.call(g,e),c?(f=c.start,p=c.end):h=g.timelineConverter.calcMediaTimeFromPresentationTime(i||0,e),r=0,o=t.length;r<o;r+=1)if(n=t[r],a=0,n.hasOwnProperty("r")&&(a=n.r),n.hasOwnProperty("t")&&(T=n.t),a<0&&(d=t[r+1],l=d&&d.hasOwnProperty("t")?d.t/m:e.adaptation.period.duration,a=Math.ceil((l-T/m)/(n.d/m))-1),D){if(_)break;w+=a+1}else for(s=0;s<=a;s+=1){if(w+=1,c){if(w>p){if(D=!0,_)break;continue}w>=f&&S.push(M.call(g,n))}else{if(S.length>E){if(D=!0,_)break;continue}T/m>=h-n.d/m&&S.push(M.call(g,n))}T+=n.d}if(!_){var I,L,C=t[0];I=void 0===C.t?0:g.timelineConverter.calcPresentationTimeFromMediaTime(C.t/m,e),L=g.timelineConverter.calcPresentationTimeFromMediaTime((T-n.d)/m,e),e.segmentAvailabilityRange={start:I,end:L},e.availableSegmentsNumber=w+1,e.segmentStartIndex=0}return u.when(S)},v=function(t){var n,i,r,s,a=[],l=this,d=u.defer(),c=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentTemplate,h=t.segmentDuration,f=null,p=Math.floor(t.adaptation.period.start/h),m=null,y=null;return s=t.startNumber,E.call(l,t).then(function(u){for(t.segmentAvailabilityRange=u,f=_.call(l,t),i=f.start,r=f.end,n=i;n<=r;n+=1)m=g.call(l,t,n-(e?p:0)),m.replacementTime=(s+n-1)*t.segmentDuration,y=c.media,y=o(y,"Number",m.replacementNumber),y=o(y,"Time",m.replacementTime),m.media=y,a.push(m),m=null;t.availableSegmentsNumber=p+Math.ceil((u.end-u.start)/h),t.segmentStartIndex=i,d.resolve(a)}),d.promise},_=function(t){var r,o,s,a=this,l=t.adaptation.period.start,u=t.segmentDuration,d=t.adaptation.period.mpd.manifest.minBufferTime,c=t.segmentAvailabilityRange,h=NaN,f=null,p=t.segments,m=2*u,g=Math.max(2*d,10*u);return c||(c=a.timelineConverter.calcSegmentAvailabilityRange(t,e)),
e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted?(r=Math.floor(c.start/u),o=Math.floor(c.end/u),s={start:r,end:o}):(p?(f=I(n,t),h=f?f.presentationStartTime-l:n>0?n*u:i-l||p[0].presentationStartTime-l):h=n>0?n*u:e?c.end:c.start,r=Math.floor(Math.max(h-m,c.start)/u),o=Math.floor(Math.min(r+g/u,c.end/u)),s={start:r,end:o})},b=function(t){var r,o,s,a=NaN,l=t.segments,u=2,d=10,c=0,h=Number.POSITIVE_INFINITY;if(e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted)return s={start:c,end:h};if(!e&&null!==i)return null;if(l){if(n<0)return null;a=n}else a=n>0?n:e?h:c;return r=Math.max(a-u,c),o=Math.min(a+d,h),s={start:r,end:o}},E=function(t){var n,i,r=this,o=u.defer(),s=function(){n=r.timelineConverter.calcSegmentAvailabilityRange(t,e),n.end>0?o.resolve(n):(i=1e3*Math.abs(n.end),setTimeout(s,i))};return s(),o.promise},x=function(t,n,i,r,s,a,u,d){var c,h,f,m=this,g=n/r,y=Math.min(i/r,t.adaptation.period.mpd.maxSegmentDuration);return c=m.timelineConverter.calcPresentationTimeFromMediaTime(g,t),c=g,h=c+y,f=new p.vo.Segment,f.representation=t,f.duration=y,f.mediaStartTime=g,f.presentationStartTime=c,f.availabilityStartTime=t.adaptation.period.mpd.manifest.mpdLoadedTime,f.availabilityEndTime=m.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(h,t.adaptation.period.mpd,e),f.wallStartTime=m.timelineConverter.calcWallTimeForSegment(f,e),f.replacementTime=d?d:n,f.replacementNumber=l(f,u),s=o(s,"Number",f.replacementNumber),s=o(s,"Time",f.replacementTime),f.media=s,f.mediaRange=a,f.availabilityIdx=u,f},S=function(t){var n,i,r,o,s,a=this,l=[],d=u.defer(),c=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,h=c.SegmentURL_asArray.length,f=0,p=c.SegmentURL_asArray.length;return s=t.startNumber,E.call(a,t).then(function(u){for(e||(o=_.call(a,t),f=o.start,p=o.end),n=f;n<p;n+=1)r=c.SegmentURL_asArray[n],i=g.call(a,t,n),i.replacementTime=(s+n-1)*t.segmentDuration,i.media=r.media,i.mediaRange=r.mediaRange,i.index=r.index,i.indexRange=r.indexRange,r.duration&&(i.duration=r.duration,i.presentationStartTime=i.mediaStartTime=r.time),void 0!==r.sequenceNumber&&(i.sequenceNumber=r.sequenceNumber),void 0!==r.decryptionInfo&&(i.decryptionInfo=r.decryptionInfo),l.push(i),i=null;t.segmentAvailabilityRange=u,t.availableSegmentsNumber=h,t.segmentStartIndex=f,d.resolve(l)}),d.promise},T=function(e){var t,n,i,r,o=this,s=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,a=u.defer(),l=[],d=0,c=null;return e.indexRange&&(c=e.indexRange),this.baseURLExt.loadSegments(s,c).then(function(s){for(n=0,i=s.length;n<i;n+=1)t=s[n],r=x.call(o,e,t.startTime,t.duration,t.timescale,t.media,t.mediaRange,d),l.push(r),r=null,d+=1;e.segmentAvailabilityRange={start:l[0].presentationStartTime,end:l[i-1].presentationStartTime},e.availableSegmentsNumber=i,e.segmentStartIndex=0,a.resolve(l)},function(){a.reject()}),a.promise},w=function(t){var n,i,r=u.defer(),o=this;return C.call(o,t)?(n="SegmentTimeline"===t.segmentInfoType?y.call(o,t):"SegmentTemplate"===t.segmentInfoType?v.call(o,t):"SegmentList"===t.segmentInfoType?S.call(o,t):T.call(o,t),u.when(n).then(function(n){if(t.segments=n,i=n.length-1,e&&isNaN(t.adaptation.period.liveEdge)){var s=o.metricsModel.getMetricsFor("stream"),a=n[i].presentationStartTime;t.adaptation.period.liveEdge=a,o.metricsModel.updateManifestUpdateInfo(o.metricsExt.getCurrentManifestUpdate(s),{presentationStartTime:a})}r.resolve(n)},function(){r.reject()}),r.promise):u.when(t.segments)},D=function(e){var n=this,i=u.defer();return e.segments=null,n.debug.log("[DashHandler]["+t+"] updateSegmentList for representation ",e.id),w.call(n,e).then(function(t){e.segments=t,i.resolve(t)}),i.promise},M=function(e,n){var i,r,o,s,a=null===n?null:n.segments,l=null===a?0:a.length-1,d=-1,c=this;if(c.debug.log("[DashHandler]["+t+"] getIndexForSegments for time ",e),a&&a.length>0)for(s=l;s>=0;s--){if(i=a[s],r=i.presentationStartTime,o=i.duration,e+p.dependencies.DashHandler.EPSILON>=r&&e-p.dependencies.DashHandler.EPSILON<=r+o){d=i.availabilityIdx,c.debug.log("[DashHandler]["+t+"] getIndexForSegments, idx =  ",d);break}if(d===-1&&e-p.dependencies.DashHandler.EPSILON>r+o){c.debug.log("[DashHandler]["+t+"] getIndexForSegments, (past the end) idx =  ",d),d=isNaN(n.segmentDuration)?i.availabilityIdx+1:Math.floor((e-n.adaptation.period.start)/n.segmentDuration);break}}return d===-1&&(isNaN(n.segmentDuration)?c.debug.log("[DashHandler]["+t+"] Couldn't figure out segment for time: "+e):(c.debug.log("[DashHandler]["+t+"] getIndexForSegments, (segment duration) idx =  ",d),d=Math.floor((e-n.adaptation.period.start)/n.segmentDuration))),u.when(d)},I=function(e,t){if(!t||!t.segments)return null;var n,i,r=t.segments.length;for(i=0;i<r;i+=1)if(n=t.segments[i],n.availabilityIdx===e)return n;return null},L=function(e,t){if(!t||!t.segments)return null;var n,i,r=t.segments.length;for(i=0;i<r;i+=1)if(n=t.segments[i],void 0!==n.sequenceNumber&&n.sequenceNumber===e)return i<r-1?t.segments[i+1]:null;return null},C=function(e){var t,r,o,s,a=!1,l=e.segments;return l&&0!==l.length?null!==i?(s=l[0].presentationStartTime,o=l[l.length-1].presentationStartTime,a=i<s||i>o):(r=l[0].availabilityIdx,t=l[l.length-1].availabilityIdx,a=n<r||n>t):a=!0,a},R=function(e){if(null===e||void 0===e)return null;var n,i=new m.vo.SegmentRequest,r=e.representation,l=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth;return n=d(e.media,r),n=o(n,"Number",e.replacementNumber),n=o(n,"Time",e.replacementTime),n=o(n,"Bandwidth",l),n=a(n,r.id),n=s(n),i.streamType=t,i.type="Media Segment",i.url=n,i.range=e.mediaRange,i.startTime=e.presentationStartTime,i.duration=e.duration,i.timescale=r.timescale,i.availabilityStartTime=e.availabilityStartTime,i.availabilityEndTime=e.availabilityEndTime,i.wallStartTime=e.wallStartTime,i.quality=r.index,i.index=e.availabilityIdx,void 0!==e.sequenceNumber&&(i.sequenceNumber=e.sequenceNumber),void 0!==e.decryptionInfo&&(i.decryptionInfo=e.decryptionInfo),i},A=function(e,r){var o,s,a,l=this;return e?(i=r,n=-1,l.debug.log("[DashHandler]["+t+"] Getting the request for time: "+r),o=u.defer(),w.call(l,e).then(function(){var t;return t=M.call(l,r,e)},function(){o.reject()}).then(function(i){return l.debug.log("[DashHandler]["+t+"] Index for time "+r+" is "+i),n=i,u.when(f.call(l,e))}).then(function(i){var r=null;return i?(s=new m.vo.SegmentRequest,s.action=s.ACTION_COMPLETE,s.index=n,l.debug.log("[DashHandler]["+t+"] Signal complete."),l.debug.log(s),o.resolve(s)):(a=I(n,e),r=R.call(l,a)),u.when(r)}).then(function(e){o.resolve(e)}),o.promise):u.reject("no representation")},P=function(e){var r,o,s,a,l=this;if(!e)return u.reject("no represenation");if(n===-1)throw"You must call getSegmentRequestForTime first.";return i=null,n+=1,r=u.defer(),l.debug.log("[DashHandler]["+t+"] Getting the next request => index = "+n),a=f.call(l,e),a?(o=new m.vo.SegmentRequest,o.action=o.ACTION_COMPLETE,o.index=n,l.debug.log("[DashHandler]["+t+"] Signal complete."),r.resolve(o)):w.call(l,e).then(function(){var t;return s=I(n,e),t=R.call(l,s),u.when(t)}).then(function(e){r.resolve(e)}),r.promise},F=function(e,r){var o,s,a,l,d=this;if(!e)return u.reject("no represenation");if(n===-1)throw"You must call getSegmentRequestForTime first.";return i=null,n+=1,o=u.defer(),d.debug.log("[DashHandler]["+t+"] Getting the next request => sn = "+r),w.call(d,e).then(function(){if(l=f.call(d,e))s=new m.vo.SegmentRequest,s.action=s.ACTION_COMPLETE,s.index=n,d.debug.log("[DashHandler]["+t+"] Signal complete."),o.resolve(s);else if(a=L(r,e),null===a)o.resolve(null);else{n=a.availabilityIdx;var i=R.call(d,a);o.resolve(i)}}),o.promise},N=function(e,n,i){var r,o=this,s=Math.max(n-i,0),a=u.defer(),l=0;return e?(o.debug.log("[DashHandler]["+t+"] getSegmentCountForDuration"),w.call(o,e).then(function(e){r=e[0].duration,l=Math.ceil(s/r),a.resolve(l)},function(){a.resolve(0)}),a.promise):u.reject("no represenation")},B=function(e){var i,r,o=this,s=u.defer();return e?(r=n,w.call(o,e).then(function(n){r<0?i=o.timelineConverter.calcPresentationStartTime(e.adaptation.period):(r=r<n[0].availabilityIdx?n[0].availabilityIdx:Math.min(n[n.length-1].availabilityIdx,r),i=I(r,e).presentationStartTime,o.debug.log("[DashHandler]["+t+"] getSegmentByIndex, index = "+r+" => time = "+i)),o.debug.log("[DashHandler]["+t+"] getCurrentTime => ",i),s.resolve(i)},function(){s.reject()}),s.promise):u.reject("no represenation")},k=function(){},O=function(){};return{debug:void 0,baseURLExt:void 0,metricsModel:void 0,metricsExt:void 0,manifestModel:void 0,manifestExt:void 0,timelineConverter:void 0,capabilities:void 0,videoModel:void 0,getType:function(){return t},setType:function(e){t=e},getIsDynamic:function(){return e},setIsDynamic:function(t){e=t},getInitRequest:h,getSegmentRequestForTime:A,getNextSegmentRequest:P,getNextSegmentRequestFromSN:F,getCurrentTime:B,getSegmentCountForDuration:N,updateSegmentList:D,getIFrameRequest:k,getFragmentInfoRequest:O}},p.dependencies.DashHandler.EPSILON=.003,p.dependencies.DashHandler.prototype={constructor:p.dependencies.DashHandler},p.dependencies.DashManifestExtensions=function(){"use strict";this.timelineConverter=void 0},p.dependencies.DashManifestExtensions.prototype={constructor:p.dependencies.DashManifestExtensions,getIsType:function(e,t,n){"use strict";var i,r,o,s,a=!1;if(!e)return!1;if(void 0===e.type&&(e.type=null),o=e.ContentComponent_asArray)for(i=0;i<e.ContentComponent_asArray.length&&!a;i++)e.ContentComponent_asArray[i].contentType===t&&(e.type=t,a=!0);if(!a&&e.mimeType)for(i=0;i<n.length&&!a;i++)e.mimeType.indexOf(n[i])!==-1&&(e.type=t,a=!0);if(!a)for(i=0;i<e.Representation_asArray.length&&!a;i++)for(s=e.Representation_asArray[i],r=0;r<n.length&&!a;r++)s.mimeType.indexOf(n[r])!==-1&&(e.type=t,a=!0);return a},getIsVideo:function(e){return this.getIsType(e,"video",["video"])},getIsAudio:function(e){return this.getIsType(e,"audio",["audio"])},getIsText:function(e){return this.getIsType(e,"text",["vtt","ttml","application/mp4"])},getIsTextTrack:function(e){return"text/vtt"===e||"application/ttml+xml"===e||"application/ttml+xml+mp4"===e||"application/mp4"===e},getIsMain:function(){"use strict";return!1},processAdaptation:function(e){"use strict";return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e},getDataForId:function(e,t,n){"use strict";var i,r,o=t.Period_asArray[n].AdaptationSet_asArray;for(i=0,r=o.length;i<r;i+=1)if(o[i].hasOwnProperty("id")&&o[i].id===e)return o[i];return null},getDataForIndex:function(e,t,n){"use strict";var i;return t&&n>=0&&(i=t.Period_asArray[n].AdaptationSet_asArray,i&&i.length>0&&!isNaN(e))?i[e]:[]},getIndex:function(e,t){var n,i,r,o=t.Period_asArray;for(i=0;i<o.length;i+=1)for(n=o[i].AdaptationSet_asArray,r=0;r<n.length;r+=1)if(n[r]===e)return r;return-1},getDataIndex:function(e,t,n){"use strict";var i,r,o;if(t&&n>=0)if(i=t.Period_asArray[n].AdaptationSet_asArray,e.id){for(r=0,o=i.length;r<o;r+=1)if(i[r].id&&i[r].id===e.id)return r}else{var s,a=JSON.stringify(e);for(r=0,o=i.length;r<o;r+=1)if(s=JSON.stringify(i[r]),s===a)return r}return-1},getVideoData:function(e,t){"use strict";var n,i;if(!e||t<0)return null;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return null;for(i=0;i<n.length;i+=1)if(this.getIsVideo(n[i]))return n[i];return null},getTextDatas:function(e,t){"use strict";var n,i,r=[];if(!e||t<0)return r;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return r;for(i=0;i<n.length;i+=1)this.getIsText(n[i])&&r.push(n[i]);return r},getAudioDatas:function(e,t){"use strict";var n,i,r=[];if(!e||t<0)return r;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return r;for(i=0;i<n.length;i+=1)this.getIsAudio(n[i])&&r.push(n[i]);return r},getSpecificAudioData:function(e,t,n){"use strict";var i,r;if(!e||t<0)return null;if(r=this.getAudioDatas(e,t),0===r.length)return null;for(i=0;i<r.length;i+=1)if(r[i].lang===n)return this.processAdaptation(r[i]);return this.processAdaptation(r[0])},getSpecificTextData:function(e,t,n){"use strict";var i,r;if(!e||t<0)return null;if(r=this.getTextDatas(e,t),0===r.length)return null;for(i=0;i<r.length;i+=1)if(r[i].lang===n)return this.processAdaptation(r[i]);return this.processAdaptation(r[0])},getCodec:function(e){"use strict";for(var t,n=0,i=null;null===i&&n<e.Representation_asArray.length;)t=e.Representation_asArray[n],i=this.getCodecForRepresentation(t),n++;return i},getCodecForRepresentation:function(e){"use strict";return null===e.codecs||""===e.codecs?null:e.mimeType+';codecs="'+e.codecs+'"'},getMimeType:function(e){"use strict";return e.Representation_asArray[0].mimeType},getKID:function(e){"use strict";return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null},getContentProtectionData:function(e){"use strict";return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:function(e){"use strict";var t=!1,n="dynamic";return e&&e.hasOwnProperty("type")&&(t=e.type===n),t},getIsDVR:function(e){"use strict";var t,n,i=this.getIsDynamic(e);return t=!isNaN(e.timeShiftBufferDepth),n=i&&t},getIsOnDemand:function(e){"use strict";var t=!1;return e.profiles&&e.profiles.length>0&&(t=e.profiles.indexOf("urn:mpeg:dash:profile:isoff-on-demand:2011")!==-1),t},getDuration:function(e){var t;return t=e&&e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.POSITIVE_INFINITY},getBandwidth:function(e){"use strict";return e.bandwidth},getRefreshDelay:function(e){"use strict";var t=NaN,n=2;return e.hasOwnProperty("minimumUpdatePeriod")&&(t=Math.max(parseFloat(e.minimumUpdatePeriod),n)),t},getRepresentationCount:function(e){"use strict";return e?e.Representation_asArray.length:null},getRepresentationFor:function(e,t){"use strict";return t.Representation_asArray[e]},getRepresentationsForAdaptation:function(e,t){var n,i,r,o,s,a=[];if(e&&t){n=this.processAdaptation(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]);for(var l=0;l<n.Representation_asArray.length;l+=1)s=n.Representation_asArray[l],i=new p.vo.Representation,i.index=l,i.adaptation=t,s.hasOwnProperty("id")&&(i.id=s.id),s.hasOwnProperty("SegmentBase")?(o=s.SegmentBase,i.segmentInfoType="SegmentBase"):s.hasOwnProperty("SegmentList")?(o=s.SegmentList,i.segmentInfoType="SegmentList",i.useCalculatedLiveEdgeTime=!0):s.hasOwnProperty("SegmentTemplate")?(o=s.SegmentTemplate,o.hasOwnProperty("SegmentTimeline")?i.segmentInfoType="SegmentTimeline":i.segmentInfoType="SegmentTemplate",o.hasOwnProperty("initialization")&&(i.initialization=o.initialization.split("$Bandwidth$").join(s.bandwidth).split("$RepresentationID$").join(s.id))):(o=s.BaseURL,i.segmentInfoType="BaseURL"),o.hasOwnProperty("Initialization")?(r=o.Initialization,r.hasOwnProperty("sourceURL")?i.initialization=r.sourceURL:r.hasOwnProperty("range")&&(i.initialization=s.BaseURL,i.range=r.range)):s.hasOwnProperty("mimeType")&&this.getIsTextTrack(s.mimeType)&&(i.initialization=s.BaseURL,i.range=0),o.hasOwnProperty("timescale")&&(i.timescale=o.timescale),o.hasOwnProperty("duration")&&(i.segmentDuration=o.duration/i.timescale),o.hasOwnProperty("startNumber")&&(i.startNumber=o.startNumber),o.hasOwnProperty("indexRange")&&(i.indexRange=o.indexRange),o.hasOwnProperty("presentationTimeOffset")&&(i.presentationTimeOffset=o.presentationTimeOffset/i.timescale),i.MSETimeOffset=this.timelineConverter.calcMSETimeOffset(i),a.push(i)}return a},getAdaptationsForPeriod:function(e,t){var n,i=null===e?null:e.Period_asArray[t.index],r=[];if(i)for(var o=0;o<i.AdaptationSet_asArray.length;o+=1)n=new p.vo.AdaptationSet,n.index=o,n.period=t,r.push(n);return r},getRegularPeriods:function(e,t){var n,i,r=[],o=this.getIsDynamic(e),s=null,a=null,l=null,u=null;for(n=0,i=e.Period_asArray.length;n<i;n+=1)a=e.Period_asArray[n],a.hasOwnProperty("start")?(u=new p.vo.Period,u.start=a.start):null!==s&&a.hasOwnProperty("duration")?(u=new p.vo.Period,u.start=l.start+l.duration,u.duration=a.duration):0!==n||o||(u=new p.vo.Period,u.start=0),null!==l&&isNaN(l.duration)&&(l.duration=u.start-l.start),null!==u&&a.hasOwnProperty("id")&&(u.id=a.id),null!==u&&a.hasOwnProperty("duration")&&(u.duration=a.duration),null!==u&&(u.index=n,u.mpd=t,r.push(u)),s=a,a=null,l=u,u=null;return 0===r.length?r:(t.checkTime=this.getCheckTime(e,r[0]),null!==l&&isNaN(l.duration)&&(l.duration=this.getEndTimeForLastPeriod(t)-l.start),r)},getMpd:function(e){var t=new p.vo.Mpd;return e?(t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.mpdLoadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t):null},getFetchTime:function(e,t){var n=this.timelineConverter.calcPresentationTimeFromWallTime(e.mpdLoadedTime,t);return n},getCheckTime:function(e,t){var n=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(n=this.getFetchTime(e,t)+e.minimumUpdatePeriod),n},getEndTimeForLastPeriod:function(e){var t;if(e.manifest.mediaPresentationDuration)t=e.manifest.mediaPresentationDuration;else{if(isNaN(e.checkTime))return new Error("Must have @mediaPresentationDuration or @minimumUpdatePeriod on MPD or an explicit @duration on the last period.");t=e.checkTime}return t},getEventsForPeriod:function(e,t){var n=null===e?null:e.Period_asArray,i=null===n?null:n[t.index].EventStream_asArray,r=[];if(i)for(var o=0;o<i.length;o+=1){var s=new p.vo.EventStream;if(s.period=t,s.timescale=1,!i[o].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";s.schemeIdUri=i[o].schemeIdUri,i[o].hasOwnProperty("timescale")&&(s.timescale=i[o].timescale),i[o].hasOwnProperty("value")&&(s.value=i[o].value);for(var a=0;a<i[o].Event_asArray.length;a+=1){var l=new p.vo.Event;l.presentationTime=0,l.eventStream=s,i[o].Event_asArray[a].hasOwnProperty("presentationTime")&&(l.presentationTime=i[o].Event_asArray[a].presentationTime),i[o].Event_asArray[a].hasOwnProperty("duration")&&(l.duration=i[o].Event_asArray[a].duration),i[o].Event_asArray[a].hasOwnProperty("id")&&(l.id=i[o].Event_asArray[a].id),r.push(l)}}return r},getEventStreamForAdaptationSet:function(e){var t,n=[];if(e&&(t=e.InbandEventStream_asArray))for(var i=0;i<t.length;i+=1){var r=new p.vo.EventStream;if(r.timescale=1,!t[i].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";r.schemeIdUri=t[i].schemeIdUri,t[i].hasOwnProperty("timescale")&&(r.timescale=t[i].timescale),t[i].hasOwnProperty("value")&&(r.value=t[i].value),n.push(r)}return n},getEventStreamForRepresentation:function(e,t){var n,i=[];if(e&&t&&(n=e.Representation_asArray[t.index].InbandEventStream_asArray))for(var r=0;r<n.length;r++){var o=new p.vo.EventStream;if(o.timescale=1,o.representation=t,!n[r].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";o.schemeIdUri=n[r].schemeIdUri,n[r].hasOwnProperty("timescale")&&(o.timescale=n[r].timescale),n[r].hasOwnProperty("value")&&(o.value=n[r].value),i.push(o)}return i},getRepresentationBandwidth:function(e,t){return this.getBandwidth(this.getRepresentationFor(t,e))}},p.dependencies.DashMetricsExtensions=function(){"use strict";var e=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return u;return-1},t=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):n=!1,n},i=function(e,t){var i,r,o,s,a,l;for(a=0;a<e.length;a+=1)for(i=e[a],o=i.AdaptationSet_asArray,l=0;l<o.length;l+=1)if(r=o[l],s=r.Representation_asArray,n.call(this,r,t))return s.length;return-1},r=function(e){var n,i=this,r=i.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?(n=t.call(i,o,e),null===n?null:n.bandwidth):null},o=function(t){var n,i=this,r=i.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?n=e.call(i,o,t):null},s=function(e){var t,n=this,r=n.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?t=i.call(this,o,e):null},a=function(e){if(null===e)return null;var t,n,i,r=e.RepSwitchList;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n])},l=function(e){if(null===e)return null;var t,n,i,r=e.BufferLevel;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n])},u=function(e){if(null===e)return null;var t,n,i=e.HttpList,r=null;if(null===i||i.length<=0)return null;for(t=i.length,n=t-1;n>=0;){if(null!==i[n].responsecode){r=i[n];break}n-=1}return r},d=function(e){return null===e?[]:e.HttpList?e.HttpList:[]},c=function(e){if(null===e)return null;var t,n,i,r=e.DroppedFrames;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n])},h=function(e){if(null===e)return null;var t=e.PlaybackQuality;return null===t||t.length<=0?null:t[t.length-1]},f=function(e){if(null===e)return null;var t,n=e.DVRInfo,i=null;return null===n||n.length<=0?null:(t=n.length-1,i=n[t])},p=function(e){if(null===e)return null;var t,n,i,r=e.ManifestUpdate;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n])};return{manifestModel:void 0,manifestExt:void 0,getBandwidthForRepresentation:r,getIndexForRepresentation:o,getMaxIndexForBufferType:s,getCurrentRepresentationSwitch:a,getCurrentBufferLevel:l,getCurrentHttpRequest:u,getHttpRequests:d,getCurrentDroppedFrames:c,getCurrentPlaybackQuality:h,getCurrentDVRInfo:f,getCurrentManifestUpdate:p}},p.dependencies.DashMetricsExtensions.prototype={constructor:p.dependencies.DashMetricsExtensions},p.dependencies.DashParser=function(){"use strict";var t=31536e3,n=2592e3,i=86400,o=3600,s=60,a=60,l=1e3,d=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,c=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,h=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,f=[{type:"duration",test:function(e){return d.test(e)},converter:function(e){var r=d.exec(e);return parseFloat(r[2]||0)*t+parseFloat(r[4]||0)*n+parseFloat(r[6]||0)*i+parseFloat(r[8]||0)*o+parseFloat(r[10]||0)*s+parseFloat(r[12]||0)}},{type:"datetime",test:function(e){return c.test(e)},converter:function(e){var t,n=c.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&parseFloat(n[7])*l||0),n[9]&&n[10]){var i=parseInt(n[9],10)*a+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*i*s*l}return new Date(t)}},{type:"numeric",test:function(e){return h.test(e)},converter:function(e){return parseFloat(e)}}],p=function(){var e,t,n,i;return i=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],e={},e.name="AdaptationSet",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=i,t={},t.name="Representation",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=i,e.children.push(t),n={},n.name="SubRepresentation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=i,t.children.push(n),e},m=function(){var e,t,n,i;return i=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],e={},e.name="Period",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=i,t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=i,e.children.push(t),n={},n.name="Representation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=i,t.children.push(n),e},g=function(){var e,t,n,i,r;return r=[{name:"BaseURL",merge:!0,mergeFunction:function(e,t){var n;return n=0===t.indexOf("http://")?t:e+t}}],e={},e.name="mpd",e.isRoot=!0,e.isArray=!0,e.parent=null,e.children=[],e.properties=r,t={},t.name="Period",t.isRoot=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,e.children.push(t),n={},n.name="AdaptationSet",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=r,t.children.push(n),i={},i.name="Representation",i.isRoot=!1,i.isArray=!0,i.parent=n,i.children=[],i.properties=r,n.children.push(i),e},y=function(){var e=[];return e.push(p()),e.push(m()),e.push(g()),e},v=function(t,n){var i,o=new r(f,"",(!0)),s=new e(y()),a=new Date,l=null,d=null;try{i=o.xml_str2json(t),l=new Date,i.hasOwnProperty("BaseURL")?(i.BaseURL=i.BaseURL_asArray[0],0!==i.BaseURL.toString().indexOf("http")&&(i.BaseURL=n+i.BaseURL)):i.BaseURL=n,s.run(i),d=new Date,this.debug.log("Parsing complete: ( xml2json: "+(l.getTime()-a.getTime())+"ms, objectiron: "+(d.getTime()-l.getTime())+"ms, total: "+(d.getTime()-a.getTime())/1e3+"s)")}catch(c){return u.reject(null)}return u.when(i)};return{debug:void 0,parse:v}},p.dependencies.DashParser.prototype={constructor:p.dependencies.DashParser},p.dependencies.FragmentExtensions=function(){"use strict";var e=function(e){for(var t,n,i,r,o,s,a=new DataView(e),l=0;"tfdt"!==r&&l<a.byteLength;){for(i=a.getUint32(l),l+=4,r="",o=0;o<4;o+=1)s=a.getInt8(l),r+=String.fromCharCode(s),l+=1;"moof"!==r&&"traf"!==r&&"tfdt"!==r&&(l+=i-8)}if(l===a.byteLength)throw"Error finding live offset.";return n=a.getUint8(l),this.debug.log("position: "+l),0===n?(l+=4,t=a.getUint32(l,!1)):(l+=i-16,t=b.Math.to64BitNumber(a.getUint32(l+4,!1),a.getUint32(l,!1))),{version:n,base_media_decode_time:t}},t=function(e){for(var t,n,i,r,o,s,a,l=new DataView(e),d=0;"sidx"!==o&&d<l.byteLength;){for(s=l.getUint32(d),d+=4,o="",r=0;r<4;r+=1)a=l.getInt8(d),o+=String.fromCharCode(a),d+=1;"moof"!==o&&"traf"!==o&&"sidx"!==o?d+=s-8:"sidx"===o&&(d-=8)}return t=l.getUint8(d+8),d+=12,n=l.getUint32(d+4,!1),d+=8,i=0===t?l.getUint32(d,!1):b.Math.to64BitNumber(l.getUint32(d+4,!1),l.getUint32(d,!1)),u.when({earliestPresentationTime:i,timescale:n})},n=function(t){var n,i,r,o=u.defer(),s=new XMLHttpRequest,a=!1;return n=t,s.onloadend=function(){a||(i="Error loading fragment: "+n,o.reject(i))},s.onload=function(){a=!0,r=e(s.response),o.resolve(r)},s.onerror=function(){i="Error loading fragment: "+n,o.reject(i)},s.open("GET",n),s.responseType="arraybuffer",s.send(null),o.promise};return{debug:void 0,loadFragment:n,parseTFDT:e,parseSIDX:t}},p.dependencies.FragmentExtensions.prototype={constructor:p.dependencies.FragmentExtensions},p.dependencies.TimelineConverter=function(){"use strict";var e=0,t=function(e,t,n,i){var r=NaN;return r=i?n&&t.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*e):t.availabilityStartTime},n=function(e,n,i){return t.call(this,e,n,i)},i=function(e,n,i){return t.call(this,e,n,i,!0)},r=function(e){var t,n="dynamic"===e.mpd.manifest.type,i=parseInt(this.uriQueryFragModel.getURIFragmentData().s,10);return n?(!isNaN(i)&&i>1262304e3&&(t=i-e.mpd.availabilityStartTime.getTime()/1e3,(t>e.liveEdge||t<e.liveEdge-e.mpd.timeShiftBufferDepth)&&(t=null)),t=t||e.liveEdge):t=!isNaN(i)&&i<e.duration&&i>=0?i:e.start,t},o=function(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime())/1e3},s=function(e,t){var n=t.presentationTimeOffset;return e-n},a=function(e,t){var n=t.presentationTimeOffset;return n+e},l=function(e,t){var n,i,r;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,i=e.presentationStartTime+n,r=new Date(e.availabilityStartTime.getTime()+1e3*i)),r},u=function(e,t,n){var i,r=this,o=r.calcSegmentAvailabilityRange(e,n);return t>=o.start&&t<=o.end?t:i=Math.max(o.end-2*e.adaptation.period.mpd.manifest.minBufferTime,o.start)},d=function(t,n){var i,r,s=t.segmentDuration,a=0,l=t.adaptation.period.duration,u={start:a,end:l};return n?t.adaptation.period.mpd.isClientServerTimeSyncCompleted&&!isNaN(s)||!t.segmentAvailabilityRange?(i=t.adaptation.period.mpd.checkTime,r=o(new Date((new Date).getTime()+e),t.adaptation.period),a=Math.max(r-t.adaptation.period.mpd.timeShiftBufferDepth,0),i+=e/1e3,l=isNaN(i)?r:Math.min(i,r),u={start:a,end:l}):t.segmentAvailabilityRange:u},c=function(e){var t=e.presentationTimeOffset;return-t};return{system:void 0,debug:void 0,uriQueryFragModel:void 0,setup:function(){},calcAvailabilityStartTimeFromPresentationTime:n,calcAvailabilityEndTimeFromPresentationTime:i,calcPresentationTimeFromWallTime:o,calcPresentationTimeFromMediaTime:s,calcPresentationStartTime:r,calcActualPresentationTime:u,calcMediaTimeFromPresentationTime:a,calcSegmentAvailabilityRange:d,calcWallTimeForSegment:l,calcMSETimeOffset:c}},p.dependencies.TimelineConverter.prototype={constructor:p.dependencies.TimelineConverter},p.vo.AdaptationSet=function(){"use strict";this.period=null,this.index=-1},p.vo.AdaptationSet.prototype={constructor:p.vo.AdaptationSet},p.vo.Event=function(){"use strict";this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},p.vo.Event.prototype={constructor:p.vo.Event},p.vo.EventStream=function(){"use strict";this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},p.vo.EventStream.prototype={constructor:p.vo.EventStream},p.vo.Mpd=function(){"use strict";this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.checkTime=NaN,this.clientServerTimeShift=0,this.isClientServerTimeSyncCompleted=!1},p.vo.Mpd.prototype={constructor:p.vo.Mpd},p.vo.Period=function(){"use strict";this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.liveEdge=NaN},p.vo.Period.prototype={constructor:p.vo.Period},p.vo.Representation=function(){"use strict";this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0},p.vo.Representation.prototype={constructor:p.vo.Representation},p.vo.Segment=function(){"use strict";this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null},p.vo.Segment.prototype={constructor:p.vo.Segment},m.models.ProtectionModel=function(){},m.models.ProtectionModel.eventList={ENAME_NEED_KEY:"needkey",ENAME_KEY_SYSTEM_ACCESS_COMPLETE:"keySystemAccessComplete",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected",
ENAME_VIDEO_ELEMENT_SELECTED:"videoElementSelected",ENAME_SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",ENAME_KEY_MESSAGE:"keyMessage",ENAME_KEY_ADDED:"keyAdded",ENAME_KEY_ERROR:"keyError",ENAME_KEY_SESSION_CREATED:"keySessionCreated",ENAME_KEY_SESSION_REMOVED:"keySessionRemoved",ENAME_KEY_SESSION_CLOSED:"keySessionClosed",ENAME_KEY_STATUSES_CHANGED:"keyStatusesChanged",ENAME_TEARDOWN_COMPLETE:"protectionTeardownComplete"},m.utils.copyMethods=function(e){var t=new e;t.parent={};for(var n in t)t.parent[n]=t[n];return t.setup=function(){for(var e in this.parent)void 0===this.parent[e]&&(this.parent[e]=this[e])},t},m.utils.DOMParser=function(){"use strict";var e=null,t=null;return{getAllSpecificNodes:function(e,t){var n,i,r=0,o=[];if(e&&(i=e.querySelectorAll(t)))for(r=0;r<i.length;r++)n=this.getAttributeValue(i[r],"xml:id"),n&&(o[n]=i[r].attributes,i[r].childNodes.length>0&&(o[n].childNodes=i[r].childNodes));return o},getAttributeName:function(e,t){var n=[],i=null,r=0,o=null;if(e&&e.attributes&&(o=e.attributes))for(r=0;r<o.length;r++)i=o[r],i.value===t&&n.push(i.name);return n},getTextNodesIn:function(e){var t=[],n=0,i=null,r=null,o=null;if(e)for(i=e.childNodes,n=0;n<i.length;n++)r=i[n],o=r.nodeType,3==o?t.push(r):1!=o&&9!=o&&11!=o||(t=t.concat(this.getTextNodesIn(r)));return t},getAttributeValue:function(e,t,n){var i=null;return e&&"function"==typeof e.getAttribute&&(i=e.getAttribute(t),null===i&&n&&(i=e.getAttributeNS(n,t))),i},getChildNode:function(e,t){var n,i=0;if(e&&e.childNodes)for(i=0;i<e.childNodes.length;i++){if(n=e.childNodes[i],n.nodeName===t)return n;n=void 0}return n},getChildNodes:function(e,t){var n=0,i=[];if(e&&e.childNodes)for(n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeName===t&&i.push(e.childNodes[n]);return i},createXmlTree:function(n){if(window.DOMParser)try{if(e||(e=new window.DOMParser),t=e.parseFromString(n,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(i){t=null}return t}}},m.utils.ObjectIron=function(e){var t;t=[];for(var n=0,i=e.length;n<i;n+=1)e[n].isRoot?t.push("root"):t.push(e[n].name);var r=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},o=function(e,t,n){var i,o,s,a,l;if(null!==e&&0!==e.length)for(i=0,o=e.length;i<o;i+=1)s=e[i],t.hasOwnProperty(s.name)&&(n.hasOwnProperty(s.name)?s.merge&&(a=t[s.name],l=n[s.name],"object"==typeof a&&"object"==typeof l?r(a,l):null!==s.mergeFunction?n[s.name]=s.mergeFunction(a,l):n[s.name]=a+l):n[s.name]=t[s.name])},s=function(e,t){var n,i,r,a,l,u,d,c=e;if(e.transformFunc&&(t=e.transformFunc(t)),null===c.children||0===c.children.length)return t;for(n=0,i=c.children.length;n<i;n+=1){u=c.children[n];var h=null;if(t.hasOwnProperty(u.name))if(u.isArray)for(l=t[u.name+"_asArray"],r=0,a=l.length;r<a;r+=1)d=l[r],o(c.properties,t,d),h=s(u,d),t[u.name+"_asArray"][r]=h,t[u.name][r]=h;else d=t[u.name],o(c.properties,t,d),h=s(u,d),t[u.name]=h,t[u.name+"_asArray"]=[h]}return t},a=function(n){var i,r,o,l,u,d,c;if(null===n)return n;if("object"!=typeof n)return n;for(i=0,r=t.length;i<r;i+=1)"root"===t[i]&&(u=e[i],d=n,n=s(u,d));for(l in n)if(n.hasOwnProperty(l)){if(o=t.indexOf(l),o!==-1)if(u=e[o],u.isArray)for(c=n[l+"_asArray"],i=0,r=c.length;i<r;i+=1)d=c[i],n[l][i]=s(u,d),n[l+"_asArray"][i]=s(u,d);else d=n[l],n[l]=s(u,d),n[l+"_asArray"]=[s(u,d)];n[l]=a(n[l])}return n};return{run:a}},m.dependencies.protection.CommonEncryption={findCencContentProtection:function(e){var t,n=null,i=0;for(i=0;i<e.length;++i)t=e[i],"urn:mpeg:dash:mp4protection:2011"===t.schemeIdUri.toLowerCase()&&"cenc"===t.value.toLowerCase()&&(n=t);return n},getPSSHData:function(e){var t=8,n=new DataView(e),i=n.getUint8(t);return t+=20,i>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)},getPSSHForKeySystem:function(e,t){var n=m.dependencies.protection.CommonEncryption.parsePSSHList(t);return n.hasOwnProperty(e.uuid.toLowerCase())?n[e.uuid.toLowerCase()]:null},parseInitDataFromContentProtection:function(e){return e&&"pssh"in e?y.decodeArray(e.pssh.__text).buffer:null},readBytes:function(e,t,n){var i=0,r=0;for(r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},parsePSSHList:function(e){if(null===e)return[];for(var t=new DataView(e),n=!1,i={},r=0;!n;){var o,s,a,l,u,d=r;if(r>=t.buffer.byteLength)break;if(o=t.getUint32(r),s=r+o,r+=4,1886614376===t.getUint32(r))if(r+=4,a=t.getUint8(r),0===a||1===a){r++,r+=3,l="";var c,h;for(c=0;c<4;c++)h=t.getUint8(r+c).toString(16),l+=1===h.length?"0"+h:h;for(r+=4,l+="-",c=0;c<2;c++)h=t.getUint8(r+c).toString(16),l+=1===h.length?"0"+h:h;for(r+=2,l+="-",c=0;c<2;c++)h=t.getUint8(r+c).toString(16),l+=1===h.length?"0"+h:h;for(r+=2,l+="-",c=0;c<2;c++)h=t.getUint8(r+c).toString(16),l+=1===h.length?"0"+h:h;for(r+=2,l+="-",c=0;c<6;c++)h=t.getUint8(r+c).toString(16),l+=1===h.length?"0"+h:h;r+=6,l=l.toLowerCase(),u=t.getUint32(r),r+=4,i[l]=t.buffer.slice(d,s),r=s}else r=s;else r=s}return i},getKeySystemConfigurations:function(e,t,n){var i=[],r=[];return e&&r.push(new m.vo.protection.MediaCapability(e)),t&&i.push(new m.vo.protection.MediaCapability(t)),[new m.vo.protection.KeySystemConfiguration(i,r,"optional","temporary"===n?"optional":"required",[n])]}},ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return e instanceof ArrayBuffer}),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n,i,r,o=this.byteLength;return e=0|e||0,t=void 0===t?o:0|t,e<0&&(e=Math.max(e+o,0)),t<0&&(t=Math.max(t+o,0)),0===o||e>=o||e>=t?new ArrayBuffer(0):(n=Math.min(o-e,t-e),i=new ArrayBuffer(n),r=new Uint8Array(i),r.set(new Uint8Array(this,e,n)),i)}),m.dependencies.ProtectionController=function(){"use strict";var e,t,n,i=null,r=[],o=null,s=!1,a=function(e){var t=null,i=e.systemString;return n&&(t=i in n?n[i]:null),t},l=function(n,i){var o,s,a,l,u,d=this,c=[],h=[],f=0;if(this.keySystem){for(s=0;s<n.length;s++)if(this.keySystem===n[s].ks){o=n[s].ks.sessionType,c.push({ks:n[s].ks,configs:n[s].ks.getKeySystemConfigurations(t,e,o)}),h.push({schemeIdURI:n[s].ks.schemeIdURI,systemString:n[s].ks.systemString}),a={},a[m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){d.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,a),e.error?(d.debug.log("[DRM] KeySystem Access Denied! -- "+e.error),d.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error})):(d.debug.log("[DRM] KeySystem Access Granted"),d.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:e.data}),d.createKeySession(n[s].initData,n[s].cdmData))},this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,a,void 0,!0),this.protectionModel.requestKeySystemAccess(c);break}}else if(void 0===this.keySystem){for(this.keySystem=null,r.push(n),f=0;f<n.length;f++)o=n[f].ks.sessionType,c.push({ks:n[f].ks,configs:n[f].ks.getKeySystemConfigurations(t,e,o)}),h.push({schemeIdURI:n[f].ks.schemeIdURI,systemString:n[f].ks.systemString});l={},l[m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){d.protectionModel&&(d.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,l),e.error?(d.debug.log("[DRM] KeySystem Access Denied! -- "+e.error),d.keySystem=void 0,d.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l),i||d.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error}),d.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:h}))):(u=e.data,d.debug.log("[DRM] KeySystem Access ("+u.keySystem.systemString+") Granted!  Selecting key system..."),d.protectionModel.selectKeySystem(u)))},l[m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(e){if(d.protectionModel)if(d.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l),e.error)d.keySystem=void 0,i||d.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] Error selecting key system! -- "+e.error}),d.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:h}));else for(d.debug.log("[DRM] KeySystem selected => create key session"),d.keySystem=d.protectionModel.keySystem,d.notify(m.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,u),d.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:u}),f=0;f<r.length;f++)for(s=0;s<r[f].length;s++)if(d.keySystem===r[f][s].ks){d.createKeySession(r[f][s].initData,r[f][s].cdmData);break}},this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l,void 0,!0),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,l,void 0,!0),this.protectionModel.requestKeySystemAccess(c)}else r.push(n)},u=function(e){var t,n,i=this,r=null;t=e.data,n=t.messageType?t.messageType:"license-request",this.debug.log("[DRM] Key message: type = "+n),this.eventBus.dispatchEvent({type:m.dependencies.ProtectionController.events.KEY_MESSAGE,data:t});var s=t.message,l=t.sessionToken,u=a(this.keySystem),d=this.keySystem.systemString,c=this.protectionExt.getLicenseServer(this.keySystem,u,n),h=!0;if(!s||0===s.byteLength)return void this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"Empty key message from CDM"));if(!c)return void this.debug.log("[DRM] License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+l.getSessionID());if(this.protectionExt.isClearKey(this.keySystem)){var f=this.protectionExt.processClearKeyLicenseRequest(u,s);if(f)return this.debug.log("[DRM] ClearKey license request handled by application!"),void this.protectionModel.updateKeySession(l,f)}o=new XMLHttpRequest;var p=null;if(u)if(u.serverURL){var g=u.serverURL;"string"==typeof g&&""!==g?p=g:"object"==typeof g&&g.hasOwnProperty(n)&&(p=g[n])}else u.laURL&&""!==u.laURL&&(p=u.laURL);if(null===p&&(p=this.keySystem.getLicenseServerURLFromInitData(m.dependencies.protection.CommonEncryption.getPSSHData(l.initData)),p||(p=e.data.defaultURL)),p=c.getServerURLFromMessage(p,s,n),this.debug.log("[DRM] Licenser server url: "+p),!p)return void this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN,"No license server URL specified"));o.open(c.getHTTPMethod(n),p,!0),o.responseType=c.getResponseType(d,n),o.onload=function(){this.status<200||this.status>299||200===this.status&&4===this.readyState&&(i.debug.log("[DRM] Received license response"),h=!1,r=c.getLicenseMessage(this.response,d,n),null!==r?(h=!1,i.protectionModel.updateKeySession(l,r)):h=!0)},o.onerror=o.onloadend=function(){return h?(h=!1,this.aborted||i.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR,"License request failed",{url:p,status:this.status,error:this.response&&null!==this.response?c.getErrorResponse(this.response):""})),void(o=null)):void(o=null)};var y=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(o.withCredentials=!0),o.setRequestHeader(t,e[t])};u&&y(u.httpRequestHeaders),y(this.keySystem.getRequestHeadersFromMessage(s)),u&&u.withCredentials&&(o.withCredentials=!0),this.debug.log("[DRM] Send license request");var v=this.keySystem.getLicenseRequestFromMessage(s);null===v&&this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"No license challenge from CDM key message")),o.send(v)},d=function(e){var t,n,i=this;return i.debug.log("[DRM] onNeedKey, initDataType = "+e.data.initDataType),"cenc"!==e.data.initDataType?void i.debug.log("[DRM] Only 'cenc' initData is supported!  Ignoring initData of type: "+e.data.initDataType):(t=e.data.initData,ArrayBuffer.isView(t)&&(t=t.buffer),n=this.protectionExt.getSupportedKeySystems(t),0===n.length?void i.debug.log("[DRM] Received needkey event with initData, but we don't support any of the key systems!"):void l.call(this,n,!1))},c=function(e){e.error?(this.debug.error("[DRM] Failed to set license server certificate"),this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE,"Failed to set server certificate",e.error))):this.debug.log("[DRM] License server certificate successfully updated")},h=function(e){e.error?(this.debug.error("[DRM] Failed to create key session"),this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION,"Failed to create key session",e.error))):this.debug.log("[DRM] Session created.  SessionID = "+e.data.getSessionID())},f=function(){this.debug.log("[DRM] Key added")},p=function(e){this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(e.data.code,e.data.message,e.data.data))},g=function(e){e.error?this.debug.warn("[DRM] Failed to close session"):this.debug.log("[DRM] Session closed. SessionID = "+e.data)},y=function(e){e.error?this.debug.warn("[DRM] Failed to remove session"):this.debug.log("[DRM] Session removed. SessionID = "+e.data)},v=function(e){e.error?this.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(e.error.code,e.error.message,e.error.data)):this.debug.log("[DRM] Key statuses changed. statuses = "+e.data)};return{system:void 0,debug:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:void 0,setup:function(){this[m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE]=u.bind(this),this[m.models.ProtectionModel.eventList.ENAME_NEED_KEY]=d.bind(this),this[m.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED]=c.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_ADDED]=f.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_ERROR]=p.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED]=h.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED]=g.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED]=y.bind(this),this[m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED]=v.bind(this),i=this.protectionExt.getKeySystems(),this.protectionModel=this.system.getObject("protectionModel"),this.protectionModel.init(),this.eventBus=this.system.getObject("eventBus"),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this)},init:function(n,i,r){var o;s||(this.debug.log("[DRM] Initialize ProtectionController ("+r+", "+i+")"),e=i,t=r,o=this.protectionExt.getSupportedKeySystemsFromContentProtection(n),o&&o.length>0&&l.call(this,o,!0),s=!0)},addEventListener:function(e,t){this.eventBus.addEventListener(e,t)},removeEventListener:function(e,t){this.eventBus.removeEventListener(e,t)},teardown:function(){var e=this;o&&(o.aborted=!0,o.abort()),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),this.keySystem=void 0,this.setMediaElement(null).then(function(){e.protectionModel.teardown(),e.protectionModel=void 0})},createKeySession:function(e,t){var n,i=m.dependencies.protection.CommonEncryption.getPSSHForKeySystem(this.keySystem,e),r=0;if(i){for(this.debug.log("[DRM] create key session for initData:",String.fromCharCode.apply(null,new Uint8Array(i))),n=this.protectionModel.getAllInitData(),r=0;r<n.length;r++)if(this.protectionExt.initDataEquals(i,n[r]))return void this.debug.log("[DRM] Ignoring initData because we have already seen it!");try{this.protectionModel.createKeySession(i,this.keySystem.sessionType,t)}catch(o){this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Create key session raised en exception",error:new m.vo.Error(o.code,o.name,o.message)})}}else this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"needkey/encrypted event contains no initData corresponding to that key system "+this.keySystem.systemString,error:null})},loadKeySession:function(e){this.protectionModel.loadKeySession(e)},removeKeySession:function(e){this.protectionModel.removeKeySession(e)},closeKeySession:function(e){this.protectionModel.closeKeySession(e)},setServerCertificate:function(e){this.protectionModel.setServerCertificate(e)},setMediaElement:function(e){return e?this.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_NEED_KEY,this):null===e&&this.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.setMediaElement(e)},setSessionType:function(e){this.keysystem&&(this.keySystem.sessionType=e)},setProtectionData:function(e){n=e,this.protectionExt.init(e)}}},m.dependencies.ProtectionController.events={KEY_SYSTEM_SELECTED:"keySystemSelected",SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",KEY_ADDED:"keyAdded",KEY_SESSION_CREATED:"keySessionCreated",KEY_SESSION_REMOVED:"keySessionRemoved",KEY_SESSION_CLOSED:"keySessionClosed",KEY_STATUSES_CHANGED:"keyStatusesChanged",KEY_MESSAGE:"keyMessage",LICENSE_REQUEST_COMPLETE:"licenseRequestComplete"},m.dependencies.ProtectionController.eventList={ENAME_PROTECTION_ERROR:"protectionError",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected"},m.dependencies.ProtectionController.prototype={constructor:m.dependencies.ProtectionController},m.dependencies.ProtectionExtensions=function(){"use strict";this.system=void 0,this.debug=void 0,this.keySystems=[],this.clearkeyKeySystem=void 0},m.dependencies.ProtectionExtensions.prototype={constructor:m.dependencies.ProtectionExtensions,setup:function(){var e;e=this.system.getObject("ksPlayReady"),this.keySystems.push(e),e=this.system.getObject("ksWidevine"),this.keySystems.push(e),e=this.system.getObject("ksClearKey"),this.keySystems.push(e),this.clearkeyKeySystem=e},init:function(e){for(var t=(function(t){var n=null;return e&&(n=t in e?e[t]:null),n}),n=0;n<this.keySystems.length;n++){var i=this.keySystems[n];i.init(t(i.systemString))}},getKeySystems:function(){return this.keySystems},getKeySystemBySystemString:function(e){for(var t=0;t<this.keySystems.length;t++)if(this.keySystems[t].systemString===e)return this.keySystems[t];return null},isClearKey:function(e){return e===this.clearkeyKeySystem},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),i=new Uint8Array(t),r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}return!1},getSupportedKeySystemsFromContentProtection:function(e){var t,n,i,r,o=[];if(e)for(i=0;i<this.keySystems.length;++i)for(n=this.keySystems[i],r=0;r<e.length;++r)if(t=e[r],t.schemeIdUri.toLowerCase()===n.schemeIdURI){var s=n.getInitData(t);s&&o.push({ks:this.keySystems[i],initData:s,cdmData:n.getCDMData()})}return o},getSupportedKeySystems:function(e){var t,n=[],i=m.dependencies.protection.CommonEncryption.parsePSSHList(e);for(this.debug.log("[DRM] Get supported key systems from init data"),t=0;t<this.keySystems.length;++t)this.keySystems[t].uuid in i&&n.push({ks:this.keySystems[t],initData:i[this.keySystems[t].uuid],cdmData:this.keySystems[t].getCDMData()});return n},getLicenseServer:function(e,t,n){if("license-release"===n||"individualization-request"==n)return null;var i=null;return t&&t.hasOwnProperty("drmtoday")?i=this.system.getObject("serverDRMToday"):"com.widevine.alpha"===e.systemString?i=this.system.getObject("serverWidevine"):"com.microsoft.playready"===e.systemString?i=this.system.getObject("serverPlayReady"):"org.w3.clearkey"===e.systemString&&(i=this.system.getObject("serverClearKey")),i},processClearKeyLicenseRequest:function(e,t){try{return m.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData(e,t)}catch(n){return this.log("Failed to retrieve clearkeys from ProtectionData"),null}},autoSelectKeySystem:function(e,t,n,i){if(this.debug.log("[DRM] Auto select key system: "),this.debug.log("[DRM] ---- video codec = "+n),this.debug.log("[DRM] ---- audio codec = "+i),0===e.length)throw new Error("DRM system for this content not supported by the player!");var r=[],o=[];n&&o.push(new m.vo.protection.MediaCapability(n)),i&&r.push(new m.vo.protection.MediaCapability(i));for(var s=new m.vo.protection.KeySystemConfiguration(r,o),a=[],l=0;l<e.length;l++)a.push({ks:e[l].ks,configs:[s]});var u=this;!function(e){var t={};t[m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(t){if(e.protectionModel.unsubscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),t.error)u.debug.log(t.error),e.notify(m.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"[DRM] KeySystem Access Denied! -- "+t.error,null));else{var n=t.data;u.debug.log("[DRM] KeySystem Access Granted ("+n.keySystem.systemString+")!"),e.selectKeySystem(n)}},e.protectionModel.subscribe(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,t),e.requestKeySystemAccess(a)}(t)}},m.models.ProtectionModel_01b=function(){var e,t=null,n=null,i=[],r=[],o=function(){var t=this;return{handleEvent:function(o){var s=null;switch(o.type){case n.needkey:var l=ArrayBuffer.isView(o.initData)?o.initData.buffer:o.initData;t.notify(m.models.ProtectionModel.eventList.ENAME_NEED_KEY,new m.vo.protection.NeedKey(l,"cenc"));break;case n.keyerror:if(s=a(r,o.sessionId),s||(s=a(i,o.sessionId)),s){var u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,d="MediakeyError";switch(o.errorCode.code){case 1:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,d+="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,d+="The Key System could not be installed or updated.";break;case 3:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,d+="The message passed into update indicated an error from the license service.";break;case 4:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,d+="There is no available output device with the required characteristics for the content protection system.";break;case 5:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,d+="A hardware configuration change caused a content protection error.";break;case 6:u=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,d+="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}o.systemCode&&(d+="  (System Code = "+o.systemCode+")"),t.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new m.vo.protection.KeyError(u,d))}else t.log("No session token found for key error");break;case n.keyadded:s=a(r,o.sessionId),s||(s=a(i,o.sessionId)),s?t.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ADDED,s):t.log("No session token found for key added");break;case n.keymessage:if(e=null!==o.sessionId&&void 0!==o.sessionId,e?(s=a(r,o.sessionId),!s&&i.length>0&&(s=i.shift(),r.push(s),s.sessionID=o.sessionId)):i.length>0&&(s=i.shift(),r.push(s),0!==i.length&&t.errHandler.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),s){var c=ArrayBuffer.isView(o.message)?o.message.buffer:o.message;s.keyMessage=c,t.notify(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new m.vo.protection.KeyMessage(s,c,o.defaultURL))}else t.log("No session token found for key message")}}}},s=null,a=function(e,t){if(t&&e){for(var n=e.length,i=0;i<n;i++)if(e[i].sessionID===t)return e[i];return null}return null},l=function(){t.removeEventListener(n.keyerror,s),t.removeEventListener(n.needkey,s),t.removeEventListener(n.keymessage,s),t.removeEventListener(n.keyadded,s)};return{system:void 0,log:void 0,errHandler:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){s=o.call(this)},init:function(){var e=document.createElement("video");n=m.models.ProtectionModel_01b.detect(e)},teardown:function(){t&&l();for(var e=0;e<r.length;e++)this.closeKeySession(r[e]);this.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)},getAllInitData:function(){var e,t=[];for(e=0;e<i.length;e++)t.push(i[e].initData);for(e=0;e<r.length;e++)t.push(r[e].initData);return t},requestKeySystemAccess:function(e){var n=t;n||(n=document.createElement("video"));for(var i=!1,r=0;r<e.length;r++)for(var o=e[r].ks.systemString,s=e[r].configs,a=null,l=null,u=0;u<s.length;u++){var d=s[u].videoCapabilities;if(d&&0!==d.length){l=[];for(var c=0;c<d.length;c++)""!==n.canPlayType(d[c].contentType,o)&&l.push(d[c])}if(!(!a&&!l||a&&0===a.length||l&&0===l.length)){i=!0;var h=new m.vo.protection.KeySystemConfiguration(a,l),f=this.protectionExt.getKeySystemBySystemString(o),p=new m.vo.protection.KeySystemAccess(f,h);this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,p);break}}i||this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(e){this.keySystem=e.keySystem,this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(t!==e)return t&&l(),t=e,t&&(t.addEventListener(n.keyerror,s),t.addEventListener(n.needkey,s),t.addEventListener(n.keymessage,s),t.addEventListener(n.keyadded,s),this.notify(m.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)),u.when()},createKeySession:function(o){if(!this.keySystem)throw new Error("Can not create sessions until you have selected a key system");if(e||0===r.length){var s={sessionID:null,initData:o,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return i.push(s),t[n.generateKeyRequest](this.keySystem.systemString,new Uint8Array(o)),s}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,i){var r=e.sessionID;if(this.protectionExt.isClearKey(this.keySystem))for(var o=0;o<i.keyPairs.length;o++)t[n.addKey](this.keySystem.systemString,i.keyPairs[o].key,i.keyPairs[o].keyID,r);else t[n.addKey](this.keySystem.systemString,new Uint8Array(i),e.initData,r)},closeKeySession:function(e){t[n.cancelKeyRequest](this.keySystem.systemString,e.sessionID)},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},m.models.ProtectionModel_01b.prototype={constructor:m.models.ProtectionModel_01b},m.models.ProtectionModel_01b.APIs=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],m.models.ProtectionModel_01b.detect=function(e){for(var t=m.models.ProtectionModel_01b.APIs,n=0;n<t.length;n++){var i=t[n];if("function"==typeof e[i.generateKeyRequest]&&"function"==typeof e[i.addKey]&&"function"==typeof e[i.cancelKeyRequest])return i}return null},m.models.ProtectionModel_3Feb2014=function(){var e=null,t=null,n=null,i=null,r=null,o=[],s=function(){var e=this;return{handleEvent:function(t){switch(t.type){case r.needkey:if(t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;e.notify(m.models.ProtectionModel.eventList.ENAME_NEED_KEY,new m.vo.protection.NeedKey(n,"cenc"))}}}}},a=null,l=function(){var n=function(){e.removeEventListener("loadedmetadata",i),e[r.setMediaKeys](t),this.notify(m.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)};e.readyState>=1?n.call(this):(i=n.bind(this),e.addEventListener("loadedmetadata",i))},d=function(e){var t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,n="MediakeyError";if(e.errorCode)switch(e.errorCode.code){case 1:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,n="The Key System could not be installed or updated.";break;case 3:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,n="The message passed into update indicated an error from the license service.";break;case 4:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,n="There is no available output device with the required characteristics for the content protection system.";break;case 5:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,n+="A hardware configuration change caused a content protection error.";break;case 6:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,n="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.";break;default:t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes."}else t=m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";return e.systemCode&&(n+="  (System Code = "+e.systemCode+")"),new m.vo.protection.KeyError(t,n)},c=function(e,t){var n=this;return{session:e,initData:t,handleEvent:function(e){switch(e.type){case r.error:n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,d(e));break;case r.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new m.vo.protection.KeyMessage(this,t,e.destinationURL));
break;case r.ready:n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this);break;case r.close:n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this.getSessionID())}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}}};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,debug:void 0,keySystem:null,setup:function(){a=s.call(this)},init:function(){var e=document.createElement("video");r=m.models.ProtectionModel_3Feb2014.detect(e)},teardown:function(){try{for(var t=0;t<o.length;t++)this.closeKeySession(o[t]);e&&e.removeEventListener(r.needkey,a),this.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)}catch(n){this.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,null,"Error tearing down key sessions and MediaKeys! -- "+n.message)}},getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)e.push(o[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++){var i=e[n].ks.systemString,o=e[n].configs,s=null,a=null;this.debug.log("[DRM][3Feb2014] Request access for key system "+i);for(var l=0;l<o.length;l++){var u=o[l].audioCapabilities,d=o[l].videoCapabilities;if(u&&0!==u.length){s=[];for(var c=0;c<u.length;c++)window[r.MediaKeys].isTypeSupported(i,u[c].contentType)&&s.push(u[c])}if(d&&0!==d.length){a=[];for(var h=0;h<d.length;h++)window[r.MediaKeys].isTypeSupported(i,d[h].contentType)&&a.push(d[h])}if(!(!s&&!a||s&&0===s.length||a&&0===a.length)){t=!0;var f=new m.vo.protection.KeySystemConfiguration(s,a),p=this.protectionExt.getKeySystemBySystemString(i),g=new m.vo.protection.KeySystemAccess(p,f);this.debug.log("[DRM][3Feb2014] configuration supported = audio:"+JSON.stringify(s)+", video:"+JSON.stringify(a)),this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,g);break}}}t||this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"[DRM][3Feb2014] Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(i){this.debug.log("[DRM][3Feb2014] Select key system "+i.keySystem.systemString);try{t=i.mediaKeys=new window[r.MediaKeys](i.keySystem.systemString),this.keySystem=i.keySystem,n=i,e&&l.call(this),this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}catch(o){this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+this.keySystem.systemString+")! Could not create MediaKeys -- TODO")}},setMediaElement:function(n){if(e!==n)return e&&(e.removeEventListener(r.needkey,a),e.removeEventListener("loadedmetadata",i)),e=n,e&&t&&l.call(this),u.when()},createKeySession:function(e,i,s){if(!this.keySystem||!t||!n)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][3Feb2014] Create key session");var a=n.ksConfiguration.videoCapabilities[0].contentType,l=t.createSession(a,new Uint8Array(e),s?new Uint8Array(s):null),u=c.call(this,l,e);l.addEventListener(r.error,u),l.addEventListener(r.message,u),l.addEventListener(r.ready,u),l.addEventListener(r.close,u),o.push(u),this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,u)},updateKeySession:function(e,t){var n=e.session;this.debug.log("[DRM][3Feb2014] Update key session"),this.protectionExt.isClearKey(this.keySystem)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:function(e){this.debug.log("[DRM][3Feb2014] Close key session, token = "+e.session.sessionId);var t=e.session;t.removeEventListener(r.error,e),t.removeEventListener(r.message,e),t.removeEventListener(r.ready,e),t.removeEventListener(r.close,e);for(var n=0;n<o.length;n++)if(o[n]===e){o.splice(n,1);break}t[r.release]()},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},m.models.ProtectionModel_3Feb2014.APIs=[{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"},{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"}],m.models.ProtectionModel_3Feb2014.detect=function(e){for(var t=m.models.ProtectionModel_3Feb2014.APIs,n=0;n<t.length;n++){var i=t[n];if("function"==typeof e[i.setMediaKeys]&&"function"==typeof window[i.MediaKeys])return i}return null},m.models.ProtectionModel_3Feb2014.prototype={constructor:m.models.ProtectionModel_3Feb2014},m.models.ProtectionModel_21Jan2015=function(){var e=null,t=null,n=null,i=[],r=function(e){var t,n="[";for(t=0;t<e.length;t++)n+="0x"+e[t].toString(16),t<e.length-1&&(n+=",");return n+="]"},o=function(e,t){var n=this;return void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess?void this.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Insecure origins are not allowed"):void function(t){var i=e[t].ks,r=e[t].configs;n.debug.log("[DRM][PM_21Jan2015] requestMediaKeySystemAccess: "+i.systemString),navigator.requestMediaKeySystemAccess(i.systemString,r).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new m.vo.protection.KeySystemAccess(i,t);r.mksa=e,n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,r)})["catch"](function(){++t<e.length?o.call(n,e,t):n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied!")})}(t)},s=function(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()},a=function(){var e=this;return{session:null,handleEvent:function(t){switch(t.type){case"encrypted":if(e.debug.log("[DRM][PM_21Jan2015] 'encrypted' event"),t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;e.notify(m.models.ProtectionModel.eventList.ENAME_NEED_KEY,new m.vo.protection.NeedKey(n,"cenc"))}break;case"waitingforkey":e.debug.log("[DRM][PM_21Jan2015] 'waitingforkey' event"),null!==this.session&&this.session.usable&&(this.session.usable=!1,e.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new m.vo.protection.KeyError(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,"Media is encrypted and no valid key is available")))}}}},l=function(e){for(var t=0;t<i.length;t++)if(i[t]===e){i.splice(t,1);break}},d=function(t,o,s){var a=this,u=function(e,t){for(var n=0;n<i.length;n++)if(i[n].session===e){i[n].usable=t;break}},d={session:t,initData:o,usable:!1,handleEvent:function(t){switch(t.type){case"keystatuseschange":a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),t.target.keyStatuses.forEach(function(){var i,o;switch(arguments&&arguments.length>0&&(arguments[0]&&("string"==typeof arguments[0]?i=arguments[0]:o=arguments[0]),arguments[1]&&("string"==typeof arguments[1]?i=arguments[1]:o=arguments[1])),a.debug.log("[DRM][PM_21Jan2015] status = "+i+" for KID "+r(new Uint8Array(o))),i){case"expired":u(t.target,!1),a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_EXPIRED,"License has expired",null));break;case"output-restricted":u(t.target,!1),a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new m.vo.Error(m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,"There is no available output device with the required characteristics for the content protection system",null));break;case"usable":u(t.target,!0),e.addEventListener("waitingforkey",n);break;default:a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,{status:i,keyId:o})}});break;case"message":a.debug.log("[DRM][PM_21Jan2015] 'message' event: ",t);var i=ArrayBuffer.isView(t.message)?t.message.buffer:t.message;a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new m.vo.protection.KeyMessage(this,i,(void 0),t.messageType))}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return this.session.expiration},getKeyStatuses:function(){return this.session.keyStatuses},getSessionType:function(){return s}};return t.addEventListener("keystatuseschange",d),t.addEventListener("message",d),t.closed.then(function(){l(d),a.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,d.getSessionID())}),i.push(d),d};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,config:null,debug:null,setup:function(){n=a.call(this)},init:function(){n.session=null},teardown:function(){var e,n,r=i.length,o=this;if(this.debug.log("[DRM][PM_21Jan2015] Teardown"),this.config.getParam("Protection.licensePersistence","boolean",!1)){for(n=0;n<i.length;n++)e=i[n],e.usable||(i.splice(n,1),n--);this.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)}else{var a=function(e){o.debug.log("[DRM][PM_21Jan2015] Session closed"),l(e),n>=r-1&&(t=null,o.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE))};if(0===r)return t=null,void this.notify(m.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE);for(n=0;n<r;n++)e=i[n],function(t){o.debug.log("[DRM][PM_21Jan2015] Close session "+e.getSessionID()),e.session.closed.then(function(){a(t)}),s(e)["catch"](function(){a(t)})}(e)}},getAllInitData:function(){for(var e=[],t=0;t<i.length;t++)e.push(i[t].initData);return e},requestKeySystemAccess:function(e){o.call(this,e,0)},selectKeySystem:function(i){var r=this;return r.debug.log("[DRM][PM_21Jan2015] Select key system, create new MediaKeys"),null!==t?(r.debug.log("[DRM][PM_21Jan2015] MediaKeys already created"),void r.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)):void i.mksa.createMediaKeys().then(function(o){r.keySystem=i.keySystem,t=o,e&&e.setMediaKeys(t).then(function(){var t=r.keySystem.getServerCertificate();t?r.setServerCertificate(t).then(function(){r.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED),e.addEventListener("encrypted",n)}):(r.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED),e.addEventListener("encrypted",n))})})["catch"](function(){r.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+i.keySystem.systemString+")! Could not create MediaKeys -- TODO")})},setMediaElement:function(i){var r=this,o=u.defer();return e===i?(o.resolve(),o.promise):(e&&(e.removeEventListener("encrypted",n),e.removeEventListener("waitingforkey",n),e.setMediaKeys?e.setMediaKeys(null).then(function(){r.debug.log("[DRM][PM_21Jan2015] Successfully detached MediaKeys from video element"),o.resolve()},function(e){r.debug.error("[DRM][PM_21Jan2015] Failed to detach MediaKeys from video element: "+e),o.resolve()}):o.resolve()),e=i,e&&t&&e.setMediaKeys&&(e.addEventListener("encrypted",n),e.setMediaKeys(t)),o.promise)},setServerCertificate:function(e){if(!this.keySystem||!t)throw new Error("Can not set server certificate until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Set server certificate");var n=this,i=u.defer();return t.setServerCertificate(e).then(function(){n.notify(m.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED),i.resolve()})["catch"](function(e){n.notify(m.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,null,"Error updating server certificate -- "+e.name),i.reject()}),i.promise},createKeySession:function(e,n){if(!this.keySystem||!t)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Create key session, type = "+n),this.debug.log("[DRM][PM_21Jan2015] initData = "+String.fromCharCode.apply(null,new Uint8Array(e)));var i=t.createSession(n),r=d.call(this,i,e,n),o=this;i.generateRequest("cenc",e).then(function(){o.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,r)})["catch"](function(e){l(r),o.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to generate key request",error:new m.vo.Error(e.code,e.name,e.message)})})},updateKeySession:function(e,t){var i=e.session,r=this;r.debug.log("[DRM][PM_21Jan2015] Update key session. SessionID = "+i.sessionId),this.protectionExt.isClearKey(this.keySystem)&&(t=t.toJWK()),i.update(t).then(function(){n.session=e})["catch"](function(e){r.notify(m.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new m.vo.protection.KeyError(m.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,"Error while providing license to the CDM",e))})},loadKeySession:function(e){if(!this.keySystem||!t)throw new Error("Can not load sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Load key session. SessionID = "+e);var n=t.createSession(),i=this;n.load(e).then(function(t){if(t){var r=d.call(this,n);i.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,r)}else i.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to load session "+e,error:null})})["catch"](function(t){i.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,{reason:"Failed to load session "+e,error:new m.vo.Error(t.code,t.name,t.message)})})},removeKeySession:function(e){var t=e.session;this.debug.log("[DRM][PM_21Jan2015] Remove key session. SessionID = "+e.getSessionID());var n=this;t.remove().then(function(){n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,e.getSessionID())},function(t){n.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,null,"Error removing session ("+e.getSessionID()+"). "+t.name)})},closeKeySession:function(e){this.debug.log("[DRM][PM_21Jan2015] Close key session. SessionID = "+e.getSessionID());var t=this;s(e)["catch"](function(n){l(e),t.notify(m.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,null,"Error closing session ("+e.getSessionID()+") "+n.name)})},checkIfEncrypted:function(){}}},m.models.ProtectionModel_21Jan2015.detect=function(e){return void 0!==e.onencrypted&&void 0!==e.mediaKeys&&!window.MSMediaKeys},m.models.ProtectionModel_21Jan2015.prototype={constructor:m.models.ProtectionModel_21Jan2015},m.dependencies.protection.KeySystem=function(){},m.dependencies.protection.KeySystem_Access=function(){},m.dependencies.protection.KeySystem_Access.prototype={constructor:m.dependencies.protection.KeySystem_Access},m.dependencies.protection.KeySystem_ClearKey=function(){"use strict";var e,t="org.w3.clearkey",n="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b";return{system:void 0,schemeIdURI:"urn:uuid:"+n,systemString:t,uuid:n,sessionType:"temporary",init:function(t){e=t},getInitData:m.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection,getKeySystemConfigurations:m.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getServerCertificate:function(){return null}}},m.dependencies.protection.KeySystem_ClearKey.prototype={constructor:m.dependencies.protection.KeySystem_ClearKey},m.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData=function(e,t){var n=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),r=[],o=0;o<i.kids.length;o++){var s=i.kids[o],a=e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!a)throw new Error("[DRM] ClearKey keyID ("+s+") is not known!");r.push(new m.vo.protection.KeyPair(s,a))}n=new m.vo.protection.ClearKeyKeySet(r)}return n},m.dependencies.protection.KeySystem_PlayReady=function(){"use strict";var e,t="com.microsoft.playready",n="9a04f079-9840-4286-ab92-e65be0885f95",i="utf16",r='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>',o=function(e){var t,n,r,o,s={},a=e instanceof ArrayBuffer?e:e.buffer,l="utf16"===i?new Uint16Array(a):new Uint8Array(a),u=0;for(t=String.fromCharCode.apply(null,l),n=this.domParser.createXmlTree(t),r=n.getElementsByTagName("name"),o=n.getElementsByTagName("value"),u=0;u<r.length;u+=1)s[r[u].childNodes[0].nodeValue]=o[u].childNodes[0].nodeValue;return s.hasOwnProperty("Content")&&(s["Content-Type"]=s.Content,delete s.Content),s.hasOwnProperty("Content-Type")||(s["Content-Type"]="text/xml; charset=utf-8"),s},s=function(e){var t,n,r,o=null,s=e instanceof ArrayBuffer?e:e.buffer,a="utf16"===i?new Uint16Array(s):new Uint8Array(s);return t=String.fromCharCode.apply(null,a),n=this.domParser.createXmlTree(t),n.getElementsByTagName("Challenge")[0]?(r=n.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,r&&(o=y.decode(r))):o=t,o},a=function(e){if(e){var t,n,i,r,o,s,a,l=new DataView(e),u=l.getUint16(4,!0),d=6,c=0;for(c=0;c<u;c++)if(t=l.getUint16(d,!0),d+=2,n=l.getUint16(d,!0),d+=2,1===t){if(i=e.slice(d,d+n),r=String.fromCharCode.apply(null,new Uint16Array(i)),o=this.domParser.createXmlTree(r),o.getElementsByTagName("LA_URL")[0]&&(s=o.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue))return s;if(o.getElementsByTagName("LUI_URL")[0]&&(a=o.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue))return a}else d+=n}return null},l=function(e){var t,n,i,r,o,s=0,a=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=null;if("pssh"in e)return m.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(e);if("pro"in e)u=y.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;u=y.decodeArray(e.prheader.__text)}return t=u.length,n=4+a.length+l.length+4+t,i=new ArrayBuffer(n),r=new Uint8Array(i),o=new DataView(i),o.setUint32(s,n),s+=4,r.set(a,s),s+=a.length,r.set(l,s),s+=l.length,o.setUint32(s,t),s+=4,r.set(u,s),s+=t,r.buffer},u=function(){var t,n,i,o;if(e&&e.cdmData){for(t=[],o=0;o<e.cdmData.length;++o)t.push(e.cdmData.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=y.encode(t),n=r.replace("%CUSTOMDATA%",t),i=[],o=0;o<n.length;++o)i.push(n.charCodeAt(o)),i.push(0);return new Uint8Array(i).buffer}return null};return{schemeIdURI:"urn:uuid:"+n,systemString:t,uuid:n,notify:void 0,subscribe:void 0,unsubscribe:void 0,domParser:void 0,sessionType:"temporary",init:function(t){t&&(e=t,e.sessionType&&(this.sessionType=e.sessionType))},getInitData:l,getKeySystemConfigurations:m.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:o,getLicenseRequestFromMessage:s,getLicenseServerURLFromInitData:a,getCDMData:u,getServerCertificate:function(){return null},setPlayReadyMessageFormat:function(e){if("utf8"!==e&&"utf16"!==e)throw new Error("Illegal PlayReady message format! -- "+e);i=e}}},m.dependencies.protection.KeySystem_PlayReady.prototype={constructor:m.dependencies.protection.KeySystem_PlayReady},m.dependencies.protection.KeySystem_Widevine=function(){"use strict";var e="com.widevine.alpha",t="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",n=null,i=function(e){return n&&n.pssh?y.decodeArray(n.pssh).buffer:m.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(e)},r=function(){return n&&n.serverCertificate&&n.serverCertificate.length>0?y.decodeArray(n.serverCertificate).buffer:null};return{schemeIdURI:"urn:uuid:"+t,systemString:e,uuid:t,sessionType:"temporary",init:function(e){e&&(n=e,n.sessionType&&(this.sessionType=n.sessionType))},getInitData:i,getKeySystemConfigurations:m.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getServerCertificate:r}},m.dependencies.protection.KeySystem_Widevine.prototype={constructor:m.dependencies.protection.KeySystem_Widevine},m.dependencies.protection.servers.ClearKey=function(){"use strict";return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=0;for(e+="/?",i=0;i<n.kids.length;i++)e+=n.kids[i]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){var t,n,i,r,o=[];if(!e.hasOwnProperty("keys"))return null;for(t=0;t<e.keys.length;t++)n=e.keys[t],i=n.kid.replace(/=/g,""),r=n.k.replace(/=/g,""),o.push(new m.vo.protection.KeyPair(i,r));return new m.vo.protection.ClearKeyKeySet(o)},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},m.dependencies.protection.servers.ClearKey.prototype={constructor:m.dependencies.protection.servers.ClearKey},m.dependencies.protection.servers.DRMToday=function(){"use strict";var e={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return y.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(t){return e[t].responseType},getLicenseMessage:function(t,n){return e[n].getLicenseMessage(t)},getErrorResponse:function(t,n){return{code:0,name:"UnknownError",message:e[n].getErrorResponse(t)}}}},m.dependencies.protection.servers.DRMToday.prototype={constructor:m.dependencies.protection.servers.DRMToday},m.dependencies.protection.servers.LicenseServer=function(){},m.dependencies.protection.servers.PlayReady=function(){"use strict";var e=function(e){var t="",n=0,i=0,r=0,o=0,s=new Uint8Array(e);for(s.length>=3&&239===s[0]&&187===s[1]&&191===s[2]&&(n=3);n<s.length;)if(i=s[n],i<128)t+=String.fromCharCode(i),n++;else if(i>191&&i<224){if(n+1>=s.length)throw"UTF-8 Decode failed. Two byte character was truncated.";r=s[n+1],t+=String.fromCharCode((31&i)<<6|63&r),n+=2}else{if(n+2>=s.length)throw"UTF-8 Decode failed. Multi byte character was truncated.";r=s[n+1],o=s[n+2],t+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o),n+=3}return t},t=function(t){var n=e(t),i=this.domParser.createXmlTree(n),r=i?this.domParser.getChildNode(i,"soap:Envelope"):null,o=r?this.domParser.getChildNode(r,"soap:Body"):null,s=o?this.domParser.getChildNode(o,"soap:Fault"):null;return s?null:t},n=function(t){var n=e(t),i=this.domParser.createXmlTree(n),r=i?this.domParser.getChildNode(i,"soap:Envelope"):null,o=r?this.domParser.getChildNode(r,"soap:Body"):null,s=o?this.domParser.getChildNode(o,"soap:Fault"):null,a=s?this.domParser.getChildNode(s,"detail"):null,l=a?this.domParser.getChildNode(a,"Exception"):null,u=null,d="",c="",h="",f=-1,p=-1;return null===s?{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(t))}:(u=this.domParser.getChildNode(s,"faultstring").firstChild,d=u?u.nodeValue:null,null!==l&&(u=this.domParser.getChildNode(l,"StatusCode"),c=u?u.firstChild.nodeValue:null,u=this.domParser.getChildNode(l,"Message"),h=u?u.firstChild.nodeValue:null,f=h?h.lastIndexOf("[")+1:-1,p=h?h.indexOf("]"):-1),{code:c,name:d,message:h?h.substring(f,p):""})};return{domParser:void 0,getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return t.call(this,e)},getErrorResponse:function(e){return n.call(this,e)}}},m.dependencies.protection.servers.PlayReady.prototype={constructor:m.dependencies.protection.servers.PlayReady},m.dependencies.protection.servers.Widevine=function(){"use strict";return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},m.dependencies.protection.servers.Widevine.prototype={constructor:m.dependencies.protection.servers.Widevine},m.vo.protection.ClearKeyKeySet=function(e,t){if(t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t,this.toJWK=function(){var e,t=this.keyPairs.length,n={};for(n.keys=[],e=0;e<t;e++){var i={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(i)}this.type&&(n.type=this.type);var r=JSON.stringify(n),o=r.length,s=new ArrayBuffer(o),a=new Uint8Array(s);for(e=0;e<o;e++)a[e]=r.charCodeAt(e);return s}},m.vo.protection.ClearKeyKeySet.prototype={constructor:m.vo.protection.ClearKeyKeySet},m.vo.protection.KeyError=function(e,t,n){"use strict";this.code=e,this.message=t,this.data=n},m.vo.protection.KeyError.prototype={constructor:m.vo.protection.KeyError},m.vo.protection.KeyMessage=function(e,t,n,i){"use strict";this.sessionToken=e,this.message=t,this.defaultURL=n,this.messageType=i},m.vo.protection.KeyMessage.prototype={constructor:m.vo.protection.KeyMessage},m.vo.protection.KeyPair=function(e,t){"use strict";this.keyID=e,this.key=t},m.vo.protection.KeyPair.prototype={constructor:m.vo.protection.KeyPair},m.vo.protection.KeySystemAccess=function(e,t){this.keySystem=e,this.ksConfiguration=t},m.vo.protection.KeySystemAccess.prototype={constructor:m.vo.protection.KeySystemAccess},m.vo.protection.KeySystemConfiguration=function(e,t,n,i,r){this.initDataTypes=["cenc"],this.audioCapabilities=e,this.videoCapabilities=t,this.distinctiveIdentifier=n,this.persistentState=i,this.sessionTypes=r},m.vo.protection.KeySystemConfiguration.prototype={constructor:m.vo.protection.KeySystemConfiguration},m.vo.protection.LicenseRequestComplete=function(e,t){"use strict";this.message=e,this.requestData=t},m.vo.protection.LicenseRequestComplete.prototype={constructor:m.vo.protection.LicenseRequestComplete},m.vo.protection.MediaCapability=function(e,t){this.contentType=e,this.robustness=t},m.vo.protection.MediaCapability.prototype={constructor:m.vo.protection.MediaCapability},m.vo.protection.NeedKey=function(e,t){this.initData=e,this.initDataType=t},m.vo.protection.NeedKey.prototype={constructor:m.vo.protection.NeedKey},m.vo.protection.ProtectionData=function(e,t,n,i){this.laURL=e,this.httpRequestHeaders=t,this.bearerToken=n,this.clearkeys=i},m.vo.protection.ProtectionData.prototype={constructor:m.vo.protection.ProtectionData},m.models.SessionToken=function(){},m.models.SessionToken.prototype={initData:null,getSessionID:function(){return""},getExpirationTime:function(){return NaN},getKeyStatuses:function(){return null}},f=function(){"use strict";return{dependencies:{}}}(),f.dependencies.AES=function(){this.init=function(e){this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute.call(this);var t,n,i,r,o,s=this._tables[0][4],a=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size="+l);for(r=e.slice(0),o=[],this._key=[r,o],t=l;t<4*l+28;t++)i=r[t-1],(t%l===0||8===l&&t%l===4)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],t%l===0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),r[t]=r[t-l]^i;for(n=0;t;n++,t--)i=r[3&n?t:t-4],t<=4||n<4?o[n]=i:o[n]=a[0][s[i>>>24]]^a[1][s[i>>16&255]]^a[2][s[i>>8&255]]^a[3][s[255&i]]},this._precompute=function(){var e,t,n,i,r,o,s,a,l,u=this._tables[0],d=this._tables[1],c=u[4],h=d[4],f=[],p=[];for(e=0;e<256;e++)p[(f[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!c[t];t^=i||1,n=p[n]||1)for(s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^255&s^99,c[t]=s,h[s]=t,o=f[r=f[i=f[t]]],l=16843009*o^65537*r^257*i^16843008*t,a=257*f[s]^16843008*s,e=0;e<4;e++)u[e][t]=a=a<<24^a>>>8,d[e][s]=l=l<<24^l>>>8;for(e=0;e<5;e++)u[e]=u[e].slice(0),d[e]=d[e].slice(0)},this.decrypt=function(e,t,n,i,r,o){var s,a,l,u,d=this._key[1],c=e^d[0],h=i^d[1],f=n^d[2],p=t^d[3],m=d.length/4-2,g=4,y=this._tables[1],v=y[0],_=y[1],b=y[2],E=y[3],x=y[4];for(u=0;u<m;u++)s=v[c>>>24]^_[h>>16&255]^b[f>>8&255]^E[255&p]^d[g],a=v[h>>>24]^_[f>>16&255]^b[p>>8&255]^E[255&c]^d[g+1],l=v[f>>>24]^_[p>>16&255]^b[c>>8&255]^E[255&h]^d[g+2],p=v[p>>>24]^_[c>>16&255]^b[h>>8&255]^E[255&f]^d[g+3],g+=4,c=s,h=a,f=l;for(u=0;u<4;u++)r[(3&-u)+o]=x[c>>>24]<<24^x[h>>16&255]<<16^x[f>>8&255]<<8^x[255&p]^d[g++],s=c,c=h,h=f,f=p,p=s}},f.dependencies.AES.prototype={constructor:f.dependencies.AES},f.dependencies.AES128Decrypter=function(e,t){"use strict";this.key=e,this.iv=t,this.ntoh=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},this.doDecrypt=function(e,t,n){var i,r,o,s,a,l,u,d,c,h=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),p=new f.dependencies.AES,m=new Uint8Array(e.byteLength),g=new Int32Array(m.buffer);for(p.init(Array.prototype.slice.call(t)),i=~~n[0],r=~~n[1],o=~~n[2],s=~~n[3],c=0;c<h.length;c+=4)a=~~this.ntoh(h[c]),l=~~this.ntoh(h[c+1]),u=~~this.ntoh(h[c+2]),d=~~this.ntoh(h[c+3]),p.decrypt(a,l,u,d,g,c),g[c]=this.ntoh(g[c]^i),g[c+1]=this.ntoh(g[c+1]^r),g[c+2]=this.ntoh(g[c+2]^o),g[c+3]=this.ntoh(g[c+3]^s),i=a,r=l,o=u,s=d;return m},this.localDecrypt=function(e,t,n,i){var r=this.doDecrypt(e,t,n);i.set(r,e.byteOffset)},this.decrypt=function(e){var t=32e3,n=new Int32Array(e),i=new Uint8Array(e.byteLength),r=0,o=this.key,s=this.iv;for(this.localDecrypt(n.subarray(r,r+t),o,s,i),r=t;r<n.length;r+=t)s=new Uint32Array([this.ntoh(n[r-4]),this.ntoh(n[r-3]),this.ntoh(n[r-2]),this.ntoh(n[r-1])]),this.localDecrypt(n.subarray(r,r+t),o,s,i);return i}},f.dependencies.AES128Decrypter.prototype={constructor:f.dependencies.AES128Decrypter},f.dependencies.HlsDemux=function(){"use strict";var e=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n},t=[1,5,6],n=1,i=[],r=[],o=-1,s=-1,a=function(e,t,n,i){for(var r,o=t;o<e.length;){if(r=new x.ts.TsPacket,r.parse(e.subarray(o,o+x.ts.TsPacket.prototype.TS_PACKET_SIZE)),r.getPid()===n&&(void 0===i||r.getPusi()===i))return{offset:o,packet:r};o+=x.ts.TsPacket.prototype.TS_PACKET_SIZE}return null},l=function(e){var t=new x.ts.TsPacket;return t.checkSyncWord(e.subarray(0,x.ts.TsPacket.prototype.TS_PACKET_SIZE))},u=function(e){var t=a.call(this,e,0,x.ts.TsPacket.prototype.PAT_PID);if(null===t)return null;var n=new x.si.PAT;return n.parse(t.packet.getPayload()),n},d=function(e,t){var n=a.call(this,e,0,t);if(null===n)return null;var i=new x.si.PMT;return i.parse(n.packet.getPayload()),i},c=function(e){var t,n,r,a,l=null,u=null;if(t=new x.ts.TsPacket,t.parse(e),!t.hasAdaptationFieldOnly()&&(n=t.getPid(),r=i[n]))if(t.getPusi())if(a=new x.pes.PesPacket,a.parse(t.getPayload()),l=new m.vo.Mp4Track.Sample,l.cts=a.getPts().getValue(),l.dts=null!==a.getDts()?a.getDts().getValue():l.cts,l.size=0,l.duration=0,l.subSamples=[],o===-1&&(o=l.dts),l.mpegTimestamp=l.cts,l.dts-=o,l.cts-=o,l.dts+=s,l.cts+=s,u=a.getPayload(),"audio"===r.type&&(l.flags=16777216),"video"===r.type&&r.streamType.search("H.264")!==-1&&(l.flags=x.h264.isIDR(u)?33554432:16842752),l.subSamples.push(u),l.dts>=0)r.samples.push(l);else{var d=Math.abs(l.dts)/9e4;if(d>10)throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"A/V desynchronization ("+Math.round(d)+" s.)"}}else r.samples.length>0&&(l=r.samples[r.samples.length-1],l.subSamples.push(t.getPayload()))},h=function(e){var t,n,i,r,o=0,s=0;if(0!==e.samples.length){for(i=0;i<e.samples.length;i++){for(n=0,t=e.samples[i],r=0;r<t.subSamples.length;r++)n+=t.subSamples[r].length;i>0&&(e.samples[i-1].duration=e.samples[i].dts-e.samples[i-1].dts),t.size=n,o+=n}for(e.samples[e.samples.length-1].duration=e.samples[e.samples.length-2].duration,e.data=new Uint8Array(o),e.dataCTS=[],i=0;i<e.samples.length;i++)for(t=e.samples[i],e.streamType.search("ADTS")!==-1&&(e.dataCTS[s]=t.cts),
r=0;r<t.subSamples.length;r++)e.data.set(t.subSamples[r],s),s+=t.subSamples[r].length;if(e.streamType.search("H.264")!==-1&&f.call(this,e),e.streamType.search("ADTS")!==-1&&p.call(this,e),e.previousCts&&e.previousDuration){t=e.samples[0];var a=t.cts-(e.previousCts+e.previousDuration);a>0&&a<e.timescale&&(t.cts-=a,t.dts-=a,t.duration+=a,this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(t.cts/9e4).toFixed(3)+", duration = "+(t.duration/9e4).toFixed(3)))}}},f=function(e){var n,i,r,o,s,a,l;for(r=0,s=0,a=0;a<e.samples.length;a++){for(n=e.samples[a],n.nalus=x.h264.parseNALUs(e.data.subarray(s,s+n.size)),l=0;l<n.nalus.length;l++)i=n.nalus[l],t.indexOf(i.type)!==-1?(i.offset+=s,r+=4+n.nalus[l].size):(n.nalus.splice(l,1),l--);s+=n.size}for(o=new Uint8Array(r),s=0,a=0;a<e.samples.length;a++)for(n=e.samples[a],n.size=0,l=0;l<n.nalus.length;l++)i=n.nalus[l],o[s++]=(4278190080&i.size)>>24,o[s++]=(16711680&i.size)>>16,o[s++]=(65280&i.size)>>8,o[s++]=255&i.size,o.set(e.data.subarray(i.offset,i.offset+i.size),s),s+=i.size,n.size+=4+i.size;e.data=o},p=function(e){var t,n,i,r,o,s,a,l,u=[];for(t=x.aac.parseADTS(e.data,e.dataCTS),n=0,l=0;l<t.length;l++)n+=t[l].length;for(r=new Uint8Array(n),s=e.samples[0].cts,a=1024*e.timescale/e.samplingRate,i=0,l=0;l<t.length;l++)o=new m.vo.Mp4Track.Sample,o.cts=o.dts=t[l].cts?t[l].cts:s,o.size=t[l].length,o.duration=a,o.flags=16777216,0===u.length&&(o.mpegTimestamp=e.samples[0].mpegTimestamp),u.push(o),s=o.cts+a,l>0&&(u[l-1].duration=u[l].cts-u[l-1].cts,u[l-1].duration>a&&this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(u[l-1].cts/9e4).toFixed(3)+", duration = "+(u[l-1].duration/9e4).toFixed(3))),r.set(e.data.subarray(t[l].offset,t[l].offset+t[l].length),i),i+=t[l].length;e.data=r,e.samples=u},g=function(e){var t="",n=0,i=0;for(n=0;n<e.length;n++)i=e[n].toString(16),i.length<2&&(i="0"+i),t+=i;return t},y=function(){this.debug.log("[HlsDemux] Reset"),n=1,i=[],r=[],o=-1,s=-1},v=function(t,n){var i,r,o,s,l,u,d,c;if(i=a.call(this,t,0,n.pid,!0),null===i)throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"No packets for track "+n.type};if(r=new x.pes.PesPacket,r.parse(i.packet.getPayload()),o=r.getPayload(),n.streamType.search("H.264")!==-1){for(s=x.h264.getSequenceHeader(o);null===s;)i=a.call(this,t,i.offset+x.ts.TsPacket.prototype.TS_PACKET_SIZE,n.pid,!1),o=e(o,i.packet.getPayload()),s=x.h264.getSequenceHeader(o);n.codecPrivateData=g(s.bytes),n.codecs="avc1.",l=/00000001[0-9]7/.exec(n.codecPrivateData),l&&l[0]&&(n.codecs+=n.codecPrivateData.substr(n.codecPrivateData.indexOf(l[0])+10,6)),n.width=s.width,n.height=s.height,this.debug.log("[HlsDemux] width  = "+n.width),this.debug.log("[HlsDemux] height = "+n.height)}n.streamType.search("AAC")!==-1&&(u=x.aac.getAudioSpecificConfig(o),d=(248&u[0])>>3,n.codecPrivateData=g(u),n.codecs="mp4a.40."+d,c=(7&u[0])<<1|(128&u[1])>>7,n.samplingRate=x.aac.SAMPLING_FREQUENCY[c],n.channels=(120&u[1])>>3,n.bandwidth=0),this.debug.log("[HlsDemux] codecs = "+n.codecs),this.debug.log("[HlsDemux] codecPrivateData = "+n.codecPrivateData)},_=function(e){var t,o,s,a,c,h,f=0;if(!l.call(this,e))throw{name:m.dependencies.ErrorHandler.prototype.HLS_INVALID_PACKET_ERROR,message:"Failed to demux, packet is invalid, missing SYNC byte"};if(t=u.call(this,e),null===t)throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PAT)"};if(o=d.call(this,e,t.getPmtPid()),null===o)throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PMT)"};for(f=0;f<o.m_listOfComponents.length;f++){if(s=o.m_listOfComponents[f],a=s.m_elementary_PID,c=i[a],!c){if(c=new m.vo.Mp4Track,c.timescale=x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY,c.pid=a,h=o.gStreamTypes[s.m_stream_type],null===h){this.debug.log("[HlsDemux] Stream Type "+s.m_stream_type+" unknown!");continue}switch(c.streamType=h.name,h.value){case 224:c.type="video";break;case 192:c.type="audio";break;case 252:c.type="data";break;default:c.type="und"}}if(v.call(this,e,c),""===c.codecs)throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to get codec information for track "+c.type};i[a]||(c.trackId=n,n++,this.debug.log("[HlsDemux] Add track: type = "+c.type+", PID = "+c.pid+", trackId = "+c.trackId),r.push(c),i[a]=c)}return r},b=function(e,t){var n,i,o=0,a=-1;for(s===-1&&(s=9e4*t.startTime,this.debug.log("[HlsDemux] Media start time = "+s+" ("+t.startTime+")")),this.debug.log("[HlsDemux] Demux chunk, size = "+e.length+", nb packets = "+Math.round(e.length/x.ts.TsPacket.prototype.TS_PACKET_SIZE)),_.call(this,e),o=0;o<r.length;o++)n=r[o],n.samples.length>0&&(n.previousCts=n.samples[n.samples.length-1].cts,n.previousDuration=n.samples[n.samples.length-1].duration),r[o].samples=[],r[o].data=null;for(o=0;o<e.length;){if(o+x.ts.TsPacket.prototype.TS_PACKET_SIZE>e.length){this.debug.log("[HlsDemux] Demux chunk, residual bytes = "+(e.length-o));break}c.call(this,e.subarray(o,o+x.ts.TsPacket.prototype.TS_PACKET_SIZE)),o+=x.ts.TsPacket.prototype.TS_PACKET_SIZE}for(o=0;o<r.length;o++)if(n=r[o],0!==n.samples.length&&(h.call(this,n),this.debug.log("[HlsDemux]["+n.type+"] Demux: 1st PTS = "+n.samples[0].dts+" ("+n.samples[0].dts/9e4+")"),a=Math.max(a,n.samples[0].dts),i=Math.abs(n.samples[0].dts-a)/9e4,i>10))throw{name:m.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"A/V desynchronization ("+Math.round(i)+" s.)"};var l=[];for(o=0;o<r.length;o++)r[o].samples.length>0&&l.push(r[o]);return l};return{debug:void 0,reset:y,getTracks:_,demux:b}},f.dependencies.HlsDemux.prototype={constructor:f.dependencies.HlsDemux},f.dependencies.HlsFragmentController=function(){"use strict";var e={},t=function(e,t){var n=0,i=s.hlsDemux.demux(new Uint8Array(e),t);for(n=0;n<i.length;n+=1)!s.manifestModel.getValue().timestampMap&&i[n].samples[0].mpegTimestamp&&(s.manifestModel.getValue().timestampMap={local:i[n].samples[0].cts/9e4,mpegts:i[n].samples[0].mpegTimestamp});return s.mp4Processor.generateInitMediaSegment(i)},n=function(e){var t=new Uint8Array(16),n=0;for(n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},i=function(e,t){var i=new Date,r=new DataView(t.key.buffer),o=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]);r=new DataView(n(t.iv).buffer);var a=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]),l=new f.dependencies.AES128Decrypter(o,a);return s.debug.log("[HlsFragmentController] decrypted chunk ("+(((new Date).getTime()-i.getTime())/1e3).toFixed(3)+"s.)"),l.decrypt(e)},r=function(e){var t=u.defer();this.debug.log("[HlsFragmentController]","Load decryption key: "+e.uri);var n=new m.dependencies.XHRLoader;return n.initialize("arraybuffer",0,0),n.load(e.uri).then(function(n){e.key=new Uint8Array(n.response),t.resolve()},function(n){!n||n.aborted?t.reject():t.reject({name:m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download HLS decryption key",data:{url:e.uri,status:n.status}})}),t.promise},o=function(t,n){var o,s=u.defer(),a=this;return n.decryptionInfo&&"NONE"!==n.decryptionInfo.method?(o=e[n.decryptionInfo.uri],o?s.resolve(i.call(this,t,o)):(o=n.decryptionInfo,r.call(this,o).then(function(){return o.key&&16!==o.key.byteLength?s.reject({name:m.dependencies.ErrorHandler.prototype.HLS_INVALID_KEY_ERROR,message:"Invalid HLS key - Key length ("+o.key.byteLength+") does not respect specification"}):(e[o.uri]=o,void s.resolve(i.call(a,t,o)))},function(e){s.reject(e)})),s.promise):(s.resolve(t),s.promise)},s=m.utils.copyMethods(m.dependencies.FragmentController);return s.manifestModel=void 0,s.hlsDemux=void 0,s.mp4Processor=void 0,s.process=function(e,n){var i=u.defer(),r=null;return null===e||void 0===e||0===e.byteLength?(i.resolve(null),i.promise):n&&"Media Segment"===n.type?"text"===n.streamType?(i.resolve(e),i.promise):(o.call(s,e,n).then(function(e){try{s.manifestModel.getValue()?(r=t(e,n),s.sequenceNumber++,i.resolve(r)):i.resolve(null)}catch(o){i.reject(o)}},function(e){i.reject(e)}),i.promise):(i.resolve(null),i.promise)},s},f.dependencies.HlsFragmentController.prototype={constructor:f.dependencies.HlsFragmentController},f.dependencies.HlsHandler=function(){"use strict";var e=function(e){var n,i,r,o=null,s=this,a=null,l=u.defer();return o=e.adaptation.period,a=o.start,n=t.manifestModel.getValue(),i=t.manifestExt.getIsDynamic(n),r=new m.vo.SegmentRequest,r.streamType=t.getType(),r.type="Initialization Segment",r.url=null,r.data=1,r.range=e.range,r.availabilityStartTime=s.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(a,e.adaptation.period.mpd,i),r.availabilityEndTime=s.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(a+o.duration,o.mpd,i),r.quality=e.index,l.resolve(r),l.promise},t=m.utils.copyMethods(p.dependencies.DashHandler);return t.getInitRequest=e,t},f.dependencies.HlsHandler.prototype={constructor:f.dependencies.HlsHandler},f.dependencies.HlsParser=function(){var e,t=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,n=/#EXT-X-MEDIA:(.*)/g,i="(?:#(EXT-X-MEDIA-SEQUENCE):*(\\d+))",r="(?:#(EXT-X-TARGETDURATION):*(\\d+))",o="(?:#(EXT-X-PROGRAM-DATE-TIME):*(.+))",s="(?:#(EXT-X-KEY):(.+))",a="(?:#(EXTINF):*(\\d+(?:\\.\\d+)?)(?:,(.*))?[\r\n]*(.*))",l="(?:#(EXT-X-ENDLIST))",d=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,c=new RegExp("(?:"+i+"|"+r+"|"+o+"|"+s+"|"+a+"|"+l+")","g"),h=2,f=500,p=h,g=f,y=function(e){for(var t,n,i,r={};null!==(t=d.exec(e));)n=t[1],i=t[2].replace(/"/g,""),r[n]=i;return r},v=function(e,t){return 0===e.indexOf("http://")||0===e.indexOf("https://")?e:t+e},_=function(e){for(var n,i,r,o,s,a,l,u,d,c,h=[];null!==(i=t.exec(e));){for(r=y(i[1]),o=r.CODECS||"",o=o.split(","),s=a="",c=0;c<o.length;c++)o[c].indexOf("avc1")!==-1?a=o[c]:s=o[c];l=r.RESOLUTION||"0x0",l=l.split("x"),u=parseInt(l[0],10),d=parseInt(l[1],10),n={programId:r["PROGRAM-ID"]||"",bandwidth:parseInt(r.BANDWIDTH||"0",10),audioCodec:s,videoCodec:a,width:u,height:d,audioId:r.AUDIO||"",subtitlesId:r.SUBTITLES||"",uri:i[2]},h.push(n)}return h},b=function(e){for(var t,i,r,o,s=[];null!==(t=n.exec(e))&&(i=y(t[1]),r=(i.TYPE||"").toLowerCase(),0!==r.length);)o={type:r,groupId:i["GROUP-ID"]||"",name:r+(i.NAME?"_"+i.NAME:""),language:i.LANGUAGE||"",autoSelect:"YES"===i["AUTO-SELECT"],"default":"YES"===i.SUTITLES,uri:i.URI||""},s.push(o);return s},E=function(e,t){for(var n=0;n<e.length&&e[n].sequenceNumber<t;n++)e.shift(),n--},x=function(e,t,n){var i,r,o,s,a,l=null,u=0,d=0,h=null;if(!e||e&&e.length<0)return!1;if(0!==e.indexOf("#EXTM3U"))return!1;i=t.SegmentList,i||(i={name:"SegmentList",isRoot:!1,isArray:!1,duration:0,startNumber:0,timescale:1,BaseURL:t.BaseURL,SegmentURL_asArray:[]},t.SegmentList=i),r=i.SegmentURL_asArray,t.duration=1/0;for(var f,p,m;null!==(f=c.exec(e));)switch(f=f.filter(function(e){return void 0!==e}),p=f[1]){case"EXT-X-MEDIA-SEQUENCE":d=parseInt(f[2]),i.startNumber=d;break;case"EXT-X-TARGETDURATION":i.duration=parseInt(f[2]);break;case"EXT-X-KEY":m=y(f[2]),l={method:m.METHOD||"NONE",uri:v(m.URI,i.BaseURL),iv:m.IV};break;case"EXTINF":o={name:"SegmentURL",isRoot:!1,isArray:!0,media:v(f[4],i.BaseURL),sequenceNumber:d,time:0===r.length?0:r[r.length-1].time+r[r.length-1].duration,duration:parseFloat(f[2]),decryptionInfo:l},o.decryptionInfo&&!o.decryptionInfo.iv&&(o.decryptionInfo.iv=o.sequenceNumber),(0===r.length||o.sequenceNumber>r[r.length-1].sequenceNumber)&&r.push(o),d++,u+=o.duration,h&&(o.programDateTime=h,h+=1e3*o.duration);break;case"EXT-X-ENDLIST":t.duration=u;break;case"EXT-X-PROGRAM-DATE-TIME":h=Date.parse(f[2])}if(E(r,i.startNumber),n.segments&&(E(r,n.segments[0].sequenceNumber),E(n.segments,r[0].sequenceNumber),r[0].time!==n.segments[0].time))for(r[0].time=n.segments[0].time,a=1;a<r.length;a++)r[a].time=r[a-1].time+r[a-1].duration;n.segments=r;var g={start:r[0].time,end:r[r.length-1].time+r[r.length-1].duration};return h&&(g.programStart=r[0].programDateTime,g.programEnd=r[r.length-1].programDateTime+r[r.length-1].duration),"video"===n.contentType&&this.metricsModel.addDVRInfo("video",new Date,g),s={name:"Initialization",sourceURL:t.SegmentList.SegmentURL_asArray[0].media},t.SegmentList.Initialization=s,!0},S=function(e,t){var n,i,r,o,s,a,l=u.defer(),d=e.Period_asArray[0],c=d.AdaptationSet_asArray[0],h=c.Representation_asArray[t],f=new m.vo.SegmentRequest;for(d.start=0,c.duration=h.duration,d.duration=h.duration,h.duration!==1/0&&(e.mediaPresentationDuration=h.duration),e.type=h.duration===1/0?"dynamic":"static",n=h.SegmentList.duration*h.SegmentList.SegmentURL_asArray.length,"dynamic"===e.type&&(i=new Date,e.availabilityStartTime=new Date(i.getTime()-1e3*n),e.timeShiftBufferDepth=n),e.minBufferTime=3*h.SegmentList.duration,r=Math.max.apply(null,d.AdaptationSet_asArray.map(function(e){var n=t>e.Representation_asArray.length?0:t;return e.Representation_asArray[n].SegmentList.startNumber})),o=0;o<d.AdaptationSet_asArray.length;o++){var p=d.AdaptationSet_asArray[o];for(s=0;s<p.Representation_asArray.length;s++)if(p.Representation_asArray[s].SegmentList){var g=p.Representation_asArray[s].SegmentList.SegmentURL_asArray;if(g[0].sequenceNumber<r&&(E(g,r),g.length>0))for(g[0].time=0,a=1;a<g.length;a++)g[a].time=g[a-1].time+g[a-1].duration}}h=c.Representation_asArray[t],f.type="Initialization Segment",f.url=h.SegmentList.Initialization.sourceURL;var y=function(e,t){var n=this.hlsDemux.getTracks(new Uint8Array(t.data)),i=0;for(e.codecs="",i=0;i<n.length;i++)e.codecs+=n[i].codecs,i<n.length-1&&(e.codecs+=",");l.resolve()},v=function(){l.resolve()};return""===h.codecs?(this.debug.log("[HlsParser]","Load initialization segment: "+f.url),this.fragmentLoader.load(f).then(y.bind(this,h),v.bind(this))):l.resolve(),l.promise},T=function(e){var t=null;return e.indexOf("/")!==-1&&(e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},w=function(t,n){var i=this,r=u.defer();return this.debug.log("[HlsParser]","Load playlist manifest: "+t.url),e=new m.dependencies.XHRLoader,e.initialize("text",p,g),e.load(t.url).then(function(e){x.call(i,e.response,t,n)?r.resolve():r.reject({name:m.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse variant stream playlist",data:{url:t.url}})},function(e){!e||e.aborted?r.reject():r.reject({name:m.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download variant stream playlist",data:{url:t.url,status:e.status}})}),r.promise},D=function(e,t){var n,i,r,o,s,a,l,d,c=this,h=u.defer(),f=[],p=0,m=[],g=[],y=[],E=0;if(0!==e.indexOf("#EXTM3U"))return this.debug.error("[HlsParser] no stream in HLS manifest"),h.reject(),h.promise;if(n={},n.name="M3U",n.isRoot=!0,n.isArray=!0,n.parent=null,n.BaseURL=t,n.profiles="urn:mpeg:dash:profile:isoff-live:2011",n.type="static",i={},i.name="Period",i.isRoot=!1,i.isArray=!1,i.parent=n,i.duration=0,i.BaseURL=n.BaseURL,n.Period=i,n.Period_asArray=[i],f=[],i.AdaptationSet=f,i.AdaptationSet_asArray=f,m=_(e),0===m.length)return this.debug.error("[HlsParser] No stream in HLS manifest"),h.reject(),h.promise;for(m.sort(function(e,t){return e.bandwidth-t.bandwidth}),r={name:"AdaptationSet",isRoot:!1,isArray:!0,id:"video",lang:"",contentType:"video",mimeType:"video/mp4",maxWidth:0,maxHeight:0,BaseURL:i.BaseURL},o=[],E=0;E<m.length&&(a=m[E],!(a.bandwidth<=64e3));E++)s={name:"Representation",isRoot:!1,isArray:!0,id:p.toString(),mimeType:"video/mp4",codecs:a.videoCodec.length>0?a.audioId.length>0?a.videoCodec:a.videoCodec+","+a.audioCodec:"",bandwidth:a.bandwidth,width:a.width,height:a.height,url:v(a.uri,r.BaseURL)},s.BaseURL=T(s.url),o.push(s),p++;for(r.Representation=o.length>1?o:o[0],r.Representation_asArray=o,f.push(r),d=this.abrController.getPlaybackQuality("video",f[0]).quality,s=f[0].Representation_asArray[d],y.push(w.call(this,s,r)),g=b(e),E=0;E<g.length;E++)l=g[E],r={name:"AdaptationSet",isRoot:!1,isArray:!0,id:l.name,lang:l.language,contentType:l.type,mimeType:"audio"===l.type?"audio/mp4":"text/vtt",maxWidth:0,maxHeight:0,BaseURL:i.BaseURL},s={name:"Representation",isRoot:!1,isArray:!0,id:"",mimeType:"audio"===l.type?"audio/mp4":"text/vtt",codecs:"audio"===l.type?m[0].audioCodec:"WebVTT",bandwidth:0,width:0,height:0,url:v(l.uri,r.BaseURL)},s.BaseURL=T(s.url),r.Representation=s,r.Representation_asArray=[s],f.push(r),y.push(w.call(this,s,r));return u.all(y).then(function(){S.call(c,n,d).then(function(){h.resolve(n)})},function(e){e?h.reject(e):h.resolve(null)}),h.promise},M=function(e,t){return this.hlsDemux.reset(),this.debug.log("[HlsParser]","Doing parse."),this.debug.log("[HlsParser]",e),D.call(this,e,t)},I=function(){null!==e&&e.abort()};return{debug:void 0,config:void 0,manifestModel:void 0,fragmentLoader:void 0,abrController:void 0,hlsDemux:void 0,metricsModel:void 0,setup:function(){p=this.config.getParam("ManifestLoader.RetryAttempts","number",h),g=this.config.getParam("ManifestLoader.RetryInterval","number",f)},parse:M,updatePlaylist:w,abort:I}},f.dependencies.HlsParser.prototype={constructor:f.dependencies.HlsParser},h=function(){"use strict";return{dependencies:{}}}(),h.dependencies.MssParser=function(){"use strict";var e=1e7,t=["AAC","AACL","AVC1","H264","TTML","DFXP"],n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},i={video:"video/mp4",audio:"audio/mp4",text:"application/ttml+xml+mp4"},r=null,o=null,s=function(){var e,t,n={},i=[],s=this.domParser.getChildNode(r,"SmoothStreamingMedia");for(n.BaseURL=o,t=0;t<s.childNodes.length;t++)"StreamIndex"===s.childNodes[t].nodeName&&(e=a.call(this,s.childNodes[t]),null!==e&&i.push(e));return i.length>0&&(n.AdaptationSet=i.length>1?i:i[0]),n.AdaptationSet_asArray=i,n},a=function(e){var t,n,r={},s=[],a={},u=null,d=null;for(r.id=this.domParser.getAttributeValue(e,"Name"),r.lang=this.domParser.getAttributeValue(e,"Language"),r.contentType=this.domParser.getAttributeValue(e,"Type"),r.mimeType=i[r.contentType],r.maxWidth=this.domParser.getAttributeValue(e,"MaxWidth"),r.maxHeight=this.domParser.getAttributeValue(e,"MaxHeight"),r.BaseURL=o,d=this.domParser.getAttributeValue(e,"Subtype"),d&&(r.subType=d),a=f.call(this,e),u=this.domParser.getChildNodes(e,"QualityLevel"),n=0;n<u.length;n++)u[n].BaseURL=r.BaseURL,u[n].mimeType=r.mimeType,u[n].Id=r.id+"_"+this.domParser.getAttributeValue(u[n],"Index"),t=l.call(this,u[n],e),null!==t&&(t.SegmentTemplate=a,s.push(t));return 0===s.length?null:(r.Representation=s.length>1?s:s[0],r.Representation_asArray=s,r.SegmentTemplate=a,r)},l=function(e,n){var i={},r=null,o=this.domParser.getAttributeValue(n,"Type");if(i.id=e.Id,i.bandwidth=parseInt(this.domParser.getAttributeValue(e,"Bitrate"),10),i.mimeType=e.mimeType,i.width=parseInt(this.domParser.getAttributeValue(e,"MaxWidth"),10),i.height=parseInt(this.domParser.getAttributeValue(e,"MaxHeight"),10),r=this.domParser.getAttributeValue(e,"FourCC"),null!==r&&""!==r||(r=this.domParser.getAttributeValue(n,"FourCC")),null===r||""===r){if("audio"!==o)return this.errHandler.sendWarning(m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,o+" codec/FourCC not provided",{codec:""}),null;r="AAC"}return t.indexOf(r.toUpperCase())===-1?(this.debug.warn("[MssParser] Codec not supported: "+r),null):("H264"===r||"AVC1"===r?i.codecs=d.call(this,e):r.indexOf("AAC")>=0&&(i.codecs=c.call(this,e,r),i.audioSamplingRate=parseInt(this.domParser.getAttributeValue(e,"SamplingRate"),10),i.audioChannels=parseInt(this.domParser.getAttributeValue(e,"Channels"),10)),i.codecPrivateData=""+this.domParser.getAttributeValue(e,"CodecPrivateData"),i.BaseURL=e.BaseURL,i)},d=function(e){var t,n,i=this.domParser.getAttributeValue(e,"CodecPrivateData").toString();return t=/00000001[0-9]7/.exec(i),n=t&&t[0]?i.substr(i.indexOf(t[0])+10,6):void 0,"avc1."+n},c=function(e,t){var i,r,o,s,a=0,l=this.domParser.getAttributeValue(e,"CodecPrivateData").toString(),u=parseInt(this.domParser.getAttributeValue(e,"SamplingRate"),10);return"AACH"===t&&(a=5),void 0===l||""===l?(a=2,o=n[u],"AACH"===t?(a=5,l=new Uint8Array(4),s=n[2*u],l[0]=a<<3|o>>1,l[1]=o<<7|e.Channels<<3|s>>1,l[2]=s<<7|8,l[3]=0,r=new Uint16Array(2),r[0]=(l[0]<<8)+l[1],r[1]=(l[2]<<8)+l[3],i=r[0].toString(16),i=r[0].toString(16)+r[1].toString(16)):(l=new Uint8Array(2),l[0]=a<<3|o>>1,l[1]=o<<7|parseInt(this.domParser.getAttributeValue(e,"Channels"),10)<<3,r=new Uint16Array(1),r[0]=(l[0]<<8)+l[1],i=r[0].toString(16)),l=""+i,l=l.toUpperCase(),e.setAttribute("CodecPrivateData",l)):0===a&&(a=(248&parseInt(l.substr(0,2),16))>>3),"mp4a.40."+a},f=function(t){var n,i={};return n=this.domParser.getAttributeValue(t,"Url").replace("{bitrate}","$Bandwidth$"),n=n.replace("{start time}","$Time$"),i.media=n,i.timescale=e,i.SegmentTimeline=p.call(this,t),i},p=function(e){var t,n,i,r={},o=this.domParser.getChildNodes(e,"c"),s=[];for(t=0;t<o.length;t++)n=parseFloat(this.domParser.getAttributeValue(o[t],"t")),i=parseFloat(this.domParser.getAttributeValue(o[t],"d")),0!==t||n||(n=0),t>0&&(s[s.length-1].d||(s[s.length-1].d=n-s[s.length-1].t),n||(n=s[s.length-1].t+s[s.length-1].d)),s.push({d:i,t:n});return r.S=s,r.S_asArray=s,r},g=function(e){var t,n,i,r;return t=y.decodeArray(e.firstChild.data),n=v(t),n=new Uint16Array(n.buffer),n=String.fromCharCode.apply(null,n),i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelector("KID").textContent,r=y.decodeArray(r),_(r),r},v=function(e){var t,n,i,r,o,s=0;for(t=(e[s+3]<<24)+(e[s+2]<<16)+(e[s+1]<<8)+e[s],s+=4,n=(e[s+1]<<8)+e[s],s+=2;s<e.length;)if(i=(e[s+1]<<8)+e[s],s+=2,1===i)return r=(e[s+1]<<8)+e[s],s+=2,o=new Uint8Array(r),o.set(e.subarray(s,s+r)),o;return null},_=function(e){b(e,0,3),b(e,1,2),b(e,4,5),b(e,6,7)},b=function(e,t,n){var i=e[t];e[t]=e[n],e[n]=i},E=function(e){var t,n={},i=this.system.getObject("ksPlayReady");return t={__text:e.firstChild.data,__prefix:"mspr"},n.schemeIdUri=i.schemeIdURI,n.value=i.systemString,n.pro=t,n.pro_asArray=t,n},x=function(){var e={},t=this.system.getObject("ksWidevine");return e.schemeIdUri=t.schemeIdURI,e.value=t.systemString,e},S=function(e){var t=e.SegmentTemplate,n=t.SegmentTimeline.S_asArray;if(0!==n.length){var i={start:n[0].t/t.timescale,end:(n[n.length-1].t+n[n.length-1].d)/t.timescale};this.metricsModel.addDVRInfo(e.contentType,new Date,i)}},T=function(t){var n,i,a,l,u,d,c,f,p,y={},v=[],_=this.domParser.getChildNode(r,"SmoothStreamingMedia"),b=this.domParser.getChildNode(_,"Protection"),T=null;y.name="MSS",y.profiles="urn:mpeg:dash:profile:isoff-live:2011";var w=this.domParser.getAttributeValue(_,"IsLive");y.type=null!==w&&"true"===w.toLowerCase()?"dynamic":"static",y.timeShiftBufferDepth=parseFloat(this.domParser.getAttributeValue(_,"DVRWindowLength"))/e;var D=parseFloat(this.domParser.getAttributeValue(_,"Duration"));for(y.mediaPresentationDuration=0===D?1/0:D/e,y.BaseURL=o,y.minBufferTime=m.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME,"dynamic"===y.type&&(y.availabilityStartTime=new Date(t.getTime()-1e3*y.timeShiftBufferDepth)),y.Period=s.call(this),y.Period_asArray=[y.Period],n=y.Period,n.start=0,void 0!==b&&(T=this.domParser.getChildNode(b,"ProtectionHeader"),T.firstChild.data=T.firstChild.data.replace(/\n|\r/g,""),l=g(T),a=E.call(this,T),a["cenc:default_KID"]=l,v.push(a),a=x.call(this,T),a["cenc:default_KID"]=l,a.pssh={__text:h.dependencies.createVOWidevinePssh(l,this.debug)},v.push(a),y.ContentProtection=v.length>1?v:v[0],y.ContentProtection_asArray=v),i=n.AdaptationSet_asArray,f=0;f<i.length;f+=1)void 0!==y.ContentProtection&&(i[f].ContentProtection=y.ContentProtection,i[f].ContentProtection_asArray=y.ContentProtection_asArray),"dynamic"===y.type&&S.call(this,i[f]);if(delete y.ContentProtection,delete y.ContentProtection_asArray,"static"===y.type){for(f=0;f<i.length;f++)"audio"!==i[f].contentType&&"video"!==i[f].contentType||(c=i[f].SegmentTemplate.SegmentTimeline.S_asArray,d=c[0].t,d>0&&(u=u?Math.min(u,d):d),y.mediaPresentationDuration=Math.min(y.mediaPresentationDuration,((c[c.length-1].t+c[c.length-1].d)/e).toFixed(3)));if(u>0){for(f=0;f<i.length;f++){for(c=i[f].SegmentTemplate.SegmentTimeline.S_asArray,p=0;p<c.length;p++)c[p].tManifest=c[p].t,c[p].t-=u;"audio"!==i[f].contentType&&"video"!==i[f].contentType||(n.start=Math.max(c[0].t,n.start))}n.start/=e}}return n.duration=y.mediaPresentationDuration,y},w=function(e,t){this.debug.info("[MssParser]","Doing parse.");var n=new Date,i=null,s=null,a=null;return r=this.domParser.createXmlTree(e),i=new Date,null===r?u.reject(null):(o=t,s=T.call(this,n),a=new Date,this.debug.info("[MssParser]","Parsing complete (xmlParser: "+(i.getTime()-n.getTime())+"ms, mss2dash: "+(a.getTime()-i.getTime())+"ms, total: "+((new Date).getTime()-n.getTime())/1e3+"s)"),u.when(s))};return{debug:void 0,system:void 0,errHandler:void 0,domParser:void 0,metricsModel:void 0,parse:w}},h.dependencies.MssParser.prototype={constructor:h.dependencies.MssParser},h.dependencies.MssHandler=function(){"use strict";var e=function(e,t){var n=1;return e.audioChannels?n=e.audioChannels:t.audioChannels&&(n=t.audioChannels),n},t=function(e,t){var n=1;return n=e.audioSamplingRate?e.audioSamplingRate:t.audioSamplingRate},n=function(n){var r,o,s,a,l,u=i.manifestModel.getValue();if(n.initData)return n.initData;if(r=n.adaptation,o=u.Period_asArray[r.period.index].AdaptationSet_asArray[r.index],s=o.Representation_asArray[n.index],a=new m.vo.Mp4Track,a.type=i.getType()||"und",a.trackId=r.index+1,a.timescale=n.timescale,a.duration=n.adaptation.period.duration,a.codecs=s.codecs,a.codecPrivateData=s.codecPrivateData,a.bandwidth=s.bandwidth,"text"!==a.type&&(l=s.mimeType+';codecs="'+s.codecs+'"',!this.capabilities.supportsCodec(this.videoModel.getElement(),l)))throw{name:m.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Codec is not supported (HTMLMediaElement)",data:{codec:l,bandwidth:s.bandwidth,codecPrivateData:s.codecPrivateData}};return o.ContentProtection_asArray&&o.ContentProtection_asArray.length>0&&(a.contentProtection=o.ContentProtection_asArray),a.width=s.width||o.maxWidth,a.height=s.height||o.maxHeight,a.language=o.lang?o.lang:"und",a.channels=e(o,s),a.samplingRate=t(o,s),n.initData=i.mp4Processor.generateInitSegment([a]),n.initData},i=m.utils.copyMethods(p.dependencies.DashHandler);return i.mp4Processor=void 0,i.getInitRequest=function(e){var t=null,r=this,o=null,s=null,a=u.defer();if(!e)throw new Error("MssHandler.getInitRequest(): representation is undefined");t=e.adaptation.period,o=t.start,s=new m.vo.SegmentRequest,s.streamType=i.getType(),s.type="Initialization Segment",s.url=null;try{s.data=n.call(this,e)}catch(l){return a.reject(l),a.promise}return s.range=e.range,s.availabilityStartTime=r.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(o,e.adaptation.period.mpd,i.getIsDynamic()),s.availabilityEndTime=r.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(o+t.duration,t.mpd,i.getIsDynamic()),s.quality=e.index,a.resolve(s),a.promise},i.getIFrameRequest=function(e){return e&&e.url&&("video"===e.streamType||"audio"===e.streamType)&&(e.url=e.url.replace("Fragments","KeyFrames")),e},i.getFragmentInfoRequest=function(e){return e&&e.url&&(e.url=e.url.replace("Fragments","FragmentInfo"),e.type="FragmentInfo Segment"),e},i},h.dependencies.MssHandler.prototype={constructor:h.dependencies.MssHandler},h.dependencies.MssFragmentController=function(){"use strict";var e=function(e,t,n,i){var r,o=this.manifestModel.getValue(),s=!1,a=i.SegmentTemplate.SegmentTimeline.S,l=t.entry,u=0,d=0,c=null,h=0,f=0,p=0,m=-1,g=null;if("dynamic"===o.type){for(;f<l.length;)u=l[f].fragment_absolute_time,d=l[f].fragment_duration,c=a[a.length-1],h=c.t,u>h&&(this.debug.log("[MssFragmentController] Add new segment - t = "+u/1e7),a.push({t:u,d:d}),s=!0),f+=1;for(p=a.length-1;p>=0;p-=1)if(a[p].t===n.baseMediaDecodeTime){m=p;break}if(m>=0)for(f=0;f<l.length;f+=1)m+f<a.length&&(h=a[m+f].t,h+a[m+f].d!==l[f].fragment_absolute_time&&(a[m+f].t=l[f].fragment_absolute_time,a[m+f].d=l[f].fragment_duration,this.debug.log("[MssFragmentController] Correct tfrf time  = "+l[f].fragment_absolute_time+"and duration = "+l[f].fragment_duration+"! ********"),s=!0));if(o.timeShiftBufferDepth&&o.timeShiftBufferDepth>0){if(s)for(c=a[a.length-1],h=c.t,g=h-1e7*o.timeShiftBufferDepth,c=a[0];c.t<g;)this.debug.log("[MssFragmentController] Remove segment  - t = "+c.t/1e7),a.splice(0,1),c=a[0];r={start:a[0].t/i.SegmentTemplate.timescale,end:n.baseMediaDecodeTime/i.SegmentTemplate.timescale+e.duration};var y=this.metricsModel.getMetricsFor(i.type).DVRInfo;y&&y.length>0&&r.end>y[y.length-1].range.end&&this.metricsModel.addDVRInfo(i.type,new Date,r)}return s}},t=function(t,n,i){var r,o=null,s=null,a=null,l=null,u=null,d=0;if(o=E.deserialize(t),s=o.getBoxByType("moof"),a=s.getBoxByType("traf"),l=a.getBoxByType("tfdt"),null===l&&(l=new E.boxes.TrackFragmentBaseMediaDecodeTimeBox,l.version=1,l.flags=0,l.baseMediaDecodeTime=Math.floor(n.startTime*n.timescale),r=a.getBoxIndexByType("tfhd"),a.boxes.splice(r+1,0,l)),u=a.getBoxesByType("tfrf"),0!==u.length)for(d=0;d<u.length;d+=1)e.call(this,n,u[d],l,i)},n=function(e,t){var n,i,r,o,s,a=null,l=null,u=null,d=null,c=null,h=null;for(a=e.getBoxByType("moof"),l=e.getBoxByType("mdat"),u=a.getBoxByType("traf"),d=u.getBoxByType("trun"),n=u.getBoxByType("tfhd"),d.samples_table[0].sample_duration||(d.samples_table[0].sample_duration=n.default_sample_duration),d.flags|=256,n.flags&=16777207,r=Math.floor(t/d.samples_table[0].sample_duration),i=0;i<r-1;i++)d.samples_table.push(d.samples_table[0]);if(d.sample_count=d.samples_table.length,o=r*d.samples_table[0].sample_duration,o<t&&(d.samples_table[d.samples_table.length-1].sample_duration+=t-o),c=u.getBoxByType("sepiff"),null!==c){for(c.sample_count>1&&(c.entry=c.entry.slice(0,1)),i=0;i<r-1;i+=1)c.entry.push(c.entry[0]);c.sample_count=c.entry.length}if(h=u.getBoxByType("saiz"),null!==h){if(0===h.default_sample_info_size)for(h.sample_count>1&&(h.sample_info_size=h.sample_info_size.slice(0,1)),i=0;i<r-1;i+=1)h.sample_info_size.push(h.sample_info_size[0]);h.sample_count=c.entry.length}for(s=l.data,l.data=new Uint8Array(s.length*d.sample_count),i=0;i<d.sample_count;i++)l.data.set(s,s.length*i)},i=function(t,i,r){var o,s,a=0,l=this.manifestModel.getValue(),u=l?this.manifestExt.getIndex(r,l)+1:-1,d=E.deserialize(t),c=null,h=null,f=null,p=null,m=null,g=null,y=null,v=null,_=null,b=null,x=-1,S=0,T=0,w=0,D=0,M=null;if(!d)return null;if(c=d.getBoxByType("moof"),h=d.getBoxByType("mdat"),f=c.getBoxByType("traf"),p=f.getBoxByType("trun"),m=f.getBoxByType("tfhd"),s=void 0!==p.samples_table[0].sample_duration?p.samples_table[0].sample_duration:m.default_sample_duration,o=i.duration*i.timescale,1===p.samples_table.length&&s<o&&n(d,o),m.track_ID=u,f.removeBoxByType("tfxd"),_=f.getBoxByType("tfdt"),null===_&&(_=new E.boxes.TrackFragmentBaseMediaDecodeTimeBox,_.version=1,_.flags=0,_.baseMediaDecodeTime=Math.floor(i.startTime*i.timescale),x=f.getBoxIndexByType("tfhd"),f.boxes.splice(x+1,0,_)),b=f.getBoxesByType("tfrf"),0!==b.length)for(a=0;a<b.length;a+=1)e.call(this,i,b[a],_,r),f.removeBoxByType("tfrf");if(y=f.getBoxByType("sepiff"),null!==y&&(y.boxtype="senc",y.extended_type=void 0,g=f.getBoxByType("saio"),null===g)){if(g=new E.boxes.SampleAuxiliaryInformationOffsetsBox,g.version=0,g.flags=0,g.entry_count=1,g.offset=[],v=new E.boxes.SampleAuxiliaryInformationSizesBox,v.version=0,v.flags=0,v.sample_count=y.sample_count,v.default_sample_info_size=0,v.sample_info_size=[],2&y.flags)for(a=0;a<y.sample_count;a+=1)v.sample_info_size[a]=10+6*y.entry[a].NumberOfEntries;else v.default_sample_info_size=8;f.boxes.push(v),f.boxes.push(g)}return m.flags&=16777214,m.flags|=131072,p.flags|=1,p.data_offset=0,S=d.getLength(),p.data_offset=S-h.size+8,g=f.getBoxByType("saio"),null!==g&&(T=d.getBoxOffsetByType("moof"),w=c.getBoxOffsetByType("traf"),D=f.getBoxOffsetByType("senc"),g.offset[0]=T+w+D+16),M=E.serialize(d)},r=m.utils.copyMethods(m.dependencies.FragmentController);return r.manifestModel=void 0,r.manifestExt=void 0,r.metricsModel=void 0,r.process=function(e,n,r){
var o=u.defer(),s=null,a=this.manifestModel.getValue(),l=null;if(!(null!==e&&void 0!==e&&e.byteLength>0))return o.resolve(null),o.promise;if(s=new Uint8Array(e),a&&r)try{l=a.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index],n&&("Media Segment"===n.type?(s=i.call(this,s,n,l),o.resolve(s?s:null)):"FragmentInfo Segment"===n.type?(t.call(this,s,n,l),o.resolve(s)):o.resolve(s))}catch(d){o.reject(d)}else o.resolve(s);return o.promise},r},h.dependencies.MssFragmentController.prototype={constructor:h.dependencies.MssFragmentController},h.dependencies.createVOWidevinePssh=function(e,t){var n=new Uint8Array([255,255,255,255,112,115,115,104,0,0,0,0,237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237,255,255,255,255,8,1,18,16,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,26,12,118,105,97,99,99,101,115,115,111,114,99,97,42,2,83,68]),i=n.length,r=i-32,o="",s=0;if(n[0]=(4278190080&i)>>32,n[1]=(16711680&i)>>16,n[2]=(65280&i)>>8,n[3]=255&i,n[28]=(4278190080&r)>>32,n[29]=(16711680&r)>>16,n[30]=(65280&r)>>8,n[31]=255&r,n.set(e,36),t){for(o="",s=0;s<n.length;s++)o+="\\0x"+n[s].toString(16);t.log("[VoWvPssh] "+o)}return n=String.fromCharCode.apply(null,n),t&&t.log("[VoWvPssh] "+n),n=y.encodeASCII(n),t&&t.log("[VoWvPssh] "+n),n};var g={};g.encode=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},g.decode=function(e){for(var t=[],n=0;n<e.length;){var i=e[n++];i<128||(i<224?(i=(31&i)<<6,i|=63&e[n++]):i<240?(i=(15&i)<<12,i|=(63&e[n++])<<6,i|=63&e[n++]):(i=(7&i)<<18,i|=(63&e[n++])<<12,i|=(63&e[n++])<<6,i|=63&e[n++])),t.push(String.fromCharCode(i))}return t.join("")};var y={};if(function(e){var t=function(t){for(var n=0,i=[],r=0|t.length/3;0<r--;){var o=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push(e.charAt(63&o))}if(2==t.length-n){var o=(t[n]<<16)+(t[n+1]<<8);i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push("=")}else if(1==t.length-n){var o=t[n]<<16;i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push("==")}return i.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),i=function(e){for(var t=0,i=[],r=0|e.length/4;0<r--;){var o=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];i.push(255&o>>16),i.push(255&o>>8),i.push(255&o),t+=4}return i&&("="==e.charAt(t-2)?(i.pop(),i.pop()):"="==e.charAt(t-1)&&i.pop()),i},r={};r.encode=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},r.decode=function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")},y.decodeArray=function(e){var t=i(e);return new Uint8Array(t)},y.encodeASCII=function(e){var n=r.encode(e);return t(n)},y.decodeASCII=function(e){var t=i(e);return r.decode(t)},y.encode=function(e){var n=g.encode(e);return t(n)},y.decode=function(e){var t=i(e);return g.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0===v)var v=y.encode;if(void 0===_)var _=y.decode;if(function(e){"use strict";var t={VERSION:"0.5.3"};t.System=function(){this._mappings={},this._outlets={},this._handlers={},this.strictInjections=!0,this.autoMapOutlets=!1,this.postInjectionHook="setup"},t.System.prototype={_createAndSetupInstance:function(e,t){var n=new t;return this.injectInto(n,e),n},_retrieveFromCacheOrCreate:function(e,t){"undefined"==typeof t&&(t=!1);var n;if(!this._mappings.hasOwnProperty(e))throw new Error(1e3);var i=this._mappings[e];return!t&&i.isSingleton?(null==i.object&&(i.object=this._createAndSetupInstance(e,i.clazz)),n=i.object):n=i.clazz?this._createAndSetupInstance(e,i.clazz):i.object,n},mapOutlet:function(e,t,n){if("undefined"==typeof e)throw new Error(1010);return t=t||"global",n=n||e,this._outlets.hasOwnProperty(t)||(this._outlets[t]={}),this._outlets[t][n]=e,this},getObject:function(e){if("undefined"==typeof e)throw new Error(1020);return this._retrieveFromCacheOrCreate(e)},mapValue:function(e,t){if("undefined"==typeof e)throw new Error(1030);return this._mappings[e]={clazz:null,object:t,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this.hasMapping(e)&&this.injectInto(t,e),this},hasMapping:function(e){if("undefined"==typeof e)throw new Error(1040);return this._mappings.hasOwnProperty(e)},mapClass:function(e,t){if("undefined"==typeof e)throw new Error(1050);if("undefined"==typeof t)throw new Error(1051);return this._mappings[e]={clazz:t,object:null,isSingleton:!1},this.autoMapOutlets&&this.mapOutlet(e),this},mapSingleton:function(e,t){if("undefined"==typeof e)throw new Error(1060);if("undefined"==typeof t)throw new Error(1061);return this._mappings[e]={clazz:t,object:null,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this},instantiate:function(e){if("undefined"==typeof e)throw new Error(1070);return this._retrieveFromCacheOrCreate(e,!0)},injectInto:function(e,t){if("undefined"==typeof e)throw new Error(1080);if("object"==typeof e){var n=[];this._outlets.hasOwnProperty("global")&&n.push(this._outlets.global),"undefined"!=typeof t&&this._outlets.hasOwnProperty(t)&&n.push(this._outlets[t]);for(var i in n){var r=n[i];for(var o in r){var s=r[o];(!this.strictInjections||o in e)&&(e[o]=this.getObject(s))}}"setup"in e&&e.setup.call(e)}return this},unmap:function(e){if("undefined"==typeof e)throw new Error(1090);return delete this._mappings[e],this},unmapOutlet:function(e,t){if("undefined"==typeof e)throw new Error(1100);if("undefined"==typeof t)throw new Error(1101);return delete this._outlets[e][t],this},mapHandler:function(e,t,n,i,r){if("undefined"==typeof e)throw new Error(1110);return t=t||"global",n=n||e,"undefined"==typeof i&&(i=!1),"undefined"==typeof r&&(r=!1),this._handlers.hasOwnProperty(e)||(this._handlers[e]={}),this._handlers[e].hasOwnProperty(t)||(this._handlers[e][t]=[]),this._handlers[e][t].push({handler:n,oneShot:i,passEvent:r}),this},unmapHandler:function(e,t,n){if("undefined"==typeof e)throw new Error(1120);if(t=t||"global",this._handlers.hasOwnProperty(e)&&this._handlers[e].hasOwnProperty(t)){var i=this._handlers[e][t];for(var r in i){var o=i[r];if(!n||o.handler===n){i.splice(r,1);break}}}return this},notify:function(e){if("undefined"==typeof e)throw new Error(1130);var t=Array.prototype.slice.call(arguments),n=t.slice(1);if(this._handlers.hasOwnProperty(e)){var i=this._handlers[e];for(var r in i){var o,s=i[r];"global"!==r&&(o=this.getObject(r));var a,l,u=[];for(a=0,l=s.length;a<l;a++){var d,c=s[a];d=o&&"string"==typeof c.handler?o[c.handler]:c.handler,c.oneShot&&u.unshift(a),c.passEvent?d.apply(o,t):d.apply(o,n)}for(a=0,l=u.length;a<l;a++)s.splice(u[a],1)}}return this}},e.dijon=t}(this),d={},d.math={},d.math.Long=function(e,t){this.low_=0|e,this.high_=0|t},d.math.Long.IntCache_={},d.math.Long.fromInt=function(e){if(-128<=e&&e<128){var t=d.math.Long.IntCache_[e];if(t)return t}var n=new d.math.Long(0|e,e<0?-1:0);return-128<=e&&e<128&&(d.math.Long.IntCache_[e]=n),n},d.math.Long.fromNumber=function(e){return isNaN(e)||!isFinite(e)?d.math.Long.ZERO:e<=-d.math.Long.TWO_PWR_63_DBL_?d.math.Long.MIN_VALUE:e+1>=d.math.Long.TWO_PWR_63_DBL_?d.math.Long.MAX_VALUE:e<0?d.math.Long.fromNumber(-e).negate():new d.math.Long(e%d.math.Long.TWO_PWR_32_DBL_|0,e/d.math.Long.TWO_PWR_32_DBL_|0)},d.math.Long.fromBits=function(e,t){return new d.math.Long(e,t)},d.math.Long.fromString=function(e,t){if(0==e.length)throw Error("number format error: empty string");var n=t||10;if(n<2||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return d.math.Long.fromString(e.substring(1),n).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var i=d.math.Long.fromNumber(Math.pow(n,8)),r=d.math.Long.ZERO,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),a=parseInt(e.substring(o,o+s),n);if(s<8){var l=d.math.Long.fromNumber(Math.pow(n,s));r=r.multiply(l).add(d.math.Long.fromNumber(a))}else r=r.multiply(i),r=r.add(d.math.Long.fromNumber(a))}return r},d.math.Long.TWO_PWR_16_DBL_=65536,d.math.Long.TWO_PWR_24_DBL_=1<<24,d.math.Long.TWO_PWR_32_DBL_=d.math.Long.TWO_PWR_16_DBL_*d.math.Long.TWO_PWR_16_DBL_,d.math.Long.TWO_PWR_31_DBL_=d.math.Long.TWO_PWR_32_DBL_/2,d.math.Long.TWO_PWR_48_DBL_=d.math.Long.TWO_PWR_32_DBL_*d.math.Long.TWO_PWR_16_DBL_,d.math.Long.TWO_PWR_64_DBL_=d.math.Long.TWO_PWR_32_DBL_*d.math.Long.TWO_PWR_32_DBL_,d.math.Long.TWO_PWR_63_DBL_=d.math.Long.TWO_PWR_64_DBL_/2,d.math.Long.ZERO=d.math.Long.fromInt(0),d.math.Long.ONE=d.math.Long.fromInt(1),d.math.Long.NEG_ONE=d.math.Long.fromInt(-1),d.math.Long.MAX_VALUE=d.math.Long.fromBits(-1,2147483647),d.math.Long.MIN_VALUE=d.math.Long.fromBits(0,-2147483648),d.math.Long.TWO_PWR_24_=d.math.Long.fromInt(1<<24),d.math.Long.prototype.toInt=function(){return this.low_},d.math.Long.prototype.toNumber=function(){return this.high_*d.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},d.math.Long.prototype.toString=function(e){var t=e||10;if(t<2||36<t)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(d.math.Long.MIN_VALUE)){var n=d.math.Long.fromNumber(t),i=this.div(n),r=i.multiply(n).subtract(this);return i.toString(t)+r.toInt().toString(t)}return"-"+this.negate().toString(t)}for(var o=d.math.Long.fromNumber(Math.pow(t,6)),r=this,s="";;){var a=r.div(o),l=r.subtract(a.multiply(o)).toInt(),u=l.toString(t);if(r=a,r.isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},d.math.Long.prototype.getHighBits=function(){return this.high_},d.math.Long.prototype.getLowBits=function(){return this.low_},d.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:d.math.Long.TWO_PWR_32_DBL_+this.low_},d.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(d.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high_?t+33:t+1},d.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},d.math.Long.prototype.isNegative=function(){return this.high_<0},d.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},d.math.Long.prototype.equals=function(e){return this.high_==e.high_&&this.low_==e.low_},d.math.Long.prototype.notEquals=function(e){return this.high_!=e.high_||this.low_!=e.low_},d.math.Long.prototype.lessThan=function(e){return this.compare(e)<0},d.math.Long.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},d.math.Long.prototype.greaterThan=function(e){return this.compare(e)>0},d.math.Long.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},d.math.Long.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.subtract(e).isNegative()?-1:1},d.math.Long.prototype.negate=function(){return this.equals(d.math.Long.MIN_VALUE)?d.math.Long.MIN_VALUE:this.not().add(d.math.Long.ONE)},d.math.Long.prototype.add=function(e){var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,r=65535&this.low_,o=e.high_>>>16,s=65535&e.high_,a=e.low_>>>16,l=65535&e.low_,u=0,c=0,h=0,f=0;return f+=r+l,h+=f>>>16,f&=65535,h+=i+a,c+=h>>>16,h&=65535,c+=n+s,u+=c>>>16,c&=65535,u+=t+o,u&=65535,d.math.Long.fromBits(h<<16|f,u<<16|c)},d.math.Long.prototype.subtract=function(e){return this.add(e.negate())},d.math.Long.prototype.multiply=function(e){if(this.isZero())return d.math.Long.ZERO;if(e.isZero())return d.math.Long.ZERO;if(this.equals(d.math.Long.MIN_VALUE))return e.isOdd()?d.math.Long.MIN_VALUE:d.math.Long.ZERO;if(e.equals(d.math.Long.MIN_VALUE))return this.isOdd()?d.math.Long.MIN_VALUE:d.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(d.math.Long.TWO_PWR_24_)&&e.lessThan(d.math.Long.TWO_PWR_24_))return d.math.Long.fromNumber(this.toNumber()*e.toNumber());var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,r=65535&this.low_,o=e.high_>>>16,s=65535&e.high_,a=e.low_>>>16,l=65535&e.low_,u=0,c=0,h=0,f=0;return f+=r*l,h+=f>>>16,f&=65535,h+=i*l,c+=h>>>16,h&=65535,h+=r*a,c+=h>>>16,h&=65535,c+=n*l,u+=c>>>16,c&=65535,c+=i*a,u+=c>>>16,c&=65535,c+=r*s,u+=c>>>16,c&=65535,u+=t*l+n*a+i*s+r*o,u&=65535,d.math.Long.fromBits(h<<16|f,u<<16|c)},d.math.Long.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return d.math.Long.ZERO;if(this.equals(d.math.Long.MIN_VALUE)){if(e.equals(d.math.Long.ONE)||e.equals(d.math.Long.NEG_ONE))return d.math.Long.MIN_VALUE;if(e.equals(d.math.Long.MIN_VALUE))return d.math.Long.ONE;var t=this.shiftRight(1),n=t.div(e).shiftLeft(1);if(n.equals(d.math.Long.ZERO))return e.isNegative()?d.math.Long.ONE:d.math.Long.NEG_ONE;var i=this.subtract(e.multiply(n)),r=n.add(i.div(e));return r}if(e.equals(d.math.Long.MIN_VALUE))return d.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(var o=d.math.Long.ZERO,i=this;i.greaterThanOrEqual(e);){for(var n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:Math.pow(2,s-48),l=d.math.Long.fromNumber(n),u=l.multiply(e);u.isNegative()||u.greaterThan(i);)n-=a,l=d.math.Long.fromNumber(n),u=l.multiply(e);l.isZero()&&(l=d.math.Long.ONE),o=o.add(l),i=i.subtract(u)}return o},d.math.Long.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},d.math.Long.prototype.not=function(){return d.math.Long.fromBits(~this.low_,~this.high_)},d.math.Long.prototype.and=function(e){return d.math.Long.fromBits(this.low_&e.low_,this.high_&e.high_)},d.math.Long.prototype.or=function(e){return d.math.Long.fromBits(this.low_|e.low_,this.high_|e.high_)},d.math.Long.prototype.xor=function(e){return d.math.Long.fromBits(this.low_^e.low_,this.high_^e.high_)},d.math.Long.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var t=this.low_;if(e<32){var n=this.high_;return d.math.Long.fromBits(t<<e,n<<e|t>>>32-e)}return d.math.Long.fromBits(0,t<<e-32)},d.math.Long.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var t=this.high_;if(e<32){var n=this.low_;return d.math.Long.fromBits(n>>>e|t<<32-e,t>>e)}return d.math.Long.fromBits(t>>e-32,t>=0?0:-1)},d.math.Long.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var t=this.high_;if(e<32){var n=this.low_;return d.math.Long.fromBits(n>>>e|t<<32-e,t>>>e)}return 32==e?d.math.Long.fromBits(t,0):d.math.Long.fromBits(t>>>e-32,0)},"undefined"==typeof b)var b={};"undefined"==typeof b.Math&&(b.Math={}),b.Math.to64BitNumber=function(e,t){var n,i,r;return n=new d.math.Long(0,t),i=new d.math.Long(e,0),r=n.add(i),r.toNumber()},function(e){u=e()}(function(){"use strict";function e(e){var t=Function.call;return function(){return t.apply(e,arguments)}}function n(e){return"[object StopIteration]"===ae(e)||e instanceof J}function i(e,t){t.stack&&"object"==typeof e&&null!==e&&e.stack&&e.stack.indexOf(le)===-1&&(e.stack=r(e.stack)+"\n"+le+"\n"+r(t.stack))}function r(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;++i){var r=t[i];s(r)||o(r)||n.push(r)}return n.join("\n")}function o(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function s(e){var t=/at .+ \((.*):(\d+):\d+\)/.exec(e);if(!t)return!1;var n=t[1],i=t[2];return n===X&&i>=Q&&i<=he}function a(){if(Error.captureStackTrace){var e,t,n=Error.prepareStackTrace;return Error.prepareStackTrace=function(n,i){e=i[1].getFileName(),t=i[1].getLineNumber()},(new Error).stack,Error.prepareStackTrace=n,X=e,t}}function l(e){return b(e)}function u(){function e(e){n&&(t=b(e),te(n,function(e,n){$(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,i=void 0)}var t,n=[],i=[],r=re(u.prototype),o=re(c.prototype);return o.promiseDispatch=function(e,r,o){var s=ee(arguments);n?(n.push(s),"when"===r&&o[1]&&i.push(o[1])):$(function(){t.promiseDispatch.apply(t,s)})},o.valueOf=function(){return n?o:t=h(t)},Error.captureStackTrace&&l.longStackJumpLimit>0&&(Error.captureStackTrace(o,u),o.stack=o.stack.substring(o.stack.indexOf("\n")+1)),r.promise=o,r.resolve=e,r.fulfill=function(t){e(_(t))},r.reject=function(t){e(v(t))},r.notify=function(e){n&&te(i,function(t,n){$(function(){n(e)})},void 0)},r}function d(e){var t=u();return A(e,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function c(e,t,n,i,r){void 0===t&&(t=function(e){return v(new Error("Promise does not support operation: "+e))});var o=re(c.prototype);return o.promiseDispatch=function(n,i,r){var s;try{s=e[i]?e[i].apply(o,r):t.call(o,i,r)}catch(a){s=v(a)}n&&n(s)},n&&(o.valueOf=n),r&&(o.exception=i),o}function h(e){return f(e)?e.valueOf():e}function f(e){return e&&"function"==typeof e.promiseDispatch}function p(e){return e&&"function"==typeof e.then}function m(e){return!g(e)&&!y(e)}function g(e){return!p(h(e))}function y(e){return e=h(e),f(e)&&"exception"in e}function v(e){var t=c({when:function(t){if(t){var n=ne(ue,this);n!==-1&&(de.splice(n,1),ue.splice(n,1))}return t?t(e):this}},function(){return v(e)},function(){return this},e,!0);return ue.push(t),de.push(e),t}function _(e){return c({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null==t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return se(e)}},void 0,function(){return e})}function b(e){return f(e)?e:(e=h(e),p(e)?E(e):_(e))}function E(e){var t=u();return $(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function x(e){return c({isDef:function(){}},function(t,n){return I(e,t,n)},function(){return h(e)})}function S(e,t,n,r){function o(e){try{return"function"==typeof t?t(e):e}catch(n){return v(n)}}function s(e){if("function"==typeof n){i(e,h);try{return n(e)}catch(t){return v(t)}}return v(e)}function a(e){return"function"==typeof r?r(e):e}var d=u(),c=!1,h=b(e);return $(function(){h.promiseDispatch(function(e){c||(c=!0,d.resolve(o(e)))},"when",[function(e){c||(c=!0,d.resolve(s(e)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(i){if(n=!0,!l.onerror)throw i;l.onerror(i)}n||d.notify(t)}]),d.promise}function T(e,t,n){return S(e,function(e){return F(e).then(function(e){return t.apply(void 0,e)},n)},n)}function w(e){return function(){function t(e,t){var s;try{s=i[e](t)}catch(a){return n(a)?a.value:v(a)}return S(s,r,o)}var i=e.apply(this,arguments),r=t.bind(t,"send"),o=t.bind(t,"throw");return r()}}function D(e){throw new J(e)}function M(e){return function(){return T([this,F(arguments)],function(t,n){return e.apply(t,n)})}}function I(e,t,n){var i=u();return $(function(){b(e).promiseDispatch(i.resolve,t,n)}),i.promise}function L(e){return function(t){var n=ee(arguments,1);return I(t,e,n)}}function C(e,t){var n=ee(arguments,2);return ce(e,t,n)}function R(e,t){return I(e,"apply",[void 0,t])}function A(e){var t=ee(arguments,1);return R(e,t)}function P(e){var t=ee(arguments,1);return function(){var n=t.concat(ee(arguments));return I(e,"apply",[this,n])}}function F(e){return S(e,function(e){var t=e.length;if(0===t)return b(e);var n=u();return te(e,function(i,r,o){g(r)?(e[o]=h(r),0===--t&&n.resolve(e)):S(r,function(i){e[o]=i,0===--t&&n.resolve(e)}).fail(n.reject)},void 0),n.promise})}function N(e){return S(e,function(e){return e=ie(e,b),S(F(ie(e,function(e){return S(e,Z,Z)})),function(){return e})})}function B(e,t){return S(e,void 0,t)}function k(e,t){return S(e,void 0,void 0,t)}function O(e,t){return S(e,function(e){return S(t(),function(){return e})},function(e){return S(t(),function(){return v(e)})})}function U(e,n,r,o){var s=function(t){$(function(){if(i(t,e),!l.onerror)throw t;l.onerror(t)})},a=n||r||o?S(e,n,r,o):e;"object"==typeof t&&t&&t.domain&&(s=t.domain.bind(s)),B(a,s)}function H(e,t){var n=u(),i=setTimeout(function(){n.reject(new Error("Timed out after "+t+" ms"))},t);return S(e,function(e){clearTimeout(i),n.resolve(e)},function(e){clearTimeout(i),n.reject(e)}),n.promise}function V(e,t){void 0===t&&(t=e,e=void 0);var n=u();return setTimeout(function(){n.resolve(e)},t),n.promise}function j(e,t){var n=ee(t),i=u();return n.push(i.makeNodeResolver()),R(e,n).fail(i.reject),i.promise}function q(e){var t=ee(arguments,1),n=u();return t.push(n.makeNodeResolver()),R(e,t).fail(n.reject),n.promise}function z(e){var t=ee(arguments,1);return function(){var n=t.concat(ee(arguments)),i=u();return n.push(i.makeNodeResolver()),R(e,n).fail(i.reject),i.promise}}function Y(e){var t=ee(arguments,1);return function(){function n(){return e.apply(o,arguments)}var i=t.concat(ee(arguments)),r=u();i.push(r.makeNodeResolver());var o=this;return R(n,i).fail(r.reject),r.promise}}function K(e,t,n){var i=ee(n||[]),r=u();return i.push(r.makeNodeResolver()),ce(e,t,i).fail(r.reject),r.promise}function W(e,t){var n=ee(arguments,2),i=u();return n.push(i.makeNodeResolver()),ce(e,t,n).fail(i.reject),i.promise}function G(e,t){return t?void e.then(function(e){$(function(){t(null,e)})},function(e){$(function(){t(e)})}):e}var X,$,Q=a(),Z=function(){};"undefined"!=typeof t?$=t.nextTick:"function"==typeof setImmediate?$="undefined"!=typeof window?setImmediate.bind(window):setImmediate:!function(){function e(){if(--o,++a>=r){a=0,r*=4;for(var e=s&&Math.min(s-1,r);o<e;)++o,t()}for(;s;){--s,n=n.next;var i=n.task;n.task=void 0,i()}a=0}var t,n={task:void 0,next:null},i=n,r=2,o=0,s=0,a=0;if($=function(e){i=i.next={task:e,next:null},o<++s&&o<r&&(++o,t())},"undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=e,t=function(){l.port2.postMessage(0)}}else t=function(){setTimeout(e,0)}}();var J,ee=e(Array.prototype.slice),te=e(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;n<i;n++)n in this&&(t=e(t,this[n],n));return t}),ne=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),ie=e(Array.prototype.map||function(e,t){var n=this,i=[];return te(n,function(r,o,s){i.push(e.call(t,o,s,n))},void 0),i}),re=Object.create||function(e){function t(){}return t.prototype=e,new t},oe=e(Object.prototype.hasOwnProperty),se=Object.keys||function(e){var t=[];for(var n in e)oe(e,n)&&t.push(n);return t},ae=e(Object.prototype.toString);J="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e},l.longStackJumpLimit=1;var le="From previous event:";l.nextTick=$,l.defer=u,u.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(ee(arguments,1)):e.resolve(n)}},l.promise=d,l.makePromise=c,c.prototype.then=function(e,t,n){return S(this,e,t,n)},c.prototype.thenResolve=function(e){return S(this,function(){return e})},te(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","put","set","del","delete","post","send","invoke","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","ncall","napply","nbind","npost","nsend","ninvoke","nodeify"],function(e,t){c.prototype[t]=function(){return l[t].apply(l,[this].concat(ee(arguments)))}},void 0),c.prototype.toSource=function(){return this.toString()},c.prototype.toString=function(){return"[object Promise]"},l.nearer=h,l.isPromise=f,l.isPromiseAlike=p,l.isPending=m,l.isFulfilled=g,l.isRejected=y;var ue=[],de=[];"undefined"!=typeof t&&t.on&&t.on("exit",function(){for(var e=0;e<de.length;e++){var t=de[e];t&&"undefined"!=typeof t.stack?console.warn("Unhandled rejected promise:",t.stack):console.warn("Unhandled rejected promise (no stack):",t)}}),l.reject=v,l.fulfill=_,l.resolve=b,l.master=x,l.when=S,l.spread=T,l.async=w,l["return"]=D,l.promised=M,l.dispatch=I,l.dispatcher=L,l.get=L("get"),l.set=L("set"),l["delete"]=l.del=L("delete");var ce=l.post=L("post");l.send=C,l.invoke=C,l.fapply=R,l["try"]=A,l.fcall=A,l.fbind=P,l.keys=L("keys"),l.all=F,l.allResolved=N,l["catch"]=l.fail=B,l.progress=k,l["finally"]=l.fin=O,l.done=U,l.timeout=H,l.delay=V,l.nfapply=j,l.nfcall=q,l.nfbind=z,l.denodeify=l.nfbind,l.nbind=Y,l.npost=K,l.nsend=W,l.ninvoke=l.nsend,l.nodeify=G;var he=a();return l});var E=function(){var e={boxes:{},fields:{},debug:!1,warningHandler:function(e){}},t={};return e.registerTypeBoxes=function(){t.moov=e.boxes.MovieBox,t.moof=e.boxes.MovieFragmentBox,t.ftyp=e.boxes.FileTypeBox,t.mfhd=e.boxes.MovieFragmentHeaderBox,t.mfra=e.boxes.MovieFragmentRandomAccessBox,t.udta=e.boxes.UserDataBox,t.trak=e.boxes.TrackBox,t.edts=e.boxes.EditBox,t.mdia=e.boxes.MediaBox,t.minf=e.boxes.MediaInformationBox,t.dinf=e.boxes.DataInformationBox,t.stbl=e.boxes.SampleTableBox,t.mvex=e.boxes.MovieExtendsBox,t.traf=e.boxes.TrackFragmentBox,t.meta=e.boxes.MetaBox,t.mvhd=e.boxes.MovieHeaderBox,t.mdat=e.boxes.MediaDataBox,t.free=e.boxes.FreeSpaceBox,t.sidx=e.boxes.SegmentIndexBox,t.tkhd=e.boxes.TrackHeaderBox,t.mdhd=e.boxes.MediaHeaderBox,t.mehd=e.boxes.MovieExtendsHeaderBox,t.hdlr=e.boxes.HandlerBox,t.stts=e.boxes.TimeToSampleBox,t.stsc=e.boxes.SampleToChunkBox,t.stco=e.boxes.ChunkOffsetBox,t.trex=e.boxes.TrackExtendsBox,t.vmhd=e.boxes.VideoMediaHeaderBox,t.smhd=e.boxes.SoundMediaHeaderBox,t.dref=e.boxes.DataReferenceBox,t["url "]=e.boxes.DataEntryUrlBox,t["urn "]=e.boxes.DataEntryUrnBox,t.tfhd=e.boxes.TrackFragmentHeaderBox,t.tfdt=e.boxes.TrackFragmentBaseMediaDecodeTimeBox,t.trun=e.boxes.TrackFragmentRunBox,t.stsd=e.boxes.SampleDescriptionBox,t.sdtp=e.boxes.SampleDependencyTableBox,t.avc1=e.boxes.AVC1VisualSampleEntryBox,t.encv=e.boxes.EncryptedVideoBox,t.avcC=e.boxes.AVCConfigurationBox,t.pasp=e.boxes.PixelAspectRatioBox,t.mp4a=e.boxes.MP4AudioSampleEntryBox,t.enca=e.boxes.EncryptedAudioBox,t.esds=e.boxes.ESDBox,t.stsz=e.boxes.SampleSizeBox,t.pssh=e.boxes.ProtectionSystemSpecificHeaderBox,t.senc=e.boxes.SampleEncryptionBox,t.saiz=e.boxes.SampleAuxiliaryInformationSizesBox,t.saio=e.boxes.SampleAuxiliaryInformationOffsetsBox,t.sinf=e.boxes.ProtectionSchemeInformationBox,t.schi=e.boxes.SchemeInformationBox,t.tenc=e.boxes.TrackEncryptionBox,t.schm=e.boxes.SchemeTypeBox,t.elst=e.boxes.EditListBox,t.hmhd=e.boxes.HintMediaHeaderBox,t.nmhd=e.boxes.NullMediaHeaderBox,t.ctts=e.boxes.CompositionOffsetBox,t.cslg=e.boxes.CompositionToDecodeBox,t.stss=e.boxes.SyncSampleBox,t.tref=e.boxes.TrackReferenceBox,t.frma=e.boxes.OriginalFormatBox,t[JSON.stringify([109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])]=e.boxes.TfxdBox,t[JSON.stringify([212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])]=e.boxes.TfrfBox,t[JSON.stringify([208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])]=e.boxes.PiffProtectionSystemSpecificHeaderBox,t[JSON.stringify([137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])]=e.boxes.PiffTrackEncryptionBox,t[JSON.stringify([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])]=e.boxes.PiffSampleEncryptionBox},e.constructorTypeBox=function(e){var t,n;return t=Object.create(e.prototype),n=Array.prototype.slice.call(arguments,1),e.apply(t,n),t},e.searchBox=function(n,i){var r;return r=i?t[i]:t[n],r||(r=e.boxes.UnknownBox),r},e.createBox=function(t,n,i){return e.constructorTypeBox.apply(null,[e.searchBox(t,i),n])},e.deserialize=function(t){var n=new e.boxes.File;try{n.read(t)}catch(i){return e.warningHandler(i.message),null}return n},e.serialize=function(e){var t=e.getLength(),n=new Uint8Array(t);return e.write(n),n},e.ParseException=function(e){this.message=e,this.name="ParseException"},e.DataIntegrityException=function(e){this.message=e,this.name="DataIntegrityException"},e}();"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=E:window.mp4lib=E,E.fields.readBytes=function(e,t,n){var i=0,r=0;for(r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},E.fields.writeBytes=function(e,t,n,i){var r=0;for(r=0;r<n;r++)e[t+n-r-1]=255&i,i>>=8},E.fields.readString=function(e,t,n){var i,r="";for(i=t;i<t+n;i++)r+=String.fromCharCode(e[i]);return r},E.fields.NumberField=function(e,t){this.bits=e,this.signed=t},E.fields.NumberField.prototype.read=function(e,t){return E.fields.readBytes(e,t,this.bits/8)},E.fields.NumberField.prototype.write=function(e,t,n){E.fields.writeBytes(e,t,this.bits/8,n)},E.fields.NumberField.prototype.getLength=function(){return this.bits/8},E.fields.LongNumberField=function(){},E.fields.LongNumberField.prototype.read=function(e,t){var n=E.fields.readBytes(e,t,4),i=E.fields.readBytes(e,t+4,4);return d.math.Long.fromBits(i,n).toNumber()},E.fields.LongNumberField.prototype.write=function(e,t,n){var i=d.math.Long.fromNumber(n),r=i.getLowBits(),o=i.getHighBits();E.fields.writeBytes(e,t,4,o),E.fields.writeBytes(e,t+4,4,r)},E.fields.LongNumberField.prototype.getLength=function(){return 8},E.fields.FixedLenStringField=function(e){this.size=e},E.fields.FixedLenStringField.prototype.read=function(e,t){var n="",i=0;for(i=0;i<this.size;i++)n+=String.fromCharCode(e[t+i]);return n},E.fields.FixedLenStringField.prototype.write=function(e,t,n){var i=0;for(i=0;i<this.size;i++)e[t+i]=n.charCodeAt(i)},E.fields.FixedLenStringField.prototype.getLength=function(){return this.size},E.fields.BoxTypeField=function(){},E.fields.BoxTypeField.prototype.read=function(e,t){var n="",i=0;for(i=0;i<4;i++)n+=String.fromCharCode(e[t+i]);return n},E.fields.BoxTypeField.prototype.write=function(e,t,n){var i=0;for(i=0;i<4;i++)e[t+i]=n.charCodeAt(i)},E.fields.BoxTypeField.prototype.getLength=function(){return 4},E.fields.StringField=function(){},E.fields.StringField.prototype.read=function(e,t,n){var i="",r=0;for(r=t;r<n;r++)if(i+=String.fromCharCode(e[r]),0===e[r])return i;if(n-t<255&&e[0]==String.fromCharCode(n-t))return i=i.substr(1,n-t),E.warningHandler('null-terminated string expected, but found a string "'+i+'", which seems to be length-prefixed instead. Conversion done.'),i;throw new E.ParseException('expected null-terminated string, but end of field reached without termination. Read so far:"'+i+'"')},E.fields.StringField.prototype.write=function(e,t,n){var i=0;for(i=0;i<n.length;i++)e[t+i]=n.charCodeAt(i);e[t+n.length]=0},E.fields.StringField.prototype.getLength=function(e){return e.length},E.fields.ArrayField=function(e,t){this.innerField=e,this.size=t},E.fields.ArrayField.prototype.read=function(e,t){var n=-1,i=[],r=0;for(r=0;r<this.size;r++)i.push(this.innerField.read(e,t)),n==-1&&(n=this.innerField.getLength(i[r])),t+=n;return i},E.fields.FIELD_INT8=new E.fields.NumberField(8,(!0)),E.fields.FIELD_INT16=new E.fields.NumberField(16,(!0)),E.fields.FIELD_INT32=new E.fields.NumberField(32,(!0)),E.fields.FIELD_INT64=new E.fields.LongNumberField,E.fields.FIELD_UINT8=new E.fields.NumberField(8,(!1)),E.fields.FIELD_UINT16=new E.fields.NumberField(16,(!1)),E.fields.FIELD_UINT32=new E.fields.NumberField(32,(!1)),E.fields.FIELD_UINT64=new E.fields.LongNumberField,E.fields.FIELD_BIT8=new E.fields.NumberField(8,(!1)),E.fields.FIELD_BIT16=new E.fields.NumberField(16,(!1)),E.fields.FIELD_BIT24=new E.fields.NumberField(24,(!1)),E.fields.FIELD_BIT32=new E.fields.NumberField(32,(!1)),E.fields.FIELD_ID=new E.fields.BoxTypeField(4),E.fields.FIELD_STRING=new E.fields.StringField,E.boxes.File=function(){this.boxes=[]},E.boxes.File.prototype.getBoxByType=function(e){var t=0;for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},E.boxes.File.prototype.getLength=function(){var e=0,t=0;for(t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),e+=this.boxes[t].size;return e},E.boxes.File.prototype.write=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++)t=this.boxes[n].write(e,t)},E.boxes.File.prototype.read=function(e){for(var t,n=0,i=null,r=0,o=null,s=0,a=e.length;s<a;)if(n=E.fields.FIELD_UINT32.read(e,s),
i=E.fields.readString(e,s+4,4),"uuid"==i&&(r=1==n?16:8,o=new E.fields.ArrayField(E.fields.FIELD_INT8,16).read(e,s+r,s+r+16),o=JSON.stringify(o)),t=E.createBox(i,n,o),"uuid"===i?(s=t.read(e,s+16*E.fields.FIELD_INT8.getLength()+8,s+n),o=null):s=t.read(e,s+8,s+n),E.debug&&(t.__sourceBuffer=e.subarray(s-t.size,s)),t.boxtype&&this.boxes.push(t),t.size<=0||null===t.size)throw new E.ParseException("Problem on size of box "+t.boxtype+", parsing stopped to avoid infinite loop")},E.boxes.File.prototype.getBoxOffsetByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return-1},E.boxes.File.prototype.getBoxIndexByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return-1},E.boxes.Box=function(e,t,n,i){this.size=t||null,this.boxtype=e,1===this.size&&i&&(this.largesize=i),n&&(this.extended_type=n),this.localPos=0,this.localEnd=0},E.boxes.Box.prototype.write=function(e,t){this.localPos=t;var n=0;if(this._writeData(e,E.fields.FIELD_UINT32,this.size),this.extended_type?this._writeData(e,E.fields.FIELD_ID,"uuid"):this._writeData(e,E.fields.FIELD_ID,this.boxtype),1===this.size&&this._writeData(e,E.fields.FIELD_INT64,this.largesize),this.extended_type)for(n=0;n<16;n++)this._writeData(e,E.fields.FIELD_INT8,this.extended_type[n])},E.boxes.Box.prototype.getBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},E.boxes.Box.prototype.getBoxesByType=function(e){var t=[],n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++)this.boxes[n].boxtype===e&&t.push(this.boxes[n]);return t},E.boxes.Box.prototype.removeBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)this.boxes[t].boxtype===e&&this.boxes.splice(t,1);else E.warningHandler(""+this.boxtype+"does not have "+e+" box, impossible to remove it")},E.boxes.Box.prototype.getBoxOffsetByType=function(e){var t=8,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return null},E.boxes.Box.prototype.getBoxIndexByType=function(e){var t=0,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return null},E.boxes.Box.prototype.computeLength=function(){this.size=E.fields.FIELD_UINT32.getLength()+E.fields.FIELD_ID.getLength(),this.extended_type&&(this.size+=16*E.fields.FIELD_INT8.getLength())},E.boxes.Box.prototype._readData=function(e,t){var n=t.read(e,this.localPos,this.localEnd);return this.localPos+=t.getLength(n),n},E.boxes.Box.prototype._writeData=function(e,t,n){if(void 0===n||null===n)throw new E.ParseException("a field to write is null or undefined for box : "+this.boxtype);t.write(e,this.localPos,n),this.localPos+=t.getLength(n)},E.boxes.Box.prototype._writeBuffer=function(e,t,n){e.set(t,this.localPos),this.localPos+=n},E.boxes.Box.prototype._writeArrayData=function(e,t,n){var i=0;if(void 0===n||null===n||0===n.length)throw new E.ParseException("an array to write is null, undefined or length = 0 for box : "+this.boxtype);for(i=0;i<n.length;i++)this._writeData(e,t,n[i])},E.boxes.Box.prototype._readArrayData=function(e,t){var n=[],i=t.getLength(),r=(this.localEnd-this.localPos)/i,o=0;for(o=0;o<r;o++)n.push(t.read(e,this.localPos)),this.localPos+=i;return n},E.boxes.Box.prototype._readArrayFieldData=function(e,t,n){var i=-1,r=[],o=0;for(o=0;o<n;o++)r.push(t.read(e,this.localPos)),i===-1&&(i=t.getLength(r[o])),this.localPos+=i;return r},E.boxes.ContainerBox=function(e,t){E.boxes.Box.call(this,e,t),this.boxes=[]},E.boxes.ContainerBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.ContainerBox.prototype.constructor=E.boxes.ContainerBox,E.boxes.ContainerBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},E.boxes.ContainerBox.prototype.write=function(e,t){E.boxes.Box.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},E.boxes.ContainerBox.prototype.read=function(e,t,n){for(var i,r,o=0,s=0,a=null;t<n;)if(o=E.fields.FIELD_UINT32.read(e,t),i=E.fields.readString(e,t+4,4),"uuid"===i&&(s=1==o?16:8,a=new E.fields.ArrayField(E.fields.FIELD_INT8,16).read(e,t+s,t+s+16),a=JSON.stringify(a)),r=E.createBox(i,o,a),"uuid"===i?(t=r.read(e,t+16*E.fields.FIELD_INT8.getLength()+8,t+o),a=null):t=r.read(e,t+8,t+o),E.debug&&(r.__sourceBuffer=e.subarray(t-r.size,t)),r.boxtype&&this.boxes.push(r),r.size<=0||null===r.size)throw new E.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");return t},E.boxes.FullBox=function(e,t,n){E.boxes.Box.call(this,e,t,n),this.version=null,this.flags=null},E.boxes.FullBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.FullBox.prototype.constructor=E.boxes.FullBox,E.boxes.FullBox.prototype.read=function(e,t,n){this.localPos=t,this.localEnd=n,this.version=this._readData(e,E.fields.FIELD_INT8),this.flags=this._readData(e,E.fields.FIELD_BIT24)},E.boxes.FullBox.prototype.write=function(e,t){E.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT8,this.version),this._writeData(e,E.fields.FIELD_BIT24,this.flags)},E.boxes.FullBox.prototype.getFullBoxAttributesLength=function(){this.size+=E.fields.FIELD_INT8.getLength()+E.fields.FIELD_BIT24.getLength()},E.boxes.FullBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),E.boxes.FullBox.prototype.getFullBoxAttributesLength.call(this)},E.boxes.ContainerFullBox=function(e,t){E.boxes.FullBox.call(this,e,t),this.boxes=[]},E.boxes.ContainerFullBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.ContainerFullBox.prototype.constructor=E.boxes.ContainerFullBox,E.boxes.ContainerFullBox.prototype.computeLength=function(e){E.boxes.FullBox.prototype.computeLength.call(this);var t=0;for(e&&(this.size+=E.fields.FIELD_UINT32.getLength()),t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),this.size+=this.boxes[t].size},E.boxes.ContainerFullBox.prototype.read=function(e,t,n,i){E.boxes.FullBox.prototype.read.call(this,e,t,n);var r,o,s=0,a=0,l=null;for(i&&(this.entry_count=this._readData(e,E.fields.FIELD_UINT32));this.localPos<this.localEnd;)if(s=E.fields.FIELD_UINT32.read(e,this.localPos),r=E.fields.readString(e,this.localPos+4,4),"uuid"==r&&(a=1==s?16:8,l=new E.fields.ArrayField(E.fields.FIELD_INT8,16).read(e,this.localPos+a,this.localPos+a+16),l=JSON.stringify(l)),o=E.createBox(r,s,l),"uuid"===r?(this.localPos=o.read(e,this.localPos+16*E.fields.FIELD_INT8.getLength()+8,this.localPos+s),l=null):this.localPos=o.read(e,this.localPos+8,this.localPos+s),E.debug&&(o.__sourceBuffer=e.subarray(this.localPos-o.size,this.localPos)),o.boxtype&&this.boxes.push(o),o.size<=0||null===o.size)throw new E.ParseException("Problem on size of box "+o.boxtype+", parsing stopped to avoid infinite loop");return this.localPos},E.boxes.ContainerFullBox.prototype.write=function(e,t,n){E.boxes.FullBox.prototype.write.call(this,e,t);var i=0;for(n===!0&&this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),i=0;i<this.boxes.length;i++)this.localPos=this.boxes[i].write(e,this.localPos);return this.localPos},E.boxes.UnknownBox=function(e){E.boxes.Box.call(this,null,e)},E.boxes.UnknownBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.UnknownBox.prototype.constructor=E.boxes.UnknownBox,E.boxes.UnknownBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.unrecognized_data=e.subarray(this.localPos,this.localEnd),this.localEnd},E.boxes.UnknownBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.unrecognized_data,this.unrecognized_data.length),this.localPos},E.boxes.UnknownBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=this.unrecognized_data.length},E.boxes.FileTypeBox=function(e){E.boxes.Box.call(this,"ftyp",e)},E.boxes.FileTypeBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.FileTypeBox.prototype.constructor=E.boxes.FileTypeBox,E.boxes.FileTypeBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_INT32.getLength()+E.fields.FIELD_INT32.getLength()*this.compatible_brands.length},E.boxes.FileTypeBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.major_brand=this._readData(e,E.fields.FIELD_INT32),this.minor_brand=this._readData(e,E.fields.FIELD_INT32),this.compatible_brands=this._readArrayData(e,E.fields.FIELD_INT32),this.localPos},E.boxes.FileTypeBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT32,this.major_brand),this._writeData(e,E.fields.FIELD_INT32,this.minor_brand),this._writeArrayData(e,E.fields.FIELD_INT32,this.compatible_brands),this.localPos},E.boxes.MovieBox=function(e){E.boxes.ContainerBox.call(this,"moov",e)},E.boxes.MovieBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MovieBox.prototype.constructor=E.boxes.MovieBox,E.boxes.MovieFragmentBox=function(e){E.boxes.ContainerBox.call(this,"moof",e)},E.boxes.MovieFragmentBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MovieFragmentBox.prototype.constructor=E.boxes.MovieFragmentBox,E.boxes.MovieFragmentRandomAccessBox=function(e){E.boxes.ContainerBox.call(this,"mfra",e)},E.boxes.MovieFragmentRandomAccessBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MovieFragmentRandomAccessBox.prototype.constructor=E.boxes.MovieFragmentRandomAccessBox,E.boxes.UserDataBox=function(e){E.boxes.ContainerBox.call(this,"udta",e)},E.boxes.UserDataBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.UserDataBox.prototype.constructor=E.boxes.UserDataBox,E.boxes.TrackBox=function(e){E.boxes.ContainerBox.call(this,"trak",e)},E.boxes.TrackBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.TrackBox.prototype.constructor=E.boxes.TrackBox,E.boxes.EditBox=function(e){E.boxes.ContainerBox.call(this,"edts",e)},E.boxes.EditBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.EditBox.prototype.constructor=E.boxes.EditBox,E.boxes.MediaBox=function(e){E.boxes.ContainerBox.call(this,"mdia",e)},E.boxes.MediaBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MediaBox.prototype.constructor=E.boxes.MediaBox,E.boxes.MediaInformationBox=function(e){E.boxes.ContainerBox.call(this,"minf",e)},E.boxes.MediaInformationBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MediaInformationBox.prototype.constructor=E.boxes.MediaInformationBox,E.boxes.DataInformationBox=function(e){E.boxes.ContainerBox.call(this,"dinf",e)},E.boxes.DataInformationBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.DataInformationBox.prototype.constructor=E.boxes.DataInformationBox,E.boxes.SampleTableBox=function(e){E.boxes.ContainerBox.call(this,"stbl",e)},E.boxes.SampleTableBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.SampleTableBox.prototype.constructor=E.boxes.SampleTableBox,E.boxes.MovieExtendsBox=function(e){E.boxes.ContainerBox.call(this,"mvex",e)},E.boxes.MovieExtendsBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.MovieExtendsBox.prototype.constructor=E.boxes.MovieExtendsBox,E.boxes.TrackFragmentBox=function(e){E.boxes.ContainerBox.call(this,"traf",e)},E.boxes.TrackFragmentBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.TrackFragmentBox.prototype.constructor=E.boxes.TrackFragmentBox,E.boxes.MetaBox=function(e){E.boxes.ContainerFullBox.call(this,"meta",e)},E.boxes.MetaBox.prototype=Object.create(E.boxes.ContainerFullBox.prototype),E.boxes.MetaBox.prototype.constructor=E.boxes.MetaBox,E.boxes.MetaBox.prototype.computeLength=function(){E.boxes.ContainerFullBox.prototype.computeLength.call(this,!1)},E.boxes.MetaBox.prototype.read=function(e,t,n){return E.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!1)},E.boxes.MetaBox.prototype.write=function(e,t){return E.boxes.ContainerFullBox.prototype.write.call(this,e,t,!1)},E.boxes.MovieHeaderBox=function(e){E.boxes.FullBox.call(this,"mvhd",e)},E.boxes.MovieHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.MovieHeaderBox.prototype.constructor=E.boxes.MovieHeaderBox,E.boxes.MovieHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_INT32.getLength()+2*E.fields.FIELD_INT16.getLength(),this.size+=2*E.fields.FIELD_INT32.getLength()+9*E.fields.FIELD_INT32.getLength(),this.size+=6*E.fields.FIELD_BIT32.getLength()+E.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=3*E.fields.FIELD_UINT64.getLength()+E.fields.FIELD_UINT32.getLength():this.size+=4*E.fields.FIELD_UINT32.getLength()},E.boxes.MovieHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.creation_time),this._writeData(e,E.fields.FIELD_UINT64,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.timescale),this._writeData(e,E.fields.FIELD_UINT64,this.duration)):(this._writeData(e,E.fields.FIELD_UINT32,this.creation_time),this._writeData(e,E.fields.FIELD_UINT32,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.timescale),this._writeData(e,E.fields.FIELD_UINT32,this.duration)),this._writeData(e,E.fields.FIELD_INT32,this.rate),this._writeData(e,E.fields.FIELD_INT16,this.volume),this._writeData(e,E.fields.FIELD_INT16,this.reserved),this._writeArrayData(e,E.fields.FIELD_INT32,this.reserved_2),this._writeArrayData(e,E.fields.FIELD_INT32,this.matrix),this._writeArrayData(e,E.fields.FIELD_BIT32,this.pre_defined),this._writeData(e,E.fields.FIELD_UINT32,this.next_track_ID),this.localPos},E.boxes.MovieHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1==this.version?(this.creation_time=this._readData(e,E.fields.FIELD_UINT64),this.modification_time=this._readData(e,E.fields.FIELD_UINT64),this.timescale=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,E.fields.FIELD_UINT32),this.modification_time=this._readData(e,E.fields.FIELD_UINT32),this.timescale=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT32)),this.rate=this._readData(e,E.fields.FIELD_INT32),this.volume=this._readData(e,E.fields.FIELD_INT16),this.reserved=this._readData(e,E.fields.FIELD_INT16),this.reserved_2=this._readArrayFieldData(e,E.fields.FIELD_INT32,2),this.matrix=this._readArrayFieldData(e,E.fields.FIELD_INT32,9),this.pre_defined=this._readArrayFieldData(e,E.fields.FIELD_BIT32,6),this.next_track_ID=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.MediaDataBox=function(e){E.boxes.Box.call(this,"mdat",e)},E.boxes.MediaDataBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.MediaDataBox.prototype.constructor=E.boxes.MediaDataBox,E.boxes.MediaDataBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},E.boxes.MediaDataBox.prototype.read=function(e,t,n){return this.data=e.subarray(t,n),n},E.boxes.MediaDataBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},E.boxes.FreeSpaceBox=function(e){E.boxes.Box.call(this,"free",e)},E.boxes.FreeSpaceBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.FreeSpaceBox.prototype.constructor=E.boxes.FreeSpaceBox,E.boxes.FreeSpaceBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},E.boxes.FreeSpaceBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data=e.subarray(this.localPos,this.localEnd),this.localEnd},E.boxes.FreeSpaceBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},E.boxes.SegmentIndexBox=function(e){E.boxes.FullBox.call(this,"sidx",e)},E.boxes.SegmentIndexBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SegmentIndexBox.prototype.constructor=E.boxes.SegmentIndexBox,E.boxes.SegmentIndexBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=2*E.fields.FIELD_UINT64.getLength():this.size+=2*E.fields.FIELD_UINT32.getLength(),this.size+=E.fields.FIELD_UINT16.getLength(),this.size+=E.fields.FIELD_UINT16.getLength(),this.size+=(E.fields.FIELD_UINT64.getLength()+E.fields.FIELD_UINT32.getLength())*this.reference_count},E.boxes.SegmentIndexBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.reference_ID=this._readData(e,E.fields.FIELD_UINT32),this.timescale=this._readData(e,E.fields.FIELD_UINT32),1===this.version?(this.earliest_presentation_time=this._readData(e,E.fields.FIELD_UINT64),this.first_offset=this._readData(e,E.fields.FIELD_UINT64)):(this.earliest_presentation_time=this._readData(e,E.fields.FIELD_UINT32),this.first_offset=this._readData(e,E.fields.FIELD_UINT32)),this.reserved=this._readData(e,E.fields.FIELD_UINT16),this.reference_count=this._readData(e,E.fields.FIELD_UINT16),this.references=[],i=0;i<this.reference_count;i++)r={},r.reference_info=this._readData(e,E.fields.FIELD_UINT64),r.SAP=this._readData(e,E.fields.FIELD_UINT32),this.references.push(r);return this.localPos},E.boxes.SegmentIndexBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.reference_ID),this._writeData(e,E.fields.FIELD_UINT32,this.timescale),1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.earliest_presentation_time),this._writeData(e,E.fields.FIELD_UINT64,this.first_offset)):(this._writeData(e,E.fields.FIELD_UINT32,this.earliest_presentation_time),this._writeData(e,E.fields.FIELD_UINT32,this.first_offset)),this._writeData(e,E.fields.FIELD_UINT16,this.reserved),this._writeData(e,E.fields.FIELD_UINT16,this.reference_count),n=0;n<this.reference_count;n++)this._writeData(e,E.fields.FIELD_UINT64,this.references[n].reference_info),this._writeData(e,E.fields.FIELD_UINT32,this.references[n].SAP);return this.localPos},E.boxes.TrackHeaderBox=function(e){E.boxes.FullBox.call(this,"tkhd",e)},E.boxes.TrackHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackHeaderBox.prototype.constructor=E.boxes.TrackHeaderBox,E.boxes.TrackHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=4*E.fields.FIELD_INT16.getLength()+2*E.fields.FIELD_INT32.getLength()+2*E.fields.FIELD_UINT32.getLength()+9*E.fields.FIELD_INT32.getLength(),1==this.version?this.size+=3*E.fields.FIELD_UINT64.getLength()+2*E.fields.FIELD_UINT32.getLength():this.size+=5*E.fields.FIELD_UINT32.getLength()},E.boxes.TrackHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,E.fields.FIELD_UINT64),this.modification_time=this._readData(e,E.fields.FIELD_UINT64),this.track_id=this._readData(e,E.fields.FIELD_UINT32),this.reserved=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,E.fields.FIELD_UINT32),this.modification_time=this._readData(e,E.fields.FIELD_UINT32),this.track_id=this._readData(e,E.fields.FIELD_UINT32),this.reserved=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT32)),this.reserved_2=this._readArrayFieldData(e,E.fields.FIELD_UINT32,2),this.layer=this._readData(e,E.fields.FIELD_INT16),this.alternate_group=this._readData(e,E.fields.FIELD_INT16),this.volume=this._readData(e,E.fields.FIELD_INT16),this.reserved_3=this._readData(e,E.fields.FIELD_INT16),this.matrix=this._readArrayFieldData(e,E.fields.FIELD_INT32,9),this.width=this._readData(e,E.fields.FIELD_INT32),this.height=this._readData(e,E.fields.FIELD_INT32),this.localPos},E.boxes.TrackHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.creation_time),this._writeData(e,E.fields.FIELD_UINT64,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.track_id),this._writeData(e,E.fields.FIELD_UINT32,this.reserved),this._writeData(e,E.fields.FIELD_UINT64,this.duration)):(this._writeData(e,E.fields.FIELD_UINT32,this.creation_time),this._writeData(e,E.fields.FIELD_UINT32,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.track_id),this._writeData(e,E.fields.FIELD_UINT32,this.reserved),this._writeData(e,E.fields.FIELD_UINT32,this.duration)),this._writeArrayData(e,E.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,E.fields.FIELD_INT16,this.layer),this._writeData(e,E.fields.FIELD_INT16,this.alternate_group),this._writeData(e,E.fields.FIELD_INT16,this.volume),this._writeData(e,E.fields.FIELD_INT16,this.reserved_3),this._writeArrayData(e,E.fields.FIELD_INT32,this.matrix),this._writeData(e,E.fields.FIELD_INT32,this.width),this._writeData(e,E.fields.FIELD_INT32,this.height),this.localPos},E.boxes.MediaHeaderBox=function(e){E.boxes.FullBox.call(this,"mdhd",e)},E.boxes.MediaHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.MediaHeaderBox.prototype.constructor=E.boxes.MediaHeaderBox,E.boxes.MediaHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT16.getLength(),1==this.version?this.size+=3*E.fields.FIELD_UINT64.getLength()+E.fields.FIELD_UINT32.getLength():this.size+=4*E.fields.FIELD_UINT32.getLength()},E.boxes.MediaHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,E.fields.FIELD_UINT64),this.modification_time=this._readData(e,E.fields.FIELD_UINT64),this.timescale=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,E.fields.FIELD_UINT32),this.modification_time=this._readData(e,E.fields.FIELD_UINT32),this.timescale=this._readData(e,E.fields.FIELD_UINT32),this.duration=this._readData(e,E.fields.FIELD_UINT32)),this.language=this._readData(e,E.fields.FIELD_UINT16),this.pre_defined=this._readData(e,E.fields.FIELD_UINT16),this.localPos},E.boxes.MediaHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.creation_time),this._writeData(e,E.fields.FIELD_UINT64,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.timescale),this._writeData(e,E.fields.FIELD_UINT64,this.duration)):(this._writeData(e,E.fields.FIELD_UINT32,this.creation_time),this._writeData(e,E.fields.FIELD_UINT32,this.modification_time),this._writeData(e,E.fields.FIELD_UINT32,this.timescale),this._writeData(e,E.fields.FIELD_UINT32,this.duration)),this._writeData(e,E.fields.FIELD_UINT16,this.language),this._writeData(e,E.fields.FIELD_UINT16,this.pre_defined),this.localPos},E.boxes.MovieExtendsHeaderBox=function(e){E.boxes.FullBox.call(this,"mehd",e)},E.boxes.MovieExtendsHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.MovieExtendsHeaderBox.prototype.constructor=E.boxes.MovieExtendsHeaderBox,E.boxes.MovieExtendsHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),1==this.version?this.size+=E.fields.FIELD_UINT64.getLength():this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.MovieExtendsHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.fragment_duration=this._readData(e,E.fields.FIELD_UINT64):this.fragment_duration=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.MovieExtendsHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,E.fields.FIELD_UINT64,this.fragment_duration):this._writeData(e,E.fields.FIELD_UINT32,this.fragment_duration),this.localPos},E.boxes.HandlerBox=function(e){E.boxes.FullBox.call(this,"hdlr",e)},E.boxes.HandlerBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.HandlerBox.prototype.constructor=E.boxes.HandlerBox,E.boxes.HandlerBox.prototype.HANDLERTYPEVIDEO="vide",E.boxes.HandlerBox.prototype.HANDLERTYPEAUDIO="soun",E.boxes.HandlerBox.prototype.HANDLERTYPETEXT="meta",E.boxes.HandlerBox.prototype.HANDLERVIDEONAME="Video Track",E.boxes.HandlerBox.prototype.HANDLERAUDIONAME="Audio Track",E.boxes.HandlerBox.prototype.HANDLERTEXTNAME="Text Track",E.boxes.HandlerBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT32.getLength()+3*E.fields.FIELD_UINT32.getLength()+E.fields.FIELD_STRING.getLength(this.name)},E.boxes.HandlerBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,E.fields.FIELD_UINT32),this.handler_type=this._readData(e,E.fields.FIELD_UINT32),this.reserved=this._readArrayFieldData(e,E.fields.FIELD_UINT32,3),this.name=this._readData(e,E.fields.FIELD_STRING),this.localPos},E.boxes.HandlerBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.pre_defined),this._writeData(e,E.fields.FIELD_UINT32,this.handler_type),this._writeArrayData(e,E.fields.FIELD_UINT32,this.reserved),this._writeData(e,E.fields.FIELD_STRING,this.name),this.localPos},E.boxes.TimeToSampleBox=function(e){E.boxes.FullBox.call(this,"stts",e)},E.boxes.TimeToSampleBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TimeToSampleBox.prototype.constructor=E.boxes.TimeToSampleBox,E.boxes.TimeToSampleBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(2*E.fields.FIELD_UINT32.getLength())},E.boxes.TimeToSampleBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,E.fields.FIELD_UINT32),this.entry=[],i=0;i<this.entry_count;i++)r={},r.sample_count=this._readData(e,E.fields.FIELD_UINT32),r.sample_delta=this._readData(e,E.fields.FIELD_UINT32),this.entry.push(r);return this.localPos},E.boxes.TimeToSampleBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].sample_count),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].sample_delta);return this.localPos},E.boxes.SampleToChunkBox=function(e){E.boxes.FullBox.call(this,"stsc",e)},E.boxes.SampleToChunkBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleToChunkBox.prototype.constructor=E.boxes.SampleToChunkBox,E.boxes.SampleToChunkBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(3*E.fields.FIELD_UINT32.getLength())},E.boxes.SampleToChunkBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,E.fields.FIELD_UINT32),this.entry=[],i=0;i<this.entry_count;i++)r={},r.first_chunk=this._readData(e,E.fields.FIELD_UINT32),r.samples_per_chunk=this._readData(e,E.fields.FIELD_UINT32),r.samples_description_index=this._readData(e,E.fields.FIELD_UINT32),this.entry.push(r);return this.localPos},E.boxes.SampleToChunkBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].first_chunk),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].samples_per_chunk),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].samples_description_index);return this.localPos},E.boxes.ChunkOffsetBox=function(e){E.boxes.FullBox.call(this,"stco",e)},E.boxes.ChunkOffsetBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.ChunkOffsetBox.prototype.constructor=E.boxes.ChunkOffsetBox,E.boxes.ChunkOffsetBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength()+this.entry_count*E.fields.FIELD_UINT32.getLength()},E.boxes.ChunkOffsetBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.entry_count=this._readData(e,E.fields.FIELD_UINT32),this.chunk_offset=this._readArrayFieldData(e,E.fields.FIELD_UINT32,this.entry_count),this.localPos},E.boxes.ChunkOffsetBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.chunk_offset[n]);return this.localPos},E.boxes.TrackExtendsBox=function(e){E.boxes.FullBox.call(this,"trex",e)},E.boxes.TrackExtendsBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackExtendsBox.prototype.constructor=E.boxes.TrackExtendsBox,E.boxes.TrackExtendsBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*E.fields.FIELD_UINT32.getLength()},E.boxes.TrackExtendsBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,E.fields.FIELD_UINT32),this.default_sample_description_index=this._readData(e,E.fields.FIELD_UINT32),this.default_sample_duration=this._readData(e,E.fields.FIELD_UINT32),this.default_sample_size=this._readData(e,E.fields.FIELD_UINT32),this.default_sample_flags=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.TrackExtendsBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.track_ID),this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_description_index),this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_duration),this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_size),this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},E.boxes.VideoMediaHeaderBox=function(e){E.boxes.FullBox.call(this,"vmhd",e)},E.boxes.VideoMediaHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.VideoMediaHeaderBox.prototype.constructor=E.boxes.VideoMediaHeaderBox,E.boxes.VideoMediaHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_INT16.getLength()+3*E.fields.FIELD_UINT16.getLength()},E.boxes.VideoMediaHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.graphicsmode=this._readData(e,E.fields.FIELD_INT16),this.opcolor=this._readArrayFieldData(e,E.fields.FIELD_UINT16,3),this.localPos},E.boxes.VideoMediaHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT16,this.graphicsmode),this._writeArrayData(e,E.fields.FIELD_UINT16,this.opcolor),this.localPos},E.boxes.SoundMediaHeaderBox=function(e){E.boxes.FullBox.call(this,"smhd",e)},E.boxes.SoundMediaHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SoundMediaHeaderBox.prototype.constructor=E.boxes.SoundMediaHeaderBox,E.boxes.SoundMediaHeaderBox.prototype.computeLength=function(){
E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_INT16.getLength()+E.fields.FIELD_UINT16.getLength()},E.boxes.SoundMediaHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.balance=this._readData(e,E.fields.FIELD_INT16),this.reserved=this._readData(e,E.fields.FIELD_UINT16),this.localPos},E.boxes.SoundMediaHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT16,this.balance),this._writeData(e,E.fields.FIELD_UINT16,this.reserved),this.localPos},E.boxes.DataReferenceBox=function(e){E.boxes.ContainerFullBox.call(this,"dref",e)},E.boxes.DataReferenceBox.prototype=Object.create(E.boxes.ContainerFullBox.prototype),E.boxes.DataReferenceBox.prototype.constructor=E.boxes.DataReferenceBox,E.boxes.DataReferenceBox.prototype.computeLength=function(){E.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},E.boxes.DataReferenceBox.prototype.read=function(e,t,n){return E.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},E.boxes.DataReferenceBox.prototype.write=function(e,t){return this.entry_count||(this.entry_count=this.boxes.length),E.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},E.boxes.DataEntryUrlBox=function(e){E.boxes.FullBox.call(this,"url ",e)},E.boxes.DataEntryUrlBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.DataEntryUrlBox.prototype.constructor=E.boxes.DataEntryUrlBox,E.boxes.DataEntryUrlBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),void 0!==this.location&&(this.size+=E.fields.FIELD_STRING.getLength(this.location))},E.boxes.DataEntryUrlBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.flags&!1&&(this.location=this._readData(e,E.fields.FIELD_STRING)),this.localPos},E.boxes.DataEntryUrlBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),void 0!==this.location&&this._writeData(e,E.fields.FIELD_STRING,this.location),this.localPos},E.boxes.DataEntryUrnBox=function(e){E.boxes.FullBox.call(this,"urn ",e)},E.boxes.DataEntryUrnBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.DataEntryUrnBox.prototype.constructor=E.boxes.DataEntryUrnBox,E.boxes.DataEntryUrnBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.flags&!1&&(this.size+=E.fields.FIELD_STRING.getLength(this.name)+E.fields.FIELD_STRING.getLength(this.location))},E.boxes.DataEntryUrnBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.flags&!1&&(this.name=this._readData(e,E.fields.FIELD_STRING),this.location=this._readData(e,E.fields.FIELD_STRING)),this.localPos},E.boxes.DataEntryUrnBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this.flags&!1&&(this._writeData(e,E.fields.FIELD_STRING,this.name),this._writeData(e,E.fields.FIELD_STRING,this.location)),this.localPos},E.boxes.MovieFragmentHeaderBox=function(e){E.boxes.FullBox.call(this,"mfhd",e)},E.boxes.MovieFragmentHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.MovieFragmentHeaderBox.prototype.constructor=E.boxes.MovieFragmentHeaderBox,E.boxes.MovieFragmentHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.MovieFragmentHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.sequence_number=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.MovieFragmentHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.sequence_number),this.localPos},E.boxes.TrackFragmentHeaderBox=function(e){E.boxes.FullBox.call(this,"tfhd",e)},E.boxes.TrackFragmentHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackFragmentHeaderBox.prototype.constructor=E.boxes.TrackFragmentHeaderBox,E.boxes.TrackFragmentHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),0!==(1&this.flags)&&void 0!==this.base_data_offset&&(this.size+=E.fields.FIELD_UINT64.getLength()),0!==(2&this.flags)&&void 0!==this.sample_description_index&&(this.size+=E.fields.FIELD_UINT32.getLength()),0!==(8&this.flags)&&void 0!==this.default_sample_duration&&(this.size+=E.fields.FIELD_UINT32.getLength()),0!==(16&this.flags)&&void 0!==this.default_sample_size&&(this.size+=E.fields.FIELD_UINT32.getLength()),0!==(32&this.flags)&&void 0!==this.default_sample_flags&&(this.size+=E.fields.FIELD_UINT32.getLength())},E.boxes.TrackFragmentHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,E.fields.FIELD_UINT32),0!==(1&this.flags)&&(this.base_data_offset=this._readData(e,E.fields.FIELD_UINT64)),0!==(2&this.flags)&&(this.sample_description_index=this._readData(e,E.fields.FIELD_UINT32)),0!==(8&this.flags)&&(this.default_sample_duration=this._readData(e,E.fields.FIELD_UINT32)),0!==(16&this.flags)&&(this.default_sample_size=this._readData(e,E.fields.FIELD_UINT32)),0!==(32&this.flags)&&(this.default_sample_flags=this._readData(e,E.fields.FIELD_UINT32)),this.localPos},E.boxes.TrackFragmentHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.track_ID),0!==(1&this.flags)&&this._writeData(e,E.fields.FIELD_UINT64,this.base_data_offset),0!==(2&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.sample_description_index),0!==(8&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_duration),0!==(16&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_size),0!==(32&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},E.boxes.TrackFragmentBaseMediaDecodeTimeBox=function(e){E.boxes.FullBox.call(this,"tfdt",e)},E.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.constructor=E.boxes.TrackFragmentBaseMediaDecodeTimeBox,E.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=E.fields.FIELD_UINT64.getLength():this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.baseMediaDecodeTime=this._readData(e,E.fields.FIELD_UINT64):this.baseMediaDecodeTime=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,E.fields.FIELD_UINT64,this.baseMediaDecodeTime):this._writeData(e,E.fields.FIELD_UINT32,this.baseMediaDecodeTime),this.localPos},E.boxes.TrackFragmentRunBox=function(e){E.boxes.FullBox.call(this,"trun",e)},E.boxes.TrackFragmentRunBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackFragmentRunBox.prototype.constructor=E.boxes.TrackFragmentRunBox,E.boxes.TrackFragmentRunBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this);var e=0;for(this.size+=E.fields.FIELD_UINT32.getLength(),0!==(1&this.flags)&&void 0!==this.data_offset&&(this.size+=E.fields.FIELD_INT32.getLength()),0!==(4&this.flags)&&void 0!==this.first_sample_flags&&(this.size+=E.fields.FIELD_UINT32.getLength()),e=0;e<this.sample_count;e++)0!==(256&this.flags)&&void 0!==this.samples_table[e].sample_duration&&(this.size+=E.fields.FIELD_UINT32.getLength()),0!==(512&this.flags)&&void 0!==this.samples_table[e].sample_size&&(this.size+=E.fields.FIELD_UINT32.getLength()),0!==(1024&this.flags)&&void 0!==this.samples_table[e].sample_flags&&(this.size+=E.fields.FIELD_UINT32.getLength()),1===this.version?0!==(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=E.fields.FIELD_INT32.getLength()):0!==(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=E.fields.FIELD_UINT32.getLength())},E.boxes.TrackFragmentRunBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.sample_count=this._readData(e,E.fields.FIELD_UINT32),0!==(1&this.flags)&&(this.data_offset=this._readData(e,E.fields.FIELD_INT32)),0!==(4&this.flags)&&(this.first_sample_flags=this._readData(e,E.fields.FIELD_UINT32)),this.samples_table=[],i=0;i<this.sample_count;i++)r={},0!==(256&this.flags)&&(r.sample_duration=this._readData(e,E.fields.FIELD_UINT32)),0!==(512&this.flags)&&(r.sample_size=this._readData(e,E.fields.FIELD_UINT32)),0!==(1024&this.flags)&&(r.sample_flags=this._readData(e,E.fields.FIELD_UINT32)),1===this.version?0!==(2048&this.flags)&&(r.sample_composition_time_offset=this._readData(e,E.fields.FIELD_INT32)):0!==(2048&this.flags)&&(r.sample_composition_time_offset=this._readData(e,E.fields.FIELD_UINT32)),this.samples_table.push(r);return this.localPos},E.boxes.TrackFragmentRunBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.sample_count),0!==(1&this.flags)&&this._writeData(e,E.fields.FIELD_INT32,this.data_offset),0!==(4&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.first_sample_flags),n=0;n<this.sample_count;n++)0!==(256&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.samples_table[n].sample_duration),0!==(512&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.samples_table[n].sample_size),0!==(1024&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.samples_table[n].sample_flags),1===this.version?0!==(2048&this.flags)&&this._writeData(e,E.fields.FIELD_INT32,this.samples_table[n].sample_composition_time_offset):0!==(2048&this.flags)&&this._writeData(e,E.fields.FIELD_UINT32,this.samples_table[n].sample_composition_time_offset);return this.localPos},E.boxes.SampleDescriptionBox=function(e){E.boxes.ContainerFullBox.call(this,"stsd",e)},E.boxes.SampleDescriptionBox.prototype=Object.create(E.boxes.ContainerFullBox.prototype),E.boxes.SampleDescriptionBox.prototype.constructor=E.boxes.SampleDescriptionBox,E.boxes.SampleDescriptionBox.prototype.computeLength=function(){E.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},E.boxes.SampleDescriptionBox.prototype.read=function(e,t,n){return E.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},E.boxes.SampleDescriptionBox.prototype.write=function(e,t){return this.entry_count=this.boxes.length,E.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},E.boxes.SampleDependencyTableBox=function(e){E.boxes.FullBox.call(this,"sdtp",e)},E.boxes.SampleDependencyTableBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleDependencyTableBox.prototype.constructor=E.boxes.SampleDependencyTableBox,E.boxes.SampleDependencyTableBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT8.getLength()*this.sample_dependency_table.length},E.boxes.SampleDependencyTableBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_dependency_table=this._readArrayData(e,E.fields.FIELD_UINT8),this.localPos},E.boxes.SampleDependencyTableBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,E.fields.FIELD_UINT8,this.sample_dependency_table),this.localPos},E.boxes.SampleEntryBox=function(e,t){E.boxes.Box.call(this,e,t)},E.boxes.SampleEntryBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.SampleEntryBox.prototype.constructor=E.boxes.SampleEntryBox,E.boxes.SampleEntryBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT16.getLength()+6*E.fields.FIELD_UINT8.getLength()},E.boxes.SampleEntryBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.reserved=this._readArrayFieldData(e,E.fields.FIELD_UINT8,6),this.data_reference_index=this._readData(e,E.fields.FIELD_UINT16),this.localPos},E.boxes.SampleEntryBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeArrayData(e,E.fields.FIELD_UINT8,this.reserved),this._writeData(e,E.fields.FIELD_UINT16,this.data_reference_index),this.localPos},E.boxes.VisualSampleEntryBox=function(e,t){E.boxes.SampleEntryBox.call(this,e,t)},E.boxes.VisualSampleEntryBox.prototype=Object.create(E.boxes.SampleEntryBox.prototype),E.boxes.VisualSampleEntryBox.prototype.constructor=E.boxes.VisualSampleEntryBox,E.boxes.VisualSampleEntryBox.prototype.computeLength=function(){E.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=7*E.fields.FIELD_UINT16.getLength()+3*E.fields.FIELD_UINT32.getLength(),this.size+=3*E.fields.FIELD_UINT32.getLength(),this.size+=32},E.boxes.VisualSampleEntryBox.prototype.read=function(e,t,n){return E.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,E.fields.FIELD_UINT16),this.reserved_2=this._readData(e,E.fields.FIELD_UINT16),this.pre_defined_2=this._readArrayFieldData(e,E.fields.FIELD_UINT32,3),this.width=this._readData(e,E.fields.FIELD_UINT16),this.height=this._readData(e,E.fields.FIELD_UINT16),this.horizresolution=this._readData(e,E.fields.FIELD_UINT32),this.vertresolution=this._readData(e,E.fields.FIELD_UINT32),this.reserved_3=this._readData(e,E.fields.FIELD_UINT32),this.frame_count=this._readData(e,E.fields.FIELD_UINT16),this.compressorname=this._readArrayFieldData(e,E.fields.FIELD_UINT8,32),this.depth=this._readData(e,E.fields.FIELD_UINT16),this.pre_defined_3=this._readData(e,E.fields.FIELD_INT16),this.localPos},E.boxes.VisualSampleEntryBox.prototype.write=function(e,t){return E.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,E.fields.FIELD_UINT16,this.reserved_2),this._writeArrayData(e,E.fields.FIELD_UINT32,this.pre_defined_2),this._writeData(e,E.fields.FIELD_UINT16,this.width),this._writeData(e,E.fields.FIELD_UINT16,this.height),this._writeData(e,E.fields.FIELD_UINT32,this.horizresolution),this._writeData(e,E.fields.FIELD_UINT32,this.vertresolution),this._writeData(e,E.fields.FIELD_UINT32,this.reserved_3),this._writeData(e,E.fields.FIELD_UINT16,this.frame_count),this._writeArrayData(e,E.fields.FIELD_UINT8,this.compressorname),this._writeData(e,E.fields.FIELD_UINT16,this.depth),this._writeData(e,E.fields.FIELD_INT16,this.pre_defined_3),this.localPos},E.boxes.VisualSampleEntryContainerBox=function(e,t){E.boxes.VisualSampleEntryBox.call(this,e,t),this.boxes=[]},E.boxes.VisualSampleEntryContainerBox.prototype=Object.create(E.boxes.VisualSampleEntryBox.prototype),E.boxes.VisualSampleEntryContainerBox.prototype.constructor=E.boxes.VisualSampleEntryContainerBox,E.boxes.VisualSampleEntryContainerBox.prototype.computeLength=function(){E.boxes.VisualSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},E.boxes.VisualSampleEntryContainerBox.prototype.read=function(e,t,n){E.boxes.VisualSampleEntryBox.prototype.read.call(this,e,t,n);for(var i,r,o=0,s=0,a=null;this.localPos<this.localEnd;){if(o=E.fields.FIELD_UINT32.read(e,this.localPos),i=E.fields.readString(e,this.localPos+4,4),"uuid"==i&&(s=1==o?16:8,a=new E.fields.ArrayField(E.fields.FIELD_INT8,16).read(e,this.localPos+s,this.localPos+s+16),a=JSON.stringify(a)),r=E.createBox(i,o,a),"uuid"===i?this.localPos=r.read(e,this.localPos+16*E.fields.FIELD_INT8.getLength()+8,this.localPos+o):this.localPos=r.read(e,this.localPos+8,this.localPos+o),E.debug&&(r.__sourceBuffer=e.subarray(this.localPos-r.size,this.localPos)),this.boxes.push(r),r.size<=0||null===r.size)throw new E.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");if(!r.boxtype)throw new E.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},E.boxes.VisualSampleEntryContainerBox.prototype.write=function(e,t){E.boxes.VisualSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},E.boxes.AVC1VisualSampleEntryBox=function(e){E.boxes.VisualSampleEntryContainerBox.call(this,"avc1",e)},E.boxes.AVC1VisualSampleEntryBox.prototype=Object.create(E.boxes.VisualSampleEntryContainerBox.prototype),E.boxes.AVC1VisualSampleEntryBox.prototype.constructor=E.boxes.AVC1VisualSampleEntryBox,E.boxes.EncryptedVideoBox=function(e){E.boxes.VisualSampleEntryContainerBox.call(this,"encv",e)},E.boxes.EncryptedVideoBox.prototype=Object.create(E.boxes.VisualSampleEntryContainerBox.prototype),E.boxes.EncryptedVideoBox.prototype.constructor=E.boxes.EncryptedVideoBox,E.boxes.AVCConfigurationBox=function(e){E.boxes.Box.call(this,"avcC",e)},E.boxes.AVCConfigurationBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.AVCConfigurationBox.prototype.constructor=E.boxes.AVCConfigurationBox,E.boxes.AVCConfigurationBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=4*E.fields.FIELD_UINT8.getLength()+3*E.fields.FIELD_UINT8.getLength(),this.size+=this._getNALLength(this.numOfSequenceParameterSets,this.SPS_NAL),this.size+=this._getNALLength(this.numOfPictureParameterSets,this.PPS_NAL)},E.boxes.AVCConfigurationBox.prototype._getNALLength=function(e,t){var n=0,i=0;for(i=0;i<e;i++)n+=E.fields.FIELD_UINT16.getLength()+t[i].NAL_length;return n},E.boxes.AVCConfigurationBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.configurationVersion=this._readData(e,E.fields.FIELD_UINT8),this.AVCProfileIndication=this._readData(e,E.fields.FIELD_UINT8),this.profile_compatibility=this._readData(e,E.fields.FIELD_UINT8),this.AVCLevelIndication=this._readData(e,E.fields.FIELD_UINT8),this.temp=this._readData(e,E.fields.FIELD_UINT8),this.lengthSizeMinusOne=3&this.temp,this.numOfSequenceParameterSets_tmp=this._readData(e,E.fields.FIELD_UINT8),this.numOfSequenceParameterSets=31&this.numOfSequenceParameterSets_tmp,this.SPS_NAL=this._readNAL(e,this.numOfSequenceParameterSets),this.numOfPictureParameterSets=this._readData(e,E.fields.FIELD_UINT8),this.PPS_NAL=this._readNAL(e,this.numOfPictureParameterSets),this.localPos},E.boxes.AVCConfigurationBox.prototype._readNAL=function(e,t){var n=[],i=0,r={};for(i=0;i<t;i++)r={},r.NAL_length=this._readData(e,E.fields.FIELD_UINT16),r.NAL=e.subarray(this.localPos,this.localPos+r.NAL_length),this.localPos+=r.NAL_length,n.push(r);return n},E.boxes.AVCConfigurationBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT8,this.configurationVersion),this._writeData(e,E.fields.FIELD_UINT8,this.AVCProfileIndication),this._writeData(e,E.fields.FIELD_UINT8,this.profile_compatibility),this._writeData(e,E.fields.FIELD_UINT8,this.AVCLevelIndication),this.temp=252|this.lengthSizeMinusOne,this._writeData(e,E.fields.FIELD_UINT8,this.temp),this.numOfSequenceParameterSets=this.SPS_NAL.length,this.numOfSequenceParameterSets_tmp=224|this.numOfSequenceParameterSets,this._writeData(e,E.fields.FIELD_UINT8,this.numOfSequenceParameterSets_tmp),this._writeNAL(e,this.numOfSequenceParameterSets,this.SPS_NAL),this._writeData(e,E.fields.FIELD_UINT8,this.numOfPictureParameterSets),this._writeNAL(e,this.numOfPictureParameterSets,this.PPS_NAL),this.localPos},E.boxes.AVCConfigurationBox.prototype._writeNAL=function(e,t,n){var i=0;for(i=0;i<t;i++)this._writeData(e,E.fields.FIELD_UINT16,n[i].NAL_length),this._writeBuffer(e,n[i].NAL,n[i].NAL_length)},E.boxes.PixelAspectRatioBox=function(e){E.boxes.Box.call(this,"pasp",e)},E.boxes.PixelAspectRatioBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.PixelAspectRatioBox.prototype.constructor=E.boxes.PixelAspectRatioBox,E.boxes.PixelAspectRatioBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_INT32.getLength()},E.boxes.PixelAspectRatioBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.hSpacing=this._readData(e,E.fields.FIELD_INT32),this.vSpacing=this._readData(e,E.fields.FIELD_INT32),this.localPos},E.boxes.PixelAspectRatioBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT32,this.hSpacing),this._writeData(e,E.fields.FIELD_INT32,this.vSpacing),this.localPos},E.boxes.AudioSampleEntryBox=function(e,t){E.boxes.SampleEntryBox.call(this,e,t)},E.boxes.AudioSampleEntryBox.prototype=Object.create(E.boxes.SampleEntryBox.prototype),E.boxes.AudioSampleEntryBox.prototype.constructor=E.boxes.AudioSampleEntryBox,E.boxes.AudioSampleEntryBox.prototype.computeLength=function(){E.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=4*E.fields.FIELD_UINT16.getLength()+3*E.fields.FIELD_UINT32.getLength()},E.boxes.AudioSampleEntryBox.prototype.read=function(e,t,n){return E.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.reserved_2=this._readArrayFieldData(e,E.fields.FIELD_UINT32,2),this.channelcount=this._readData(e,E.fields.FIELD_UINT16),this.samplesize=this._readData(e,E.fields.FIELD_UINT16),this.pre_defined=this._readData(e,E.fields.FIELD_UINT16),this.reserved_3=this._readData(e,E.fields.FIELD_UINT16),this.samplerate=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.AudioSampleEntryBox.prototype.write=function(e,t){return E.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeArrayData(e,E.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,E.fields.FIELD_UINT16,this.channelcount),this._writeData(e,E.fields.FIELD_UINT16,this.samplesize),this._writeData(e,E.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,E.fields.FIELD_UINT16,this.reserved_3),this._writeData(e,E.fields.FIELD_UINT32,this.samplerate),this.localPos},E.boxes.AudioSampleEntryContainerBox=function(e,t){E.boxes.AudioSampleEntryBox.call(this,e,t),this.boxes=[]},E.boxes.AudioSampleEntryContainerBox.prototype=Object.create(E.boxes.AudioSampleEntryBox.prototype),E.boxes.AudioSampleEntryContainerBox.prototype.constructor=E.boxes.AudioSampleEntryContainerBox,E.boxes.AudioSampleEntryContainerBox.prototype.computeLength=function(){E.boxes.AudioSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},E.boxes.AudioSampleEntryContainerBox.prototype.read=function(e,t,n){E.boxes.AudioSampleEntryBox.prototype.read.call(this,e,t,n);for(var i,r,o=0,s=0,a=null;this.localPos<this.localEnd;){if(o=E.fields.FIELD_UINT32.read(e,this.localPos),i=E.fields.readString(e,this.localPos+4,4),"uuid"==i&&(s=1==o?16:8,a=new E.fields.ArrayField(E.fields.FIELD_INT8,16).read(e,this.localPos+s,this.localPos+s+16),a=JSON.stringify(a)),r=E.createBox(i,o,a),"uuid"===i?this.localPos=r.read(e,this.localPos+16*E.fields.FIELD_INT8.getLength()+8,this.localPos+o):this.localPos=r.read(e,this.localPos+8,this.localPos+o),E.debug&&(r.__sourceBuffer=e.subarray(this.localPos-r.size,this.localPos)),this.boxes.push(r),r.size<=0||null===r.size)throw new E.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");if(!r.boxtype)throw new E.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},E.boxes.AudioSampleEntryContainerBox.prototype.write=function(e,t){E.boxes.AudioSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},E.boxes.MP4AudioSampleEntryBox=function(e){E.boxes.AudioSampleEntryContainerBox.call(this,"mp4a",e)},E.boxes.MP4AudioSampleEntryBox.prototype=Object.create(E.boxes.AudioSampleEntryContainerBox.prototype),E.boxes.MP4AudioSampleEntryBox.prototype.constructor=E.boxes.MP4AudioSampleEntryBox,E.boxes.EncryptedAudioBox=function(e){E.boxes.AudioSampleEntryContainerBox.call(this,"enca",e)},E.boxes.EncryptedAudioBox.prototype=Object.create(E.boxes.AudioSampleEntryContainerBox.prototype),E.boxes.EncryptedAudioBox.prototype.constructor=E.boxes.EncryptedAudioBox,E.boxes.ESDBox=function(e){E.boxes.FullBox.call(this,"esds",e)},E.boxes.ESDBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.ESDBox.prototype.constructor=E.boxes.ESDBox,E.boxes.ESDBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT8.getLength()+this.ES_length},E.boxes.ESDBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.ES_tag=this._readData(e,E.fields.FIELD_UINT8),this.ES_length=this._readData(e,E.fields.FIELD_UINT8),this.ES_data=e.subarray(this.localPos,this.localPos+this.ES_length),this.localPos+=this.ES_length,this.localPos},E.boxes.ESDBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT8,this.ES_tag),this._writeData(e,E.fields.FIELD_UINT8,this.ES_length),this._writeBuffer(e,this.ES_data,this.ES_length),this.localPos},E.boxes.SampleSizeBox=function(e){E.boxes.FullBox.call(this,"stsz",e)},E.boxes.SampleSizeBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleSizeBox.prototype.constructor=E.boxes.SampleSizeBox,E.boxes.SampleSizeBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT32.getLength()+E.fields.FIELD_UINT32.getLength()*this.sample_count},E.boxes.SampleSizeBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_size=this._readData(e,E.fields.FIELD_UINT32),this.sample_count=this._readData(e,E.fields.FIELD_UINT32),this.entries=this._readArrayFieldData(e,E.fields.FIELD_UINT32,this.sample_count),this.localPos},E.boxes.SampleSizeBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.sample_size),this._writeData(e,E.fields.FIELD_UINT32,this.sample_count),n=0;n<this.sample_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.entries[n]);return this.localPos},E.boxes.ProtectionSystemSpecificHeaderBox=function(e){E.boxes.FullBox.call(this,"pssh",e)},E.boxes.ProtectionSystemSpecificHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.ProtectionSystemSpecificHeaderBox.prototype.constructor=E.boxes.ProtectionSystemSpecificHeaderBox,E.boxes.ProtectionSystemSpecificHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=16*E.fields.FIELD_UINT8.getLength(),this.size+=E.fields.FIELD_UINT32.getLength(),this.size+=E.fields.FIELD_UINT8.getLength()*this.DataSize},E.boxes.ProtectionSystemSpecificHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.SystemID=this._readArrayFieldData(e,E.fields.FIELD_UINT8,16),this.DataSize=this._readData(e,E.fields.FIELD_UINT32),this.Data=this._readArrayFieldData(e,E.fields.FIELD_UINT8,this.DataSize),this.localPos},E.boxes.ProtectionSystemSpecificHeaderBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<16;n++)this._writeData(e,E.fields.FIELD_UINT8,this.SystemID[n]);for(this._writeData(e,E.fields.FIELD_UINT32,this.DataSize),n=0;n<this.DataSize;n++)this._writeData(e,E.fields.FIELD_UINT8,this.Data[n]);return this.localPos},E.boxes.SampleEncryptionBox=function(e){E.boxes.FullBox.call(this,"senc",e)},E.boxes.SampleEncryptionBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleEncryptionBox.prototype.constructor=E.boxes.SampleEncryptionBox,E.boxes.SampleEncryptionBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=E.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=E.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=E.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=E.fields.FIELD_UINT16.getLength(),this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.SampleEncryptionBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0,i=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,E.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,E.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),i=0;i<this.entry[n].NumberOfEntries;i++)this._writeData(e,E.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[i].BytesOfClearData),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[i].BytesOfEncryptedData);return this.localPos},E.boxes.SampleEncryptionBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r=0,o={},s={};for(this.sample_count=this._readData(e,E.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,E.fields.FIELD_UINT8)),this.entry=[],i=0;i<this.sample_count;i++){if(s={},s.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(s.NumberOfEntries=this._readData(e,E.fields.FIELD_UINT16),s.clearAndCryptedData=[],r=0;r<s.NumberOfEntries;r++)o={},o.BytesOfClearData=this._readData(e,E.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,E.fields.FIELD_UINT32),s.clearAndCryptedData.push(o);this.entry.push(s)}return this.localPos},E.boxes.SampleAuxiliaryInformationSizesBox=function(e){E.boxes.FullBox.call(this,"saiz",e)},E.boxes.SampleAuxiliaryInformationSizesBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleAuxiliaryInformationSizesBox.prototype.constructor=E.boxes.SampleAuxiliaryInformationSizesBox,E.boxes.SampleAuxiliaryInformationSizesBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*E.fields.FIELD_UINT32.getLength()),this.size+=E.fields.FIELD_UINT8.getLength()+E.fields.FIELD_UINT32.getLength(),0===this.default_sample_info_size&&(this.size+=E.fields.FIELD_UINT8.getLength()*this.sample_count)},E.boxes.SampleAuxiliaryInformationSizesBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,E.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,E.fields.FIELD_UINT32)),this.default_sample_info_size=this._readData(e,E.fields.FIELD_UINT8),this.sample_count=this._readData(e,E.fields.FIELD_UINT32),0===this.default_sample_info_size&&(this.sample_info_size=this._readArrayFieldData(e,E.fields.FIELD_UINT8,this.sample_count)),this.localPos},E.boxes.SampleAuxiliaryInformationSizesBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,E.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,E.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,E.fields.FIELD_UINT8,this.default_sample_info_size),this._writeData(e,E.fields.FIELD_UINT32,this.sample_count),0===this.default_sample_info_size)for(n=0;n<this.sample_count;n++)this._writeData(e,E.fields.FIELD_UINT8,this.sample_info_size[n]);return this.localPos},E.boxes.SampleAuxiliaryInformationOffsetsBox=function(e){E.boxes.FullBox.call(this,"saio",e)},E.boxes.SampleAuxiliaryInformationOffsetsBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.constructor=E.boxes.SampleAuxiliaryInformationOffsetsBox,E.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.computeLength=function(){
E.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*E.fields.FIELD_UINT32.getLength()),this.size+=E.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=E.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=E.fields.FIELD_UINT64.getLength()*this.entry_count},E.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,E.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,E.fields.FIELD_UINT32)),this.entry_count=this._readData(e,E.fields.FIELD_UINT32),0===this.version?this.offset=this._readArrayFieldData(e,E.fields.FIELD_UINT32,this.entry_count):this.offset=this._readArrayFieldData(e,E.fields.FIELD_UINT64,this.entry_count),this.localPos},E.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,E.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,E.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),0===this.version)for(n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.offset[n]);else for(n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT64,this.offset[n]);return this.localPos},E.boxes.ProtectionSchemeInformationBox=function(e){E.boxes.ContainerBox.call(this,"sinf",e)},E.boxes.ProtectionSchemeInformationBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.ProtectionSchemeInformationBox.prototype.constructor=E.boxes.ProtectionSchemeInformationBox,E.boxes.SchemeInformationBox=function(e){E.boxes.ContainerBox.call(this,"schi",e)},E.boxes.SchemeInformationBox.prototype=Object.create(E.boxes.ContainerBox.prototype),E.boxes.SchemeInformationBox.prototype.constructor=E.boxes.SchemeInformationBox,E.boxes.TrackEncryptionBox=function(e){E.boxes.FullBox.call(this,"tenc",e)},E.boxes.TrackEncryptionBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackEncryptionBox.prototype.constructor=E.boxes.TrackEncryptionBox,E.boxes.TrackEncryptionBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_BIT24.getLength(),this.size+=E.fields.FIELD_UINT8.getLength(),this.size+=16*E.fields.FIELD_UINT8.getLength()},E.boxes.TrackEncryptionBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.default_IsEncrypted=this._readData(e,E.fields.FIELD_BIT24),this.default_IV_size=this._readData(e,E.fields.FIELD_UINT8),this.default_KID=this._readArrayFieldData(e,E.fields.FIELD_UINT8,16),this.localPos},E.boxes.TrackEncryptionBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_BIT24,this.default_IsEncrypted),this._writeData(e,E.fields.FIELD_UINT8,this.default_IV_size),this._writeArrayData(e,E.fields.FIELD_UINT8,this.default_KID),this.localPos},E.boxes.SchemeTypeBox=function(e){E.boxes.FullBox.call(this,"schm",e)},E.boxes.SchemeTypeBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SchemeTypeBox.prototype.constructor=E.boxes.SchemeTypeBox,E.boxes.SchemeTypeBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=E.fields.FIELD_STRING.getLength(this.scheme_uri))},E.boxes.SchemeTypeBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.scheme_type=this._readData(e,E.fields.FIELD_UINT32),this.scheme_version=this._readData(e,E.fields.FIELD_UINT32),1&this.flags&&(this.scheme_uri=this._readData(e,E.fields.FIELD_STRING)),this.localPos},E.boxes.SchemeTypeBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.scheme_type),this._writeData(e,E.fields.FIELD_UINT32,this.scheme_version),1&this.flags&&this._writeData(e,E.fields.FIELD_STRING,this.scheme_uri),this.localPos},E.boxes.EditListBox=function(e){E.boxes.FullBox.call(this,"elst",e),this.entries=[]},E.boxes.EditListBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.EditListBox.prototype.constructor=E.boxes.EditListBox,E.boxes.EditListBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=(2*E.fields.FIELD_UINT64.getLength()+2*E.fields.FIELD_UINT16.getLength())*this.entry_count:this.size+=(2*E.fields.FIELD_UINT32.getLength()+2*E.fields.FIELD_UINT16.getLength())*this.entry_count},E.boxes.EditListBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,E.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},1===this.version?(r.segment_duration=this._readData(e,E.fields.FIELD_UINT64),r.media_time=this._readData(e,E.fields.FIELD_UINT64)):(r.segment_duration=this._readData(e,E.fields.FIELD_UINT32),r.media_time=this._readData(e,E.fields.FIELD_UINT32)),r.media_rate_integer=this._readData(e,E.fields.FIELD_UINT16),r.media_rate_fraction=this._readData(e,E.fields.FIELD_UINT16),this.entries.push(r);return this.localPos},E.boxes.EditListBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.entries[n].segment_duration),this._writeData(e,E.fields.FIELD_UINT64,this.entries[n].media_time)):(this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].segment_duration),this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].media_time)),this._writeData(e,E.fields.FIELD_UINT16,this.entries[n].media_rate_integer),this._writeData(e,E.fields.FIELD_UINT16,this.entries[n].media_rate_fraction);return this.localPos},E.boxes.HintMediaHeaderBox=function(e){E.boxes.FullBox.call(this,"hmhd",e)},E.boxes.HintMediaHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.HintMediaHeaderBox.prototype.constructor=E.boxes.HintMediaHeaderBox,E.boxes.HintMediaHeaderBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*E.fields.FIELD_UINT16.getLength(),this.size+=3*E.fields.FIELD_UINT32.getLength()},E.boxes.HintMediaHeaderBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.maxPDUsize=this._readData(e,E.fields.FIELD_UINT16),this.avgPDUsize=this._readData(e,E.fields.FIELD_UINT16),this.maxbitrate=this._readData(e,E.fields.FIELD_UINT32),this.avgbitrate=this._readData(e,E.fields.FIELD_UINT32),this.reserved=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.HintMediaHeaderBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT16,this.maxPDUsize),this._writeData(e,E.fields.FIELD_UINT16,this.avgPDUsize),this._writeData(e,E.fields.FIELD_UINT32,this.maxbitrate),this._writeData(e,E.fields.FIELD_UINT32,this.avgbitrate),this._writeData(e,E.fields.FIELD_UINT32,this.reserved),this.localPos},E.boxes.NullMediaHeaderBox=function(e){E.boxes.FullBox.call(this,"nmhd",e)},E.boxes.NullMediaHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.NullMediaHeaderBox.prototype.constructor=E.boxes.NullMediaHeaderBox,E.boxes.CompositionOffsetBox=function(e){E.boxes.FullBox.call(this,"ctts",e),this.entries=[]},E.boxes.CompositionOffsetBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.CompositionOffsetBox.prototype.constructor=E.boxes.CompositionOffsetBox,E.boxes.CompositionOffsetBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=2*E.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=(E.fields.FIELD_UINT32.getLength()+E.fields.FIELD_INT32.getLength())*this.entry_count},E.boxes.CompositionOffsetBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,E.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},0===this.version?(r.sample_count=this._readData(e,E.fields.FIELD_UINT32),r.sample_offset=this._readData(e,E.fields.FIELD_UINT32)):(r.sample_count=this._readData(e,E.fields.FIELD_UINT32),r.sample_offset=this._readData(e,E.fields.FIELD_INT32)),this.entries.push(r);return this.localPos},E.boxes.CompositionOffsetBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)0===this.version?(this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].sample_offset)):(this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,E.fields.FIELD_INT32,this.entries[n].sample_offset));return this.localPos},E.boxes.CompositionToDecodeBox=function(e){E.boxes.FullBox.call(this,"cslg",e)},E.boxes.CompositionToDecodeBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.CompositionToDecodeBox.prototype.constructor=E.boxes.CompositionToDecodeBox,E.boxes.CompositionToDecodeBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*E.fields.FIELD_INT32.getLength()},E.boxes.CompositionToDecodeBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.compositionToDTSShift=this._readData(e,E.fields.FIELD_INT32),this.leastDecodeToDisplayDelta=this._readData(e,E.fields.FIELD_INT32),this.greatestDecodeToDisplayDelta=this._readData(e,E.fields.FIELD_INT32),this.compositionStartTime=this._readData(e,E.fields.FIELD_INT32),this.compositionEndTime=this._readData(e,E.fields.FIELD_INT32),this.localPos},E.boxes.CompositionToDecodeBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_INT32,this.compositionToDTSShift),this._writeData(e,E.fields.FIELD_INT32,this.leastDecodeToDisplayDelta),this._writeData(e,E.fields.FIELD_INT32,this.greatestDecodeToDisplayDelta),this._writeData(e,E.fields.FIELD_INT32,this.compositionStartTime),this._writeData(e,E.fields.FIELD_INT32,this.compositionEndTime),this.localPos},E.boxes.SyncSampleBox=function(e){E.boxes.FullBox.call(this,"stss",e),this.entries=[]},E.boxes.SyncSampleBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.SyncSampleBox.prototype.constructor=E.boxes.SyncSampleBox,E.boxes.SyncSampleBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength(),this.size+=E.fields.FIELD_UINT32.getLength()*this.entry_count},E.boxes.SyncSampleBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,E.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},r.sample_number=this._readData(e,E.fields.FIELD_UINT32),this.entries.push(r);return this.localPos},E.boxes.SyncSampleBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,E.fields.FIELD_UINT32,this.entries[n].sample_number);return this.localPos},E.boxes.TrackReferenceBox=function(e){E.boxes.FullBox.call(this,"tref",e)},E.boxes.TrackReferenceBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TrackReferenceBox.prototype.constructor=E.boxes.TrackReferenceBox,E.boxes.TrackReferenceBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength()*this.track_IDs.length},E.boxes.TrackReferenceBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_IDs=this._readArrayData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.TrackReferenceBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,E.fields.FIELD_UINT32,this.track_IDs),this.localPos},E.boxes.OriginalFormatBox=function(e){E.boxes.Box.call(this,"frma",e)},E.boxes.OriginalFormatBox.prototype=Object.create(E.boxes.Box.prototype),E.boxes.OriginalFormatBox.prototype.constructor=E.boxes.OriginalFormatBox,E.boxes.OriginalFormatBox.prototype.computeLength=function(){E.boxes.Box.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.OriginalFormatBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data_format=this._readData(e,E.fields.FIELD_UINT32),this.localPos},E.boxes.OriginalFormatBox.prototype.write=function(e,t){return E.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,E.fields.FIELD_UINT32,this.data_format),this.localPos},E.boxes.PiffSampleEncryptionBox=function(e){E.boxes.FullBox.call(this,"sepiff",e,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])},E.boxes.PiffSampleEncryptionBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.PiffSampleEncryptionBox.prototype.constructor=E.boxes.PiffSampleEncryptionBox,E.boxes.PiffSampleEncryptionBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=E.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=E.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=E.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=E.fields.FIELD_UINT16.getLength(),this.size+=E.fields.FIELD_UINT32.getLength()},E.boxes.PiffSampleEncryptionBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0,i=0;for(this._writeData(e,E.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,E.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,E.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),i=0;i<this.entry[n].NumberOfEntries;i++)this._writeData(e,E.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[i].BytesOfClearData),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[i].BytesOfEncryptedData);return this.localPos},E.boxes.PiffSampleEncryptionBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r=0,o={},s={};for(this.sample_count=this._readData(e,E.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,E.fields.FIELD_UINT8)),this.entry=[],i=0;i<this.sample_count;i++){if(s={},s.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(s.NumberOfEntries=this._readData(e,E.fields.FIELD_UINT16),s.clearAndCryptedData=[],r=0;r<s.NumberOfEntries;r++)o={},o.BytesOfClearData=this._readData(e,E.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,E.fields.FIELD_UINT32),s.clearAndCryptedData.push(o);this.entry.push(s)}return this.localPos},E.boxes.PiffTrackEncryptionBox=function(e){E.boxes.FullBox.call(this,"tepiff",e,[137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])},E.boxes.PiffTrackEncryptionBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.PiffTrackEncryptionBox.prototype.constructor=E.boxes.PiffTrackEncryptionBox,E.boxes.PiffProtectionSystemSpecificHeaderBox=function(e){E.boxes.FullBox.call(this,"psshpiff",e,[208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])},E.boxes.PiffProtectionSystemSpecificHeaderBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.PiffProtectionSystemSpecificHeaderBox.prototype.constructor=E.boxes.PiffProtectionSystemSpecificHeaderBox,E.boxes.TfxdBox=function(e){E.boxes.FullBox.call(this,"tfxd",e,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])},E.boxes.TfxdBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TfxdBox.prototype.constructor=E.boxes.TfxdBox,E.boxes.TfxdBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=2*E.fields.FIELD_UINT64.getLength():this.size+=2*E.fields.FIELD_UINT32.getLength()},E.boxes.TfxdBox.prototype.write=function(e,t){return E.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.fragment_absolute_time),this._writeData(e,E.fields.FIELD_UINT64,this.fragment_duration)):(this._writeData(e,E.fields.FIELD_UINT32,this.fragment_absolute_time),this._writeData(e,E.fields.FIELD_UINT32,this.fragment_duration)),this.localPos},E.boxes.TfxdBox.prototype.read=function(e,t,n){return E.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.fragment_absolute_time=this._readData(e,E.fields.FIELD_UINT64),this.fragment_duration=this._readData(e,E.fields.FIELD_UINT64)):(this.fragment_absolute_time=this._readData(e,E.fields.FIELD_UINT32),this.fragment_duration=this._readData(e,E.fields.FIELD_UINT32)),this.localPos},E.boxes.TfrfBox=function(e){E.boxes.FullBox.call(this,"tfrf",e,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])},E.boxes.TfrfBox.prototype=Object.create(E.boxes.FullBox.prototype),E.boxes.TfrfBox.prototype.constructor=E.boxes.TfrfBox,E.boxes.TfrfBox.prototype.computeLength=function(){E.boxes.FullBox.prototype.computeLength.call(this),this.size+=E.fields.FIELD_UINT8.getLength(),1===this.version?this.size+=2*E.fields.FIELD_UINT64.getLength()*this.fragment_count:this.size+=2*E.fields.FIELD_UINT32.getLength()*this.fragment_count},E.boxes.TfrfBox.prototype.write=function(e,t){E.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,E.fields.FIELD_UINT8,this.fragment_count),n=0;n<this.fragment_count;n++)1===this.version?(this._writeData(e,E.fields.FIELD_UINT64,this.entry[n].fragment_absolute_time),this._writeData(e,E.fields.FIELD_UINT64,this.entry[n].fragment_duration)):(this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].fragment_absolute_time),this._writeData(e,E.fields.FIELD_UINT32,this.entry[n].fragment_duration));return this.localPos},E.boxes.TfrfBox.prototype.read=function(e,t,n){E.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.fragment_count=this._readData(e,E.fields.FIELD_UINT8),this.entry=[],i=0;i<this.fragment_count;i++)r={},1===this.version?(r.fragment_absolute_time=this._readData(e,E.fields.FIELD_UINT64),r.fragment_duration=this._readData(e,E.fields.FIELD_UINT64)):(r.fragment_absolute_time=this._readData(e,E.fields.FIELD_UINT32),r.fragment_duration=this._readData(e,E.fields.FIELD_UINT32)),this.entry.push(r);return this.localPos},E.registerTypeBoxes();var x=function(){return{pes:{},si:{},binary:{},ts:{},Pts:{},aac:{},h264:{}}}();return"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=x:window.mpegts=x,x.si.PSISection=function(e){this.m_table_id=e,this.m_section_syntax_indicator=1,this.m_section_length=x.si.PSISection.prototype.SECTION_LENGTH,this.m_transport_stream_id=0,this.m_version_number=0,this.m_current_next_indicator=!0,this.m_section_number=0,this.m_last_section_number=0,this.m_bValid=null},x.si.PSISection.prototype.parse=function(e){this.m_bValid=!1;var t=0,n=e[t];return t=0===n?t+1:t+n,this.m_table_id=e[t],t++,this.m_section_syntax_indicator=x.binary.getBitFromByte(e[t],0),this.m_section_length=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,this.m_transport_stream_id=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_version_number=x.binary.getValueFromByte(e[t],2,5),this.m_current_next_indicator=x.binary.getBitFromByte(e[t],7),t++,this.m_section_number=e[t],t++,this.m_last_section_number=e[t],this.m_bValid=!0,t},x.si.PSISection.prototype.getSectionLength=function(){return this.m_section_length},x.si.PSISection.prototype.SECTION_LENGTH=9,x.si.PSISection.prototype.HEADER_LENGTH=8,x.aac.SAMPLING_FREQUENCY=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],x.aac.getAudioSpecificConfig=function(e){var t=x.binary.getValueFromByte(e[2],0,2),n=x.binary.getValueFromByte(e[2],2,4),i=x.binary.getValueFrom2Bytes(e.subarray(2,5),7,3),r=new Uint8Array(2);return r[0]=t+1<<3,r[0]|=(14&n)>>1,r[1]|=(1&n)<<7,r[1]|=i<<3,r},x.aac.parseADTS=function(e,t){for(var n,i,r=[],o={},s=0;s<e.length;)i=s,o.syncword=(e[s]<<4)+((240&e[s+1])>>4),o.protection_absent=1&e[s+1],o.sampling_frequency_index=(60&e[s+2])>>2,o.channel_configuration=((1&e[s+2])<<1)+((192&e[s+3])>>6),o.aac_frame_length=((3&e[s+3])<<11)+(e[s+4]<<3)+((224&e[s+5])>>5),o.number_of_raw_data_blocks_in_frame=(3&e[s+6])>>2,s+=7,0===o.number_of_raw_data_blocks_in_frame&&(0===o.protection_absent&&(s+=2),n={},n.offset=s,n.length=o.aac_frame_length-(s-i),t&&t[i]&&(n.cts=t[i]),r.push(n),s+=n.length);return r},x.ts.AdaptationField=function(){this.m_cAFLength=null,this.m_bDiscontinuityInd=null,this.m_bRAI=null,this.m_bESPriority=null,this.m_bPCRFlag=null,this.m_bOPCRFlag=null,this.m_bSplicingPointFlag=null,this.m_bPrivateDataFlag=null,this.m_bAdaptationFieldExtFlag=null},x.ts.AdaptationField.prototype.getLength=function(){return this.m_cAFLength+1},x.ts.AdaptationField.prototype.parse=function(e){if(this.m_cAFLength=e[0],0!==this.m_cAFLength){var t=1;this.m_bDiscontinuityInd=x.binary.getBitFromByte(e[t],0),this.m_bRAI=x.binary.getBitFromByte(e[t],1),this.m_bESPriority=x.binary.getBitFromByte(e[t],2),this.m_bPCRFlag=x.binary.getBitFromByte(e[t],3),this.m_bOPCRFlag=x.binary.getBitFromByte(e[t],4),this.m_bSplicingPointFlag=x.binary.getBitFromByte(e[t],5),this.m_bPrivateDataFlag=x.binary.getBitFromByte(e[t],6),this.m_bAdaptationFieldExtFlag=x.binary.getBitFromByte(e[t],7)}},x.binary.readBytes=function(e,t,n){for(var i=0,r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},x.binary.getBitFromByte=function(e,t){var n=0;return n+=1<<7-t,0!==(e&n)},x.binary.getValueFrom3Bytes=function(e,t,n){"undefined"==typeof n&&(n=-1),"undefined"==typeof t&&(t=0);var i=n==-1?-1:n-(16-t),r=n==-1?0:8-i,o=x.binary.getValueFromByte(e[0],t),s=x.binary.getValueFromByte(e[1]),a=x.binary.getValueFromByte(e[2],0,i,!1);return(o<<16&16711680|s<<8&65280|255&a)>>r},x.binary.getValueFrom2Bytes=function(e,t,n){"undefined"==typeof n&&(n=-1),"undefined"==typeof t&&(t=0);var i=n==-1?-1:n-(8-t),r=n==-1?0:8-i,o=x.binary.getValueFromByte(e[0],t),s=x.binary.getValueFromByte(e[1],0,i,!1);return(o<<8&65280|255&s)>>r},x.binary.getValueFromByte=function(e,t,n,i){var r=0,o=0;"undefined"==typeof n&&(n=-1),"undefined"==typeof t&&(t=0);var s=n==-1?7:t+n-1;for(o=t;o<=s;o++)r+=1<<7-o;var a=e&r;return(i||"undefined"==typeof i)&&(a>>=7-s),a},x.h264.getSequenceHeader=function(e){for(var t,n=-1,i=-1,r=0,o=null,s=0,a=0;r<e.length;)if(0===e[r]&&0===e[r+1]&&0===e[r+2]&&1===e[r+3]){if(t=31&e[r+4],t>=x.h264.NALUTYPE_SPS&&t<=x.h264.NALUTYPE_PPS){if(n===-1&&(n=r),t===x.h264.NALUTYPE_SPS){var l=x.h264.parseSPS(e.subarray(r+5));s=l.pic_width_in_mbs_minus1+1<<4,a=l.pic_height_in_map_units_minus1+1<<4}}else n>0&&(i=r-n);if(t===x.h264.NALUTYPE_IDR||t===x.h264.NALUTYPE_NONIDR)break;r+=4}else{if(0===e[r]&&0===e[r+1]&&1===e[r+2]){n>0&&(i=r-n);break}r++}return n===-1||i===-1?null:(o=new Uint8Array(i),o.set(e.subarray(n,n+i)),{bytes:o,width:s,height:a})},x.h264.read_ue=function(e,t){var n=1,i=0,r=0;for(t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);0===t._bit;)r++,n<<=1,t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);if(n-=1,i=0,r)for(;r>0;)t._bit=t._byte>>t._bitPos&1,t._bitPos--,i=(i<<1)+t._bit,r--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);return n+=i},x.h264.read_flag=function(e,t){var n=0;return t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7),n=t._bit},x.h264.parseSPS=function(e){var t={profile_idc:0,constraint_set0_flag:0,constraint_set1_flag:0,constraint_set2_flag:0,constraint_set3_flag:0,level_idc:0,seq_parameter_set_id:0,chroma_format_idc:0,separate_colour_plane_flag:0,bit_depth_luma_minus8:0,bit_depth_chroma_minus8:0,qpprime_y_zero_transform_bypass_flag:0,seq_scaling_matrix_present_flag:0,log2_max_frame_num_minus4:0,pic_order_cnt_type:0,log2_max_pic_order_cnt_lsb_minus4:0,num_ref_frames:0,gaps_in_frame_num_value_allowed_flag:0,pic_width_in_mbs_minus1:0,pic_height_in_map_units_minus1:0},n={_byte:0,_bit:0,_bytePos:0,_bitPos:0};return n._bytePos=n._bitPos=0,n._byte=e[n._bytePos],n._bytePos++,t.profile_idc=n._byte,n._byte=e[n._bytePos],n._bytePos++,t.constraint_set0_flag=(128&n._byte)>>7,t.constraint_set1_flag=(64&n._byte)>>6,t.constraint_set2_flag=(32&n._byte)>>5,t.constraint_set3_flag=(16&n._byte)>>4,n._byte=e[n._bytePos],n._bytePos++,t.level_idc=n._byte,n._byte=e[n._bytePos],n._bytePos++,n._bitPos=7,t.seq_parameter_set_id=x.h264.read_ue(e,n),100!==t.profile_idc&&110!==t.profile_idc&&122!==t.profile_idc&&244!==t.profile_idc&&44!==t.profile_idc&&83!==t.profile_idc&&86!==t.profile_idc||(t.chroma_format_idc=x.h264.read_ue(e,n),3===t.chroma_format_idc&&(t.separate_colour_plane_flag=x.h264.read_flag(e,n)),t.bit_depth_luma_minus8=x.h264.read_ue(e,n),t.bit_depth_chroma_minus8=x.h264.read_ue(e,n),t.qpprime_y_zero_transform_bypass_flag=x.h264.read_flag(e,n),t.seq_scaling_matrix_present_flag=x.h264.read_flag(e,n),1===t.seq_scaling_matrix_present_flag),t.log2_max_frame_num_minus4=x.h264.read_ue(e,n),t.pic_order_cnt_type=x.h264.read_ue(e,n),0===t.pic_order_cnt_type?t.log2_max_pic_order_cnt_lsb_minus4=x.h264.read_ue(e,n):1===t.pic_order_cnt_type,t.num_ref_frames=x.h264.read_ue(e,n),t.gaps_in_frame_num_value_allowed_flag=x.h264.read_flag(e,n),t.pic_width_in_mbs_minus1=x.h264.read_ue(e,n),t.pic_height_in_map_units_minus1=x.h264.read_ue(e,n),t},x.h264.parseNALUs=function(e){for(var t,n=0,i=e.length,r=0,o=[];n<i;)0===e[n]&&r++,1===e[n]&&r>=2&&(n++,o.length>0&&(o[o.length-1].size=n-(r+1)-o[o.length-1].offset),t={},t.type=31&e[n],t.offset=n,o.push(t),r=0),e[n]&&(r=0),n++;return o.length>0&&(o[o.length-1].size=n-o[o.length-1].offset),o},x.h264.bytestreamToMp4=function(e){for(var t=0,n=e.length,i=-1,r=0;t<n;)0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]?(i>=0&&(r=t-i-4,e[i]=(4278190080&r)>>24,e[i+1]=(16711680&r)>>16,e[i+2]=(65280&r)>>8,e[i+3]=255&r),i=t,t+=4):t++;r=t-i-4,e[i]=(4278190080&r)>>24,e[i+1]=(16711680&r)>>16,e[i+2]=(65280&r)>>8,e[i+3]=255&r},x.h264.isIDR=function(e){for(var t,n=0;n<e.length;)if(0===e[n]&&0===e[n+1]&&1===e[n+2]){if(t=31&e[n+3],t===x.h264.NALUTYPE_IDR)return!0;n+=3}else n++;return!1},x.h264.NALUTYPE_NONIDR=1,x.h264.NALUTYPE_IDR=5,x.h264.NALUTYPE_SEI=6,x.h264.NALUTYPE_SPS=7,x.h264.NALUTYPE_PPS=8,x.h264.NALUTYPE_AU_DELIMITER=9,x.si.PAT=function(){x.si.PSISection.call(this,x.si.PAT.prototype.TABLE_ID),this.m_listOfProgramAssociation=[],this.m_network_pid=null},x.si.PAT.prototype=Object.create(x.si.PSISection.prototype),x.si.PAT.prototype.constructor=x.si.PAT,x.si.PAT.prototype.parse=function(e){var t=x.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){for(var n=this.getSectionLength()-this.SECTION_LENGTH;n>=4;){var i=new x.si.ProgramAssociation(e.subarray(t,t+4));0===i.getProgramNumber()?this.m_network_pid=i.getProgramMapPid():this.m_listOfProgramAssociation.push(i),n-=4,t+=4}this.m_bValid=!0}},x.si.PAT.prototype.getPmtPid=function(){var e=x.ts.TsPacket.prototype.UNDEFINED_PID;if(this.m_listOfProgramAssociation.length>=1){var t=this.m_listOfProgramAssociation[0];e=t.getProgramMapPid()}return e},x.si.PAT.prototype.TABLE_ID=0,x.si.PAT.prototype.PID=0,x.si.ProgramAssociation=function(e){this.m_program_number=0,this.m_program_map_pid=0,this.parse(e)},x.si.ProgramAssociation.prototype.getProgramNumber=function(){return this.m_program_number},x.si.ProgramAssociation.prototype.getProgramMapPid=function(){return this.m_program_map_pid},x.si.ProgramAssociation.prototype.getLength=function(){return 4},x.si.ProgramAssociation.prototype.parse=function(e){this.m_program_number=x.binary.getValueFrom2Bytes(e.subarray(0,2)),this.m_program_map_pid=x.binary.getValueFrom2Bytes(e.subarray(2,4),3,13)},x.pes.PesPacket=function(){this.m_cStreamID=null,this.m_nPESPacketLength=null,this.m_cPESScramblingCtrl=null,this.m_bPESpriority=null,this.m_bDataAlignement=null,this.m_bCopyright=null,this.m_bOriginalOrCopy=null,this.m_cPES_header_data_length=null,this.m_cPTS_DTS_flags=null,this.m_bESCR_flag=null,this.m_bES_rate_flag=null,this.m_bDSM_trick_mode_flag=null,this.m_bAdditional_copy_info_flag=null,this.m_bPES_CRC_flag=null,this.m_bPES_extension_flag=null,this.m_pPTS=null,this.m_pDTS=null,this.m_pESCR=null,this.m_ES_rate=null,this.m_DSM_trick_mode=null,this.m_Additional_copy_info=null,this.m_PES_CRC=null,this.m_cNbStuffingBytes=null,this.m_pPESExtension=null,this.m_pPrivateData=null,this.m_payloadArray=null,this.m_nPayloadLength=null,this.m_bDirty=null,this.m_bValid=!1},x.pes.PesPacket.prototype.parse=function(e){var t=0;this.m_nLength=e.length;var n=x.binary.getValueFrom3Bytes(e.subarray(t,t+3));if(n===this.START_CODE_PREFIX){if(t=3,this.m_cStreamID=e[t],t++,this.m_nPESPacketLength=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_cStreamID===x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM)return void(this.m_bValid=!0);if(!this.hasOptionalPESHeader())return this.m_payloadArray=e.subarray(t+x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH),this.m_nPayloadLength=this.m_nLength-x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH,void(this.m_bValid=!0);var i=x.binary.getValueFromByte(e[t],0,2);if(2===i){this.m_cPESScramblingCtrl=x.binary.getValueFromByte(e[t],2,2),this.m_bPESpriority=x.binary.getBitFromByte(e[t],4),this.m_bDataAlignement=x.binary.getBitFromByte(e[t],5),this.m_bCopyright=x.binary.getBitFromByte(e[t],6),this.m_bOriginalOrCopy=x.binary.getBitFromByte(e[t],7),t++,this.m_cPTS_DTS_flags=x.binary.getValueFromByte(e[t],0,2),this.m_bESCR_flag=x.binary.getBitFromByte(e[t],2),this.m_bES_rate_flag=x.binary.getBitFromByte(e[t],3),this.m_bDSM_trick_mode_flag=x.binary.getBitFromByte(e[t],4),this.m_bAdditional_copy_info_flag=x.binary.getBitFromByte(e[t],5),this.m_bPES_CRC_flag=x.binary.getBitFromByte(e[t],6),this.m_bPES_extension_flag=x.binary.getBitFromByte(e[t],7),t++,this.m_cPES_header_data_length=255&e[t],t++,(this.m_cPTS_DTS_flags&x.pes.PesPacket.prototype.FLAG_PTS)==x.pes.PesPacket.prototype.FLAG_PTS&&(this.m_pPTS=new x.Pts(e.subarray(t,t+5)),t+=5),(this.m_cPTS_DTS_flags&x.pes.PesPacket.prototype.FLAG_DTS)==x.pes.PesPacket.prototype.FLAG_DTS&&(this.m_pDTS=new x.Pts(e.subarray(t,t+5)),t+=5),this.m_bESCR_flag&&(t+=6),this.m_bES_rate_flag&&(this.m_ES_rate=x.binary.getValueFrom3Bytes(e.subarray(t,t+3),1,22),t+=3),this.m_bDSM_trick_mode_flag&&(this.m_DSM_trick_mode=e[t],t++),this.m_bAdditional_copy_info_flag&&(this.m_Additional_copy_info=e[t],t++),this.m_bPES_CRC_flag&&(this.m_PES_CRC=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2),this.m_bPES_extension_flag;var r=x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length;this.m_cNbStuffingBytes=r-t,t+=this.m_cNbStuffingBytes,this.m_nPayloadLength=this.m_nLength-r,this.m_payloadArray=e.subarray(r,r+this.m_nPayloadLength),this.m_bValid=!0}}},x.pes.PesPacket.prototype.hasOptionalPESHeader=function(){return this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM},x.pes.PesPacket.prototype.getHeaderLength=function(){return x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length;
},x.pes.PesPacket.prototype.getPayload=function(){return this.m_payloadArray},x.pes.PesPacket.prototype.getPts=function(){return this.m_pPTS},x.pes.PesPacket.prototype.getDts=function(){return this.m_pDTS},x.pes.PesPacket.prototype.START_CODE_PREFIX=1,x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH=6,x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH=3,x.pes.PesPacket.prototype.FLAG_DTS=1,x.pes.PesPacket.prototype.FLAG_PTS=2,x.si.PMT=function(){x.si.PSISection.call(this,x.si.PMT.prototype.TABLE_ID),this.m_listOfComponents=[],this.m_PCR_PID=null,this.m_program_info_length=null},x.si.PMT.prototype=Object.create(x.si.PSISection.prototype),x.si.PMT.prototype.constructor=x.si.PMT,x.si.PMT.prototype.parse=function(e){var t=x.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){var n=this.getSectionLength()-this.SECTION_LENGTH;if(!(n<4)){this.m_PCR_PID=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),3),t+=2,this.m_program_info_length=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,t+=this.m_program_info_length,n=this.m_section_length-this.SECTION_LENGTH-4-this.m_program_info_length;for(var i=null;n>0;)i=new x.si.ESDescription(e.subarray(t,t+n)),this.m_listOfComponents.push(i),n-=i.getLength(),t+=i.getLength();this.m_bValid=!0}}},x.si.PMT.prototype.TABLE_ID=2,x.si.PMT.prototype.gStreamTypes=[{name:"Reserved",value:0,desc:"ITU-T | ISO/IEC Reserved"},{name:"MPEG1-Video",value:224,desc:"ISO/IEC 11172-2 Video"},{name:"MPEG2-Video",value:224,desc:"ITU-T Rec. H.262 | ISO/IEC 13818-2 Video or ISO/IEC 11172-2 constrained parameter video stream"},{name:"MPEG1-Audio",value:192,desc:"ISO/IEC 11172-3 Audio"},{name:"MPEG2-Audio",value:192,desc:"ISO/IEC 13818-3 Audio"},{name:"PRIVATE_SECTIONS",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 private_sections"},{name:"PRIVATE",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 PES packets containing private data"},{name:"MHEG",value:243,desc:"ISO/IEC 13522 MHEG"},{name:"MPEG1-DSM-CC",value:242,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 Annex A DSM-CC"},{name:"H.222.1",value:244,desc:"ITU-T Rec. H.222.1"},{name:"DSM-CC_A",value:244,desc:"ISO/IEC 13818-6 type A"},{name:"DSM-CC_B",value:245,desc:"ISO/IEC 13818-6 type B"},{name:"DSM-CC_C",value:246,desc:"ISO/IEC 13818-6 type C"},{name:"DSM-CC_D",value:247,desc:"ISO/IEC 13818-6 type D"},{name:"Auxiliary",value:0,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 auxiliary"},{name:"MPEG2-AAC-ADTS",value:192,desc:"ISO/IEC 13818-7 Audio with ADTS transport syntax"},{name:"MPEG4-Video",value:224,desc:"ISO/IEC 14496-2 Visual"},{name:"MPEG4-AAC-LATM",value:192,desc:"ISO/IEC 14496-3 Audio with the LATM transport syntax as defined in ISO/IEC 14496-3/AMD-1"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in PES packets"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in ISO/IEC14496_sections"},{name:"DSM-CC_SDP",value:0,desc:"ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"META_PES",value:252,desc:"Metadata carried in PES packets"},{name:"META_SECTIONS",value:252,desc:"Metadata carried in metadata_sections"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Data Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Object Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"MPEG2-IPMP",value:0,desc:"IPMP stream (defined in ISO/IEC 13818-11, MPEG-2 IPMP)"},{name:"H.264",value:224,desc:"AVC video stream as defined in ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"MPEG4AAC",value:192,desc:"ISO/IEC 14496-3 Audio, without using any additional transport syntax, such as DST, ALS and SLS"},{name:"MPEG4Text",value:0,desc:"ISO/IEC 14496-17 Text"},{name:"Aux. Video (23002-3)",value:30,desc:"Auxiliary video stream as defined in ISO/IEC 23002-3"},{name:"H.264-SVC",value:224,desc:"SVC video sub-bitstream of a video stream as defined in the Annex G of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"H.264-MVC",value:224,desc:"MVC video sub-bitstream of a video stream as defined in the Annex H of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"Reserved1",value:0,desc:"TBC Reserved"},{name:"Reserved2",value:0,desc:"TBC Reserved"},{name:"Reserved3",value:0,desc:"TBC Reserved"},{name:"HEVC",value:224,desc:"ITU.-T Rec H.26x | ISO/IEC 23008-2 video stream"}],x.si.PMT.prototype.MPEG2_VIDEO_STREAM_TYPE=2,x.si.PMT.prototype.AVC_VIDEO_STREAM_TYPE=27,x.si.PMT.prototype.MPEG1_AUDIO_STREAM_TYPE=3,x.si.PMT.prototype.MPEG2_AUDIO_STREAM_TYPE=4,x.si.PMT.prototype.AAC_AUDIO_STREAM_TYPE=17,x.si.PMT.prototype.AC3_AUDIO_STREAM_TYPE=6,x.si.PMT.prototype.SUB_STREAM_TYPE=6,x.si.PMT.prototype.STREAM_TYPE_MP1V=1,x.si.PMT.prototype.STREAM_TYPE_MP2V=2,x.si.PMT.prototype.STREAM_TYPE_MP1A=3,x.si.PMT.prototype.STREAM_TYPE_MP2A=4,x.si.PMT.prototype.STREAM_TYPE_PRIVATE=6,x.si.PMT.prototype.STREAM_TYPE_TELETEXT=6,x.si.PMT.prototype.STREAM_TYPE_DVBSUBTITLE=6,x.si.PMT.prototype.STREAM_TYPE_AC3=6,x.si.PMT.prototype.STREAM_TYPE_MP2AAC_ADTS=15,x.si.PMT.prototype.STREAM_TYPE_MP4AAC_LATM=17,x.si.PMT.prototype.STREAM_TYPE_H264=27,x.si.PMT.prototype.STREAM_TYPE_MP4AAC=28,x.si.PMT.prototype.STREAM_TYPE_AUX_23002_3=30,x.si.PMT.prototype.STREAM_TYPE_SVC=31,x.si.PMT.prototype.STREAM_TYPE_MVC=32,x.si.PMT.prototype.STREAM_TYPE_HEVC=36,x.si.ESDescription=function(e){this.m_stream_type=null,this.m_elementary_PID=null,this.m_ES_info_length=null,this.parse(e)},x.si.ESDescription.prototype.getStreamType=function(){return this.m_stream_type},x.si.ESDescription.prototype.getPID=function(){return this.m_elementary_PID},x.si.ESDescription.prototype.getLength=function(){return 5+this.m_ES_info_length},x.si.ESDescription.prototype.parse=function(e){this.m_stream_type=e[0],this.m_elementary_PID=x.binary.getValueFrom2Bytes(e.subarray(1,3),3),this.m_ES_info_length=x.binary.getValueFrom2Bytes(e.subarray(3,5),4)},x.Pts=function(e){var t,n,i=e[0]>>1&7;n=i>>2,t=(3&i)<<30>>>0;var r=e[1];t=(t|r<<22)>>>0;var o=e[2]>>1;t=(t|o<<15)>>>0;var s=e[3];t=(t|s<<7)>>>0;var a=e[4]>>1;t=(t|a)>>>0,this.m_lPTS=d.math.Long.fromBits(t,n).toNumber(),this.m_fPTS=this.m_lPTS/x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY},x.Pts.prototype.getValue=function(){return this.m_lPTS},x.Pts.prototype.getValueInSeconds=function(){return this.m_fPTS},x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY=9e4,x.ts.TsPacket=function(){this.m_cSync=null,this.m_bTransportError=null,this.m_bPUSI=null,this.m_bTransportPriority=null,this.m_nPID=null,this.m_cTransportScramblingCtrl=null,this.m_cAdaptationFieldCtrl=null,this.m_cContinuityCounter=null,this.m_pAdaptationField=null,this.m_payloadArray=null,this.m_cPayloadLength=null,this.m_bDirty=null,this.m_time=null,this.m_arrivalTime=null,this.m_bIgnored=null},x.ts.TsPacket.prototype.parse=function(e){var t=0;if(this.m_cSync=e[t],this.m_cSync===this.SYNC_WORD){if(t++,this.m_bTransportError=x.binary.getBitFromByte(e[t],0),this.m_bPUSI=x.binary.getBitFromByte(e[t],1),this.m_bTransportPriority=x.binary.getBitFromByte(e[t],2),this.m_nPID=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),3,13),t+=2,this.m_cTransportScramblingCtrl=x.binary.getValueFromByte(e[t],0,2),this.m_cAdaptationFieldCtrl=x.binary.getValueFromByte(e[t],2,2),this.m_cContinuityCounter=x.binary.getValueFromByte(e[t],4,4),t++,2&this.m_cAdaptationFieldCtrl){var n=e[t];if(n+t>=this.TS_PACKET_SIZE)return;this.m_pAdaptationField=new x.ts.AdaptationField,this.m_pAdaptationField.parse(e.subarray(t)),t+=this.m_pAdaptationField.getLength()}0!==this.m_cAdaptationFieldCtrl&&1&this.m_cAdaptationFieldCtrl&&(this.m_cPayloadLength=this.TS_PACKET_SIZE-t,this.m_payloadArray=e.subarray(t,t+this.m_cPayloadLength))}},x.ts.TsPacket.prototype.checkSyncWord=function(e){var t=0,n=e[t];return n===this.SYNC_WORD},x.ts.TsPacket.prototype.getPid=function(){return this.m_nPID},x.ts.TsPacket.prototype.getPayload=function(){return this.m_payloadArray},x.ts.TsPacket.prototype.getPayloadLength=function(){return this.m_cPayloadLength},x.ts.TsPacket.prototype.getPusi=function(){return this.m_bPUSI},x.ts.TsPacket.prototype.hasAdaptationFieldOnly=function(){return 2===this.m_cAdaptationFieldCtrl},x.ts.TsPacket.prototype.SYNC_WORD=71,x.ts.TsPacket.prototype.TS_PACKET_SIZE=188,x.ts.TsPacket.prototype.UNDEFINED_PID=65535,x.ts.TsPacket.prototype.PAT_PID=0,x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP=188,x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,x.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2=191,x.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM=240,x.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM=241,x.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM=242,x.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM=248,x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY=255,c=this.dijon,m})}).call(this,t("_process"))},{_process:94}],64:[function(t,n,i){!function(t,r){"function"==typeof e&&e.amd?e([],function(){return t.MetricsAgent=r()}):"object"==typeof i?n.exports=r():t.MetricsAgent=r()}(this,function(){function e(e){this.sessionId=null,this.video=e,this.browserId="browserid",this.metrics=[]}function t(e){this.debug=e}function n(e,t){this.player=e,this.video=this.player.getVideoModel().getElement(),this.database=t,this.sessionId=null,this.playerId=String(Math.random()).substring(2),this.metricAddedListener=this.onMetricAdded.bind(this),this.metricUpdatedListener=this.onMetricUpdated.bind(this),this.errorListener=this.onError.bind(this),this.timeupdateListener=this.onTimeupdate.bind(this),this.playbitrateListener=this.onPlaybitrate.bind(this),this.fullscreenchangeListener=this.onFullscreenchange.bind(this),this.closeListener=this.onClose.bind(this)}function i(e){AbstractFormatter.call(this,e),this.StateObject={},this.StateObject.Playing={count:0,duration:0,lastNewStateDuration:0},this.StateObject.Buffering={count:0,duration:0,lastNewStateDuration:0},this.StateObject.Paused={count:0,duration:0,lastNewStateDuration:0},this.StateObject.Stopped={count:0,duration:0,lastNewStateDuration:0},this.StateObject.Seeking={count:0,duration:0,lastNewStateDuration:0}}function r(e){var t=0;if(this.param=[],this.enable=!1,e)for(this.enable=!0,t=0;t<e.length;t+=1)this.param.push(parseInt(e[t],10))}function o(){this.enable=!1,this.error=null,this.profil=null,this.usage=null}function s(e,t){AbstractFormatter.call(this,e);var n=t.eventsObjectFilter&&t.eventsObjectFilter.length>0?t.eventsObjectFilter:this.DEFAULT_EVENTS_OBJECT_FILTER,i=t.eventTypeSessionFilter&&t.eventTypeSessionFilter.length>0?t.eventTypeSessionFilter:this.DEFAULT_EVENT_TYPE_SESSION_FILTER,r=t.eventTypeRealTimeFilter&&t.eventTypeRealTimeFilter.length>0?t.eventTypeRealTimeFilter:this.DEFAULT_EVENT_TYPE_REALTIME_FILTER,o=n.split(";");this.eventTypeSessionFilter=this.parseEventsFilter(i),this.eventTypeRealTimeFilter=this.parseEventsFilter(r),this.eventTypeSessionFilter.enable=o.indexOf("session")>-1,this.eventTypeRealTimeFilter.enable=o.indexOf("realtime")>-1}var a={};a=function(n){"use strict";var i="MetricsAgent",r="1.3.2",o="32e5ad0",s="2017-2-7_9:28:51",l=n,u=null,d=null,c=null,h=!1,f=null,p=null,m=null,g=null,y=null,v=!1,_=!1,b=null,E=function(e){var t;l.activationUrl&&l.activationUrl.length>0?y.http("GET",l.activationUrl,null,function(n,i){if(n<200||n>299)return void e(!1);try{t=JSON.parse(i).active,t=void 0!==t&&t,e(t)}catch(r){e(!1)}}):e(void 0===l.enable||l.enable)},x=function(e){var t;v||(v=!0,t=g.process(e),t&&y.http("POST",l.serverUrl,JSON.stringify(t)),v=!1)},S=function(){p.updateCurrentState(),p.updateCurrentEncoding(null,"video"),p.updateCurrentEncoding(null,"audio"),x()},T=function(e){var t=e.detail.metric;l.dbServerUrl&&y.http("POST",l.dbServerUrl,JSON.stringify(t)),t.hasOwnProperty("state")&&("stopped"===t.state.current?(clearInterval(b),b=null):b||(b=setInterval(function(){S()},l.sendingTime))),x(t)},w=function(n,i){u=n,d=n.getVideoModel().getElement(),c=n.getDebug(),c||(c=console),p=new e(d),m=new a.collectors[l.collector](u,p),g=new a.formatters[l.formatter](p,l),y=new t(c),f=null,v=!1,_=!1,E(function(e){h=e,c.log("[MetricsAgent]["+l.activationUrl+"] - Activation: "+h),h===!0&&(m.listen(),d.addEventListener("newMetricStored",T,!1)),i()})},D=function(e,t){h&&(f=g.generateSessionId(),p.init(f),m.init(f),g.init(),t())},M=function(){h&&(clearInterval(b),f=null)},I=function(){M()},L=function(){M(),d&&d.removeEventListener("newMetricStored",T),m.reset(),p=null,m=null,g=null,y=null};return{getVersion:function(){return r},getName:function(){return i},getBuildDate:function(){return s.indexOf("@@")===-1?s:"Not a builded version"},getVersionFull:function(){return o.indexOf("@@")===-1?r+"_"+o:r},init:w,load:D,stop:M,reset:I,destroy:L}},a.prototype={constructor:a},a.formatters={},a.collectors={},e.prototype.isDefined=function(e){return void 0!==e&&null!==e&&""!==e},e.prototype.init=function(e){this.clear(),this.sessionId=e,this.metrics.push({state:{current:"init"},date:(new Date).getTime()})},e.prototype.generateUUID=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:7&n|8).toString(16)});return t},e.prototype.getBrowserId=function(){return this.browserUUID},e.prototype.addMetric=function(e){e.date=(new Date).getTime(),this.processMetric(e)},e.prototype.processMetric=function(e){var t=!1,n=null,i=null,r=null,o=null,s=[],a=0,l=null;if(e.hasOwnProperty("session")&&(n=this.getMetricObject("session"))){for(l in e.session)this.isDefined(e.session[l])&&(n[l]=e.session[l]);t=!0}if(e.hasOwnProperty("state")&&(r=this.getMetric("state",!0)[0],r&&(e.state.previousState=r.state.current,e.state.previousTime=r.date,r.state.duration=e.date-r.date),n=this.getMetricObject("session"),n&&("buffering"!==e.state.current||n.startBufferingTime||(n.startBufferingTime=e.date),"playing"!==e.state.current||n.startPlayingTime||(n.startPlayingTime=e.date))),e.hasOwnProperty("encoding")&&(o=this.getMetric("encoding",!0,1,function(t){return t.contentType===e.encoding.contentType}),1===o.length&&(o[0].encoding.time=e.date-o[0].date)),e.hasOwnProperty("metadata")&&e.metadata.bitrates&&"video"===e.metadata.contentType&&(n=this.getMetricObject("session"))){for(a=0;a<e.metadata.bitrates.length;a+=1)s.push(e.metadata.bitrates[a].bitrate);n.minBitrate=Math.min.apply(null,s),n.maxBitrate=Math.max.apply(null,s)}if(e.hasOwnProperty("condition")&&(i=this.getMetricObject("condition"))){if(null!==e.condition.bandwidth&&(i.bandwidth=e.condition.bandwidth),null!==e.condition.videoWidth&&(i.videoWidth=e.condition.videoWidth,i.videoHeight=e.condition.videoHeight),null!==e.condition.fullScreen&&(i.fullScreen=e.condition.fullScreen),null!==e.condition.droppedFrames)if(null===i.droppedFrames)i.mt=e.condition.mt,i.droppedFrames=e.condition.droppedFrames,i.totalVideoFrames=e.condition.totalVideoFrames;else{var u=e.condition.mt-i.mt;u>1&&(i.mt=e.condition.mt,i.fps=(e.condition.totalVideoFrames-i.totalVideoFrames)/u,i.droppedFrames=e.condition.droppedFrames,i.totalVideoFrames=e.condition.totalVideoFrames)}t=!0}if(!t){this.metrics.push(e);var d=document.createEvent("CustomEvent");d.initCustomEvent("newMetricStored",!1,!1,{metric:e}),this.video.dispatchEvent(d)}},e.prototype.checkMetric=function(e,t,n){return!(!e.hasOwnProperty(t)||void 0!==n&&!n(e[t]))},e.prototype.getMetric=function(e,t,n,i){var r,o=[];if(void 0!==t&&t===!0)for(r=this.metrics.length-1;r>=0&&(!n||o.length<n);r--)this.checkMetric(this.metrics[r],e,i)&&o.push(this.metrics[r]);else for(r=0;r<this.metrics.length&&(!n||o.length<n);r+=1)this.checkMetric(this.metrics[r],e,i)&&o.push(this.metrics[r]);return o},e.prototype.getMetricObject=function(e,t,n){var i=this.getMetric(e,t,1,n);return i.length>0?i[0][e]:null},e.prototype.getMetricsObjects=function(e,t,n,i){var r=[],o=0,s=[],a=[];return t&&(o=t),n&&(o+=n),0===o||t&&!n?r=this.getMetric(e,!1,t,i):n&&!t?(r=this.getMetric(e,!0,n,i),r.reverse()):(s=this.getMetric(e,!1,void 0,i),r=this.getMetric(e,!1,t,i),a=o<s.length?this.getMetric(e,!0,n,i):this.getMetric(e,!0,s.length-t,i),r=r.concat(a.reverse()))},e.prototype.getMetrics=function(){return this.metrics},e.prototype.deleteMetrics=function(e){var t=0,n=!0;for(t=this.metrics.length-1;t>=0;t--)this.checkMetric(this.metrics[t],e)&&(n?n=!1:this.metrics.splice(t,1))},e.prototype.updateCurrentEncoding=function(e,t){var n=this.getMetric("encoding",!0,1,function(e){return e.contentType===t}),i=e?e:(new Date).getTime();1===n.length&&(n[0].encoding.time=i-n[0].date)},e.prototype.updateCurrentState=function(e){var t=this.getMetric("state",!0)[0],n=e?e:(new Date).getTime();t&&(t.state.duration=n-t.date,t.state.position=this.video.currentTime)},e.prototype.getCountState=function(e){var t=this.getMetrics(),n=0,i=t.length,r={count:0,duration:0};for(n=0;n<i;n++)t[n].hasOwnProperty("state")&&t[n].state.current===e&&(r.count++,r.duration+=t[n].state.duration);return r.duration=Math.round(r.duration),r},e.prototype.clear=function(){this.metrics=[]},t.prototype.http=function(e,t,n,i){var r=new XMLHttpRequest;r.open(e,t,!0),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.timeout=2e3,r.onloadend=r.onerror=function(){i&&i(r.status,r.response)},"GET"===e?r.send():(this.debug.log("[MetricsAgent]["+t+"] - Send message: "+n),r.send(n))};var l={};return l.Encoding=function(){"use strict";this.contentType=null,this.id=null,this.codec=null,this.index=null,this.bitrate=null,this.position=null,this.previousBitrate=null},l.Session=function(){this.id=null,this.playerid=null,this.playerType=null,this.browserid=null,this.userAgent=null,this.uri=null,this.provider=null,this.loopMode=null,this.loopCount=null,this.startTime=null,this.startBufferingTime=null,this.startPlayingTime=null,this.endTime=null,this.minBitrate=null,this.maxBitrate=null},l.MetaData=function(){this.contentType=null,this.codec=null,this.format=null,this.duration=-1,this.bitrates=[]},l.State=function(){this.current=null,this.position=null,this.previousState=null,this.previousTime=null,this.duration=null,this.reason=null},l.Action=function(){this.contentType=null,this.type=null,this.parameter=null,this.position=null},l.Condition=function(){this.videoWidth=null,this.videoHeight=null,this.fullScreen=null,this.bandwidth=null,this.droppedFrames=null,this.totalVideoFrames=null,this.fps=null},l.Error=function(){this.code=null,this.message=null,this.position=null,this.chunkURL=null},n.prototype.init=function(e){this.sessionId=e,this.previousVideoBandwith=0,this.previousAudioBandwith=0},n.prototype.listen=function(){this.customMetricsExtension=this.player.getMetricsExt(),this.player.addEventListener("metricAdded",this.metricAddedListener),this.player.addEventListener("metricUpdated",this.metricUpdatedListener),this.player.addEventListener("error",this.errorListener),this.video.addEventListener("play_bitrate",this.playbitrateListener),this.video.addEventListener("timeupdate",this.timeupdateListener),this.video.addEventListener("webkitfullscreenchange",this.fullscreenchangeListener),this.video.addEventListener("fullscreenchange",this.fullscreenchangeListener),this.video.parentElement.addEventListener("fullscreenchange",this.fullscreenchangeListener),this.video.parentElement.addEventListener("webkitfullscreenchange",this.fullscreenchangeListener),window.addEventListener("beforeunload",this.closeListener,!1)},n.prototype.reset=function(){this.player.removeEventListener("metricAdded",this.metricAddedListener),this.player.removeEventListener("metricUpdated",this.metricUpdatedListener),this.player.removeEventListener("error",this.errorListener),this.video.removeEventListener("play_bitrate",this.playbitrateListener),this.video.removeEventListener("timeupdate",this.timeupdateListener),this.video.removeEventListener("webkitfullscreenchange",this.fullscreenchangeListener),this.video.removeEventListener("fullscreenchange",this.fullscreenchangeListener),this.video.parentElement.removeEventListener("fullscreenchange",this.fullscreenchangeListener),this.video.parentElement.removeEventListener("webkitfullscreenchange",this.fullscreenchangeListener),window.removeEventListener("beforeunload",this.closeListener)},n.prototype.onMetricAdded=function(e){if(null!==this.sessionId&&e&&e.data){var t={};switch(e.data.metric){case"PlayList":t.action=this.mapActionObject(e.data),this.database.addMetric(t);break;case"State":"video"===e.data.stream&&(t.state=this.mapStateObject(e.data),this.database.addMetric(t));break;case"Session":t.session=this.mapSessionObject(e.data),this.database.addMetric(t),this.addState("stopped");break;case"ManifestReady":this.addState("startup"),this.sendMetaData("video");break;case"PlaybackQuality":t.condition=this.mapPlaybackQualityObject(e.data),this.database.addMetric(t);break;case"VideoResolution":t.condition=this.mapVideoResolutionObject(e.data),this.database.addMetric(t)}}},n.prototype.onMetricUpdated=function(e){if(null!==this.sessionId&&e&&e.data){var t={};switch(e.data.metric){case"HttpRequestTrace":t.condition=this.mapHttpRequestTraceObject(e.data),null!==t.condition&&this.database.addMetric(t)}}},n.prototype.onError=function(e){if(e&&e.data){var t=e.data,n={};switch(n.error=new l.Error,n.error.code=t.code,t.message&&(n.error.message=t.message),t.code){case"DOWNLOAD_ERR_MANIFEST":case"DOWNLOAD_ERR_SIDX":case"DOWNLOAD_ERR_CONTENT":case"DOWNLOAD_ERR_INIT":n.error.chunkURL=t.data.url,t.data.status&&(n.error.message+=" - status = "+t.data.status),t.data.request&&(n.error.message+=" - status = "+t.data.request.status)}t.data&&t.data.currentTime&&(n.error.position=t.data.currentTime),this.database.addMetric(n)}},n.prototype.onPlaybitrate=function(e){var t={data:{value:{}}},n={};t.data.stream=e.detail.type,t.data.bandwith=this.customMetricsExtension.getBandwidthForRepresentation(e.detail.representationId),t.data.codec=this.customMetricsExtension.getCodecsForRepresentation(e.detail.representationId),t.data.index=this.customMetricsExtension.getIndexForRepresentation(e.detail.representationId),t.data.max=this.customMetricsExtension.getMaxIndexForBufferType("video"),t.data.value.to=e.detail.representationId,t.data.value.mt=e.detail.time,n.encoding=this.mapEncodingObject(t.data),this.database.addMetric(n),"video"===t.data.stream?this.previousVideoBandwith=t.data.bandwith:"audio"===t.data.stream&&(this.previousAudioBandwith=t.data.bandwith)},n.prototype.onTimeupdate=function(){var e=this.database.getMetricObject("session");null!==e&&null!==e.startBufferingTime&&(void 0===e.maxPosition||this.video.currentTime>e.maxPosition)&&(e.maxPosition=this.video.currentTime)},n.prototype.onFullscreenchange=function(){var e={},t=new l.Condition;t.fullScreen=this.isVideoFullScreen(),e.condition=t,this.database.addMetric(e)},n.prototype.onClose=function(){null!==this.sessionId&&this.addState("stopped",0)},n.prototype.isVideoFullScreen=function(){return document.webkitIsFullScreen||document.msFullscreenElement||document.mozFullScreen?1:0},n.prototype.addState=function(e,t){var n={data:{value:{current:e,position:this.player.getVideoModel().getCurrentTime(),reason:t}}},i={};i.state=this.mapStateObject(n.data),this.database.addMetric(i)},n.prototype.sendMetaData=function(e){var t={},n={data:{contentType:e,codec:this.customMetricsExtension.getCodecForType(e),duration:this.customMetricsExtension.getDuration()}},i=this.customMetricsExtension.getBitratesWithResolutionForType(e),r=this.customMetricsExtension.getFormatForType(e);i.length>0&&(n.data.bitrates=i),r&&(n.data.format=r,t.metadata=this.mapMetaDataObject(n.data),this.database.addMetric(t))},n.prototype.mapSessionObject=function(e){if(e){var t=new l.Session;return t.id=this.sessionId,t.playerid=this.playerId,t.browserid=this.database.getBrowserId(),t.userAgent=navigator.userAgent,t.uri=e.value.uri,t.provider=document.location.href,t.loopMode=e.value.loopMode,t.startTime=(new Date).getTime(),t.endTime=e.value.endTime,t.playerType=e.value.playerType,t}},n.prototype.mapMetaDataObject=function(e){if(e){var t=new l.MetaData;return t.bitrates=e.bitrates,t.contentType=e.contentType,t.duration=e.duration,t.format=e.format,t.codec=e.codec,t}},n.prototype.mapStateObject=function(e){if(e&&e.value){var t=new l.State;return t.current=e.value.current,t.position=e.value.position,t.reason=e.value.reason,t}},n.prototype.mapHttpRequestTraceObject=function(e){if(e){var t,n,i=null;return e.stream&&"video"===e.stream&&(t=e.value,"Media Segment"===t.type&&t.tfinish&&(n=t.trace[t.trace.length-1]||null,i=new l.Condition,i.bandwidth=8e3*n.b[0]/(t.tfinish.getTime()-t.trequest.getTime()))),i}},n.prototype.mapPlaybackQualityObject=function(e){if(e&&e.value){var t=new l.Condition;return t.mt=e.value.mt,t.droppedFrames=e.value.droppedFrames,t.totalVideoFrames=e.value.totalVideoFrames,t}},n.prototype.mapVideoResolutionObject=function(e){if(e&&e.value){var t=new l.Condition;return t.videoWidth=e.value.width,t.videoHeight=e.value.height,t.fullScreen=this.isVideoFullScreen(),t}},n.prototype.mapErrorObject=function(e){if(e&&e.value){var t=new l.Error;return t.code=e.value.code,t.message=e.value.message,t}},n.prototype.mapActionObject=function(e){if(e&&e.value){var t=new l.Action;return t.contentType=e.stream,t.type=e.value.starttype,t.position=this.player.getVideoModel().getCurrentTime(),t}},n.prototype.mapEncodingObject=function(e){if(e&&e.value){var t=new l.Encoding;return t.contentType=e.stream,t.id=e.value.to,t.codec=e.codec,t.index=e.index,t.bitrate=e.bandwith,t.position=e.value.mt,"video"===e.stream?t.previousBitrate=this.previousVideoBandwith:"audio"===e.stream&&(t.previousBitrate=this.previousAudioBandwith),t}},a.collectors.HasPlayerCollector=n,AbstractFormatter=function(e){this.database=e},AbstractFormatter.prototype.init=function(){this.firstAccess=!0,this.msgnbr=0},AbstractFormatter.prototype.generateSessionId=function(e){return(new Date).getTime()+e+String(Math.random()).substring(2)},AbstractFormatter.prototype.formatPlayingObject=function(){var e=this.database.getCountState("playing");return e},AbstractFormatter.prototype.formatBufferingObject=function(){var e=this.database.getCountState("buffering");return e},AbstractFormatter.prototype.formatPausedObject=function(){var e=this.database.getCountState("paused");return e},AbstractFormatter.prototype.formatStoppedObject=function(){var e=this.database.getCountState("stopped");return e},AbstractFormatter.prototype.formatSeekingObject=function(){var e=this.database.getCountState("seeking");return e},AbstractFormatter.prototype.isVideo=function(e){return"video"===e.contentType},AbstractFormatter.prototype.isExcluded=function(e,t){return t.indexOf(e)>-1},AbstractFormatter.prototype.setFieldValue=function(e,t){void 0===t||null===t||""===t||this.isExcluded(e,this.excludedList)||("number"==typeof t&&isFinite(t)&&t%1!==0&&(t=Math.round(1e3*t)/1e3),this.data[e]=t)},a.formatters.AbstractFormatter=AbstractFormatter,i.prototype=Object.create(AbstractFormatter.prototype),i.prototype.constructor=i,i.prototype.init=function(){AbstractFormatter.prototype.init.call(this)},i.prototype.generateSessionId=function(){return AbstractFormatter.prototype.generateSessionId.call(this,".")},i.prototype.process=function(e){var t=null;return this.database?(e?e.hasOwnProperty("state")&&"init"!==e.state.current&&!this.firstAccess?t=this.formatterNewState(e):e.hasOwnProperty("metadata")?t=this.formatterMetadata():e.hasOwnProperty("encoding")&&"video"===e.encoding.contentType?t=this.formatterChangeBitrate():e.hasOwnProperty("error")&&(t=this.formatterError()):t=this.formatterRecurring(),t&&this.msgnbr++,t):t},i.prototype.updateFormatterState=function(e,t,n){if(t){switch(n.state.current){case"playing":this.StateObject.Playing.count+=e.Playing.count;break;case"buffering":this.StateObject.Buffering.count+=e.Buffering.count;break;case"paused":this.StateObject.Paused.count+=e.Paused.count;break;case"stopped":this.StateObject.Stopped.count+=e.Stopped.count;break;case"seeking":this.StateObject.Seeking.count+=e.Seeking.count}switch(n.state.previousState){case"playing":this.StateObject.Playing.lastNewStateDuration+=e.Playing.duration,this.StateObject.Playing.duration=this.StateObject.Playing.lastNewStateDuration;break;case"buffering":this.StateObject.Buffering.lastNewStateDuration+=e.Buffering.duration,this.StateObject.Buffering.duration=this.StateObject.Buffering.lastNewStateDuration;break;case"paused":this.StateObject.Paused.lastNewStateDuration+=e.Paused.duration,this.StateObject.Paused.duration=this.StateObject.Paused.lastNewStateDuration;break;case"stopped":this.StateObject.Stopped.lastNewStateDuration+=e.Stopped.duration,this.StateObject.Stopped.duration=this.StateObject.Stopped.lastNewStateDuration;break;case"seeking":this.StateObject.Seeking.lastNewStateDuration+=e.Seeking.duration,this.StateObject.Seeking.duration=this.StateObject.Stopped.lastNewStateDuration}}else switch(e.state.current){case"Playing":this.StateObject.Playing.duration=(e.Playing.duration+this.StateObject.Playing.lastNewStateDuration).toFixed(3);break;case"Buffering":this.StateObject.Buffering.duration=(e.Buffering.duration+this.StateObject.Buffering.lastNewStateDuration).toFixed(3);break;case"Paused":this.StateObject.Paused.duration=(e.Paused.duration+this.StateObject.Paused.lastNewStateDuration).toFixed(3);break;case"Stopped":this.StateObject.Stopped.duration=(e.Stopped.duration+this.StateObject.Stopped.lastNewStateDuration).toFixed(3);break;case"Seeking":this.StateObject.Seeking.duration=(e.Seeking.duration+this.StateObject.Seeking.lastNewStateDuration).toFixed(3)}},i.prototype.setStateObject=function(e){var t={};return t.count=e.count,t.duration=e.duration,t},i.prototype.formatterRecurring=function(){var e={};switch(e.type=0,e.session=this.formatSessionObject([]),e.state=this.formatStateObject([]),e.state.current){case"Playing":e.Playing=this.formatPlayingObject([]);break;case"Buffering":e.Buffering=this.formatBufferingObject([]);break;case"Paused":e.Paused=this.formatPausedObject([]);break;case"Stopped":e.Stopped=this.formatStoppedObject([]);break;case"Seeking":e.Seeking=this.formatSeekingObject([])}return this.updateFormatterState(e,!1),e.Playing=this.setStateObject(this.StateObject.Playing),e.Seeking=this.setStateObject(this.StateObject.Seeking),e.Stopped=this.setStateObject(this.StateObject.Stopped),e.Paused=this.setStateObject(this.StateObject.Paused),e.Buffering=this.setStateObject(this.StateObject.Buffering),e.encoding=this.formatEncodingObject([]),e.condition=this.formatConditionObject([]),e.error=this.formatErrorObject([]),this.formatStartuptime(e),this.firstAccess=!1,e},i.prototype.formatterNewState=function(e){var t={};return t.type=1,this.firstAccess?t.session=this.formatSessionObject([]):t.session=this.formatSessionObject(["playerid","browserid","uri","provider","repeatMode","repeatCount"]),t.state=this.formatStateObject([]),t.Playing=this.formatPlayingObject([]),t.Buffering=this.formatBufferingObject([]),t.Paused=this.formatPausedObject([]),t.Stopped=this.formatStoppedObject([]),t.Seeking=this.formatSeekingObject([]),this.updateFormatterState(t,!0,e),this.database.deleteMetrics("state"),this.database.deleteMetrics("action"),t.Playing=this.setStateObject(this.StateObject.Playing),t.Seeking=this.setStateObject(this.StateObject.Seeking),t.Stopped=this.setStateObject(this.StateObject.Stopped),t.Paused=this.setStateObject(this.StateObject.Paused),t.Buffering=this.setStateObject(this.StateObject.Buffering),t.encoding=this.formatEncodingObject([]),t.condition=this.formatConditionObject([]),t.error=this.formatErrorObject(["code"]),this.formatStartuptime(t),this.firstAccess=!1,t},i.prototype.formatterMetadata=function(){var e={};return e.type=2,this.firstAccess?e.session=this.formatSessionObject([]):e.session=this.formatSessionObject(["playerid","browserid","uri","provider","repeatMode","repeatCount"]),e.metadata=this.formatMetadataObject([]),this.firstAccess=!1,e},i.prototype.formatterChangeBitrate=function(){var e={};
return e.type=3,this.firstAccess?e.session=this.formatSessionObject([]):e.session=this.formatSessionObject(["playerid","browserid","uri","provider","repeatMode","repeatCount"]),e.state=this.formatStateObject(["previous","previoustime","progress"]),e.encoding=this.formatEncodingObject([]),e.condition=this.formatConditionObject([]),this.database.deleteMetrics("encoding"),this.firstAccess=!1,e},i.prototype.formatterError=function(){var e={};switch(e.type=10,this.firstAccess?e.session=this.formatSessionObject([]):e.session=this.formatSessionObject(["playerid","browserid","uri","provider","repeatMode","repeatCount"]),e.state=this.formatStateObject([]),e.state.current){case"Playing":e.Playing=this.formatPlayingObject([]);break;case"Buffering":e.Buffering=this.formatBufferingObject([]);break;case"Paused":e.Paused=this.formatPausedObject([]);break;case"Stopped":e.Stopped=this.formatStoppedObject([]);break;case"Seeking":e.Seeking=this.formatSeekingObject([])}return this.updateFormatterState(e,!1),e.Playing=this.setStateObject(this.StateObject.Playing),e.Seeking=this.setStateObject(this.StateObject.Seeking),e.Stopped=this.setStateObject(this.StateObject.Stopped),e.Paused=this.setStateObject(this.StateObject.Paused),e.Buffering=this.setStateObject(this.StateObject.Buffering),e.encoding=this.formatEncodingObject([]),e.condition=this.formatConditionObject([]),e.error=this.formatErrorObject([]),this.formatStartuptime(e),this.firstAccess=!1,e},i.prototype.formatSessionObject=function(e){var t,n=this.database.getMetricObject("session");return null===n?{}:(this.data={},this.excludedList=e,this.setFieldValue("id",n.id),this.setFieldValue("playerid",n.playerid),this.setFieldValue("browserid",n.browserid),this.data.msgnbr=this.msgnbr,n.hasOwnProperty("uri")&&!this.isExcluded("uri",this.excludedList)&&(t=document.createElement("a"),t.href=n.uri,this.data.uri="/"==t.pathname.charAt(0)?t.pathname:"/"+t.pathname,this.data.dhost=t.hostname),this.setFieldValue("provider",n.provider),this.setFieldValue("repeatMode",n.loopMode),this.setFieldValue("repeatCount",n.loopCount),this.data)},i.prototype.formatStateObject=function(e){function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}var n=this.database.getMetricObject("state",!0);return null===n?{}:(this.data={},this.excludedList=e,this.setFieldValue("current",t(n.current)),this.setFieldValue("detail",n.reason),this.setFieldValue("previous",t(n.previousState)),this.setFieldValue("previoustime",n.previousTime),this.setFieldValue("progress",n.position),this.data)},i.prototype.formatEncodingObject=function(e){var t=this.database.getMetricObject("encoding",!0,this.isVideo),n=this.database.getMetricObject("metadata",!0,this.isVideo);return null===n||null===t?{}:(this.data={},this.excludedList=e,this.setFieldValue("current",n.bitrates[t.index]),this.setFieldValue("min",0),this.setFieldValue("max",n.bitrates[n.bitrates.length-1]),this.data)},i.prototype.formatStartuptime=function(e){var t=this.database.getMetricObject("session");t&&t.startTime&&t.startPlayingTime&&(e.startuptime=Math.round(t.startPlayingTime-t.startTime)/1e3)},i.prototype.formatConditionObject=function(e){var t=this.database.getMetricObject("condition");return null===t?{}:(this.data={},this.excludedList=e,this.setFieldValue("fdc",t.droppedFrames),this.setFieldValue("wsize",null!==t.videoWidth?t.videoWidth+"x"+t.videoHeight:null),this.setFieldValue("full",t.fullScreen),this.setFieldValue("fps",t.fps),this.setFieldValue("dspeed",t.bandwidth/1e3),this.data)},i.prototype.formatErrorObject=function(e){var t={},n=this.database.getMetrics(),i=0,r=n.length,o=null;if(!this.isExcluded("count",e))for(t.count=0,i=0;i<r;i+=1)n[i].hasOwnProperty("error")&&t.count++;return this.isExcluded("code",e)||(o=this.database.getMetricObject("error",!0),null!==o&&(t.code=o.code,t.message=o.message)),t},i.prototype.formatMetadataObject=function(e){var t,n=this.database.getMetricObject("session"),i=this.database.getMetricObject("metadata",!1,this.isVideo);return this.data={},this.excludedList=e,this.setFieldValue("playertype",n.playerType),null===i?this.data:(i.hasOwnProperty("duration")&&(t=i.duration<0?"LIVE":"VOD"),this.setFieldValue("videoid",i.id),this.setFieldValue("encodingbr",i.bitrates),this.setFieldValue("contenttype",t),this.setFieldValue("contentduration",i.duration),this.setFieldValue("encodingformat",i.codec),this.setFieldValue("encapsulation",i.format),this.data)},a.formatters.CSQoE=i,o.prototype.setFilter=function(e,t){this[e]=t},o.prototype.isEnabled=function(){return this.enable},s.prototype=Object.create(AbstractFormatter.prototype),s.prototype.constructor=s,s.prototype.parseEventsFilter=function(e){var t,n=new o,i=e.split(";"),s=[],a=0,l=0;for(a=0;a<i.length;a+=1)for(t=i[a].split(","),s[t[0]]=[],l=1;l<t.length;l+=1)s[t[0]].push(t[l]);return n.setFilter("error",new r(s.error)),n.setFilter("profil",new r(s.profil)),n.setFilter("usage",new r(s.usage)),n},s.prototype.init=function(){AbstractFormatter.prototype.init.call(this),this.duration=0},s.prototype.generateSessionId=function(){return AbstractFormatter.prototype.generateSessionId.call(this,"-")},s.prototype.process=function(e){var t=null;return this.database?(e?(e.hasOwnProperty("metadata")&&void 0!==e.metadata.duration&&(this.duration=e.metadata.duration),e.hasOwnProperty("session")?t=this.formatterSession():e.hasOwnProperty("error")?t=this.formatterRealTime("/has/realtime/error/"):e.hasOwnProperty("action")&&this.eventTypeRealTimeFilter.usage.enable===!0?t=this.formatterRealTime("/has/realtime/use/"):e.hasOwnProperty("encoding")&&this.eventTypeRealTimeFilter.profil.enable===!0?t=this.formatterRealTime("/has/realtime/profil/"):e.hasOwnProperty("state")&&this.firstAccess===!1&&("stopped"===e.state.current&&"init"!==e.state.previousState?t=this.formatterSession():"buffering"===e.state.current&&(t=this.formatterRealTime("/has/realtime/error/","buffering")))):t=this.formatterRecurring(),t&&this.msgnbr++,t):t},s.prototype.formatterRecurring=function(){return this.duration>=0?null:this.formatterSession(["status"])},s.prototype.formatterRealTime=function(e,t){var n,i,r,o=[],s={},a={};if(o.push((new Date).getTime()),o.push(e),!this.eventTypeRealTimeFilter.isEnabled())return null;switch(s=this.formatSessionObject(["playerId","browserid","uuid","status"]),e){case"/has/realtime/use/":a=this.formatLastActionObject([]);break;case"/has/realtime/profil/":a=this.formatLastEncodingObject([]);break;case"/has/realtime/error/":if(t&&"buffering"===t){if(n=this.database.getMetricObject("state",!0),null===n)return null;i=new l.Error,i.code=0,i.message="buffering state",i.position=this.formatPositionValue(n.position),a=this.formatErrorObject([],i)}else a=this.formatLastErrorObject([]);if(a.Condition=this.formatTheConditionObject([]),this.eventTypeRealTimeFilter.error.enable===!1||this.eventTypeRealTimeFilter.error.enable===!0&&this.eventTypeRealTimeFilter.error.param.indexOf(a.orangeErrorCode)===-1)return null}for(r in a)s[r]=a[r];return s.Playing=this.formatPlayingObject([]),s.Buffering=this.formatBufferingObject([]),s.Seeking=this.formatSeekingObject([]),s.Paused=this.formatPausedObject([]),s.State=this.formatStateObject(),s.msgnbr=this.msgnbr,o.push(s),o},s.prototype.formatterSession=function(){var e=[],t={};return e.push((new Date).getTime()),e.push("/has/session/"),this.eventTypeSessionFilter.isEnabled()?(t=this.formatSessionObject([]),t.MetaData=this.formatMetadataObject([]),t.events={},t.events.usage=[],t.events.error=[],t.events.profil=[],t.events.profil=this.formatMetricsList("encoding",this.eventTypeSessionFilter.profil.param[0],this.eventTypeSessionFilter.profil.param[1],this.isVideo),t.events.usage=this.formatMetricsList("action",this.eventTypeSessionFilter.usage.param[0],this.eventTypeSessionFilter.usage.param[1],this.isVideo),t.events.error=this.formatMetricsList("error",this.eventTypeSessionFilter.error.param[0],this.eventTypeSessionFilter.error.param[1]),t.counts={},t.counts.error=[],t.counts.profil=[],t.counts.playing=this.formatPlayingObject([]),t.counts.buffering=this.formatBufferingObject([]),t.counts.seeking=this.formatSeekingObject([]),t.counts.paused=this.formatPausedObject([]),t.counts.profil=this.getCountsMetricTypeObject("encoding","bitrate",["originBitrate","position"],this.isVideo),t.counts.error=this.getCountsMetricTypeObject("error","orangeErrorCode",["chunkURL","errorCode","comment"]),e.push(t),e):null},s.prototype.formatMetricsList=function(e,t,n,i){var r=[],o=this.database.getMetricsObjects(e,t,n,i),s=0;if(o.length>0)for(s=0;s<o.length;s+=1)switch(e){case"encoding":r.push(this.formatEncodingObject([],o[s][e]));break;case"action":var a=this.formatActionObject([],o[s][e]);this.setFieldValue("date",o[s].date),r.push(a);break;case"error":r.push(this.formatErrorObject([],o[s][e]));break;default:return[]}return r},s.prototype.getCountsMetricTypeObject=function(e,t,n,i){var r=this.database.getMetricsObjects(e,void 0,void 0,i);return this.formatMetricCounts(n,r,e,t)},s.prototype.formatSessionObject=function(e){var t,n,i=this.database.getMetricObject("session");return null===i?{}:(this.data={},this.excludedList=e,this.setFieldValue("clientSessionId",i.id),this.setFieldValue("playerId",i.playerid),this.setFieldValue("uuid",void 0),this.setFieldValue("url",i.uri),this.setFieldValue("userAgent",i.userAgent),this.setFieldValue("contentId",void 0),this.setFieldValue("minBitrate",i.minBitrate),this.setFieldValue("maxBitrate",i.maxBitrate),this.setFieldValue("startLaunchDate",i.startTime),this.setFieldValue("startBufferingDate",i.startBufferingTime),this.setFieldValue("watchStartDate",i.startPlayingTime),this.setFieldValue("status","IN_PROGRESS"),this.firstAccess===!0?this.firstAccess=!1:(n=this.database.getMetricObject("state",!0),null!==n&&"stopped"===n.current&&(2===n.reason?this.setFieldValue("status","KO"):this.setFieldValue("status","OK"),this.setFieldValue("maxPosition",this.formatPositionValue(i.maxPosition)),this.setFieldValue("watchEndDate",(new Date).getTime()))),t=this.database.getMetricObject("metadata",!0,this.isVideo),null===t?this.data:(this.setFieldValue("contentDuration",t.duration),this.data))},s.prototype.formatStateObject=function(){function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}var t=this.database.getMetricObject("state",!0);return null===t?{}:(this.data={},this.data.current=e(t.current),this.data.detail=t.reason,this.data.previous=e(t.previousState),this.data.previoustime=t.previousTime,this.data)},s.prototype.formatEncodingObject=function(e,t){return this.excludedList=e,this.data={},this.setFieldValue("originBitrate",t.previousBitrate),this.setFieldValue("changeBitrate",t.bitrate),this.setFieldValue("position",this.formatPositionValue(t.position)),this.data},s.prototype.formatMetricCounts=function(e,t,n,i){var r,o=0,s=0,a=t.length,l=[],u=[],d=0,c=0,h=null;for(o=0;o<a;o+=1)if(h=t[o][n],r=h[i],d=1,c=t[o][n].time,void 0===u[r]){for(s=o+1;s<a;s+=1)t[s][n][i]===r&&(d++,"encoding"===n&&(c+=t[s][n].time));if("encoding"===n)this.formatEncodingObject(e,h),this.setFieldValue("time",c);else{if("error"!==n)return{};this.formatErrorObject(e,h)}this.setFieldValue("nb",d),l.push(this.data),u[r]=!0}return l},s.prototype.formatLastEncodingObject=function(e){var t=this.database.getMetricObject("encoding",!0,this.isVideo);return null===t?{}:this.formatEncodingObject(e,t)},s.prototype.formatActionObject=function(e,t){var n=-1;switch(this.data={},this.excludedList=e,t.type){case"seek":n=this.USE_SEEK;break;case"play":n=this.USE_PLAY;break;case"pause":n=this.USE_PAUSE;break;case"initial_start":n=this.USE_PLAY}return this.setFieldValue("typeCode",n),this.setFieldValue("position",this.formatPositionValue(t.position)),this.data},s.prototype.formatLastActionObject=function(e){var t=this.database.getMetricObject("action",!0);return null===t?{}:this.formatActionObject(e,t)},s.prototype.formatTheConditionObject=function(e){var t=this.database.getMetricObject("condition");return null===t?{}:this.formatConditionObject(e,t)},s.prototype.formatConditionObject=function(e,t){return this.data={},this.excludedList=e,this.setFieldValue("fdc",t.droppedFrames),this.setFieldValue("wsize",null!==t.videoWidth?t.videoWidth+"x"+t.videoHeight:null),this.setFieldValue("full",t.fullScreen),this.setFieldValue("fps",t.fps),this.setFieldValue("dspeed",t.bandwidth/1e3),this.data},s.prototype.formatErrorObject=function(e,t){switch(this.data={},this.excludedList=e,t.code){case 0:this.setFieldValue("orangeErrorCode",this.ORANGE_STALLED_STREAM_ERROR);break;case"MEDIA_KEYERR":case"MEDIA_KEYERR_UNKNOWN":case"MEDIA_KEYERR_CLIENT":case"MEDIA_KEYERR_SERVICE":case"MEDIA_KEYERR_OUTPUT":case"MEDIA_KEYERR_HARDWARECHANGE":case"MEDIA_KEYERR_DOMAIN":case"MEDIA_KEYSYSERR_ACCESS_DENIED":case"MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN":case"MEDIA_KEYMESSERR_NOCHALLENGE":case"MEDIA_KEYMESSERR_XHR_ABORTED":case"MEDIA_KEYMESSERR_XHR_ERROR":case"MEDIA_KEYMESSERR_NO_SESSION":case"MEDIA_KEYMESSERR_NO_REMOVE_SESSION":case"MEDIA_KEYMESSERR_NO_CLOSE_SESSION":case"MEDIA_ERR_DECODE":case"MEDIA_ERR_ENCRYPTED":case"CAPABILITY_ERR_MEDIAKEYS":case"MEDIA_ERR_SRC_NOT_SUPPORTED":case"MANIFEST_ERR_CODEC":this.setFieldValue("orangeErrorCode",this.ORANGE_DRM_OR_DECODER_ERROR);break;case"CC_ERR_PARSE":case"MEDIA_ERR_APPEND_SOURCEBUFFER":case"MEDIA_ERR_REMOVE_SOURCEBUFFER":case"MEDIA_ERR_CREATE_SOURCEBUFFER":case"MANIFEST_ERR_PARSE":case"MANIFEST_ERR_NOSTREAM":case"CAPABILITY_ERR_MEDIASOURCE":case"HASPLAYER_INIT_ERROR":this.setFieldValue("orangeErrorCode",this.ORANGE_UNDEFINED_PLAYER_ERROR);break;case"DOWNLOAD_ERR_MANIFEST":case"DOWNLOAD_ERR_CONTENT":case"DOWNLOAD_ERR_INIT":case"DOWNLOAD_ERR_SIDX":case"MEDIA_ERR_ABORTED":case"MEDIA_ERR_NETWORK":this.setFieldValue("orangeErrorCode",this.ORANGE_HTTP_ERROR);break;default:this.setFieldValue("orangeErrorCode",this.ORANGE_UNDEFINED_PLAYER_ERROR)}return this.setFieldValue("chunkURL",t.chunkURL),this.setFieldValue("position",this.formatPositionValue(t.position)),this.setFieldValue("errorCode",t.code),this.setFieldValue("comment",t.message),this.data},s.prototype.formatLastErrorObject=function(e){var t=this.database.getMetricObject("error",!0);return null===t?{}:this.formatErrorObject(e,t)},s.prototype.formatMetadataObject=function(e){var t,n,i=this.database.getMetricObject("session"),r=this.database.getMetricObject("metadata",!1,this.isVideo);return this.data={},this.excludedList=e,this.setFieldValue("playerType",i.playerType),null===r?this.data:(r.hasOwnProperty("duration")&&(t=r.duration<0?"LIVE":"VOD"),this.setFieldValue("encodingBr",r.bitrates),this.setFieldValue("contentType",t),this.setFieldValue("encodingFormat",r.codec),this.setFieldValue("encapsulation",r.format),n=this.database.getMetricObject("condition"),null===n?this.data:(this.setFieldValue("fdc",n.droppedFrames),this.data))},s.prototype.formatPositionValue=function(e){return Math.round(1e3*e)},s.prototype.DEFAULT_EVENTS_OBJECT_FILTER="session;realtime",s.prototype.DEFAULT_EVENT_TYPE_SESSION_FILTER="error;profil;usage",s.prototype.DEFAULT_EVENT_TYPE_REALTIME_FILTER="error;profil",s.prototype.ORANGE_STREAM_BROKEN_ERROR=10,s.prototype.ORANGE_HTTP_ERROR=20,s.prototype.ORANGE_STALLED_STREAM_ERROR=30,s.prototype.ORANGE_DRM_OR_DECODER_ERROR=40,s.prototype.ORANGE_DRM_NO_LICENSE=41,s.prototype.ORANGE_DRM_INVALID_LICENSE=42,s.prototype.ORANGE_DRM_INVALID_LICENSE2=43,s.prototype.ORANGE_GENERIC_ERROR=50,s.prototype.ORANGE_UNDEFINED_PLAYER_ERROR=99,s.prototype.ORANGE_DEVICE_CRASH_ERROR=100,s.prototype.USE_PLAY=1,s.prototype.USE_PAUSE=2,s.prototype.USE_STOP=3,s.prototype.USE_FAST_FORWARD=4,s.prototype.USE_FAST_BACKWARD=5,s.prototype.USE_SEEK=6,a.formatters.Prisme=s,a})},{}],65:[function(e,t,n){"use strict";var i=function(){var e={},t=e.hasOwnProperty;return{subscribe:function(n,i){t.call(e,n)||(e[n]=[]);var r=e[n].push(i)-1;return{remove:function(){delete e[n][r]}}},publish:function(n,i){t.call(e,n)&&e[n].forEach(function(e){e(void 0!=i?i:{})})}}}();t.exports=i},{}],66:[function(t,n,i){(function(){var t,i=[].slice;t=function(e,t){var n,r,o,s,a,l,u,d,c,h,f,p,m,g,y,v;return null==t&&(t={}),c=function(){var t;return null!=(t=e._parentCore)?t.i18n:void 0},r="en",a=function(){return(("undefined"!=typeof navigator&&null!==navigator?navigator.language:void 0)||("undefined"!=typeof navigator&&null!==navigator?navigator.browserLanguage:void 0)||r).split("-")[0]},o="i18n",u=function(e,t,n,i){var r,o;return(null!=(r=t[n])?r[e]:void 0)||(null!=(o=i[n])?o[e]:void 0)},s=function(e,t,n,i){return null==t&&(t={}),null==n&&(n=""),u(e,t,n,i)||u(e,t,n.substring(0,2),i)||u(e,t,r,i)||e},n=function(e,t){var n,i,r,o,s;if("object"!=typeof e)return!1;s=[];for(i in e)r=e[i],null==t[i]&&(t[i]={}),s.push(function(){var e,s;s=[];for(n in r)o=r[n],s.push(null!=(e=t[i])[n]?e[n]:e[n]=o);return s}());return s},f=new e.Mediator,h=a(),d=t.global||{},e.getBrowserLanguage=a,e.baseLanguage=r,l=function(){return h},y=function(){return f.off.apply(f,[o].concat(i.call(arguments)))},p=function(){return f.on.apply(f,[o].concat(i.call(arguments)))},g=function(e){if("string"==typeof e)return h=e,f.emit(o,h)},m=function(e){var t;return"object"==typeof e&&(null!=(t=c())?t.setGlobal(e):d=e,!0)},v=function(e,t){var n;return null!=(n=c())?n._(e,t):s(e,t,h,d)},e.i18n={setLanguage:g,getLanguage:l,setGlobal:m,onChange:p,_:v,unsubscribe:y},e.Sandbox.prototype.i18n={onChange:p,unsubscribe:y,getLanguage:l},{id:"i18n",init:function(e){return e.i18n.addLocal=function(t){var i;return null==(i=e.options).i18n&&(i.i18n={}),n(t,e.options.i18n)},e._=function(t){return v(t,e.options.localDict||e.options.i18n)}}}},null!=("undefined"!=typeof e&&null!==e?e.amd:void 0)?e(function(){return t}):null!=("undefined"!=typeof n&&null!==n?n.exports:void 0)?n.exports=t:null!=("undefined"!=typeof window&&null!==window?window.scaleApp:void 0)&&(window.scaleApp.plugins.i18n=t)}).call(this)},{}],67:[function(t,n,i){(function(){var t,i={}.hasOwnProperty,r=function(e,t){function n(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};t=function(e,t){var n,i;return null==t&&(t={}),i=["register","start","stop","on","off","emit"],n=function(e,t){var n,r,o,s;for(e.sub={},r=function(n){return e.sub[n]=function(){return t[n].apply(t,arguments),e}},o=0,s=i.length;o<s;o++)n=i[o],r(n);if(null!=t.permission)return e.sub.permission={add:t.permission.add,remove:t.permission.remove}},{init:function(i,o,s){var a,l,u,d,c,h,f,p,m,g,y;if(i._subCore=d=new e.constructor,d._parentCore=e,t.useGlobalMediator?e._mediator.installTo(d._mediator,!0):null!=t.mediator&&null!=(m=t.mediator)&&"function"==typeof m.installTo&&m.installTo(d._mediator,!0),d.Sandbox=a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t}(e.Sandbox),u=[],t.inherit)for(g=e._plugins,c=0,f=g.length;c<f;c++)l=g[c],u.push({plugin:l.creator,options:l.options});if(t.use instanceof Array)for(y=t.use,h=0,p=y.length;h<p;h++)l=y[h],u.push(l);else"function"==typeof t.use&&u.push(t.use);return d.use(u).boot(function(e){return e?s(e):(n(i,d),s())})},destroy:function(e){return e._subCore.stop()}}},null!=("undefined"!=typeof e&&null!==e?e.amd:void 0)?e(function(){return t}):null!=("undefined"!=typeof n&&null!==n?n.exports:void 0)?n.exports=t:null!=("undefined"!=typeof window&&null!==window?window.scaleApp:void 0)&&(window.scaleApp.plugins.submodule=t)}).call(this)},{}],68:[function(t,n,i){(function(){var t,i,r,o,s,a,l,u,d,c,h,f,p,m=[].slice;l=/function[^(]*\(([^)]*)\)/,o=/([^\s,]+)/g,u=function(e){var t;return((null!=e&&null!=(t=e.toString().match(l))?t[1]:void 0)||"").match(o)||[]},c=function(e,t,n){var i,r,o,s,a,l,u,d,c;if(null==e&&(e=[]),null==t&&(t=function(){}),i=e.length,a=[],0===i)return t(null,a);for(r=[],o=!1,c=[],s=u=0,d=e.length;u<d;s=++u)l=e[s],c.push(function(e,s){var l,u;u=function(){var e,l;if(e=arguments[0],l=2<=arguments.length?m.call(arguments,1):[],e){if(r[s]=e,o=!0,!n)return t(r,a)}else a[s]=l.length<2?l[0]:l;if(--i<=0)return o?t(r,a):t(null,a)};try{return e(u)}catch(d){return l=d,u(l)}}(l,s));return c},h=function(e,t,n){var i,r,o,s,a,l;return null==e&&(e=[]),null==t&&(t=function(){}),s=-1,i=e.length,l=[],0===i?t(null,l):(r=[],o=!1,(a=function(){var u,d,c;if(d=arguments[0],c=2<=arguments.length?m.call(arguments,1):[],d){if(r[s]=d,o=!0,!n)return t(r,l)}else s>-1&&(l[s]=c.length<2?c[0]:c);if(++s>=i)return o?t(r,l):t(null,l);try{return e[s](a)}catch(h){return u=h,a(u)}})())},d=function(e,t,n){var i,r,o,s,a;return null==e&&(e=[]),null==t&&(t=function(){}),o=-1,i=e.length,a=null,0===i?t(null):(r=[],(s=function(){var a,l,u;if(l=arguments[0],u=2<=arguments.length?m.call(arguments,1):[],l){if(r[o]=l,!n)return t(r)}else if(o>-1)return t(null,u.length<2?u[0]:u);if(++o>=i)return t(r);try{return e[o](s)}catch(d){return a=d,s(a)}})())},f=function(e,t){var n,i;return n=-1,0===e.length?t():(i=function(){var r,o;return r=arguments[0],o=2<=arguments.length?m.call(arguments,1):[],null!=r?t(r):++n>=e.length?t.apply(null,[null].concat(m.call(o))):e[n].apply(e,m.call(o).concat([i]))})()},a=function(e,t,n,i){var r,o;return null==e&&(e=[]),o=function(){var n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(function(e){return function(n){return t(e,n)}}(r));return o}(),p.runParallel(o,n,i)},p={doForAll:a,runParallel:c,runSeries:h,runFirst:d,runWaterfall:f,getArgumentNames:u,hasArgument:function(e,t){return null==t&&(t=1),p.getArgumentNames(e).length>=t}},i=function(){function e(e,t){this.cascadeChannels=null!=t&&t,this.channels={},e instanceof Object?this.installTo(e):e===!0&&(this.cascadeChannels=!0)}var t;return e.prototype.on=function(t,n,i){var r,o,s,a,l,u,d,c,h,f;if(null==i&&(i=this),null==(u=this.channels)[t]&&(u[t]=[]),a=this,t instanceof Array){for(h=[],d=0,c=t.length;d<c;d++)r=t[d],h.push(this.on(r,n,i));return h}if("object"==typeof t){f=[];for(o in t)l=t[o],f.push(this.on(o,l,n));return f}return"string"==typeof t&&(s={context:i,callback:n||function(){}},{attach:function(){return a.channels[t].push(s),this},detach:function(){return e._rm(a,t,s.callback),this},pipe:function(){return a.pipe.apply(a,[t].concat(m.call(arguments))),this}}.attach())},e.prototype.off=function(t,n){var i;switch(typeof t){case"string":"function"==typeof n&&e._rm(this,t,n),"undefined"==typeof n&&e._rm(this,t);break;case"function":for(i in this.channels)e._rm(this,i,t);break;case"undefined":for(i in this.channels)e._rm(this,i);break;case"object":for(i in this.channels)e._rm(this,i,null,t)}return this},t=function(e,t,n,i){var r,o,s,a,l;for(o=i.channels[t]||[],l=[],s=0,a=o.length;s<a;s++)r=o[s],l.push(function(t){return function(i){var r;try{return p.hasArgument(t.callback,3)?t.callback.apply(t.context,[e,n,i]):i(null,t.callback.apply(t.context,[e,n]))}catch(o){return r=o,i(r)}}}(r));return l},e.prototype.emit=function(e,n,i,r){var o,s,a;return null==i&&(i=function(){}),null==r&&(r=e),"function"==typeof n&&(i=n,n=void 0),"string"==typeof e&&(a=t(n,e,r,this),p.runSeries(a,function(e,t){var n,r;return e&&(n=new Error(function(){var t,n,i;for(i=[],t=0,n=e.length;t<n;t++)r=e[t],null!=r&&i.push(r.message);return i}().join("; "))),i(n)},!0),this.cascadeChannels&&(o=e.split("/")).length>1&&(this.emitOriginalChannels&&(s=r),this.emit(o.slice(0,-1).join("/"),n,i,s)),this)},e.prototype.send=function(e,n,i){var r;return null==i&&(i=function(){}),"function"==typeof n&&(i=n,n=void 0),"string"==typeof e&&(r=t(n,e,e,this),p.runFirst(r,function(e,t){var n,r;return e?(n=new Error(function(){var t,n,i;for(i=[],t=0,n=e.length;t<n;t++)r=e[t],null!=r&&i.push(r.message);return i}().join("; ")),i(n)):i(null,t)},!0),this)},e.prototype.installTo=function(e,t){var n,i;if("object"==typeof e)for(n in this)i=this[n],t?e[n]=i:null==e[n]&&(e[n]=i);return this},e.prototype.pipe=function(t,n,i){return n instanceof e&&(i=n,n=t),null==i?this.pipe(t,n,this):i===this&&t===n?this:(this.on(t,function(){return i.emit.apply(i,[n].concat(m.call(arguments)))}),this)},e._rm=function(e,t,n,i){var r;if(null!=e.channels[t])return e.channels[t]=function(){var o,s,a,l;for(a=e.channels[t],l=[],o=0,s=a.length;o<s;o++)r=a[o],(null!=n?r.callback!==n:null!=i?r.context!==i:r.context!==e)&&l.push(r);return l}()},e}(),s=function(e,t,n){if(typeof t!==e)return""+n+" has to be a "+e},t=function(){function e(e){var t;if(this.Sandbox=e,null!=this.Sandbox&&(t=s("function",this.Sandbox,"Sandbox")),t)throw new Error(t);this._modules={},this._plugins=[],this._instances={},this._sandboxes={},this._running={},this._mediator=new i(this),this.Mediator=i,null==this.Sandbox&&(this.Sandbox=function(e,t,n,i){return this.instanceId=t,this.options=null!=n?n:{},this.moduleId=i,e._mediator.installTo(this),this})}return e.prototype.log={error:function(){},log:function(){},info:function(){},warn:function(){},enable:function(){}},e.prototype.register=function(e,t,n){var i;return null==n&&(n={}),(i=s("string",e,"module ID")||s("function",t,"creator")||s("object",n,"option parameter"))?(this.log.error("could not register module '"+e+"': "+i),this):e in this._modules?(this.log.warn("module "+e+" was already registered"),this):(this._modules[e]={creator:t,options:n,id:e},this)},e.prototype.start=function(e,t,n){var i,r,o;return null==t&&(t={}),null==n&&(n=function(){}),0===arguments.length?this._startAll():e instanceof Array?this._startAll(e,t):"function"==typeof e?this._startAll(null,e):("function"==typeof t&&(n=t,t={}),(i=s("string",e,"module ID")||s("object",t,"second parameter")||(this._modules[e]?void 0:"module doesn't exist"))?this._startFail(i,n):(r=t.instanceId||e,this._running[r]===!0?this._startFail(new Error("module was already started"),n):(o=function(e){return function(t,o,s){if(t)return e._startFail(t,n);try{return p.hasArgument(o.init,2)?o.init(s,function(t){return t||(e._running[r]=!0),n(t)}):(o.init(s),e._running[r]=!0,n())}catch(a){return i=a,e._startFail(i,n)}}}(this),this.boot(function(i){return function(r){return r?i._startFail(r,n):i._createInstance(e,t,o)}}(this)))))},e.prototype._startFail=function(e,t){return this.log.error(e),t(new Error("could not start module: "+e.message)),this},e.prototype._createInstance=function(e,t,n){var i,r,o,s,a,l,u,d,c,h,f,p;if(o=t.instanceId||e,u=t.options,a=this._modules[e],this._instances[o])return n(this._instances[o]);for(r={},p=[a.options,u],h=0,f=p.length;h<f;h++)if(l=p[h])for(s in l)c=l[s],null==r[s]&&(r[s]=c);return i="function"==typeof t.sandbox?t.sandbox:this.Sandbox,d=new i(this,o,r,e),this._runSandboxPlugins("init",d,function(e){return function(t){var i;return i=new a.creator(d),"function"!=typeof i.init?n(new Error("module has no 'init' method")):(e._instances[o]=i,e._sandboxes[o]=d,n(null,i,r))}}(this))},e.prototype._runSandboxPlugins=function(e,t,n){var i,r;return r=function(){var n,r,o,s,a;for(o=this._plugins,a=[],n=0,r=o.length;n<r;n++)i=o[n],"function"==typeof(null!=(s=i.plugin)?s[e]:void 0)&&a.push(function(n){var i;return i=n.plugin[e],function(e){return p.hasArgument(i,3)?i(t,n.options,e):(i(t,n.options),e())}}(i));return a}.call(this),p.runSeries(r,n,!0)},e.prototype._startAll=function(e,t){var n,i,r;return null==e&&(e=function(){var e;e=[];for(i in this._modules)e.push(i);return e}.call(this)),r=function(e){return function(t,n){return e.start(t,e._modules[t].options,n)}}(this),n=function(n){var i,r,o,s,a,l,u,d;if((null!=n?n.length:void 0)>0){for(a={},r=u=0,d=n.length;u<d;r=++u)l=n[r],null!=l&&(a[e[r]]=l);s=function(){var e;e=[];for(o in a)e.push("'"+o+"'");return e}(),i=new Error("errors occurred in the following modules: "+s),i.moduleErrors=a}return"function"==typeof t?t(i):void 0},p.doForAll(e,r,n,!0),this},e.prototype.stop=function(e,t){var n,i;return null==t&&(t=function(){}),0===arguments.length||"function"==typeof e?p.doForAll(function(){var e;e=[];for(i in this._instances)e.push(i);return e}.call(this),function(e){return function(){return e.stop.apply(e,arguments)}}(this),e,!0):(n=this._instances[e])&&(delete this._instances[e],this._mediator.off(n),this._runSandboxPlugins("destroy",this._sandboxes[e],function(i){return function(r){return p.hasArgument(n.destroy)?n.destroy(function(n){return delete i._running[e],t(r||n)}):("function"==typeof n.destroy&&n.destroy(),delete i._running[e],t(r))}}(this))),this},e.prototype.use=function(e,t){var n,i,r;if(e instanceof Array)for(i=0,r=e.length;i<r;i++)switch(n=e[i],typeof n){case"function":this.use(n);break;case"object":this.use(n.plugin,n.options)}else{if("function"!=typeof e)return this;this._plugins.push({creator:e,options:t})}return this},e.prototype.boot=function(e){var t,n,i;return t=this,i=function(){var e,i,r,o;for(r=this._plugins,o=[],e=0,i=r.length;e<i;e++)n=r[e],n.booted!==!0&&o.push(function(e){return p.hasArgument(e.creator,3)?function(n){var i;return i=e.creator(t,e.options,function(t){return t||(e.booted=!0,e.plugin=i),n()})}:function(n){return e.plugin=e.creator(t,e.options),e.booted=!0,n()}}(n));return o}.call(this),p.runSeries(i,e,!0),this},e}(),r={VERSION:"0.5.0",util:p,Mediator:i,Core:t,plugins:{},modules:{}},null!=("undefined"!=typeof e&&null!==e?e.amd:void 0)?e(function(){return r}):null!=("undefined"!=typeof n&&null!==n?n.exports:void 0)?n.exports=r:"undefined"!=typeof window&&null!==window&&null==window.scaleApp&&(window.scaleApp=r)}).call(this)},{}],69:[function(e,t,n){var i=function(){function e(e){return null==e?String(e):G[X.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function i(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(t){return"object"==e(t)}function o(e){return r(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function s(e){return"number"==typeof e.length}function a(e){return C.call(e,function(e){return null!=e})}function l(e){return e.length>0?T.fn.concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function d(e){return e in F?F[e]:F[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function c(e,t){return"number"!=typeof t||N[u(e)]?t:t+"px"}function h(e){var t,n;return P[e]||(t=A.createElement(e),A.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),P[e]=n),P[e]}function f(e){return"children"in e?R.call(e.children):T.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function p(e,t){var n,i=e?e.length:0;for(n=0;n<i;n++)this[n]=e[n];this.length=i,this.selector=t||""}function m(e,t,n){for(S in t)n&&(o(t[S])||J(t[S]))?(o(t[S])&&!o(e[S])&&(e[S]={}),J(t[S])&&!J(e[S])&&(e[S]=[]),m(e[S],t[S],n)):t[S]!==x&&(e[S]=t[S])}function g(e,t){return null==t?T(e):T(e).filter(t)}function y(e,n,i,r){return t(n)?n.call(e,i,r):n}function v(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function _(e,t){var n=e.className||"",i=n&&n.baseVal!==x;return t===x?i?n.baseVal:n:void(i?n.baseVal=t:e.className=t)}function b(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?T.parseJSON(e):e):e}catch(t){return e}}function E(e,t){t(e);for(var n=0,i=e.childNodes.length;n<i;n++)E(e.childNodes[n],t)}var x,S,T,w,D,M,I=[],L=I.concat,C=I.filter,R=I.slice,A=window.document,P={},F={},N={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},B=/^\s*<(\w+|!)[^>]*>/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,O=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,U=/^(?:body|html)$/i,H=/([A-Z])/g,V=["val","css","html","text","data","width","height","offset"],j=["after","prepend","before","append"],q=A.createElement("table"),z=A.createElement("tr"),Y={tr:A.createElement("tbody"),tbody:q,thead:q,tfoot:q,td:z,th:z,"*":A.createElement("div")},K=/complete|loaded|interactive/,W=/^[\w-]*$/,G={},X=G.toString,$={},Q=A.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},J=Array.isArray||function(e){
return e instanceof Array};return $.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var i,r=e.parentNode,o=!r;return o&&(r=Q).appendChild(e),i=~$.qsa(r,t).indexOf(e),o&&Q.removeChild(e),i},D=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},M=function(e){return C.call(e,function(t,n){return e.indexOf(t)==n})},$.fragment=function(e,t,n){var i,r,s;return k.test(e)&&(i=T(A.createElement(RegExp.$1))),i||(e.replace&&(e=e.replace(O,"<$1></$2>")),t===x&&(t=B.test(e)&&RegExp.$1),t in Y||(t="*"),s=Y[t],s.innerHTML=""+e,i=T.each(R.call(s.childNodes),function(){s.removeChild(this)})),o(n)&&(r=T(i),T.each(n,function(e,t){V.indexOf(e)>-1?r[e](t):r.attr(e,t)})),i},$.Z=function(e,t){return new p(e,t)},$.isZ=function(e){return e instanceof $.Z},$.init=function(e,n){var i;if(!e)return $.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&B.test(e))i=$.fragment(e,RegExp.$1,n),e=null;else{if(n!==x)return T(n).find(e);i=$.qsa(A,e)}else{if(t(e))return T(A).ready(e);if($.isZ(e))return e;if(J(e))i=a(e);else if(r(e))i=[e],e=null;else if(B.test(e))i=$.fragment(e.trim(),RegExp.$1,n),e=null;else{if(n!==x)return T(n).find(e);i=$.qsa(A,e)}}return $.Z(i,e)},T=function(e,t){return $.init(e,t)},T.extend=function(e){var t,n=R.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){m(e,n,t)}),e},$.qsa=function(e,t){var n,i="#"==t[0],r=!i&&"."==t[0],o=i||r?t.slice(1):t,s=W.test(o);return e.getElementById&&s&&i?(n=e.getElementById(o))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:R.call(s&&!i&&e.getElementsByClassName?r?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},T.contains=A.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},T.type=e,T.isFunction=t,T.isWindow=n,T.isArray=J,T.isPlainObject=o,T.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},T.inArray=function(e,t,n){return I.indexOf.call(t,e,n)},T.camelCase=D,T.trim=function(e){return null==e?"":String.prototype.trim.call(e)},T.uuid=0,T.support={},T.expr={},T.noop=function(){},T.map=function(e,t){var n,i,r,o=[];if(s(e))for(i=0;i<e.length;i++)n=t(e[i],i),null!=n&&o.push(n);else for(r in e)n=t(e[r],r),null!=n&&o.push(n);return l(o)},T.each=function(e,t){var n,i;if(s(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(i in e)if(t.call(e[i],i,e[i])===!1)return e;return e},T.grep=function(e,t){return C.call(e,t)},window.JSON&&(T.parseJSON=JSON.parse),T.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()}),T.fn={constructor:$.Z,length:0,forEach:I.forEach,reduce:I.reduce,push:I.push,sort:I.sort,splice:I.splice,indexOf:I.indexOf,concat:function(){var e,t,n=[];for(e=0;e<arguments.length;e++)t=arguments[e],n[e]=$.isZ(t)?t.toArray():t;return L.apply($.isZ(this)?this.toArray():this,n)},map:function(e){return T(T.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return T(R.apply(this,arguments))},ready:function(e){return K.test(A.readyState)&&A.body?e(T):A.addEventListener("DOMContentLoaded",function(){e(T)},!1),this},get:function(e){return e===x?R.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return I.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):T(C.call(this,function(t){return $.matches(t,e)}))},add:function(e,t){return T(M(this.concat(T(e,t))))},is:function(e){return this.length>0&&$.matches(this[0],e)},not:function(e){var n=[];if(t(e)&&e.call!==x)this.each(function(t){e.call(this,t)||n.push(this)});else{var i="string"==typeof e?this.filter(e):s(e)&&t(e.item)?R.call(e):T(e);this.forEach(function(e){i.indexOf(e)<0&&n.push(e)})}return T(n)},has:function(e){return this.filter(function(){return r(e)?T.contains(this,e):T(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:T(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:T(e)},find:function(e){var t,n=this;return t=e?"object"==typeof e?T(e).filter(function(){var e=this;return I.some.call(n,function(t){return T.contains(t,e)})}):1==this.length?T($.qsa(this[0],e)):this.map(function(){return $.qsa(this,e)}):T()},closest:function(e,t){var n=this[0],r=!1;for("object"==typeof e&&(r=T(e));n&&!(r?r.indexOf(n)>=0:$.matches(n,e));)n=n!==t&&!i(n)&&n.parentNode;return T(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=T.map(n,function(e){if((e=e.parentNode)&&!i(e)&&t.indexOf(e)<0)return t.push(e),e});return g(t,e)},parent:function(e){return g(M(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return f(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||R.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return C.call(f(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return T.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=h(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var n=t(e);if(this[0]&&!n)var i=T(e).get(0),r=i.parentNode||this.length>1;return this.each(function(t){T(this).wrapAll(n?e.call(this,t):r?i.cloneNode(!0):i)})},wrapAll:function(e){if(this[0]){T(this[0]).before(e=T(e));for(var t;(t=e.children()).length;)e=t.first();T(e).append(this)}return this},wrapInner:function(e){var n=t(e);return this.each(function(t){var i=T(this),r=i.contents(),o=n?e.call(this,t):e;r.length?r.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){T(this).replaceWith(T(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=T(this);(e===x?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return T(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return T(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var n=this.innerHTML;T(this).empty().append(y(this,e,t,n))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var n=y(this,e,t,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(e,t){var n;return"string"!=typeof e||1 in arguments?this.each(function(n){if(1===this.nodeType)if(r(e))for(S in e)v(this,S,e[S]);else v(this,e,y(this,t,n,this.getAttribute(e)))}):this.length&&1===this[0].nodeType?!(n=this[0].getAttribute(e))&&e in this[0]?this[0][e]:n:x},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){v(this,e)},this)})},prop:function(e,t){return e=Z[e]||e,1 in arguments?this.each(function(n){this[e]=y(this,t,n,this[e])}):this[0]&&this[0][e]},data:function(e,t){var n="data-"+e.replace(H,"-$1").toLowerCase(),i=1 in arguments?this.attr(n,t):this.attr(n);return null!==i?b(i):x},val:function(e){return 0 in arguments?this.each(function(t){this.value=y(this,e,t,this.value)}):this[0]&&(this[0].multiple?T(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var n=T(this),i=y(this,e,t,n.offset()),r=n.offsetParent().offset(),o={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,n){if(arguments.length<2){var i,r=this[0];if(!r)return;if(i=getComputedStyle(r,""),"string"==typeof t)return r.style[D(t)]||i.getPropertyValue(t);if(J(t)){var o={};return T.each(t,function(e,t){o[t]=r.style[D(t)]||i.getPropertyValue(t)}),o}}var s="";if("string"==e(t))n||0===n?s=u(t)+":"+c(t,n):this.each(function(){this.style.removeProperty(u(t))});else for(S in t)t[S]||0===t[S]?s+=u(S)+":"+c(S,t[S])+";":this.each(function(){this.style.removeProperty(u(S))});return this.each(function(){this.style.cssText+=";"+s})},index:function(e){return e?this.indexOf(T(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&I.some.call(this,function(e){return this.test(_(e))},d(e))},addClass:function(e){return e?this.each(function(t){if("className"in this){w=[];var n=_(this),i=y(this,e,t,n);i.split(/\s+/g).forEach(function(e){T(this).hasClass(e)||w.push(e)},this),w.length&&_(this,n+(n?" ":"")+w.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===x)return _(this,"");w=_(this),y(this,e,t,w).split(/\s+/g).forEach(function(e){w=w.replace(d(e)," ")}),_(this,w.trim())}})},toggleClass:function(e,t){return e?this.each(function(n){var i=T(this),r=y(this,e,n,_(this));r.split(/\s+/g).forEach(function(e){(t===x?!i.hasClass(e):t)?i.addClass(e):i.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===x?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===x?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),i=U.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(T(e).css("margin-top"))||0,n.left-=parseFloat(T(e).css("margin-left"))||0,i.top+=parseFloat(T(t[0]).css("border-top-width"))||0,i.left+=parseFloat(T(t[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||A.body;e&&!U.test(e.nodeName)&&"static"==T(e).css("position");)e=e.offsetParent;return e})}},T.fn.detach=T.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});T.fn[e]=function(r){var o,s=this[0];return r===x?n(s)?s["inner"+t]:i(s)?s.documentElement["scroll"+t]:(o=this.offset())&&o[e]:this.each(function(t){s=T(this),s.css(e,y(this,r,t,s[e]()))})}}),j.forEach(function(t,n){var i=n%2;T.fn[t]=function(){var t,r,o=T.map(arguments,function(n){return t=e(n),"object"==t||"array"==t||null==n?n:$.fragment(n)}),s=this.length>1;return o.length<1?this:this.each(function(e,t){r=i?t:t.parentNode,t=0==n?t.nextSibling:1==n?t.firstChild:2==n?t:null;var a=T.contains(A.documentElement,r);o.forEach(function(e){if(s)e=e.cloneNode(!0);else if(!r)return T(e).remove();r.insertBefore(e,t),a&&E(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},T.fn[i?t+"To":"insert"+(n?"Before":"After")]=function(e){return T(e)[t](this),this}}),$.Z.prototype=p.prototype=T.fn,$.uniq=M,$.deserializeValue=b,T.zepto=$,T}();window.Zepto=i,void 0===window.$&&(window.$=i),n.Zepto=window.Zepto,n.$=window.$,function(e){function t(e){return e._zid||(e._zid=h++)}function n(e,n,o,s){if(n=i(n),n.ns)var a=r(n.ns);return(g[t(e)]||[]).filter(function(e){return e&&(!n.e||e.e==n.e)&&(!n.ns||a.test(e.ns))&&(!o||t(e.fn)===t(o))&&(!s||e.sel==s)})}function i(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function r(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function o(e,t){return e.del&&!v&&e.e in _||!!t}function s(e){return b[e]||v&&_[e]||e}function a(n,r,a,l,d,h,f){var p=t(n),m=g[p]||(g[p]=[]);r.split(/\s/).forEach(function(t){if("ready"==t)return e(document).ready(a);var r=i(t);r.fn=a,r.sel=d,r.e in b&&(a=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return r.fn.apply(this,arguments)}),r.del=h;var p=h||a;r.proxy=function(e){if(e=u(e),!e.isImmediatePropagationStopped()){e.data=l;var t=p.apply(n,e._args==c?[e]:[e].concat(e._args));return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},r.i=m.length,m.push(r),"addEventListener"in n&&n.addEventListener(s(r.e),r.proxy,o(r,f))})}function l(e,i,r,a,l){var u=t(e);(i||"").split(/\s/).forEach(function(t){n(e,t,r,a).forEach(function(t){delete g[u][t.i],"removeEventListener"in e&&e.removeEventListener(s(t.e),t.proxy,o(t,l))})})}function u(t,n){return!n&&t.isDefaultPrevented||(n||(n=t),e.each(T,function(e,i){var r=n[e];t[e]=function(){return this[i]=E,r&&r.apply(n,arguments)},t[i]=x}),(n.defaultPrevented!==c?n.defaultPrevented:"returnValue"in n?n.returnValue===!1:n.getPreventDefault&&n.getPreventDefault())&&(t.isDefaultPrevented=E)),t}function d(e){var t,n={originalEvent:e};for(t in e)S.test(t)||e[t]===c||(n[t]=e[t]);return u(n,e)}var c,h=1,f=Array.prototype.slice,p=e.isFunction,m=function(e){return"string"==typeof e},g={},y={},v="onfocusin"in window,_={focus:"focusin",blur:"focusout"},b={mouseenter:"mouseover",mouseleave:"mouseout"};y.click=y.mousedown=y.mouseup=y.mousemove="MouseEvents",e.event={add:a,remove:l},e.proxy=function(n,i){var r=2 in arguments&&f.call(arguments,2);if(p(n)){var o=function(){return n.apply(i,r?r.concat(f.call(arguments)):arguments)};return o._zid=t(n),o}if(m(i))return r?(r.unshift(n[i],n),e.proxy.apply(null,r)):e.proxy(n[i],n);throw new TypeError("expected function")},e.fn.bind=function(e,t,n){return this.on(e,t,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,n,i){return this.on(e,t,n,i,1)};var E=function(){return!0},x=function(){return!1},S=/^([A-Z]|returnValue$|layer[XY]$)/,T={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,n){return this.on(t,e,n)},e.fn.undelegate=function(e,t,n){return this.off(t,e,n)},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,i,r,o){var s,u,h=this;return t&&!m(t)?(e.each(t,function(e,t){h.on(e,n,i,t,o)}),h):(m(n)||p(r)||r===!1||(r=i,i=n,n=c),(p(i)||i===!1)&&(r=i,i=c),r===!1&&(r=x),h.each(function(c,h){o&&(s=function(e){return l(h,e.type,r),r.apply(this,arguments)}),n&&(u=function(t){var i,o=e(t.target).closest(n,h).get(0);if(o&&o!==h)return i=e.extend(d(t),{currentTarget:o,liveFired:h}),(s||r).apply(o,[i].concat(f.call(arguments,1)))}),a(h,t,r,i,n,u||s)}))},e.fn.off=function(t,n,i){var r=this;return t&&!m(t)?(e.each(t,function(e,t){r.off(e,n,t)}),r):(m(n)||p(i)||i===!1||(i=n,n=c),i===!1&&(i=x),r.each(function(){l(this,t,i,n)}))},e.fn.trigger=function(t,n){return t=m(t)||e.isPlainObject(t)?e.Event(t):u(t),t._args=n,this.each(function(){t.type in _&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,n)})},e.fn.triggerHandler=function(t,i){var r,o;return this.each(function(s,a){r=d(m(t)?e.Event(t):t),r._args=i,r.target=a,e.each(n(a,t.type||t),function(e,t){if(o=t.proxy(r),r.isImmediatePropagationStopped())return!1})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),e.Event=function(e,t){m(e)||(t=e,e=t.type);var n=document.createEvent(y[e]||"Events"),i=!0;if(t)for(var r in t)"bubbles"==r?i=!!t[r]:n[r]=t[r];return n.initEvent(e,i,!0),u(n)}}(i)},{}],70:[function(e,t,n){"use strict";var i=function(){return{init:function(t,n,i){t.container.removeClass("playerVodService").addClass("playerLiveService"),i.load({name:"MainModule",constructor:e("./live/modules/main/main"),args:[t.container,n,t],startOnLoad:!0,container:t.videoContainer}),i.load({name:"VideoModule",constructor:e("./live/modules/video/video"),args:[n],options:{hasPlayer:t.hasPlayer},template:'<div id="'+n+'-VideoModule" class="op-video"></div>',priority:0,startOnLoad:!0,container:t.videoContainer}),i.load({name:"LoadingModule",constructor:e("./common/modules/loading-buffer/loading"),args:[n],template:'<div id="'+n+'-LoadingModule" class="op-loading"></div>',priority:10,container:t.videoContainer}),i.load({name:"AccessibilityModule",constructor:e("./common/modules/accessibility/accessibility"),args:[t.container,n],options:{lastMenuClass:".op-menu-shortcuts",lastSettingsMenuClass:".op-settings-menu-quality",firstControlBarButtonClass:".op-control-menu"},priority:1e3})},onInitSetwordingDone:function(t,n,i,r){r.load({name:"MenuModule",constructor:e("./live/modules/menu/menu"),args:[i],options:n,template:'<div id="'+i+'-MenuModule" class="op-menu op-show-translate-up"></div>',priority:30,container:t.videoContainer}),r.load({name:"SettingsMenuModule",constructor:e("./live/modules/settings-menu/settings-menu"),args:[i],options:n,template:'<div id="'+i+'-SettingsMenuModule" class="op-settings-menu"></div>',priority:30,container:t.videoContainer}),r.load({name:"InfoBannerModule",constructor:e("./live/modules/info-banner/info-banner"),args:[i],options:n,template:'<div id="'+i+'-InfoBannerModule" class="op-info-banner"></div>',priority:10,container:t.videoContainer}),r.load({name:"MiddleContainerModule",constructor:e("./live/modules/middle-container/middle-container"),args:[i],options:n,template:'<div id="'+i+'-MiddleContainerModule" class="op-middle-container"></div>',priority:40,container:t.videoContainer}),r.load({name:"ControlBarModule",constructor:e("./live/modules/control-bar/control-bar"),args:[i],options:n,template:'<div id="'+i+'-ControlBarModule" class="op-control-bar"></div>',priority:20,container:t.videoContainer}),r.load({name:"FeedbackModule",constructor:e("./common/modules/feedback/feedback"),args:[i],options:n,template:'<div id="'+i+'-FeedbackModule" class="op-feedback"></div>',priority:50,container:t.videoContainer})}}}();t.exports=i},{"./common/modules/accessibility/accessibility":1,"./common/modules/feedback/feedback":14,"./common/modules/loading-buffer/loading":19,"./live/modules/control-bar/control-bar":42,"./live/modules/info-banner/info-banner":45,"./live/modules/main/main":46,"./live/modules/menu/menu":48,"./live/modules/middle-container/middle-container":49,"./live/modules/settings-menu/settings-menu":58,"./live/modules/video/video":59}],71:[function(e,t,n){"use strict";var i=e("moment"),r=function(){function e(e){var t=y[e];t&&(clearTimeout(t.id),t.id=setTimeout(t.fn,t.timer))}function t(e,t,n){y[e]||(y[e]={fn:t,id:setTimeout(t,n),timer:n})}function n(e){var t=y[e];t&&(clearTimeout(t.id),o(e))}function o(e){y[e]=null}function s(e){var t=parseInt(e,10),n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),r=t-3600*n-60*i,o=null;return n<10&&(n=n),i<10&&(i="0"+i),r<10&&(r="0"+r),o=n+":"+i+":"+r}function a(e){var t=parseInt(e/60),n=Math.floor(60*(e/60-t)),i=null;return t<10&&(t="0"+t),n<10&&(n="0"+n),i=t+":"+n}function l(e,t){var n=i.unix((e+t)/1e3).format("HH:mm");return n}function u(e,t,n,r){var o=i.unix((e+n)/1e3),s=o.add(t,"ms");return r&&(s=s.format("HH:mm")),s}function d(e){var t=c()||{};$.extend(!0,t,e);try{window.localStorage.setItem("webtv-html5-player-preferences",JSON.stringify(t))}catch(n){}}function c(){var e={};try{e=JSON.parse(window.localStorage.getItem("webtv-html5-player-preferences"))}catch(t){}return e}function h(e,t){var n,t=t||2;e.find("svg").each(function(e,i){n=i;for(var r=0;r<t;r++)n=n.parentNode;i.setAttribute("aria-label",n.title)})}function f(e){(!e[0].complete||"undefined"==typeof e[0].naturalWidth||e[0].naturalWidth<=1||e[0].naturalHeight<=1)&&e.remove()}function p(e,t){e.length&&t?(e.on("load error",function(){r.deleteEmptyImage(e)}),e.attr("src",t)):e.remove()}function m(e){var t=e.playerConfig.getConfig();return document.webkitFullscreenElement||document.fullscreenElement||document.msFullscreenElement||"undefined"!=typeof t.config.defaultPlayerStates&&"undefined"!=typeof t.config.defaultPlayerStates.playerIsInOffScreenMode&&"true"===t.config.defaultPlayerStates.playerIsInOffScreenMode}function g(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}var y={};return{refreshTimeout:e,initTimeout:t,cancelTimeout:n,destroyTimeout:o,setTimeWithSeconds:s,setTimeWithMinutes:a,setTimeWithTimestamp:l,setFinalTimeWithTimestampAndDuration:u,storePreferences:d,getPreferences:c,copyTitleToSVG:h,deleteEmptyImage:f,handleEmptyableImg:p,isSoloMode:m,detectionMobileTablet:g}}();t.exports=r},{moment:92}],72:[function(e,t,n){function i(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}t.exports=i},{}],73:[function(e,t,n){t.exports=function(e,t){var n=t||document;if(n.createStyleSheet){var i=n.createStyleSheet();return i.cssText=e,i.ownerNode}var r=n.getElementsByTagName("head")[0],o=n.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(n.createTextNode(e)),r.appendChild(o),o},t.exports.byUrl=function(e){if(document.createStyleSheet)return document.createStyleSheet(e).ownerNode;var t=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.href=e,t.appendChild(n),n}},{}],74:[function(e,t,n){(function(e){function n(){try{var e=new i("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(t){}return!1}var i=e.CustomEvent;t.exports=n()?i:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],75:[function(e,t,n){"use strict";var i=function(e){return"number"==typeof e&&!isNaN(e)},r=function(e,t){t=t||t.currentTarget;var n=t.getBoundingClientRect(),r=e.originalEvent||e,o=e.touches&&e.touches.length,s=0,a=0;return o?i(e.touches[0].pageX)&&i(e.touches[0].pageY)?(s=e.touches[0].pageX,a=e.touches[0].pageY):i(e.touches[0].clientX)&&i(e.touches[0].clientY)&&(s=r.touches[0].clientX,a=r.touches[0].clientY):i(e.pageX)&&i(e.pageY)?(s=e.pageX,a=e.pageY):e.currentPoint&&i(e.currentPoint.x)&&i(e.currentPoint.y)&&(s=e.currentPoint.x,a=e.currentPoint.y),{x:s-n.left,y:a-n.top}};t.exports=r},{}],76:[function(t,n,i){!function(t){function n(){this._events={},this._conf&&r.call(this,this._conf)}function r(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function o(e){this._events={},this.newListener=!1,r.call(this,e)}function s(e,t,n,i){if(!n)return[];var r,o,a,l,u,d,c,h=[],f=t.length,p=t[i],m=t[i+1];if(i===f&&n._listeners){if("function"==typeof n._listeners)return e&&e.push(n._listeners),[n];for(r=0,o=n._listeners.length;r<o;r++)e&&e.push(n._listeners[r]);return[n]}if("*"===p||"**"===p||n[p]){if("*"===p){for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&(h=h.concat(s(e,t,n[a],i+1)));return h}if("**"===p){c=i+1===f||i+2===f&&"*"===m,c&&n._listeners&&(h=h.concat(s(e,t,n,f)));for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&("*"===a||"**"===a?(n[a]._listeners&&!c&&(h=h.concat(s(e,t,n[a],f))),h=h.concat(s(e,t,n[a],i))):h=a===m?h.concat(s(e,t,n[a],i+2)):h.concat(s(e,t,n[a],i)));return h}h=h.concat(s(e,t,n[p],i+1))}if(l=n["*"],l&&s(e,t,l,i+1),u=n["**"])if(i<f){u._listeners&&s(e,t,u,f);for(a in u)"_listeners"!==a&&u.hasOwnProperty(a)&&(a===m?s(e,t,u[a],i+2):a===p?s(e,t,u[a],i+1):(d={},d[a]=u[a],s(e,t,{"**":d},i+1)))}else u._listeners?s(e,t,u,f):u["*"]&&u["*"]._listeners&&s(e,t,u["*"],f);return h}function a(e,t){e="string"==typeof e?e.split(this.delimiter):e.slice();for(var n=0,i=e.length;n+1<i;n++)if("**"===e[n]&&"**"===e[n+1])return;for(var r=this.listenerTree,o=e.shift();o;){if(r[o]||(r[o]={}),r=r[o],0===e.length){if(r._listeners){if("function"==typeof r._listeners)r._listeners=[r._listeners,t];else if(l(r._listeners)&&(r._listeners.push(t),!r._listeners.warned)){var s=u;"undefined"!=typeof this._events.maxListeners&&(s=this._events.maxListeners),s>0&&r._listeners.length>s&&(r._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",r._listeners.length),console.trace())}}else r._listeners=t;return!0}o=e.shift()}return!0}var l=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=10;o.prototype.delimiter=".",o.prototype.setMaxListeners=function(e){this._events||n.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},o.prototype.event="",o.prototype.once=function(e,t){return this.many(e,1,t),this},o.prototype.many=function(e,t,n){function i(){0===--t&&r.off(e,i),n.apply(this,arguments)}var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");return i._origin=n,this.on(e,i),r},o.prototype.emit=function(){this._events||n.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var t=arguments.length,i=new Array(t-1),r=1;r<t;r++)i[r-1]=arguments[r];for(r=0,t=this._all.length;r<t;r++)this.event=e,this._all[r].apply(this,i)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var o;if(this.wildcard){o=[];var a="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,o,a,this.listenerTree,0)}else o=this._events[e];if("function"==typeof o){if(this.event=e,1===arguments.length)o.call(this);else if(arguments.length>1)switch(arguments.length){case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:for(var t=arguments.length,i=new Array(t-1),r=1;r<t;r++)i[r-1]=arguments[r];o.apply(this,i)}return!0}if(o){for(var t=arguments.length,i=new Array(t-1),r=1;r<t;r++)i[r-1]=arguments[r];for(var l=o.slice(),r=0,t=l.length;r<t;r++)this.event=e,l[r].apply(this,i);return l.length>0||!!this._all}return!!this._all},o.prototype.on=function(e,t){if("function"==typeof e)return this.onAny(e),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");if(this._events||n.call(this),this.emit("newListener",e,t),this.wildcard)return a.call(this,e,t),this;if(this._events[e]){if("function"==typeof this._events[e])this._events[e]=[this._events[e],t];else if(l(this._events[e])&&(this._events[e].push(t),!this._events[e].warned)){var i=u;"undefined"!=typeof this._events.maxListeners&&(i=this._events.maxListeners),i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}else this._events[e]=t;return this},o.prototype.onAny=function(e){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(e),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var r="string"==typeof e?e.split(this.delimiter):e.slice();i=s.call(this,null,r,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var o=0;o<i.length;o++){var a=i[o];if(n=a._listeners,l(n)){for(var u=-1,d=0,c=n.length;d<c;d++)if(n[d]===t||n[d].listener&&n[d].listener===t||n[d]._origin&&n[d]._origin===t){u=d;break}if(u<0)continue;return this.wildcard?a._listeners.splice(u,1):this._events[e].splice(u,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e])}return this},o.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(t=this._all,n=0,i=t.length;n<i;n++)if(e===t[n])return t.splice(n,1),this}else this._all=[];return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||n.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),i=s.call(this,null,t,this.listenerTree,0),r=0;r<i.length;r++){var o=i[r];o._listeners=null}else{if(!this._events[e])return this;this._events[e]=null}return this},o.prototype.listeners=function(e){if(this.wildcard){var t=[],i="string"==typeof e?e.split(this.delimiter):e.slice();return s.call(this,t,i,this.listenerTree,0),t}return this._events||n.call(this),this._events[e]||(this._events[e]=[]),l(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},o.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof e&&e.amd?e(function(){return o}):"object"==typeof i?i.EventEmitter2=o:window.EventEmitter2=o}()},{}],77:[function(e,t,n){"use strict";
function i(){var e=new s.HandlebarsEnvironment;return h.extend(e,s),e.SafeString=l["default"],e.Exception=d["default"],e.Utils=h,e.escapeExpression=h.escapeExpression,e.VM=p,e.template=function(t){return p.template(t,e)},e}var r=function(e){return e&&e.__esModule?e:{"default":e}};n.__esModule=!0;var o=e("./handlebars/base"),s=r(o),a=e("./handlebars/safe-string"),l=r(a),u=e("./handlebars/exception"),d=r(u),c=e("./handlebars/utils"),h=r(c),f=e("./handlebars/runtime"),p=r(f),m=e("./handlebars/no-conflict"),g=r(m),y=i();y.create=i,g["default"](y),y["default"]=y,n["default"]=y,t.exports=n["default"]},{"./handlebars/base":78,"./handlebars/exception":79,"./handlebars/no-conflict":80,"./handlebars/runtime":81,"./handlebars/safe-string":82,"./handlebars/utils":83}],78:[function(e,t,n){"use strict";function i(e,t){this.helpers=e||{},this.partials=t||{},r(this)}function r(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new d["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,r=n.fn;if(t===!0)return r(this);if(t===!1||null==t)return i(this);if(p(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var s=o(n.data);s.contextPath=l.appendContextPath(n.data.contextPath,n.name),n={data:s}}return r(t,n)}),e.registerHelper("each",function(e,t){function n(t,n,r){u&&(u.key=t,u.index=n,u.first=0===n,u.last=!!r,c&&(u.contextPath=c+t)),a+=i(e[t],{data:u,blockParams:l.blockParams([e[t],t],[c+t,null])})}if(!t)throw new d["default"]("Must pass iterator to #each");var i=t.fn,r=t.inverse,s=0,a="",u=void 0,c=void 0;if(t.data&&t.ids&&(c=l.appendContextPath(t.data.contextPath,t.ids[0])+"."),m(e)&&(e=e.call(this)),t.data&&(u=o(t.data)),e&&"object"==typeof e)if(p(e))for(var h=e.length;s<h;s++)n(s,s,s===e.length-1);else{var f=void 0;for(var g in e)e.hasOwnProperty(g)&&(f&&n(f,s-1),f=g,s++);f&&n(f,s-1,!0)}return 0===s&&(a=r(this)),a}),e.registerHelper("if",function(e,t){return m(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||l.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){m(e)&&(e=e.call(this));var n=t.fn;if(l.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=o(t.data);i.contextPath=l.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}),e.registerHelper("log",function(t,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(i,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}function o(e){var t=l.extend({},e);return t._parent=e,t}var s=function(e){return e&&e.__esModule?e:{"default":e}};n.__esModule=!0,n.HandlebarsEnvironment=i,n.createFrame=o;var a=e("./utils"),l=s(a),u=e("./exception"),d=s(u),c="3.0.1";n.VERSION=c;var h=6;n.COMPILER_REVISION=h;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};n.REVISION_CHANGES=f;var p=l.isArray,m=l.isFunction,g=l.toString,y="[object Object]";i.prototype={constructor:i,logger:v,log:_,registerHelper:function(e,t){if(g.call(e)===y){if(t)throw new d["default"]("Arg not supported with multiple helpers");l.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(g.call(e)===y)l.extend(this.partials,e);else{if("undefined"==typeof t)throw new d["default"]("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var v={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&v.level<=e){var n=v.methodMap[e];(console[n]||console.log).call(console,t)}}};n.logger=v;var _=v.log;n.log=_},{"./exception":79,"./utils":83}],79:[function(e,t,n){"use strict";function i(e,t){var n=t&&t.loc,o=void 0,s=void 0;n&&(o=n.start.line,s=n.start.column,e+=" - "+o+":"+s);for(var a=Error.prototype.constructor.call(this,e),l=0;l<r.length;l++)this[r[l]]=a[r[l]];Error.captureStackTrace&&Error.captureStackTrace(this,i),n&&(this.lineNumber=o,this.column=s)}n.__esModule=!0;var r=["description","fileName","lineNumber","message","name","number","stack"];i.prototype=new Error,n["default"]=i,t.exports=n["default"]},{}],80:[function(e,t,n){(function(e){"use strict";n.__esModule=!0,n["default"]=function(t){var n="undefined"!=typeof e?e:window,i=n.Handlebars;t.noConflict=function(){n.Handlebars===t&&(n.Handlebars=i)}},t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],81:[function(e,t,n){"use strict";function i(e){var t=e&&e[0]||1,n=m.COMPILER_REVISION;if(t!==n){if(t<n){var i=m.REVISION_CHANGES[n],r=m.REVISION_CHANGES[t];throw new p["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+r+").")}throw new p["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function r(e,t){function n(n,i,r){r.hash&&(i=h.extend({},i,r.hash)),n=t.VM.resolvePartial.call(this,n,i,r);var o=t.VM.invokePartial.call(this,n,i,r);if(null==o&&t.compile&&(r.partials[r.name]=t.compile(n,e.compilerOptions,t),o=r.partials[r.name](i,r)),null!=o){if(r.indent){for(var s=o.split("\n"),a=0,l=s.length;a<l&&(s[a]||a+1!==l);a++)s[a]=r.indent+s[a];o=s.join("\n")}return o}throw new p["default"]("The partial "+r.name+" could not be compiled when running in runtime-only mode")}function i(t){var n=void 0===arguments[1]?{}:arguments[1],o=n.data;i._setup(n),!n.partial&&e.useData&&(o=u(t,o));var s=void 0,a=e.useBlockParams?[]:void 0;return e.useDepths&&(s=n.depths?[t].concat(n.depths):[t]),e.main.call(r,t,r.helpers,r.partials,o,a,s)}if(!t)throw new p["default"]("No environment passed to template");if(!e||!e.main)throw new p["default"]("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var r={strict:function(e,t){if(!(t in e))throw new p["default"]('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n,i,r){var s=this.programs[e],a=this.fn(e);return t||r||i||n?s=o(this,e,a,t,n,i,r):s||(s=this.programs[e]=o(this,e,a)),s},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=h.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler};return i.isTop=!0,i._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,t.helpers),e.usePartial&&(r.partials=r.merge(n.partials,t.partials)))},i._child=function(t,n,i,s){if(e.useBlockParams&&!i)throw new p["default"]("must pass block params");if(e.useDepths&&!s)throw new p["default"]("must pass parent depths");return o(r,t,e[t],n,0,i,s)},i}function o(e,t,n,i,r,o,s){function a(t){var r=void 0===arguments[1]?{}:arguments[1];return n.call(e,t,e.helpers,e.partials,r.data||i,o&&[r.blockParams].concat(o),s&&[t].concat(s))}return a.program=t,a.depth=s?s.length:0,a.blockParams=r||0,a}function s(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e=n.partials[n.name],e}function a(e,t,n){if(n.partial=!0,void 0===e)throw new p["default"]("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)}function l(){return""}function u(e,t){return t&&"root"in t||(t=t?m.createFrame(t):{},t.root=e),t}var d=function(e){return e&&e.__esModule?e:{"default":e}};n.__esModule=!0,n.checkRevision=i,n.template=r,n.wrapProgram=o,n.resolvePartial=s,n.invokePartial=a,n.noop=l;var c=e("./utils"),h=d(c),f=e("./exception"),p=d(f),m=e("./base")},{"./base":78,"./exception":79,"./utils":83}],82:[function(e,t,n){"use strict";function i(e){this.string=e}n.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},n["default"]=i,t.exports=n["default"]},{}],83:[function(e,t,n){"use strict";function i(e){return d[e]}function r(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function o(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function s(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return h.test(e)?e.replace(c,i):e}function a(e){return!e&&0!==e||!(!m(e)||0!==e.length)}function l(e,t){return e.path=t,e}function u(e,t){return(e?e+".":"")+t}n.__esModule=!0,n.extend=r,n.indexOf=o,n.escapeExpression=s,n.isEmpty=a,n.blockParams=l,n.appendContextPath=u;var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/[&<>"'`]/g,h=/[&<>"'`]/,f=Object.prototype.toString;n.toString=f;var p=function(e){return"function"==typeof e};p(/x/)&&(n.isFunction=p=function(e){return"function"==typeof e&&"[object Function]"===f.call(e)});var p;n.isFunction=p;var m=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===f.call(e)};n.isArray=m},{}],84:[function(e,t,n){t.exports=e("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":77}],85:[function(e,t,n){t.exports=e("handlebars/runtime")["default"]},{"handlebars/runtime":84}],86:[function(e,t,n){"use strict";var i=e("number-is-nan");t.exports=Number.isFinite||function(e){return!("number"!=typeof e||i(e)||e===1/0||e===-(1/0))}},{"number-is-nan":93}],87:[function(e,t,n){t.exports=e("cssify")},{cssify:73}],88:[function(e,t,n){function i(e){return!!e&&"object"==typeof e}function r(e,t){var n=null==e?void 0:e[t];return a(n)?n:void 0}function o(e){return s(e)&&f.call(e)==l}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){return null!=e&&(o(e)?p.test(c.call(e)):i(e)&&u.test(e))}var l="[object Function]",u=/^\[object .+?Constructor\]$/,d=Object.prototype,c=Function.prototype.toString,h=d.hasOwnProperty,f=d.toString,p=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=r},{}],89:[function(e,t,n){function i(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function o(e,t){var n=F(e)||g(e)?r(e.length,String):[],i=n.length,o=!!i;for(var s in e)!t&&!C.call(e,s)||o&&("length"==s||c(s,i))||n.push(s);return n}function s(e,t,n){var i=e[t];C.call(e,t)&&m(i,n)&&(void 0!==n||t in e)||(e[t]=n)}function a(e){if(!E(e))return p(e);var t=f(e),n=[];for(var i in e)("constructor"!=i||!t&&C.call(e,i))&&n.push(i);return n}function l(e,t){return t=P(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=P(n.length-t,0),s=Array(o);++r<o;)s[r]=n[t+r];r=-1;for(var a=Array(t+1);++r<t;)a[r]=n[r];return a[t]=s,i(e,this,a)}}function u(e,t,n,i){n||(n={});for(var r=-1,o=t.length;++r<o;){var a=t[r],l=i?i(n[a],e[a],a,n,e):void 0;s(n,a,void 0===l?e[a]:l)}return n}function d(e){return l(function(t,n){var i=-1,r=n.length,o=r>1?n[r-1]:void 0,s=r>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(r--,o):void 0,s&&h(n[0],n[1],s)&&(o=r<3?void 0:o,r=1),t=Object(t);++i<r;){var a=n[i];a&&e(t,a,i,o)}return t})}function c(e,t){return t=null==t?T:t,!!t&&("number"==typeof e||I.test(e))&&e>-1&&e%1==0&&e<t}function h(e,t,n){if(!E(n))return!1;var i=typeof t;return!!("number"==i?y(n)&&c(t,n.length):"string"==i&&t in n)&&m(n[t],e)}function f(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||L;return e===n}function p(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}function m(e,t){return e===t||e!==e&&t!==t}function g(e){return v(e)&&C.call(e,"callee")&&(!A.call(e,"callee")||R.call(e)==w)}function y(e){return null!=e&&b(e.length)&&!_(e)}function v(e){return x(e)&&y(e)}function _(e){var t=E(e)?R.call(e):"";return t==D||t==M}function b(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=T}function E(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function x(e){return!!e&&"object"==typeof e}function S(e){return y(e)?o(e,!0):a(e)}var T=9007199254740991,w="[object Arguments]",D="[object Function]",M="[object GeneratorFunction]",I=/^(?:0|[1-9]\d*)$/,L=Object.prototype,C=L.hasOwnProperty,R=L.toString,A=L.propertyIsEnumerable,P=Math.max,F=Array.isArray,N=d(function(e,t){u(t,S(t),e)});t.exports=N},{}],90:[function(e,t,n){function i(e,t,n){function i(){y&&clearTimeout(y),f&&clearTimeout(f),_=0,f=y=v=void 0}function o(t,n){n&&clearTimeout(n),f=y=v=void 0,t&&(_=u(),p=e.apply(g,h),y||f||(h=g=void 0))}function l(){var e=t-(u()-m);e<=0||e>t?o(v,f):y=setTimeout(l,e)}function d(){o(E,y)}function c(){if(h=arguments,m=u(),g=this,v=E&&(y||!x),b===!1)var n=x&&!y;else{f||x||(_=m);var i=b-(m-_),r=i<=0||i>b;r?(f&&(f=clearTimeout(f)),_=m,p=e.apply(g,h)):f||(f=setTimeout(d,i))}return r&&y?y=clearTimeout(y):y||t===b||(y=setTimeout(l,t)),n&&(r=!0,p=e.apply(g,h)),!r||y||f||(h=g=void 0),p}var h,f,p,m,g,y,v,_=0,b=!1,E=!0;if("function"!=typeof e)throw new TypeError(s);if(t=t<0?0:+t||0,n===!0){var x=!0;E=!1}else r(n)&&(x=!!n.leading,b="maxWait"in n&&a(+n.maxWait||0,t),E="trailing"in n?!!n.trailing:E);return c.cancel=i,c}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var o=e("lodash._getnative"),s="Expected a function",a=Math.max,l=o(Date,"now"),u=l||function(){return(new Date).getTime()};t.exports=i},{"lodash._getnative":88}],91:[function(e,t,n){function i(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError(s);return n===!1?i=!1:r(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),o(e,t,{leading:i,maxWait:+t,trailing:a})}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var o=e("lodash.debounce"),s="Expected a function";t.exports=i},{"lodash.debounce":90}],92:[function(t,n,i){!function(t,r){"object"==typeof i&&"undefined"!=typeof n?n.exports=r():"function"==typeof e&&e.amd?e(r):t.moment=r()}(this,function(){"use strict";function e(){return Ei.apply(null,arguments)}function i(e){Ei=e}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){var t;for(t in e)return!1;return!0}function a(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var n in t)c(t,n)&&(e[n]=t[n]);return c(t,"toString")&&(e.toString=t.toString),c(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t,n,i){return bt(e,t,n,i,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=p()),e._pf}function g(e){if(null==e._isValid){var t=m(e),n=Si.call(t.parsedDateParts,function(e){return null!=e}),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function y(e){var t=f(NaN);return null!=e?h(m(t),e):m(t).userInvalidated=!0,t}function v(e,t){var n,i,r;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=m(t)),a(t._locale)||(e._locale=t._locale),Ti.length>0)for(n=0;n<Ti.length;n++)i=Ti[n],r=t[i],a(r)||(e[i]=r);return e}function _(t){v(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),wi===!1&&(wi=!0,e.updateOffset(this),wi=!1)}function b(e){return e instanceof _||null!=e&&null!=e._isAMomentObject}function E(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function x(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=E(t)),n}function S(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(i=0;i<r;i++)(n&&e[i]!==t[i]||!n&&x(e[i])!==x(t[i]))&&s++;return s+o}function T(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function w(t,n){var i=!0;return h(function(){if(null!=e.deprecationHandler&&e.deprecationHandler(null,t),i){for(var r,o=[],s=0;s<arguments.length;s++){if(r="","object"==typeof arguments[s]){r+="\n["+s+"] ";for(var a in arguments[0])r+=a+": "+arguments[0][a]+", ";r=r.slice(0,-2)}else r=arguments[s];o.push(r)}T(t+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),i=!1}return n.apply(this,arguments)},n)}function D(t,n){null!=e.deprecationHandler&&e.deprecationHandler(t,n),Di[t]||(T(n),Di[t]=!0)}function M(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function I(e){var t,n;for(n in e)t=e[n],M(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function L(e,t){var n,i=h({},e);for(n in t)c(t,n)&&(o(e[n])&&o(t[n])?(i[n]={},h(i[n],e[n]),h(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)c(e,n)&&!c(t,n)&&o(e[n])&&(i[n]=h({},i[n]));return i}function C(e){null!=e&&this.set(e)}function R(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return M(i)?i.call(t,n):i}function A(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function P(){return this._invalidDate}function F(e){return this._ordinal.replace("%d",e)}function N(e,t,n,i){var r=this._relativeTime[n];return M(r)?r(e,t,n,i):r.replace(/%d/i,e)}function B(e,t){var n=this._relativeTime[e>0?"future":"past"];return M(n)?n(t):n.replace(/%s/i,t)}function k(e,t){var n=e.toLowerCase();Bi[n]=Bi[n+"s"]=Bi[t]=e}function O(e){return"string"==typeof e?Bi[e]||Bi[e.toLowerCase()]:void 0}function U(e){var t,n,i={};for(n in e)c(e,n)&&(t=O(n),t&&(i[t]=e[n]));return i}function H(e,t){ki[e]=t}function V(e){var t=[];for(var n in e)t.push({unit:n,priority:ki[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function j(t,n){return function(i){return null!=i?(z(this,t,i),e.updateOffset(this,n),this):q(this,t)}}function q(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function z(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function Y(e){return e=O(e),M(this[e])?this[e]():this}function K(e,t){if("object"==typeof e){e=U(e);for(var n=V(e),i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit])}else if(e=O(e),M(this[e]))return this[e](t);return this}function W(e,t,n){var i=""+Math.abs(e),r=t-i.length,o=e>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function G(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(Vi[e]=r),t&&(Vi[t[0]]=function(){return W(r.apply(this,arguments),t[1],t[2])}),n&&(Vi[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function X(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function $(e){var t,n,i=e.match(Oi);for(t=0,n=i.length;t<n;t++)Vi[i[t]]?i[t]=Vi[i[t]]:i[t]=X(i[t]);return function(t){var r,o="";for(r=0;r<n;r++)o+=M(i[r])?i[r].call(t,e):i[r];return o}}function Q(e,t){return e.isValid()?(t=Z(t,e.localeData()),Hi[t]=Hi[t]||$(t),Hi[t](e)):e.localeData().invalidDate()}function Z(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(Ui.lastIndex=0;i>=0&&Ui.test(e);)e=e.replace(Ui,n),Ui.lastIndex=0,i-=1;return e}function J(e,t,n){or[e]=M(t)?t:function(e,i){return e&&n?n:t}}function ee(e,t){return c(or,e)?or[e](t._strict,t._locale):new RegExp(te(e))}function te(e){return ne(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r}))}function ne(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ie(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),l(t)&&(i=function(e,n){n[t]=x(e)}),n=0;n<e.length;n++)sr[e[n]]=i}function re(e,t){ie(e,function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)})}function oe(e,t,n){null!=t&&c(sr,e)&&sr[e](t,n._a,n,e)}function se(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||yr).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function le(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[yr.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ue(e,t,n){var i,r,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=f([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?(r=gr.call(this._shortMonthsParse,s),r!==-1?r:null):(r=gr.call(this._longMonthsParse,s),r!==-1?r:null):"MMM"===t?(r=gr.call(this._shortMonthsParse,s),r!==-1?r:(r=gr.call(this._longMonthsParse,s),r!==-1?r:null)):(r=gr.call(this._longMonthsParse,s),r!==-1?r:(r=gr.call(this._shortMonthsParse,s),r!==-1?r:null))}function de(e,t,n){var i,r,o;if(this._monthsParseExact)return ue.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=f([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=x(t);else if(t=e.localeData().monthsParse(t),!l(t))return e;return n=Math.min(e.date(),se(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function he(t){return null!=t?(ce(this,t),e.updateOffset(this,!0),this):q(this,"Month")}function fe(){return se(this.year(),this.month())}function pe(e){return this._monthsParseExact?(c(this,"_monthsRegex")||ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=br),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function me(e){return this._monthsParseExact?(c(this,"_monthsRegex")||ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=Er),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ge(){function e(e,t){return t.length-e.length}var t,n,i=[],r=[],o=[];for(t=0;t<12;t++)n=f([2e3,t]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(i.sort(e),r.sort(e),o.sort(e),t=0;t<12;t++)i[t]=ne(i[t]),r[t]=ne(r[t]);for(t=0;t<24;t++)o[t]=ne(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function ye(e){return ve(e)?366:365}function ve(e){return e%4===0&&e%100!==0||e%400===0}function _e(){return ve(this.year())}function be(e,t,n,i,r,o,s){var a=new Date(e,t,n,i,r,o,s);return e<100&&e>=0&&isFinite(a.getFullYear())&&a.setFullYear(e),a}function Ee(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function xe(e,t,n){var i=7+t-n,r=(7+Ee(e,0,i).getUTCDay()-t)%7;return-r+i-1}function Se(e,t,n,i,r){var o,s,a=(7+n-i)%7,l=xe(e,i,r),u=1+7*(t-1)+a+l;return u<=0?(o=e-1,s=ye(o)+u):u>ye(e)?(o=e+1,s=u-ye(e)):(o=e,s=u),{year:o,dayOfYear:s}}function Te(e,t,n){var i,r,o=xe(e.year(),t,n),s=Math.floor((e.dayOfYear()-o-1)/7)+1;return s<1?(r=e.year()-1,i=s+we(r,t,n)):s>we(e.year(),t,n)?(i=s-we(e.year(),t,n),r=e.year()+1):(r=e.year(),i=s),{week:i,year:r}}function we(e,t,n){var i=xe(e,t,n),r=xe(e+1,t,n);return(ye(e)-i+r)/7}function De(e){return Te(e,this._week.dow,this._week.doy).week}function Me(){return this._week.dow}function Ie(){return this._week.doy}function Le(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ce(e){var t=Te(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Re(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Ae(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Pe(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:r(this._weekdays)?this._weekdays:this._weekdays.standalone}function Fe(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ne(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Be(e,t,n){var i,r,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=f([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?(r=gr.call(this._weekdaysParse,s),r!==-1?r:null):"ddd"===t?(r=gr.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=gr.call(this._minWeekdaysParse,s),r!==-1?r:null):"dddd"===t?(r=gr.call(this._weekdaysParse,s),r!==-1?r:(r=gr.call(this._shortWeekdaysParse,s),r!==-1?r:(r=gr.call(this._minWeekdaysParse,s),r!==-1?r:null))):"ddd"===t?(r=gr.call(this._shortWeekdaysParse,s),r!==-1?r:(r=gr.call(this._weekdaysParse,s),r!==-1?r:(r=gr.call(this._minWeekdaysParse,s),r!==-1?r:null))):(r=gr.call(this._minWeekdaysParse,s),r!==-1?r:(r=gr.call(this._weekdaysParse,s),r!==-1?r:(r=gr.call(this._shortWeekdaysParse,s),r!==-1?r:null)))}function ke(e,t,n){var i,r,o;if(this._weekdaysParseExact)return Be.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=f([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}}function Oe(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Re(e,this.localeData()),this.add(e-t,"d")):t}function Ue(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function He(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Ae(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Ve(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Mr),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function je(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ir),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function qe(e){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Lr),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ze(){function e(e,t){return t.length-e.length}var t,n,i,r,o,s=[],a=[],l=[],u=[];for(t=0;t<7;t++)n=f([2e3,1]).day(t),i=this.weekdaysMin(n,""),r=this.weekdaysShort(n,""),o=this.weekdays(n,""),s.push(i),a.push(r),l.push(o),u.push(i),u.push(r),u.push(o);for(s.sort(e),a.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)a[t]=ne(a[t]),l[t]=ne(l[t]),u[t]=ne(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ye(){return this.hours()%12||12}function Ke(){return this.hours()||24}function We(e,t){G(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ge(e,t){return t._meridiemParse}function Xe(e){return"p"===(e+"").toLowerCase().charAt(0)}function $e(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Qe(e){return e?e.toLowerCase().replace("_","-"):e}function Ze(e){for(var t,n,i,r,o=0;o<e.length;){for(r=Qe(e[o]).split("-"),t=r.length,n=Qe(e[o+1]),n=n?n.split("-"):null;t>0;){if(i=Je(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&S(r,n,!0)>=t-1)break;t--}o++}return null}function Je(e){var i=null;if(!Fr[e]&&"undefined"!=typeof n&&n&&n.exports)try{i=Cr._abbr,t("./locale/"+e),et(i)}catch(r){}return Fr[e]}function et(e,t){var n;return e&&(n=a(t)?it(e):tt(e,t),n&&(Cr=n)),Cr._abbr}function tt(e,t){if(null!==t){var n=Pr;if(t.abbr=e,null!=Fr[e])D("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Fr[e]._config;else if(null!=t.parentLocale){if(null==Fr[t.parentLocale])return Nr[t.parentLocale]||(Nr[t.parentLocale]=[]),Nr[t.parentLocale].push({name:e,config:t}),null;n=Fr[t.parentLocale]._config}return Fr[e]=new C(L(n,t)),Nr[e]&&Nr[e].forEach(function(e){tt(e.name,e.config)}),et(e),Fr[e]}return delete Fr[e],null}function nt(e,t){if(null!=t){var n,i=Pr;null!=Fr[e]&&(i=Fr[e]._config),t=L(i,t),n=new C(t),n.parentLocale=Fr[e],Fr[e]=n,et(e)}else null!=Fr[e]&&(null!=Fr[e].parentLocale?Fr[e]=Fr[e].parentLocale:null!=Fr[e]&&delete Fr[e]);return Fr[e]}function it(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Cr;if(!r(e)){if(t=Je(e))return t;e=[e]}return Ze(e)}function rt(){
return Li(Fr)}function ot(e){var t,n=e._a;return n&&m(e).overflow===-2&&(t=n[lr]<0||n[lr]>11?lr:n[ur]<1||n[ur]>se(n[ar],n[lr])?ur:n[dr]<0||n[dr]>24||24===n[dr]&&(0!==n[cr]||0!==n[hr]||0!==n[fr])?dr:n[cr]<0||n[cr]>59?cr:n[hr]<0||n[hr]>59?hr:n[fr]<0||n[fr]>999?fr:-1,m(e)._overflowDayOfYear&&(t<ar||t>ur)&&(t=ur),m(e)._overflowWeeks&&t===-1&&(t=pr),m(e)._overflowWeekday&&t===-1&&(t=mr),m(e).overflow=t),e}function st(e){var t,n,i,r,o,s,a=e._i,l=Br.exec(a)||kr.exec(a);if(l){for(m(e).iso=!0,t=0,n=Ur.length;t<n;t++)if(Ur[t][1].exec(l[1])){r=Ur[t][0],i=Ur[t][2]!==!1;break}if(null==r)return void(e._isValid=!1);if(l[3]){for(t=0,n=Hr.length;t<n;t++)if(Hr[t][1].exec(l[3])){o=(l[2]||" ")+Hr[t][0];break}if(null==o)return void(e._isValid=!1)}if(!i&&null!=o)return void(e._isValid=!1);if(l[4]){if(!Or.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=r+(o||"")+(s||""),ft(e)}else e._isValid=!1}function at(e){var t,n,i,r,o,s,a,l,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},d="YXWVUTSRQPONZABCDEFGHIKLM";if(t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=jr.exec(t)){if(i=n[1]?"ddd"+(5===n[1].length?", ":" "):"",r="D MMM "+(n[2].length>10?"YYYY ":"YY "),o="HH:mm"+(n[4]?":ss":""),n[1]){var c=new Date(n[2]),h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][c.getDay()];if(n[1].substr(0,3)!==h)return m(e).weekdayMismatch=!0,void(e._isValid=!1)}switch(n[5].length){case 2:0===l?a=" +0000":(l=d.indexOf(n[5][1].toUpperCase())-12,a=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:a=u[n[5]];break;default:a=u[" GMT"]}n[5]=a,e._i=n.splice(1).join(""),s=" ZZ",e._f=i+r+o+s,ft(e),m(e).rfc2822=!0}else e._isValid=!1}function lt(t){var n=Vr.exec(t._i);return null!==n?void(t._d=new Date((+n[1]))):(st(t),void(t._isValid===!1&&(delete t._isValid,at(t),t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t)))))}function ut(e,t,n){return null!=e?e:null!=t?t:n}function dt(t){var n=new Date(e.now());return t._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function ct(e){var t,n,i,r,o=[];if(!e._d){for(i=dt(e),e._w&&null==e._a[ur]&&null==e._a[lr]&&ht(e),null!=e._dayOfYear&&(r=ut(e._a[ar],i[ar]),(e._dayOfYear>ye(r)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=Ee(r,0,e._dayOfYear),e._a[lr]=n.getUTCMonth(),e._a[ur]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[dr]&&0===e._a[cr]&&0===e._a[hr]&&0===e._a[fr]&&(e._nextDay=!0,e._a[dr]=0),e._d=(e._useUTC?Ee:be).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[dr]=24)}}function ht(e){var t,n,i,r,o,s,a,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)o=1,s=4,n=ut(t.GG,e._a[ar],Te(Et(),1,4).year),i=ut(t.W,1),r=ut(t.E,1),(r<1||r>7)&&(l=!0);else{o=e._locale._week.dow,s=e._locale._week.doy;var u=Te(Et(),o,s);n=ut(t.gg,e._a[ar],u.year),i=ut(t.w,u.week),null!=t.d?(r=t.d,(r<0||r>6)&&(l=!0)):null!=t.e?(r=t.e+o,(t.e<0||t.e>6)&&(l=!0)):r=o}i<1||i>we(n,o,s)?m(e)._overflowWeeks=!0:null!=l?m(e)._overflowWeekday=!0:(a=Se(n,i,r,o,s),e._a[ar]=a.year,e._dayOfYear=a.dayOfYear)}function ft(t){if(t._f===e.ISO_8601)return void st(t);if(t._f===e.RFC_2822)return void at(t);t._a=[],m(t).empty=!0;var n,i,r,o,s,a=""+t._i,l=a.length,u=0;for(r=Z(t._f,t._locale).match(Oi)||[],n=0;n<r.length;n++)o=r[n],i=(a.match(ee(o,t))||[])[0],i&&(s=a.substr(0,a.indexOf(i)),s.length>0&&m(t).unusedInput.push(s),a=a.slice(a.indexOf(i)+i.length),u+=i.length),Vi[o]?(i?m(t).empty=!1:m(t).unusedTokens.push(o),oe(o,i,t)):t._strict&&!i&&m(t).unusedTokens.push(o);m(t).charsLeftOver=l-u,a.length>0&&m(t).unusedInput.push(a),t._a[dr]<=12&&m(t).bigHour===!0&&t._a[dr]>0&&(m(t).bigHour=void 0),m(t).parsedDateParts=t._a.slice(0),m(t).meridiem=t._meridiem,t._a[dr]=pt(t._locale,t._a[dr],t._meridiem),ct(t),ot(t)}function pt(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(i=e.isPM(n),i&&t<12&&(t+=12),i||12!==t||(t=0),t):t}function mt(e){var t,n,i,r,o;if(0===e._f.length)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)o=0,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],ft(t),g(t)&&(o+=m(t).charsLeftOver,o+=10*m(t).unusedTokens.length,m(t).score=o,(null==i||o<i)&&(i=o,n=t));h(e,n||t)}function gt(e){if(!e._d){var t=U(e._i);e._a=d([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}function yt(e){var t=new _(ot(vt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function vt(e){var t=e._i,n=e._f;return e._locale=e._locale||it(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),b(t)?new _(ot(t)):(u(t)?e._d=t:r(n)?mt(e):n?ft(e):_t(e),g(e)||(e._d=null),e))}function _t(t){var n=t._i;a(n)?t._d=new Date(e.now()):u(n)?t._d=new Date(n.valueOf()):"string"==typeof n?lt(t):r(n)?(t._a=d(n.slice(0),function(e){return parseInt(e,10)}),ct(t)):o(n)?gt(t):l(n)?t._d=new Date(n):e.createFromInputFallback(t)}function bt(e,t,n,i,a){var l={};return n!==!0&&n!==!1||(i=n,n=void 0),(o(e)&&s(e)||r(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=e,l._f=t,l._strict=i,yt(l)}function Et(e,t,n,i){return bt(e,t,n,i,!1)}function xt(e,t){var n,i;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return Et();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}function St(){var e=[].slice.call(arguments,0);return xt("isBefore",e)}function Tt(){var e=[].slice.call(arguments,0);return xt("isAfter",e)}function wt(e){for(var t in e)if(Kr.indexOf(t)===-1||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,i=0;i<Kr.length;++i)if(e[Kr[i]]){if(n)return!1;parseFloat(e[Kr[i]])!==x(e[Kr[i]])&&(n=!0)}return!0}function Dt(){return this._isValid}function Mt(){return Kt(NaN)}function It(e){var t=U(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._isValid=wt(t),this._milliseconds=+d+1e3*u+6e4*l+1e3*a*60*60,this._days=+s+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=it(),this._bubble()}function Lt(e){return e instanceof It}function Ct(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Rt(e,t){G(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+W(~~(e/60),2)+t+W(~~e%60,2)})}function At(e,t){var n=(t||"").match(e);if(null===n)return null;var i=n[n.length-1]||[],r=(i+"").match(Wr)||["-",0,0],o=+(60*r[1])+x(r[2]);return 0===o?0:"+"===r[0]?o:-o}function Pt(t,n){var i,r;return n._isUTC?(i=n.clone(),r=(b(t)||u(t)?t.valueOf():Et(t).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),e.updateOffset(i,!1),i):Et(t).local()}function Ft(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Nt(t,n,i){var r,o=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(t=At(nr,t),null===t)return this}else Math.abs(t)<16&&!i&&(t=60*t);return!this._isUTC&&n&&(r=Ft(this)),this._offset=t,this._isUTC=!0,null!=r&&this.add(r,"m"),o!==t&&(!n||this._changeInProgress?Qt(this,Kt(t-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:Ft(this)}function Bt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function kt(e){return this.utcOffset(0,e)}function Ot(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ft(this),"m")),this}function Ut(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=At(tr,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ht(e){return!!this.isValid()&&(e=e?Et(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Vt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function jt(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(v(e,this),e=vt(e),e._a){var t=e._isUTC?f(e._a):Et(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function qt(){return!!this.isValid()&&!this._isUTC}function zt(){return!!this.isValid()&&this._isUTC}function Yt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Kt(e,t){var n,i,r,o=e,s=null;return Lt(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(o={},t?o[t]=e:o.milliseconds=e):(s=Gr.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:x(s[ur])*n,h:x(s[dr])*n,m:x(s[cr])*n,s:x(s[hr])*n,ms:x(Ct(1e3*s[fr]))*n}):(s=Xr.exec(e))?(n="-"===s[1]?-1:1,o={y:Wt(s[2],n),M:Wt(s[3],n),w:Wt(s[4],n),d:Wt(s[5],n),h:Wt(s[6],n),m:Wt(s[7],n),s:Wt(s[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(r=Xt(Et(o.from),Et(o.to)),o={},o.ms=r.milliseconds,o.M=r.months),i=new It(o),Lt(e)&&c(e,"_locale")&&(i._locale=e._locale),i}function Wt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Gt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Xt(e,t){var n;return e.isValid()&&t.isValid()?(t=Pt(t,e),e.isBefore(t)?n=Gt(e,t):(n=Gt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function $t(e,t){return function(n,i){var r,o;return null===i||isNaN(+i)||(D(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),n="string"==typeof n?+n:n,r=Kt(n,i),Qt(this,r,e),this}}function Qt(t,n,i,r){var o=n._milliseconds,s=Ct(n._days),a=Ct(n._months);t.isValid()&&(r=null==r||r,o&&t._d.setTime(t._d.valueOf()+o*i),s&&z(t,"Date",q(t,"Date")+s*i),a&&ce(t,q(t,"Month")+a*i),r&&e.updateOffset(t,s||a))}function Zt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Jt(t,n){var i=t||Et(),r=Pt(i,this).startOf("day"),o=e.calendarFormat(this,r)||"sameElse",s=n&&(M(n[o])?n[o].call(this,i):n[o]);return this.format(s||this.localeData().calendar(o,this,Et(i)))}function en(){return new _(this)}function tn(e,t){var n=b(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&(t=O(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function nn(e,t){var n=b(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&(t=O(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function rn(e,t,n,i){return i=i||"()",("("===i[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===i[1]?this.isBefore(t,n):!this.isAfter(t,n))}function on(e,t){var n,i=b(e)?e:Et(e);return!(!this.isValid()||!i.isValid())&&(t=O(t||"millisecond"),"millisecond"===t?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function sn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function an(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function ln(e,t,n){var i,r,o,s;return this.isValid()?(i=Pt(e,this),i.isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),t=O(t),"year"===t||"month"===t||"quarter"===t?(s=un(this,i),"quarter"===t?s/=3:"year"===t&&(s/=12)):(o=this-i,s="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-r)/864e5:"week"===t?(o-r)/6048e5:o),n?s:E(s)):NaN):NaN}function un(e,t){var n,i,r=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(r,"months");return t-o<0?(n=e.clone().add(r-1,"months"),i=(t-o)/(o-n)):(n=e.clone().add(r+1,"months"),i=(t-o)/(n-o)),-(r+i)||0}function dn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function cn(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?Q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):M(Date.prototype.toISOString)?this.toDate().toISOString():Q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function hn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]';return this.format(n+i+r+o)}function fn(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var n=Q(this,t);return this.localeData().postformat(n)}function pn(e,t){return this.isValid()&&(b(e)&&e.isValid()||Et(e).isValid())?Kt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mn(e){return this.from(Et(),e)}function gn(e,t){return this.isValid()&&(b(e)&&e.isValid()||Et(e).isValid())?Kt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yn(e){return this.to(Et(),e)}function vn(e){var t;return void 0===e?this._locale._abbr:(t=it(e),null!=t&&(this._locale=t),this)}function _n(){return this._locale}function bn(e){switch(e=O(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function En(e){return e=O(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function xn(){return this._d.valueOf()-6e4*(this._offset||0)}function Sn(){return Math.floor(this.valueOf()/1e3)}function Tn(){return new Date(this.valueOf())}function wn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Dn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Mn(){return this.isValid()?this.toISOString():null}function In(){return g(this)}function Ln(){return h({},m(this))}function Cn(){return m(this).overflow}function Rn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function An(e,t){G(0,[e,e.length],0,t)}function Pn(e){return kn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Fn(e){return kn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Nn(){return we(this.year(),1,4)}function Bn(){var e=this.localeData()._week;return we(this.year(),e.dow,e.doy)}function kn(e,t,n,i,r){var o;return null==e?Te(this,i,r).year:(o=we(e,i,r),t>o&&(t=o),On.call(this,e,t,n,i,r))}function On(e,t,n,i,r){var o=Se(e,t,n,i,r),s=Ee(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Un(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Hn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Vn(e,t){t[fr]=x(1e3*("0."+e))}function jn(){return this._isUTC?"UTC":""}function qn(){return this._isUTC?"Coordinated Universal Time":""}function zn(e){return Et(1e3*e)}function Yn(){return Et.apply(null,arguments).parseZone()}function Kn(e){return e}function Wn(e,t,n,i){var r=it(),o=f().set(i,t);return r[n](o,e)}function Gn(e,t,n){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return Wn(e,t,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Wn(e,i,n,"month");return r}function Xn(e,t,n,i){"boolean"==typeof e?(l(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,l(t)&&(n=t,t=void 0),t=t||"");var r=it(),o=e?r._week.dow:0;if(null!=n)return Wn(t,(n+o)%7,i,"day");var s,a=[];for(s=0;s<7;s++)a[s]=Wn(t,(s+o)%7,i,"day");return a}function $n(e,t){return Gn(e,t,"months")}function Qn(e,t){return Gn(e,t,"monthsShort")}function Zn(e,t,n){return Xn(e,t,n,"weekdays")}function Jn(e,t,n){return Xn(e,t,n,"weekdaysShort")}function ei(e,t,n){return Xn(e,t,n,"weekdaysMin")}function ti(){var e=this._data;return this._milliseconds=so(this._milliseconds),this._days=so(this._days),this._months=so(this._months),e.milliseconds=so(e.milliseconds),e.seconds=so(e.seconds),e.minutes=so(e.minutes),e.hours=so(e.hours),e.months=so(e.months),e.years=so(e.years),this}function ni(e,t,n,i){var r=Kt(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function ii(e,t){return ni(this,e,t,1)}function ri(e,t){return ni(this,e,t,-1)}function oi(e){return e<0?Math.floor(e):Math.ceil(e)}function si(){var e,t,n,i,r,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*oi(li(a)+s),s=0,a=0),l.milliseconds=o%1e3,e=E(o/1e3),l.seconds=e%60,t=E(e/60),l.minutes=t%60,n=E(t/60),l.hours=n%24,s+=E(n/24),r=E(ai(s)),a+=r,s-=oi(li(r)),i=E(a/12),a%=12,l.days=s,l.months=a,l.years=i,this}function ai(e){return 4800*e/146097}function li(e){return 146097*e/4800}function ui(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if(e=O(e),"month"===e||"year"===e)return t=this._days+i/864e5,n=this._months+ai(t),"month"===e?n:n/12;switch(t=this._days+Math.round(li(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function di(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*x(this._months/12):NaN}function ci(e){return function(){return this.as(e)}}function hi(e){return e=O(e),this.isValid()?this[e+"s"]():NaN}function fi(e){return function(){return this.isValid()?this._data[e]:NaN}}function pi(){return E(this.days()/7)}function mi(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function gi(e,t,n){var i=Kt(e).abs(),r=So(i.as("s")),o=So(i.as("m")),s=So(i.as("h")),a=So(i.as("d")),l=So(i.as("M")),u=So(i.as("y")),d=r<=To.ss&&["s",r]||r<To.s&&["ss",r]||o<=1&&["m"]||o<To.m&&["mm",o]||s<=1&&["h"]||s<To.h&&["hh",s]||a<=1&&["d"]||a<To.d&&["dd",a]||l<=1&&["M"]||l<To.M&&["MM",l]||u<=1&&["y"]||["yy",u];return d[2]=t,d[3]=+e>0,d[4]=n,mi.apply(null,d)}function yi(e){return void 0===e?So:"function"==typeof e&&(So=e,!0)}function vi(e,t){return void 0!==To[e]&&(void 0===t?To[e]:(To[e]=t,"s"===e&&(To.ss=t-1),!0))}function _i(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=gi(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function bi(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,i=wo(this._milliseconds)/1e3,r=wo(this._days),o=wo(this._months);e=E(i/60),t=E(e/60),i%=60,e%=60,n=E(o/12),o%=12;var s=n,a=o,l=r,u=t,d=e,c=i,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(s?s+"Y":"")+(a?a+"M":"")+(l?l+"D":"")+(u||d||c?"T":"")+(u?u+"H":"")+(d?d+"M":"")+(c?c+"S":""):"P0D"}var Ei,xi;xi=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1};var Si=xi,Ti=e.momentProperties=[],wi=!1,Di={};e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;var Mi;Mi=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)c(e,t)&&n.push(t);return n};var Ii,Li=Mi,Ci={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Ri={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ai="Invalid date",Pi="%d",Fi=/\d{1,2}/,Ni={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Bi={},ki={},Oi=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ui=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hi={},Vi={},ji=/\d/,qi=/\d\d/,zi=/\d{3}/,Yi=/\d{4}/,Ki=/[+-]?\d{6}/,Wi=/\d\d?/,Gi=/\d\d\d\d?/,Xi=/\d\d\d\d\d\d?/,$i=/\d{1,3}/,Qi=/\d{1,4}/,Zi=/[+-]?\d{1,6}/,Ji=/\d+/,er=/[+-]?\d+/,tr=/Z|[+-]\d\d:?\d\d/gi,nr=/Z|[+-]\d\d(?::?\d\d)?/gi,ir=/[+-]?\d+(\.\d{1,3})?/,rr=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,or={},sr={},ar=0,lr=1,ur=2,dr=3,cr=4,hr=5,fr=6,pr=7,mr=8;Ii=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var gr=Ii;G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),G("MMMM",0,0,function(e){return this.localeData().months(this,e)}),k("month","M"),H("month",8),J("M",Wi),J("MM",Wi,qi),J("MMM",function(e,t){return t.monthsShortRegex(e)}),J("MMMM",function(e,t){return t.monthsRegex(e)}),ie(["M","MM"],function(e,t){t[lr]=x(e)-1}),ie(["MMM","MMMM"],function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[lr]=r:m(n).invalidMonth=e});var yr=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vr="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),_r="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),br=rr,Er=rr;G("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),k("year","y"),H("year",1),J("Y",er),J("YY",Wi,qi),J("YYYY",Qi,Yi),J("YYYYY",Zi,Ki),J("YYYYYY",Zi,Ki),ie(["YYYYY","YYYYYY"],ar),ie("YYYY",function(t,n){n[ar]=2===t.length?e.parseTwoDigitYear(t):x(t)}),ie("YY",function(t,n){n[ar]=e.parseTwoDigitYear(t)}),ie("Y",function(e,t){t[ar]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return x(e)+(x(e)>68?1900:2e3)};var xr=j("FullYear",!0);G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),k("week","w"),k("isoWeek","W"),H("week",5),H("isoWeek",5),J("w",Wi),J("ww",Wi,qi),J("W",Wi),J("WW",Wi,qi),re(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=x(e)});var Sr={dow:0,doy:6};G("d",0,"do","day"),G("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),G("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),G("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),k("day","d"),k("weekday","e"),k("isoWeekday","E"),H("day",11),H("weekday",11),H("isoWeekday",11),J("d",Wi),J("e",Wi),J("E",Wi),J("dd",function(e,t){return t.weekdaysMinRegex(e)}),J("ddd",function(e,t){return t.weekdaysShortRegex(e)}),J("dddd",function(e,t){return t.weekdaysRegex(e)}),re(["dd","ddd","dddd"],function(e,t,n,i){var r=n._locale.weekdaysParse(e,i,n._strict);null!=r?t.d=r:m(n).invalidWeekday=e}),re(["d","e","E"],function(e,t,n,i){t[i]=x(e)});var Tr="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wr="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Dr="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Mr=rr,Ir=rr,Lr=rr;G("H",["HH",2],0,"hour"),G("h",["hh",2],0,Ye),G("k",["kk",2],0,Ke),G("hmm",0,0,function(){return""+Ye.apply(this)+W(this.minutes(),2)}),G("hmmss",0,0,function(){return""+Ye.apply(this)+W(this.minutes(),2)+W(this.seconds(),2)}),G("Hmm",0,0,function(){return""+this.hours()+W(this.minutes(),2)}),G("Hmmss",0,0,function(){return""+this.hours()+W(this.minutes(),2)+W(this.seconds(),2)}),We("a",!0),We("A",!1),k("hour","h"),H("hour",13),J("a",Ge),J("A",Ge),J("H",Wi),J("h",Wi),J("k",Wi),J("HH",Wi,qi),J("hh",Wi,qi),J("kk",Wi,qi),J("hmm",Gi),J("hmmss",Xi),J("Hmm",Gi),J("Hmmss",Xi),ie(["H","HH"],dr),ie(["k","kk"],function(e,t,n){var i=x(e);t[dr]=24===i?0:i}),ie(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ie(["h","hh"],function(e,t,n){t[dr]=x(e),m(n).bigHour=!0}),ie("hmm",function(e,t,n){var i=e.length-2;t[dr]=x(e.substr(0,i)),t[cr]=x(e.substr(i)),m(n).bigHour=!0}),ie("hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[dr]=x(e.substr(0,i)),t[cr]=x(e.substr(i,2)),t[hr]=x(e.substr(r)),m(n).bigHour=!0}),ie("Hmm",function(e,t,n){var i=e.length-2;t[dr]=x(e.substr(0,i)),t[cr]=x(e.substr(i))}),ie("Hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[dr]=x(e.substr(0,i)),t[cr]=x(e.substr(i,2)),t[hr]=x(e.substr(r))});var Cr,Rr=/[ap]\.?m?\.?/i,Ar=j("Hours",!0),Pr={calendar:Ci,longDateFormat:Ri,invalidDate:Ai,ordinal:Pi,dayOfMonthOrdinalParse:Fi,relativeTime:Ni,months:vr,monthsShort:_r,week:Sr,weekdays:Tr,weekdaysMin:Dr,weekdaysShort:wr,meridiemParse:Rr},Fr={},Nr={},Br=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Or=/Z|[+-]\d\d(?::?\d\d)?/,Ur=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Hr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Vr=/^\/?Date\((\-?\d+)/i,jr=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;e.createFromInputFallback=w("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),e.ISO_8601=function(){},e.RFC_2822=function(){};var qr=w("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()}),zr=w("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}),Yr=function(){return Date.now?Date.now():+new Date},Kr=["year","quarter","month","week","day","hour","minute","second","millisecond"];Rt("Z",":"),Rt("ZZ",""),J("Z",nr),J("ZZ",nr),ie(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=At(nr,e)});var Wr=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Gr=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Xr=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Kt.fn=It.prototype,Kt.invalid=Mt;var $r=$t(1,"add"),Qr=$t(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Zr=w("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100}),An("gggg","weekYear"),An("ggggg","weekYear"),An("GGGG","isoWeekYear"),An("GGGGG","isoWeekYear"),k("weekYear","gg"),k("isoWeekYear","GG"),H("weekYear",1),H("isoWeekYear",1),J("G",er),J("g",er),J("GG",Wi,qi),J("gg",Wi,qi),J("GGGG",Qi,Yi),J("gggg",Qi,Yi),J("GGGGG",Zi,Ki),J("ggggg",Zi,Ki),re(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=x(e)}),re(["gg","GG"],function(t,n,i,r){n[r]=e.parseTwoDigitYear(t)}),G("Q",0,"Qo","quarter"),k("quarter","Q"),H("quarter",7),J("Q",ji),ie("Q",function(e,t){t[lr]=3*(x(e)-1)}),G("D",["DD",2],"Do","date"),k("date","D"),H("date",9),J("D",Wi),J("DD",Wi,qi),J("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ie(["D","DD"],ur),ie("Do",function(e,t){t[ur]=x(e.match(Wi)[0],10)});var Jr=j("Date",!0);G("DDD",["DDDD",3],"DDDo","dayOfYear"),k("dayOfYear","DDD"),H("dayOfYear",4),J("DDD",$i),J("DDDD",zi),ie(["DDD","DDDD"],function(e,t,n){n._dayOfYear=x(e)}),G("m",["mm",2],0,"minute"),k("minute","m"),H("minute",14),J("m",Wi),J("mm",Wi,qi),ie(["m","mm"],cr);var eo=j("Minutes",!1);G("s",["ss",2],0,"second"),k("second","s"),H("second",15),J("s",Wi),J("ss",Wi,qi),ie(["s","ss"],hr);var to=j("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,function(){return 10*this.millisecond()}),G(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),G(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),G(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),G(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),G(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),k("millisecond","ms"),H("millisecond",16),J("S",$i,ji),J("SS",$i,qi),J("SSS",$i,zi);var no;for(no="SSSS";no.length<=9;no+="S")J(no,Ji);for(no="S";no.length<=9;no+="S")ie(no,Vn);var io=j("Milliseconds",!1);G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var ro=_.prototype;ro.add=$r,ro.calendar=Jt,ro.clone=en,ro.diff=ln,ro.endOf=En,ro.format=fn,ro.from=pn,ro.fromNow=mn,ro.to=gn,ro.toNow=yn,ro.get=Y,ro.invalidAt=Cn,ro.isAfter=tn,ro.isBefore=nn,ro.isBetween=rn,ro.isSame=on,ro.isSameOrAfter=sn,ro.isSameOrBefore=an,ro.isValid=In,ro.lang=Zr,ro.locale=vn,ro.localeData=_n,ro.max=zr,ro.min=qr,ro.parsingFlags=Ln,ro.set=K,ro.startOf=bn,ro.subtract=Qr,ro.toArray=wn,ro.toObject=Dn,ro.toDate=Tn,ro.toISOString=cn,ro.inspect=hn,ro.toJSON=Mn,ro.toString=dn,ro.unix=Sn,ro.valueOf=xn,ro.creationData=Rn,ro.year=xr,ro.isLeapYear=_e,ro.weekYear=Pn,ro.isoWeekYear=Fn,ro.quarter=ro.quarters=Un,ro.month=he,ro.daysInMonth=fe,ro.week=ro.weeks=Le,ro.isoWeek=ro.isoWeeks=Ce,ro.weeksInYear=Bn,ro.isoWeeksInYear=Nn,ro.date=Jr,ro.day=ro.days=Oe,ro.weekday=Ue,ro.isoWeekday=He,ro.dayOfYear=Hn,ro.hour=ro.hours=Ar,ro.minute=ro.minutes=eo,ro.second=ro.seconds=to,ro.millisecond=ro.milliseconds=io,ro.utcOffset=Nt,ro.utc=kt,ro.local=Ot,ro.parseZone=Ut,ro.hasAlignedHourOffset=Ht,ro.isDST=Vt,ro.isLocal=qt,ro.isUtcOffset=zt,ro.isUtc=Yt,ro.isUTC=Yt,ro.zoneAbbr=jn,ro.zoneName=qn,ro.dates=w("dates accessor is deprecated. Use date instead.",Jr),ro.months=w("months accessor is deprecated. Use month instead",he),ro.years=w("years accessor is deprecated. Use year instead",xr),ro.zone=w("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Bt),ro.isDSTShifted=w("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",jt);var oo=C.prototype;oo.calendar=R,oo.longDateFormat=A,oo.invalidDate=P,oo.ordinal=F,oo.preparse=Kn,oo.postformat=Kn,oo.relativeTime=N,oo.pastFuture=B,oo.set=I,oo.months=ae,oo.monthsShort=le,oo.monthsParse=de,oo.monthsRegex=me,oo.monthsShortRegex=pe,oo.week=De,oo.firstDayOfYear=Ie,oo.firstDayOfWeek=Me,oo.weekdays=Pe,oo.weekdaysMin=Ne,oo.weekdaysShort=Fe,oo.weekdaysParse=ke,oo.weekdaysRegex=Ve,oo.weekdaysShortRegex=je,oo.weekdaysMinRegex=qe,oo.isPM=Xe,oo.meridiem=$e,et("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===x(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),e.lang=w("moment.lang is deprecated. Use moment.locale instead.",et),
e.langData=w("moment.langData is deprecated. Use moment.localeData instead.",it);var so=Math.abs,ao=ci("ms"),lo=ci("s"),uo=ci("m"),co=ci("h"),ho=ci("d"),fo=ci("w"),po=ci("M"),mo=ci("y"),go=fi("milliseconds"),yo=fi("seconds"),vo=fi("minutes"),_o=fi("hours"),bo=fi("days"),Eo=fi("months"),xo=fi("years"),So=Math.round,To={ss:44,s:45,m:45,h:22,d:26,M:11},wo=Math.abs,Do=It.prototype;return Do.isValid=Dt,Do.abs=ti,Do.add=ii,Do.subtract=ri,Do.as=ui,Do.asMilliseconds=ao,Do.asSeconds=lo,Do.asMinutes=uo,Do.asHours=co,Do.asDays=ho,Do.asWeeks=fo,Do.asMonths=po,Do.asYears=mo,Do.valueOf=di,Do._bubble=si,Do.get=hi,Do.milliseconds=go,Do.seconds=yo,Do.minutes=vo,Do.hours=_o,Do.days=bo,Do.weeks=pi,Do.months=Eo,Do.years=xo,Do.humanize=_i,Do.toISOString=bi,Do.toString=bi,Do.toJSON=bi,Do.locale=vn,Do.localeData=_n,Do.toIsoString=w("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bi),Do.lang=Zr,G("X",0,0,"unix"),G("x",0,0,"valueOf"),J("x",er),J("X",ir),ie("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ie("x",function(e,t,n){n._d=new Date(x(e))}),e.version="2.18.1",i(Et),e.fn=ro,e.min=St,e.max=Tt,e.now=Yr,e.utc=f,e.unix=zn,e.months=$n,e.isDate=u,e.locale=et,e.invalid=y,e.duration=Kt,e.isMoment=b,e.weekdays=Zn,e.parseZone=Yn,e.localeData=it,e.isDuration=Lt,e.monthsShort=Qn,e.weekdaysMin=ei,e.defineLocale=tt,e.updateLocale=nt,e.locales=rt,e.weekdaysShort=Jn,e.normalizeUnits=O,e.relativeTimeRounding=yi,e.relativeTimeThreshold=vi,e.calendarFormat=Zt,e.prototype=ro,e})},{}],93:[function(e,t,n){"use strict";t.exports=Number.isNaN||function(e){return e!==e}},{}],94:[function(e,t,n){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function s(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){g&&p&&(g=!1,p.length?m=p.concat(m):y=-1,m.length&&l())}function l(){if(!g){var e=o(a);g=!0;for(var t=m.length;t;){for(p=m,m=[];++y<t;)p&&p[y].run();y=-1,t=m.length}p=null,g=!1,s(e)}}function u(e,t){this.fun=e,this.array=t}function d(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(e){c=i}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(e){h=r}}();var p,m=[],g=!1,y=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new u(e,t)),1!==m.length||g||o(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=d,f.addListener=d,f.once=d,f.off=d,f.removeListener=d,f.removeAllListeners=d,f.emit=d,f.prependListener=d,f.prependOnceListener=d,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],95:[function(e,t,n){t.exports=function(e,t,n){function i(){var u=Date.now()-a;u<t&&u>=0?r=setTimeout(i,t-u):(r=null,n||(l=e.apply(s,o),s=o=null))}var r,o,s,a,l;null==t&&(t=100);var u=function(){s=this,o=arguments,a=Date.now();var u=n&&!r;return r||(r=setTimeout(i,t)),u&&(l=e.apply(s,o),s=o=null),l};return u.clear=function(){r&&(clearTimeout(r),r=null)},u}},{}],96:[function(e,t,n){"use strict";var i={};i.MAX_SET_BY_DEFAULT=100,i.HANDLE_RESIZE_DEBOUNCE=100,i.RANGE_CLASS="rangeslider",i.FILL_CLASS="rangeslider__fill",i.FILL_BG_CLASS="rangeslider__fill__bg",i.HANDLE_CLASS="rangeslider__handle",i.DISABLED_CLASS="rangeslider--disabled",i.STEP_SET_BY_DEFAULT=1,i.START_EVENTS=["mousedown","touchstart","pointerdown"],i.MOVE_EVENTS=["mousemove","touchmove","pointermove"],i.END_EVENTS=["mouseup","touchend","pointerup"],t.exports=i},{}],97:[function(e,t,n){"use strict";function i(e,t){var n=this;t=t||{},this.element=e,this.options=t,this.onSlideEventsCount=-1,this.isInteracting=!1,this.needTriggerEvents=!1,this.identifier="js-"+u+"-"+d++,this.min=a.getFirstNumberLike(t.min,parseFloat(e.getAttribute("min")),0),this.max=a.getFirstNumberLike(t.max,parseFloat(e.getAttribute("max")),l.MAX_SET_BY_DEFAULT),this.value=a.getFirstNumberLike(t.value,parseFloat(e.value),this.min+(this.max-this.min)/2),this.step=a.getFirstNumberLike(t.step,parseFloat(e.getAttribute("step")),l.STEP_SET_BY_DEFAULT),this.percent=null,this._updatePercentFromValue(),this.toFixed=h(this.step),this.range=c(l.RANGE_CLASS),this.range.id=this.identifier,this.fillBg=c(l.FILL_BG_CLASS),this.fill=c(l.FILL_CLASS),this.handle=c(l.HANDLE_CLASS),this.range.appendChild(this.handle),this.range.appendChild(this.fillBg),this.range.appendChild(this.fill),e.setAttribute("min",""+this.min),e.setAttribute("max",""+this.max),e.setAttribute("step",""+this.step),this._setValue(this.value),a.insertAfter(e,this.range),e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",e.style.opacity="0",["_update","_handleDown","_handleMove","_handleEnd","_startEventListener","_changeEventListener"].forEach(function(e){this[e]=this[e].bind(this)},this),this._init(),window.addEventListener("resize",o(this._update,l.HANDLE_RESIZE_DEBOUNCE)),l.START_EVENTS.forEach(function(e){return n.range.addEventListener(e,n._startEventListener)}),e.addEventListener("change",this._changeEventListener)}e("./styles/base.less");var r=e("clamp"),o=e("debounce"),s=e("ev-pos"),a=e("./utils"),l=e("./const"),u="rangeslider-js",d=0,c=function(e){var t=document.createElement("div");return t.classList.add(e),t},h=function(e){return(e+"").replace(".","").length-1};i.prototype.constructor=i,i.prototype._init=function(){this.options.onInit&&this.options.onInit(),this._update()},i.prototype._updatePercentFromValue=function(){this.percent=(this.value-this.min)/(this.max-this.min)},i.prototype._startEventListener=function(e,t){var n=this,i=e.target,r=!1;a.forEachAncestorsAndSelf(i,function(e){return r=e.id===n.identifier&&!e.classList.contains(l.DISABLED_CLASS)}),r&&this._handleDown(e,t)},i.prototype._changeEventListener=function(e,t){if(!t||t.origin!==this.identifier){var n=e.target.value;this._setPosition(this._getPositionFromValue(n))}},i.prototype._update=function(){this.handleWidth=a.getDimension(this.handle,"offsetWidth"),this.rangeWidth=a.getDimension(this.range,"offsetWidth"),this.maxHandleX=this.rangeWidth-this.handleWidth,this.grabX=this.handleWidth/2,this.position=this._getPositionFromValue(this.value),this.range.classList[this.element.disabled?"add":"remove"](l.DISABLED_CLASS),this._setPosition(this.position),this._updatePercentFromValue(),a.emit(this.element,"change")},i.prototype._listen=function(e){var t=this,n=(e?"add":"remove")+"EventListener";l.MOVE_EVENTS.forEach(function(e){return document[n](e,t._handleMove)}),l.END_EVENTS.forEach(function(e){document[n](e,t._handleEnd),t.range[n](e,t._handleEnd)})},i.prototype._handleDown=function(e){if(e.preventDefault(),this.isInteracting=!0,this._listen(!0),!e.target.classList.contains(l.HANDLE_CLASS)){var t=s(e,this.range).x,n=this.range.getBoundingClientRect().left,i=this.handle.getBoundingClientRect().left-n;this._setPosition(t-this.grabX),t>=i&&t<i+this.handleWidth&&(this.grabX=t-i),this._updatePercentFromValue()}},i.prototype._handleMove=function(e){this.isInteracting=!0,e.preventDefault();var t=s(e,this.range).x;this._setPosition(t-this.grabX)},i.prototype._handleEnd=function(e){e.preventDefault(),this._listen(!1),a.emit(this.element,"change",{origin:this.identifier}),(this.isInteracting||this.needTriggerEvents)&&this.options.onSlideEnd&&this.options.onSlideEnd(this.value,this.percent,this.position),this.onSlideEventsCount=0,this.isInteracting=!1},i.prototype._setPosition=function(e){var t=this._getValueFromPosition(r(e,0,this.maxHandleX)),n=this._getPositionFromValue(t);this.fill.style.width=n+this.grabX+"px",this.handle.style.webkitTransform=this.handle.style.transform="translate("+n+"px, 0px)",this._setValue(t),this.position=n,this.value=t,this._updatePercentFromValue(),(this.isInteracting||this.needTriggerEvents)&&(this.options.onSlideStart&&0===this.onSlideEventsCount&&this.options.onSlideStart(this.value,this.percent,this.position),this.options.onSlide&&this.options.onSlide(this.value,this.percent,this.position)),this.onSlideEventsCount++},i.prototype._getPositionFromValue=function(e){var t,n;return t=(e-this.min)/(this.max-this.min),n=t*this.maxHandleX},i.prototype._getValueFromPosition=function(e){var t,n;return t=e/(this.maxHandleX||1),n=this.step*Math.round(t*(this.max-this.min)/this.step)+this.min,Number(n.toFixed(this.toFixed))},i.prototype._setValue=function(e){e===this.value&&e===this.element.value||(this.value=this.element.value=e,a.emit(this.element,"input",{origin:this.identifier}))},i.prototype.update=function(e,t){return e=e||{},this.needTriggerEvents=!!t,a.isFiniteNumber(e.min)&&(this.element.setAttribute("min",""+e.min),this.min=e.min),a.isFiniteNumber(e.max)&&(this.element.setAttribute("max",""+e.max),this.max=e.max),a.isFiniteNumber(e.step)&&(this.element.setAttribute("step",""+e.step),this.step=e.step,this.toFixed=h(e.step)),a.isFiniteNumber(e.value)&&this._setValue(e.value),this._update(),this.onSlideEventsCount=0,this.needTriggerEvents=!1,this},i.prototype.destroy=function(){window.removeEventListener("resize",this._update,!1),l.START_EVENTS.forEach(function(e){this.range.removeEventListener(e,this._startEventListener)},this),this.element.removeEventListener("change",this._changeEventListener),this.element.style.cssText="",delete this.element[u],this.range.parentNode.removeChild(this.range)},i.create=function(e,t){function n(e){e[u]=e[u]||new i(e,t)}e.length?Array.prototype.slice.call(e).forEach(function(e){n(e)}):n(e)},t.exports=i},{"./const":96,"./styles/base.less":98,"./utils":99,clamp:72,debounce:95,"ev-pos":75}],98:[function(e,t,n){var i=".rangeslider {\n  position: relative;\n  cursor: pointer;\n  height: 30px;\n  width: 100%;\n}\n.rangeslider,\n.rangeslider__fill,\n.rangeslider__fill__bg {\n  display: block;\n}\n.rangeslider__fill,\n.rangeslider__fill__bg,\n.rangeslider__handle {\n  position: absolute;\n}\n.rangeslider__fill,\n.rangeslider__fill__bg {\n  top: calc(50% - 6px);\n  height: 12px;\n  z-index: 2;\n  background: #29e;\n  border-radius: 10px;\n  will-change: width;\n}\n.rangeslider__handle {\n  display: inline-block;\n  top: calc(50% - 15px);\n  background: #29e;\n  width: 30px;\n  height: 30px;\n  z-index: 3;\n  cursor: pointer;\n  border: solid 2px #ffffff;\n  border-radius: 50%;\n}\n.rangeslider__handle:active {\n  background: #107ecd;\n}\n.rangeslider__fill__bg {\n  background: #ccc;\n  width: 100%;\n}\n.rangeslider--disabled {\n  opacity: 0.4;\n}\n.rangeslider--slim .rangeslider {\n  height: 25px;\n}\n.rangeslider--slim .rangeslider:active .rangeslider__handle {\n  width: 21px;\n  height: 21px;\n  top: calc(50% - 10.5px);\n  background: #29e;\n}\n.rangeslider--slim .rangeslider__fill,\n.rangeslider--slim .rangeslider__fill__bg {\n  top: calc(50% - 1px);\n  height: 2px;\n}\n.rangeslider--slim .rangeslider__handle {\n  will-change: width, height, top;\n  -webkit-transition: width 0.1s ease-in-out, height 0.1s ease-in-out, top 0.1s ease-in-out;\n  transition: width 0.1s ease-in-out, height 0.1s ease-in-out, top 0.1s ease-in-out;\n  width: 14px;\n  height: 14px;\n  top: calc(50% - 7px);\n}\n";e("lessify")(i),t.exports=i},{lessify:87}],99:[function(e,t,n){"use strict";function i(e){return!(0!==e.offsetWidth&&0!==e.offsetHeight&&e.open!==!1)}function r(e){return c(parseFloat(e))||c(e)}function o(){if(!arguments.length)return null;for(var e=0,t=arguments.length;e<t;e++)if(r(arguments[e]))return arguments[e]}function s(e){for(var t=[],n=e.parentNode;n&&i(n);)t.push(n),n=n.parentNode;return t}function a(e,t){function n(e){"undefined"!=typeof e.open&&(e.open=!e.open)}var i=s(e),r=i.length,o=[],a=e[t];if(r){for(var l=0;l<r;l++){var u=i[l].style;o[l]=u.display,u.display="block",u.height="0",u.overflow="hidden",u.visibility="hidden",n(i[l])}a=e[t];for(var d=0;d<r;d++){var c=i[d].style;n(i[d]),c.display=o[d],c.height="",c.overflow="",c.visibility=""}}return a}function l(e,t){for(t(e);e.parentNode&&!t(e);)e=e.parentNode;return e}function u(e,t){e.parentNode.insertBefore(t,e.nextSibling)}var d=e("custom-event"),c=e("is-finite");t.exports={emit:function(e,t,n){e.dispatchEvent(new d(t,n))},isFiniteNumber:c,getFirstNumberLike:o,getDimension:a,insertAfter:u,forEachAncestorsAndSelf:l}},{"custom-event":74,"is-finite":86}],100:[function(e,t,n){!function(){"use strict";var e="undefined"!=typeof t&&t.exports,n="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var e,t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=n.length,o={};i<r;i++)if(e=n[i],e&&e[1]in document){for(i=0,t=e.length;i<t;i++)o[n[0][i]]=e[i];return o}return!1}(),r={request:function(e){var t=i.requestFullscreen;e=e||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?e[t]():e[t](n&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[i.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},raw:i};return i?(Object.defineProperties(r,{isFullscreen:{get:function(){return!!document[i.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[i.fullscreenEnabled]}}}),void(e?t.exports=r:window.screenfull=r)):void(e?t.exports=!1:window.screenfull=!1)}()},{}],101:[function(t,n,i){!function(t){function i(e,t,n,i){var r,o,s,a,l,u,d,c=t&&t.ownerDocument,h=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return n;if(!i&&((t?t.ownerDocument||t:q)!==N&&F(t),t=t||N,k)){if(11!==h&&(l=_e.exec(e)))if(r=l[1]){if(9===h){if(!(s=t.getElementById(r)))return n;if(s.id===r)return n.push(s),n}else if(c&&(s=c.getElementById(r))&&V(t,s)&&s.id===r)return n.push(s),n}else{if(l[2])return ee.apply(n,t.getElementsByTagName(e)),n;if((r=l[3])&&T.getElementsByClassName&&t.getElementsByClassName)return ee.apply(n,t.getElementsByClassName(r)),n}if(T.qsa&&!G[e+" "]&&(!O||!O.test(e))){if(1!==h)c=t,d=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(Se,Te):t.setAttribute("id",a=j),u=I(e),o=u.length;o--;)u[o]="#"+a+" "+m(u[o]);d=u.join(","),c=be.test(e)&&f(t.parentNode)||t}if(d)try{return ee.apply(n,c.querySelectorAll(d)),n}catch(p){}finally{a===j&&t.removeAttribute("id")}}}return C(e.replace(ue,"$1"),t,n,i)}function r(){function e(n,i){return t.push(n+" ")>w.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function o(e){return e[j]=!0,e}function s(e){var t=N.createElement("fieldset");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),i=n.length;i--;)w.attrHandle[n[i]]=t}function l(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function u(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function d(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&De(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function h(e){return o(function(t){return t=+t,o(function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function f(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function p(){}function m(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function g(e,t,n){var i=t.dir,r=t.next,o=r||i,s=n&&"parentNode"===o,a=Y++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,r);return!1}:function(t,n,l){var u,d,c,h=[z,a];if(l){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(c=t[j]||(t[j]={}),d=c[t.uniqueID]||(c[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[i]||t;else{if((u=d[o])&&u[0]===z&&u[1]===a)return h[2]=u[2];if(d[o]=h,h[2]=e(t,n,l))return!0}return!1}}function y(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function v(e,t,n){for(var r=0,o=t.length;r<o;r++)i(e,t[r],n);return n}function _(e,t,n,i,r){for(var o,s=[],a=0,l=e.length,u=null!=t;a<l;a++)(o=e[a])&&(n&&!n(o,i,r)||(s.push(o),u&&t.push(a)));return s}function b(e,t,n,i,r,s){return i&&!i[j]&&(i=b(i)),r&&!r[j]&&(r=b(r,s)),o(function(o,s,a,l){var u,d,c,h=[],f=[],p=s.length,m=o||v(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?m:_(m,h,e,a,l),y=n?r||(o?e:p||i)?[]:s:g;if(n&&n(g,y,a,l),i)for(u=_(y,f),i(u,[],a,l),d=u.length;d--;)(c=u[d])&&(y[f[d]]=!(g[f[d]]=c));if(o){if(r||e){if(r){for(u=[],d=y.length;d--;)(c=y[d])&&u.push(g[d]=c);r(null,y=[],u,l)}for(d=y.length;d--;)(c=y[d])&&(u=r?ne(o,c):h[d])>-1&&(o[u]=!(s[u]=c))}}else y=_(y===s?y.splice(p,y.length):y),r?r(null,s,y,l):ee.apply(s,y)})}function E(e){for(var t,n,i,r=e.length,o=w.relative[e[0].type],s=o||w.relative[" "],a=o?1:0,l=g(function(e){return e===t},s,!0),u=g(function(e){return ne(t,e)>-1},s,!0),d=[function(e,n,i){var r=!o&&(i||n!==R)||((t=n).nodeType?l(e,n,i):u(e,n,i));return t=null,r}];a<r;a++)if(n=w.relative[e[a].type])d=[g(y(d),n)];else{if(n=w.filter[e[a].type].apply(null,e[a].matches),n[j]){for(i=++a;i<r&&!w.relative[e[i].type];i++);return b(a>1&&y(d),a>1&&m(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ue,"$1"),n,a<i&&E(e.slice(a,i)),i<r&&E(e=e.slice(i)),i<r&&m(e))}d.push(n)}return y(d)}function x(e,t){var n=t.length>0,r=e.length>0,s=function(o,s,a,l,u){var d,c,h,f=0,p="0",m=o&&[],g=[],y=R,v=o||r&&w.find.TAG("*",u),b=z+=null==y?1:Math.random()||.1,E=v.length;for(u&&(R=s===N||s||u);p!==E&&null!=(d=v[p]);p++){if(r&&d){for(c=0,s||d.ownerDocument===N||(F(d),a=!k);h=e[c++];)if(h(d,s||N,a)){l.push(d);break}u&&(z=b)}n&&((d=!h&&d)&&f--,o&&m.push(d))}if(f+=p,n&&p!==f){for(c=0;h=t[c++];)h(m,g,s,a);if(o){if(f>0)for(;p--;)m[p]||g[p]||(g[p]=Z.call(l));g=_(g)}ee.apply(l,g),u&&!o&&g.length>0&&f+t.length>1&&i.uniqueSort(l)}return u&&(z=b,R=y),m};return n?o(s):s}var S,T,w,D,M,I,L,C,R,A,P,F,N,B,k,O,U,H,V,j="sizzle"+1*new Date,q=t.document,z=0,Y=0,K=r(),W=r(),G=r(),X=function(e,t){return e===t&&(P=!0),0},$={}.hasOwnProperty,Q=[],Z=Q.pop,J=Q.push,ee=Q.push,te=Q.slice,ne=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",re="[\\x20\\t\\r\\n\\f]",oe="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",se="\\["+re+"*("+oe+")(?:"+re+"*([*^$|!~]?=)"+re+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+re+"*\\]",ae=":("+oe+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",le=new RegExp(re+"+","g"),ue=new RegExp("^"+re+"+|((?:^|[^\\\\])(?:\\\\.)*)"+re+"+$","g"),de=new RegExp("^"+re+"*,"+re+"*"),ce=new RegExp("^"+re+"*([>+~]|"+re+")"+re+"*"),he=new RegExp("="+re+"*([^\\]'\"]*?)"+re+"*\\]","g"),fe=new RegExp(ae),pe=new RegExp("^"+oe+"$"),me={ID:new RegExp("^#("+oe+")"),CLASS:new RegExp("^\\.("+oe+")"),TAG:new RegExp("^("+oe+"|[*])"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+re+"*(even|odd|(([+-]|)(\\d*)n|)"+re+"*(?:([+-]|)"+re+"*(\\d+)|))"+re+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+re+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+re+"*((?:-\\d)?\\d*)"+re+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,ye=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,_e=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,Ee=new RegExp("\\\\([\\da-f]{1,6}"+re+"?|("+re+")|.)","ig"),xe=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Se=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Te=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},we=function(){F()},De=g(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{ee.apply(Q=te.call(q.childNodes),q.childNodes),Q[q.childNodes.length].nodeType}catch(Me){ee={apply:Q.length?function(e,t){J.apply(e,te.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}T=i.support={},M=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},F=i.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:q;return i!==N&&9===i.nodeType&&i.documentElement?(N=i,B=N.documentElement,k=!M(N),q!==N&&(n=N.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",we,!1):n.attachEvent&&n.attachEvent("onunload",we)),T.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),T.getElementsByTagName=s(function(e){return e.appendChild(N.createComment("")),!e.getElementsByTagName("*").length}),T.getElementsByClassName=ve.test(N.getElementsByClassName),T.getById=s(function(e){return B.appendChild(e).id=j,!N.getElementsByName||!N.getElementsByName(j).length}),T.getById?(w.filter.ID=function(e){var t=e.replace(Ee,xe);return function(e){return e.getAttribute("id")===t}},w.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&k){var n=t.getElementById(e);return n?[n]:[]}}):(w.filter.ID=function(e){var t=e.replace(Ee,xe);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},w.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&k){var n,i,r,o=t.getElementById(e);if(o){if(n=o.getAttributeNode("id"),n&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if(n=o.getAttributeNode("id"),n&&n.value===e)return[o]}return[]}}),w.find.TAG=T.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):T.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},w.find.CLASS=T.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&k)return t.getElementsByClassName(e)},U=[],O=[],(T.qsa=ve.test(N.querySelectorAll))&&(s(function(e){B.appendChild(e).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+re+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+re+"*(?:value|"+ie+")"),e.querySelectorAll("[id~="+j+"-]").length||O.push("~="),e.querySelectorAll(":checked").length||O.push(":checked"),e.querySelectorAll("a#"+j+"+*").length||O.push(".#.+[+~]")}),s(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=N.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+re+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&O.push(":enabled",":disabled"),B.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(T.matchesSelector=ve.test(H=B.matches||B.webkitMatchesSelector||B.mozMatchesSelector||B.oMatchesSelector||B.msMatchesSelector))&&s(function(e){T.disconnectedMatch=H.call(e,"*"),H.call(e,"[s!='']:x"),U.push("!=",ae)}),O=O.length&&new RegExp(O.join("|")),U=U.length&&new RegExp(U.join("|")),t=ve.test(B.compareDocumentPosition),V=t||ve.test(B.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=t?function(e,t){if(e===t)return P=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!T.sortDetached&&t.compareDocumentPosition(e)===n?e===N||e.ownerDocument===q&&V(q,e)?-1:t===N||t.ownerDocument===q&&V(q,t)?1:A?ne(A,e)-ne(A,t):0:4&n?-1:1)}:function(e,t){if(e===t)return P=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!r||!o)return e===N?-1:t===N?1:r?-1:o?1:A?ne(A,e)-ne(A,t):0;if(r===o)return l(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?l(s[i],a[i]):s[i]===q?-1:a[i]===q?1:0},N):N},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==N&&F(e),t=t.replace(he,"='$1']"),T.matchesSelector&&k&&!G[t+" "]&&(!U||!U.test(t))&&(!O||!O.test(t)))try{var n=H.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return i(t,N,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==N&&F(e),V(e,t)},i.attr=function(e,t){(e.ownerDocument||e)!==N&&F(e);var n=w.attrHandle[t.toLowerCase()],i=n&&$.call(w.attrHandle,t.toLowerCase())?n(e,t,!k):void 0;return void 0!==i?i:T.attributes||!k?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},i.escape=function(e){return(e+"").replace(Se,Te)},i.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,n=[],i=0,r=0;if(P=!T.detectDuplicates,A=!T.sortStable&&e.slice(0),e.sort(X),P){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return A=null,e},D=i.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=D(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=D(t);return n},w=i.selectors={cacheLength:50,createPseudo:o,match:me,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ee,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(Ee,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return me.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&fe.test(n)&&(t=I(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ee,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=K[e+" "];return t||(t=new RegExp("(^|"+re+")"+e+"("+re+"|$)"))&&K(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var o=i.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o.replace(le," ")+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var u,d,c,h,f,p,m=o!==s?"nextSibling":"previousSibling",g=t.parentNode,y=a&&t.nodeName.toLowerCase(),v=!l&&!a,_=!1;if(g){if(o){for(;m;){for(h=t;h=h[m];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?g.firstChild:g.lastChild],s&&v){for(h=g,c=h[j]||(h[j]={}),d=c[h.uniqueID]||(c[h.uniqueID]={}),u=d[e]||[],f=u[0]===z&&u[1],_=f&&u[2],h=f&&g.childNodes[f];h=++f&&h&&h[m]||(_=f=0)||p.pop();)if(1===h.nodeType&&++_&&h===t){d[e]=[z,f,_];break}}else if(v&&(h=t,c=h[j]||(h[j]={}),d=c[h.uniqueID]||(c[h.uniqueID]={}),u=d[e]||[],f=u[0]===z&&u[1],_=f),_===!1)for(;(h=++f&&h&&h[m]||(_=f=0)||p.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++_||(v&&(c=h[j]||(h[j]={}),d=c[h.uniqueID]||(c[h.uniqueID]={}),d[e]=[z,_]),h!==t)););return _-=r,_===i||_%i===0&&_/i>=0}}},PSEUDO:function(e,t){var n,r=w.pseudos[e]||w.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return r[j]?r(t):r.length>1?(n=[e,e,"",t],w.setFilters.hasOwnProperty(e.toLowerCase())?o(function(e,n){for(var i,o=r(e,t),s=o.length;s--;)i=ne(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:o(function(e){var t=[],n=[],i=L(e.replace(ue,"$1"));return i[j]?o(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:o(function(e){return function(t){return i(e,t).length>0}}),contains:o(function(e){return e=e.replace(Ee,xe),function(t){return(t.textContent||t.innerText||D(t)).indexOf(e)>-1}}),lang:o(function(e){return pe.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(Ee,xe).toLowerCase(),function(t){var n;do if(n=k?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(e){return e===B},focus:function(e){return e===N.activeElement&&(!N.hasFocus||N.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:c(!1),disabled:c(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return ye.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:h(function(){return[0]}),last:h(function(e,t){return[t-1]}),eq:h(function(e,t,n){return[n<0?n+t:n]}),even:h(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:h(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:h(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:h(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}},w.pseudos.nth=w.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[S]=u(S);for(S in{submit:!0,reset:!0})w.pseudos[S]=d(S);p.prototype=w.filters=w.pseudos,w.setFilters=new p,I=i.tokenize=function(e,t){var n,r,o,s,a,l,u,d=W[e+" "];
if(d)return t?0:d.slice(0);for(a=e,l=[],u=w.preFilter;a;){n&&!(r=de.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=ce.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ue," ")}),a=a.slice(n.length));for(s in w.filter)!(r=me[s].exec(a))||u[s]&&!(r=u[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?i.error(e):W(e,l).slice(0)},L=i.compile=function(e,t){var n,i=[],r=[],o=G[e+" "];if(!o){for(t||(t=I(e)),n=t.length;n--;)o=E(t[n]),o[j]?i.push(o):r.push(o);o=G(e,x(r,i)),o.selector=e}return o},C=i.select=function(e,t,n,i){var r,o,s,a,l,u="function"==typeof e&&e,d=!i&&I(e=u.selector||e);if(n=n||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&k&&w.relative[o[1].type]){if(t=(w.find.ID(s.matches[0].replace(Ee,xe),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=me.needsContext.test(e)?0:o.length;r--&&(s=o[r],!w.relative[a=s.type]);)if((l=w.find[a])&&(i=l(s.matches[0].replace(Ee,xe),be.test(o[0].type)&&f(t.parentNode)||t))){if(o.splice(r,1),e=i.length&&m(o),!e)return ee.apply(n,i),n;break}}return(u||L(e,d))(i,t,!k,n,!t||be.test(e)&&f(t.parentNode)||t),n},T.sortStable=j.split("").sort(X).join("")===j,T.detectDuplicates=!!P,F(),T.sortDetached=s(function(e){return 1&e.compareDocumentPosition(N.createElement("fieldset"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),T.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||a(ie,function(e,t,n){var i;if(!n)return e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null});var Ie=t.Sizzle;i.noConflict=function(){return t.Sizzle===i&&(t.Sizzle=Ie),i},"function"==typeof e&&e.amd?e(function(){return i}):"undefined"!=typeof n&&n.exports?n.exports=i:t.Sizzle=i}(window)},{}]},{},[40])(40)});